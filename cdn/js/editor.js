/*! For license information please see editor.js.LICENSE.txt */
try{let t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},e=(new t.Error).stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="4af7c5a1-2ff7-4171-80ef-228ac0b83417",t._sentryDebugIdIdentifier="sentry-dbid-4af7c5a1-2ff7-4171-80ef-228ac0b83417")}catch(t){}{let t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};t.SENTRY_RELEASE={id:"87056d371f99c571993de8147406d3762ac20646"}}(()=>{var __webpack_modules__={312:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},694:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Immutable=function t(e){return i.IsArray(e)?function(e){return globalThis.Object.freeze(e).map((e=>t(e)))}(e):i.IsDate(e)||i.IsUint8Array(e)||i.IsRegExp(e)?e:i.IsObject(e)?function(e){const i={};for(const r of Object.getOwnPropertyNames(e))i[r]=t(e[r]);for(const r of Object.getOwnPropertySymbols(e))i[r]=t(e[r]);return globalThis.Object.freeze(i)}(e):e};const i=e(72862)},786:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Intrinsic=d;const i=e(30768),r=e(61198),n=e(64833),s=e(12881),o=e(85713),a=e(51049);function l(t,e){return"string"==typeof t?"Uncapitalize"===e?function(t){const[e,i]=[t.slice(0,1),t.slice(1)];return[e.toLowerCase(),i].join("")}(t):"Capitalize"===e?function(t){const[e,i]=[t.slice(0,1),t.slice(1)];return[e.toUpperCase(),i].join("")}(t):"Uppercase"===e?function(t){return t.toUpperCase()}(t):"Lowercase"===e?function(t){return t.toLowerCase()}(t):t:t.toString()}function h(t,e){return t.map((t=>d(t,e)))}function d(t,e,d={}){return(0,a.IsMappedKey)(t)?(0,n.IntrinsicFromMappedKey)(t,e,d):(0,a.IsTemplateLiteral)(t)?function(t,e,i){const n=(0,r.TemplateLiteralParseExact)(t.pattern);if(!(0,r.IsTemplateLiteralExpressionFinite)(n))return{...t,pattern:l(t.pattern,e)};const a=h([...(0,r.TemplateLiteralExpressionGenerate)(n)].map((t=>(0,s.Literal)(t))),e),d=(0,o.Union)(a);return(0,r.TemplateLiteral)([d],i)}(t,e,d):(0,a.IsUnion)(t)?(0,o.Union)(h(t.anyOf,e),d):(0,a.IsLiteral)(t)?(0,s.Literal)(l(t.const,e),d):(0,i.CreateType)(t,d)}},940:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(76166),exports)},968:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},1039:(t,exports)=>{"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProductProcessorsEnum=void 0,function(t){t.ATTR_VALUE_PARSER="attr_value_parser",t.AUTOPICK="autopick",t.SIZE="size",t.DELIVERY_SHEET_SIZES="delivery_sheet_sizes",t.DELIVERY_ROLL="delivery_roll",t.OUT_OF_STOCK="out_of_stock"}(e||(exports.ProductProcessorsEnum=e={}))},1151:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(58503),exports)},1358:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(5171),exports),r(e(46516),exports)},1432:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Unsafe=function(t={}){return(0,i.CreateType)({[r.Kind]:t[r.Kind]??"Unsafe"},t)};const i=e(30768),r=e(73967)},2531:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.KeyOfPropertyKeys=s,exports.KeyOfPattern=function(t){o=!0;const e=s(t);return o=!1,`^(${e.map((t=>`(${t})`)).join("|")})$`};const i=e(48607),r=e(51049);function n(t){const e=[];for(const i of t)e.push(s(i));return e}function s(t){return(0,r.IsIntersect)(t)?function(t){const e=n(t);return(0,i.SetUnionMany)(e)}(t.allOf):(0,r.IsUnion)(t)?function(t){const e=n(t);return(0,i.SetIntersectMany)(e)}(t.anyOf):(0,r.IsTuple)(t)?function(t){return t.map(((t,e)=>e.toString()))}(t.items??[]):(0,r.IsArray)(t)?(t.items,["[number]"]):(0,r.IsObject)(t)?function(t){return globalThis.Object.getOwnPropertyNames(t)}(t.properties):(0,r.IsRecord)(t)?(e=t.patternProperties,o?globalThis.Object.getOwnPropertyNames(e).map((t=>"^"===t[0]&&"$"===t[t.length-1]?t.slice(1,t.length-1):t)):[]):[];var e}let o=!1},2562:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ReadonlyOptional=function(t){return(0,i.Readonly)((0,r.Optional)(t))};const i=e(13204),r=e(27822)},2698:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Value=exports.ValueErrorIterator=exports.ValueErrorType=void 0;var n=e(1358);Object.defineProperty(exports,"ValueErrorType",{enumerable:!0,get:function(){return n.ValueErrorType}}),Object.defineProperty(exports,"ValueErrorIterator",{enumerable:!0,get:function(){return n.ValueErrorIterator}}),r(e(79968),exports),r(e(38717),exports),r(e(13167),exports),r(e(97069),exports),r(e(54040),exports),r(e(41120),exports),r(e(24906),exports),r(e(1151),exports),r(e(85221),exports),r(e(97476),exports),r(e(64895),exports),r(e(38521),exports),r(e(27593),exports),r(e(13863),exports),r(e(92217),exports),r(e(57234),exports),r(e(51056),exports),r(e(81069),exports);var s=e(55160);Object.defineProperty(exports,"Value",{enumerable:!0,get:function(){return s.Value}})},3047:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AutoPickAttrProcessor=void 0,exports.AutoPickAttrProcessor=class{constructor(t,e,i,r){this.autoOptDefaultValue=t,this.cherryPicks=e,this.ignoreAttributeFromAutoPickerCallback=i,this.isAttributeRequiredCallback=r}invoke(t,e){let i=!0,r=0;for(;i&&(r++,e.evaluate(t),i=this.autoPickAttributes(t,e),!(r>=5)););for(i=!0,r=0;i&&(r++,e.evaluate(t),i=this.tryAutoPickFromCherries(t,e),!(r>=5)););return!i&&1==r}autoPickAttributes(t,e){const i=this.getAttributesAsString(t);for(const i in e.getAttributes()){if(this.ignoreAttributeFromAutoPickerCallback(i))continue;const r=null==t?void 0:t.getAttribute(i);if(r||this.isAttributeRequiredCallback(i)){const n=this.cherryPicks.getAttribute(i);this.autoPick(t,e,i,r,n)}}return i!=this.getAttributesAsString(t)}tryAutoPickFromCherries(t,e){const i=this.getAttributesAsString(t);for(const i in e.getAttributes())if(this.cherryPicks.hasAttribute(i)){const r=this.cherryPicks.getAttribute(i),n=null==t?void 0:t.getAttribute(i);n&&n==r||this.autoPick(t,e,i,n,r)}return i!=this.getAttributesAsString(t)}autoPick(t,e,i,r,n){if(null==e?void 0:e.isMultiValue(i)){Array.isArray(r)||(r=[r]);let s=r.filter((t=>e.isAvailable(i,t)));n&&(n=n.filter((t=>e.isAvailable(i,t)&&s.indexOf(t)<0)),s=[...s,...n]),this.cherryPicks.maybeRegisterALost(i,s),null==t||t.setAttribute(i,s)}else{const s=e.getDefaultValue(i);let o=null==r&&!this.isAttributeRequiredCallback(i)||e.isAvailable(i,r)?r:s;!o&&e.isDynamicValue(i)&&s&&(o=s),n&&e.isAvailable(i,n)&&!e.isDynamicValue(i)&&(o=n),this.cherryPicks.maybeRegisterALost(i,o),t.setAttribute(i,o)}}shouldAutoOptForDefaultValue(t){return this.autoOptDefaultValue.indexOf(t)>=0}getAttributesAsString(t){return Object.entries(t.getAttributes()).map((([t,e])=>`|${t}:${e}|`)).join("")}}},3110:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Partial=function(t,e){return(0,d.IsMappedResult)(t)?(0,h.PartialFromMappedResult)(t,e):(0,i.CreateType)({...u(t),...e})};const i=e(30768),r=e(27822),n=e(6905),s=e(65495),o=e(85713),a=e(940),l=e(73967),h=e(30341),d=e(51049);function c(t){return t.map((t=>u(t)))}function u(t){return(0,d.IsIntersect)(t)?(0,s.Intersect)(c(t.allOf)):(0,d.IsUnion)(t)?(0,o.Union)(c(t.anyOf)):(0,d.IsObject)(t)?function(t){const e=(0,a.Discard)(t,[l.TransformKind,"$id","required","properties"]),i=function(t){const e={};for(const i of globalThis.Object.getOwnPropertyNames(t))e[i]=(0,r.Optional)(t[i]);return e}(t.properties);return(0,n.Object)(i,e)}(t):(0,n.Object)({})}},3233:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},3251:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(24570),exports)},3665:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Convert=function(...t){return 3===t.length?p(t[0],t[1],t[2]):p(t[0],[],t[1])};const i=e(41120),r=e(97069),n=e(62413),s=e(73967),o=e(79968);function a(t){return(0,o.IsString)(t)&&!isNaN(t)&&!isNaN(parseFloat(t))}function l(t){return!0===t||(0,o.IsNumber)(t)&&1===t||(0,o.IsBigInt)(t)&&t===BigInt("1")||(0,o.IsString)(t)&&("true"===t.toLowerCase()||"1"===t)}function h(t){return!1===t||(0,o.IsNumber)(t)&&(0===t||Object.is(t,-0))||(0,o.IsBigInt)(t)&&t===BigInt("0")||(0,o.IsString)(t)&&("false"===t.toLowerCase()||"0"===t||"-0"===t)}function d(t){return!!l(t)||!h(t)&&t}function c(t){return function(t){return(0,o.IsBigInt)(t)||(0,o.IsBoolean)(t)||(0,o.IsNumber)(t)}(t)?t.toString():(0,o.IsSymbol)(t)&&void 0!==t.description?t.description.toString():t}function u(t){return a(t)?parseFloat(t):l(t)?1:h(t)?0:t}function p(t,e,g){const m=(0,n.Pushref)(t,e),f=t;switch(t[s.Kind]){case"Array":return function(t,e,i){return((0,o.IsArray)(i)?i:[i]).map((i=>p(t.items,e,i)))}(f,m,g);case"BigInt":return function(t,e,i){return function(t){return a(t)?BigInt((t=>t.split(".")[0])(t)):(0,o.IsNumber)(t)?BigInt(Math.trunc(t)):h(t)?BigInt(0):l(t)?BigInt(1):t}(i)}(0,0,g);case"Boolean":return function(t,e,i){return d(i)}(0,0,g);case"Date":return function(t,e,i){return function(t){return(0,o.IsDate)(t)?t:(0,o.IsNumber)(t)?new Date(t):l(t)?new Date(1):h(t)?new Date(0):a(t)?new Date(parseInt(t)):function(t){return(0,o.IsString)(t)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test(t)}(t)?new Date(`1970-01-01T${t}.000Z`):function(t){return(0,o.IsString)(t)&&/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test(t)}(t)?new Date(`1970-01-01T${t}`):function(t){return(0,o.IsString)(t)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)?$/i.test(t)}(t)?new Date(`${t}.000Z`):function(t){return(0,o.IsString)(t)&&/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i.test(t)}(t)?new Date(t):function(t){return(0,o.IsString)(t)&&/^\d\d\d\d-[0-1]\d-[0-3]\d$/i.test(t)}(t)?new Date(`${t}T00:00:00.000Z`):t}(i)}(0,0,g);case"Integer":return function(t,e,i){return function(t){return a(t)?parseInt(t):(0,o.IsNumber)(t)?0|t:l(t)?1:h(t)?0:t}(i)}(0,0,g);case"Intersect":return function(t,e,i){return t.allOf.reduce(((t,i)=>p(i,e,t)),i)}(f,m,g);case"Literal":return function(t,e,i){return function(t,e){return(0,o.IsString)(t.const)?function(t,e){const i=c(t);return i===e?i:t}(e,t.const):(0,o.IsNumber)(t.const)?function(t,e){const i=u(t);return i===e?i:t}(e,t.const):(0,o.IsBoolean)(t.const)?function(t,e){const i=d(t);return i===e?i:t}(e,t.const):e}(t,i)}(f,0,g);case"Null":return function(t,e,i){return function(t){return(0,o.IsString)(t)&&"null"===t.toLowerCase()?null:t}(i)}(0,0,g);case"Number":return function(t,e,i){return u(i)}(0,0,g);case"Object":return function(t,e,i){if(!(0,o.IsObject)(i))return i;for(const r of Object.getOwnPropertyNames(t.properties))(0,o.HasPropertyKey)(i,r)&&(i[r]=p(t.properties[r],e,i[r]));return i}(f,m,g);case"Record":return function(t,e,i){if(!(0,o.IsObject)(i))return i;const r=Object.getOwnPropertyNames(t.patternProperties)[0],n=t.patternProperties[r];for(const[t,r]of Object.entries(i))i[t]=p(n,e,r);return i}(f,m,g);case"Ref":case"This":return function(t,e,i){return p((0,n.Deref)(t,e),e,i)}(f,m,g);case"String":return function(t,e,i){return c(i)}(0,0,g);case"Symbol":return function(t,e,i){return(0,o.IsString)(i)||(0,o.IsNumber)(i)?Symbol(i):i}(0,0,g);case"Tuple":return function(t,e,i){return(0,o.IsArray)(i)&&!(0,o.IsUndefined)(t.items)?i.map(((i,r)=>r<t.items.length?p(t.items[r],e,i):i)):i}(f,m,g);case"Undefined":return function(t,e,i){return function(t){return(0,o.IsString)(t)&&"undefined"===t?void 0:t}(i)}(0,0,g);case"Union":return function(t,e,n){for(const s of t.anyOf){const t=p(s,e,(0,i.Clone)(n));if((0,r.Check)(s,e,t))return t}return n}(f,m,g);default:return g}}},3807:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IntersectCreate=function(t,e={}){const s=t.every((t=>(0,n.IsObject)(t))),o=(0,n.IsSchema)(e.unevaluatedProperties)?{unevaluatedProperties:e.unevaluatedProperties}:{};return(0,i.CreateType)(!1===e.unevaluatedProperties||(0,n.IsSchema)(e.unevaluatedProperties)||s?{...o,[r.Kind]:"Intersect",type:"object",allOf:t}:{...o,[r.Kind]:"Intersect",allOf:t},e)};const i=e(30768),r=e(73967),n=e(51049)},4195:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TemplateLiteralSyntax=function(t){return[...c(t)]};const i=e(12881),r=e(99974),n=e(63317),s=e(3251),o=e(11231),a=e(85713),l=e(72492);function*h(t){const e=t.trim().replace(/"|'/g,"");return"boolean"===e?yield(0,r.Boolean)():"number"===e?yield(0,s.Number)():"bigint"===e?yield(0,n.BigInt)():"string"===e?yield(0,o.String)():yield(()=>{const t=e.split("|").map((t=>(0,i.Literal)(t.trim())));return 0===t.length?(0,l.Never)():1===t.length?t[0]:(0,a.UnionEvaluated)(t)})()}function*d(t){if("{"!==t[1]){const e=(0,i.Literal)("$"),r=c(t.slice(1));return yield*[e,...r]}for(let e=2;e<t.length;e++)if("}"===t[e]){const i=h(t.slice(2,e)),r=c(t.slice(e+1));return yield*[...i,...r]}yield(0,i.Literal)(t)}function*c(t){for(let e=0;e<t.length;e++)if("$"===t[e]){const r=(0,i.Literal)(t.slice(0,e)),n=d(t.slice(e));return yield*[r,...n]}yield(0,i.Literal)(t)}},4443:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TypeGuardUnknownTypeError=void 0,exports.IsReadonly=function(t){return i.IsObject(t)&&"Readonly"===t[r.ReadonlyKind]},exports.IsOptional=function(t){return i.IsObject(t)&&"Optional"===t[r.OptionalKind]},exports.IsAny=m,exports.IsArray=f,exports.IsAsyncIterator=v,exports.IsBigInt=b,exports.IsBoolean=y,exports.IsConstructor=_,exports.IsDate=T,exports.IsFunction=x,exports.IsInteger=w,exports.IsProperties=E,exports.IsIntersect=A,exports.IsIterator=P,exports.IsKindOf=S,exports.IsLiteralString=O,exports.IsLiteralNumber=M,exports.IsLiteralBoolean=function(t){return C(t)&&i.IsBoolean(t.const)},exports.IsLiteral=C,exports.IsLiteralValue=I,exports.IsMappedKey=k,exports.IsMappedResult=N,exports.IsNever=L,exports.IsNot=D,exports.IsNull=B,exports.IsNumber=R,exports.IsObject=j,exports.IsPromise=q,exports.IsRecord=V,exports.IsRecursive=function(t){return i.IsObject(t)&&r.Hint in t&&"Recursive"===t[r.Hint]},exports.IsRef=F,exports.IsRegExp=H,exports.IsString=z,exports.IsSymbol=U,exports.IsTemplateLiteral=G,exports.IsThis=Z,exports.IsTransform=W,exports.IsTuple=K,exports.IsUndefined=Y,exports.IsUnionLiteral=function(t){return X(t)&&t.anyOf.every((t=>O(t)||M(t)))},exports.IsUnion=X,exports.IsUint8Array=Q,exports.IsUnknown=J,exports.IsUnsafe=tt,exports.IsVoid=et,exports.IsKind=it,exports.IsSchema=rt;const i=e(72862),r=e(73967),n=e(87580);class s extends n.TypeBoxError{}exports.TypeGuardUnknownTypeError=s;const o=["Any","Array","AsyncIterator","BigInt","Boolean","Constructor","Date","Enum","Function","Integer","Intersect","Iterator","Literal","MappedKey","MappedResult","Not","Null","Number","Object","Promise","Record","Ref","RegExp","String","Symbol","TemplateLiteral","This","Tuple","Undefined","Union","Uint8Array","Unknown","Void"];function a(t){try{return new RegExp(t),!0}catch{return!1}}function l(t){if(!i.IsString(t))return!1;for(let e=0;e<t.length;e++){const i=t.charCodeAt(e);if(i>=7&&i<=13||27===i||127===i)return!1}return!0}function h(t){return u(t)||rt(t)}function d(t){return i.IsUndefined(t)||i.IsBigInt(t)}function c(t){return i.IsUndefined(t)||i.IsNumber(t)}function u(t){return i.IsUndefined(t)||i.IsBoolean(t)}function p(t){return i.IsUndefined(t)||i.IsString(t)}function g(t){return i.IsUndefined(t)||rt(t)}function m(t){return S(t,"Any")&&p(t.$id)}function f(t){return S(t,"Array")&&"array"===t.type&&p(t.$id)&&rt(t.items)&&c(t.minItems)&&c(t.maxItems)&&u(t.uniqueItems)&&g(t.contains)&&c(t.minContains)&&c(t.maxContains)}function v(t){return S(t,"AsyncIterator")&&"AsyncIterator"===t.type&&p(t.$id)&&rt(t.items)}function b(t){return S(t,"BigInt")&&"bigint"===t.type&&p(t.$id)&&d(t.exclusiveMaximum)&&d(t.exclusiveMinimum)&&d(t.maximum)&&d(t.minimum)&&d(t.multipleOf)}function y(t){return S(t,"Boolean")&&"boolean"===t.type&&p(t.$id)}function _(t){return S(t,"Constructor")&&"Constructor"===t.type&&p(t.$id)&&i.IsArray(t.parameters)&&t.parameters.every((t=>rt(t)))&&rt(t.returns)}function T(t){return S(t,"Date")&&"Date"===t.type&&p(t.$id)&&c(t.exclusiveMaximumTimestamp)&&c(t.exclusiveMinimumTimestamp)&&c(t.maximumTimestamp)&&c(t.minimumTimestamp)&&c(t.multipleOfTimestamp)}function x(t){return S(t,"Function")&&"Function"===t.type&&p(t.$id)&&i.IsArray(t.parameters)&&t.parameters.every((t=>rt(t)))&&rt(t.returns)}function w(t){return S(t,"Integer")&&"integer"===t.type&&p(t.$id)&&c(t.exclusiveMaximum)&&c(t.exclusiveMinimum)&&c(t.maximum)&&c(t.minimum)&&c(t.multipleOf)}function E(t){return i.IsObject(t)&&Object.entries(t).every((([t,e])=>l(t)&&rt(e)))}function A(t){return S(t,"Intersect")&&(!i.IsString(t.type)||"object"===t.type)&&i.IsArray(t.allOf)&&t.allOf.every((t=>rt(t)&&!W(t)))&&p(t.type)&&(u(t.unevaluatedProperties)||g(t.unevaluatedProperties))&&p(t.$id)}function P(t){return S(t,"Iterator")&&"Iterator"===t.type&&p(t.$id)&&rt(t.items)}function S(t,e){return i.IsObject(t)&&r.Kind in t&&t[r.Kind]===e}function O(t){return C(t)&&i.IsString(t.const)}function M(t){return C(t)&&i.IsNumber(t.const)}function C(t){return S(t,"Literal")&&p(t.$id)&&I(t.const)}function I(t){return i.IsBoolean(t)||i.IsNumber(t)||i.IsString(t)}function k(t){return S(t,"MappedKey")&&i.IsArray(t.keys)&&t.keys.every((t=>i.IsNumber(t)||i.IsString(t)))}function N(t){return S(t,"MappedResult")&&E(t.properties)}function L(t){return S(t,"Never")&&i.IsObject(t.not)&&0===Object.getOwnPropertyNames(t.not).length}function D(t){return S(t,"Not")&&rt(t.not)}function B(t){return S(t,"Null")&&"null"===t.type&&p(t.$id)}function R(t){return S(t,"Number")&&"number"===t.type&&p(t.$id)&&c(t.exclusiveMaximum)&&c(t.exclusiveMinimum)&&c(t.maximum)&&c(t.minimum)&&c(t.multipleOf)}function j(t){return S(t,"Object")&&"object"===t.type&&p(t.$id)&&E(t.properties)&&h(t.additionalProperties)&&c(t.minProperties)&&c(t.maxProperties)}function q(t){return S(t,"Promise")&&"Promise"===t.type&&p(t.$id)&&rt(t.item)}function V(t){return S(t,"Record")&&"object"===t.type&&p(t.$id)&&h(t.additionalProperties)&&i.IsObject(t.patternProperties)&&(t=>{const e=Object.getOwnPropertyNames(t.patternProperties);return 1===e.length&&a(e[0])&&i.IsObject(t.patternProperties)&&rt(t.patternProperties[e[0]])})(t)}function F(t){return S(t,"Ref")&&p(t.$id)&&i.IsString(t.$ref)}function H(t){return S(t,"RegExp")&&p(t.$id)&&i.IsString(t.source)&&i.IsString(t.flags)&&c(t.maxLength)&&c(t.minLength)}function z(t){return S(t,"String")&&"string"===t.type&&p(t.$id)&&c(t.minLength)&&c(t.maxLength)&&function(t){return i.IsUndefined(t)||i.IsString(t)&&l(t)&&a(t)}(t.pattern)&&function(t){return i.IsUndefined(t)||i.IsString(t)&&l(t)}(t.format)}function U(t){return S(t,"Symbol")&&"symbol"===t.type&&p(t.$id)}function G(t){return S(t,"TemplateLiteral")&&"string"===t.type&&i.IsString(t.pattern)&&"^"===t.pattern[0]&&"$"===t.pattern[t.pattern.length-1]}function Z(t){return S(t,"This")&&p(t.$id)&&i.IsString(t.$ref)}function W(t){return i.IsObject(t)&&r.TransformKind in t}function K(t){return S(t,"Tuple")&&"array"===t.type&&p(t.$id)&&i.IsNumber(t.minItems)&&i.IsNumber(t.maxItems)&&t.minItems===t.maxItems&&(i.IsUndefined(t.items)&&i.IsUndefined(t.additionalItems)&&0===t.minItems||i.IsArray(t.items)&&t.items.every((t=>rt(t))))}function Y(t){return S(t,"Undefined")&&"undefined"===t.type&&p(t.$id)}function X(t){return S(t,"Union")&&p(t.$id)&&i.IsObject(t)&&i.IsArray(t.anyOf)&&t.anyOf.every((t=>rt(t)))}function Q(t){return S(t,"Uint8Array")&&"Uint8Array"===t.type&&p(t.$id)&&c(t.minByteLength)&&c(t.maxByteLength)}function J(t){return S(t,"Unknown")&&p(t.$id)}function tt(t){return S(t,"Unsafe")}function et(t){return S(t,"Void")&&"void"===t.type&&p(t.$id)}function it(t){return i.IsObject(t)&&r.Kind in t&&i.IsString(t[r.Kind])&&!o.includes(t[r.Kind])}function rt(t){return i.IsObject(t)&&(m(t)||f(t)||y(t)||b(t)||v(t)||_(t)||T(t)||x(t)||w(t)||A(t)||P(t)||C(t)||k(t)||N(t)||L(t)||D(t)||B(t)||R(t)||j(t)||q(t)||V(t)||F(t)||H(t)||z(t)||U(t)||G(t)||Z(t)||K(t)||Y(t)||X(t)||Q(t)||J(t)||tt(t)||et(t)||it(t))}},4830:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AsyncIterator=function(t,e){return(0,r.CreateType)({[i.Kind]:"AsyncIterator",type:"AsyncIterator",items:t},e)};const i=e(73967),r=e(30768)},5171:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ValueErrorIterator=exports.ValueErrorsUnknownTypeError=exports.ValueErrorType=void 0,exports.Errors=function(...t){const e=3===t.length?_(t[0],t[1],"",t[2]):_(t[0],[],"",t[1]);return new b(e)};const i=e(90816),r=e(39260),n=e(9881),s=e(38551),o=e(46516),a=e(87580),l=e(62413),h=e(13863),d=e(97069),c=e(73967),u=e(72492),p=e(79968);var g;!function(t){t[t.ArrayContains=0]="ArrayContains",t[t.ArrayMaxContains=1]="ArrayMaxContains",t[t.ArrayMaxItems=2]="ArrayMaxItems",t[t.ArrayMinContains=3]="ArrayMinContains",t[t.ArrayMinItems=4]="ArrayMinItems",t[t.ArrayUniqueItems=5]="ArrayUniqueItems",t[t.Array=6]="Array",t[t.AsyncIterator=7]="AsyncIterator",t[t.BigIntExclusiveMaximum=8]="BigIntExclusiveMaximum",t[t.BigIntExclusiveMinimum=9]="BigIntExclusiveMinimum",t[t.BigIntMaximum=10]="BigIntMaximum",t[t.BigIntMinimum=11]="BigIntMinimum",t[t.BigIntMultipleOf=12]="BigIntMultipleOf",t[t.BigInt=13]="BigInt",t[t.Boolean=14]="Boolean",t[t.DateExclusiveMaximumTimestamp=15]="DateExclusiveMaximumTimestamp",t[t.DateExclusiveMinimumTimestamp=16]="DateExclusiveMinimumTimestamp",t[t.DateMaximumTimestamp=17]="DateMaximumTimestamp",t[t.DateMinimumTimestamp=18]="DateMinimumTimestamp",t[t.DateMultipleOfTimestamp=19]="DateMultipleOfTimestamp",t[t.Date=20]="Date",t[t.Function=21]="Function",t[t.IntegerExclusiveMaximum=22]="IntegerExclusiveMaximum",t[t.IntegerExclusiveMinimum=23]="IntegerExclusiveMinimum",t[t.IntegerMaximum=24]="IntegerMaximum",t[t.IntegerMinimum=25]="IntegerMinimum",t[t.IntegerMultipleOf=26]="IntegerMultipleOf",t[t.Integer=27]="Integer",t[t.IntersectUnevaluatedProperties=28]="IntersectUnevaluatedProperties",t[t.Intersect=29]="Intersect",t[t.Iterator=30]="Iterator",t[t.Kind=31]="Kind",t[t.Literal=32]="Literal",t[t.Never=33]="Never",t[t.Not=34]="Not",t[t.Null=35]="Null",t[t.NumberExclusiveMaximum=36]="NumberExclusiveMaximum",t[t.NumberExclusiveMinimum=37]="NumberExclusiveMinimum",t[t.NumberMaximum=38]="NumberMaximum",t[t.NumberMinimum=39]="NumberMinimum",t[t.NumberMultipleOf=40]="NumberMultipleOf",t[t.Number=41]="Number",t[t.ObjectAdditionalProperties=42]="ObjectAdditionalProperties",t[t.ObjectMaxProperties=43]="ObjectMaxProperties",t[t.ObjectMinProperties=44]="ObjectMinProperties",t[t.ObjectRequiredProperty=45]="ObjectRequiredProperty",t[t.Object=46]="Object",t[t.Promise=47]="Promise",t[t.RegExp=48]="RegExp",t[t.StringFormatUnknown=49]="StringFormatUnknown",t[t.StringFormat=50]="StringFormat",t[t.StringMaxLength=51]="StringMaxLength",t[t.StringMinLength=52]="StringMinLength",t[t.StringPattern=53]="StringPattern",t[t.String=54]="String",t[t.Symbol=55]="Symbol",t[t.TupleLength=56]="TupleLength",t[t.Tuple=57]="Tuple",t[t.Uint8ArrayMaxByteLength=58]="Uint8ArrayMaxByteLength",t[t.Uint8ArrayMinByteLength=59]="Uint8ArrayMinByteLength",t[t.Uint8Array=60]="Uint8Array",t[t.Undefined=61]="Undefined",t[t.Union=62]="Union",t[t.Void=63]="Void"}(g||(exports.ValueErrorType=g={}));class m extends a.TypeBoxError{constructor(t){super("Unknown type"),this.schema=t}}function f(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}function v(t){return void 0!==t}exports.ValueErrorsUnknownTypeError=m;class b{constructor(t){this.iterator=t}[Symbol.iterator](){return this.iterator}First(){const t=this.iterator.next();return t.done?void 0:t.value}}function y(t,e,i,r,n=[]){return{type:t,schema:e,path:i,value:r,message:(0,o.GetErrorFunction)()({errorType:t,path:i,schema:e,value:r,errors:n}),errors:n}}function*_(t,e,o,a){const T=v(t.$id)?[...e,t]:e,x=t;switch(x[c.Kind]){case"Any":case"Unknown":return yield*function*(){}();case"Array":return yield*function*(t,e,i,r){if(!(0,p.IsArray)(r))return yield y(g.Array,t,i,r);!v(t.minItems)||r.length>=t.minItems||(yield y(g.ArrayMinItems,t,i,r)),!v(t.maxItems)||r.length<=t.maxItems||(yield y(g.ArrayMaxItems,t,i,r));for(let n=0;n<r.length;n++)yield*_(t.items,e,`${i}/${n}`,r[n]);if(!0!==t.uniqueItems||function(){const t=new Set;for(const e of r){const i=(0,h.Hash)(e);if(t.has(i))return!1;t.add(i)}return!0}()||(yield y(g.ArrayUniqueItems,t,i,r)),!(v(t.contains)||v(t.minContains)||v(t.maxContains)))return;const n=v(t.contains)?t.contains:(0,u.Never)(),s=r.reduce(((t,r,s)=>!0===_(n,e,`${i}${s}`,r).next().done?t+1:t),0);0===s&&(yield y(g.ArrayContains,t,i,r)),(0,p.IsNumber)(t.minContains)&&s<t.minContains&&(yield y(g.ArrayMinContains,t,i,r)),(0,p.IsNumber)(t.maxContains)&&s>t.maxContains&&(yield y(g.ArrayMaxContains,t,i,r))}(x,T,o,a);case"AsyncIterator":return yield*function*(t,e,i,r){(0,p.IsAsyncIterator)(r)||(yield y(g.AsyncIterator,t,i,r))}(x,0,o,a);case"BigInt":return yield*function*(t,e,i,r){if(!(0,p.IsBigInt)(r))return yield y(g.BigInt,t,i,r);!v(t.exclusiveMaximum)||r<t.exclusiveMaximum||(yield y(g.BigIntExclusiveMaximum,t,i,r)),!v(t.exclusiveMinimum)||r>t.exclusiveMinimum||(yield y(g.BigIntExclusiveMinimum,t,i,r)),!v(t.maximum)||r<=t.maximum||(yield y(g.BigIntMaximum,t,i,r)),!v(t.minimum)||r>=t.minimum||(yield y(g.BigIntMinimum,t,i,r)),v(t.multipleOf)&&r%t.multipleOf!==BigInt(0)&&(yield y(g.BigIntMultipleOf,t,i,r))}(x,0,o,a);case"Boolean":return yield*function*(t,e,i,r){(0,p.IsBoolean)(r)||(yield y(g.Boolean,t,i,r))}(x,0,o,a);case"Constructor":return yield*function*(t,e,i,r){yield*_(t.returns,e,i,r.prototype)}(x,T,o,a);case"Date":return yield*function*(t,e,i,r){if(!(0,p.IsDate)(r))return yield y(g.Date,t,i,r);!v(t.exclusiveMaximumTimestamp)||r.getTime()<t.exclusiveMaximumTimestamp||(yield y(g.DateExclusiveMaximumTimestamp,t,i,r)),!v(t.exclusiveMinimumTimestamp)||r.getTime()>t.exclusiveMinimumTimestamp||(yield y(g.DateExclusiveMinimumTimestamp,t,i,r)),!v(t.maximumTimestamp)||r.getTime()<=t.maximumTimestamp||(yield y(g.DateMaximumTimestamp,t,i,r)),!v(t.minimumTimestamp)||r.getTime()>=t.minimumTimestamp||(yield y(g.DateMinimumTimestamp,t,i,r)),v(t.multipleOfTimestamp)&&r.getTime()%t.multipleOfTimestamp!=0&&(yield y(g.DateMultipleOfTimestamp,t,i,r))}(x,0,o,a);case"Function":return yield*function*(t,e,i,r){(0,p.IsFunction)(r)||(yield y(g.Function,t,i,r))}(x,0,o,a);case"Integer":return yield*function*(t,e,i,r){if(!(0,p.IsInteger)(r))return yield y(g.Integer,t,i,r);!v(t.exclusiveMaximum)||r<t.exclusiveMaximum||(yield y(g.IntegerExclusiveMaximum,t,i,r)),!v(t.exclusiveMinimum)||r>t.exclusiveMinimum||(yield y(g.IntegerExclusiveMinimum,t,i,r)),!v(t.maximum)||r<=t.maximum||(yield y(g.IntegerMaximum,t,i,r)),!v(t.minimum)||r>=t.minimum||(yield y(g.IntegerMinimum,t,i,r)),v(t.multipleOf)&&r%t.multipleOf!=0&&(yield y(g.IntegerMultipleOf,t,i,r))}(x,0,o,a);case"Intersect":return yield*function*(t,e,i,n){let s=!1;for(const r of t.allOf)for(const t of _(r,e,i,n))s=!0,yield t;if(s)return yield y(g.Intersect,t,i,n);if(!1===t.unevaluatedProperties){const e=new RegExp((0,r.KeyOfPattern)(t));for(const r of Object.getOwnPropertyNames(n))e.test(r)||(yield y(g.IntersectUnevaluatedProperties,t,`${i}/${r}`,n))}if("object"==typeof t.unevaluatedProperties){const s=new RegExp((0,r.KeyOfPattern)(t));for(const r of Object.getOwnPropertyNames(n))if(!s.test(r)){const s=_(t.unevaluatedProperties,e,`${i}/${r}`,n[r]).next();s.done||(yield s.value)}}}(x,T,o,a);case"Iterator":return yield*function*(t,e,i,r){(0,p.IsIterator)(r)||(yield y(g.Iterator,t,i,r))}(x,0,o,a);case"Literal":return yield*function*(t,e,i,r){r!==t.const&&(yield y(g.Literal,t,i,r))}(x,0,o,a);case"Never":return yield*function*(t,e,i,r){yield y(g.Never,t,i,r)}(x,0,o,a);case"Not":return yield*function*(t,e,i,r){!0===_(t.not,e,i,r).next().done&&(yield y(g.Not,t,i,r))}(x,T,o,a);case"Null":return yield*function*(t,e,i,r){(0,p.IsNull)(r)||(yield y(g.Null,t,i,r))}(x,0,o,a);case"Number":return yield*function*(t,e,r,n){if(!i.TypeSystemPolicy.IsNumberLike(n))return yield y(g.Number,t,r,n);!v(t.exclusiveMaximum)||n<t.exclusiveMaximum||(yield y(g.NumberExclusiveMaximum,t,r,n)),!v(t.exclusiveMinimum)||n>t.exclusiveMinimum||(yield y(g.NumberExclusiveMinimum,t,r,n)),!v(t.maximum)||n<=t.maximum||(yield y(g.NumberMaximum,t,r,n)),!v(t.minimum)||n>=t.minimum||(yield y(g.NumberMinimum,t,r,n)),v(t.multipleOf)&&n%t.multipleOf!=0&&(yield y(g.NumberMultipleOf,t,r,n))}(x,0,o,a);case"Object":return yield*function*(t,e,r,n){if(!i.TypeSystemPolicy.IsObjectLike(n))return yield y(g.Object,t,r,n);!v(t.minProperties)||Object.getOwnPropertyNames(n).length>=t.minProperties||(yield y(g.ObjectMinProperties,t,r,n)),!v(t.maxProperties)||Object.getOwnPropertyNames(n).length<=t.maxProperties||(yield y(g.ObjectMaxProperties,t,r,n));const o=Array.isArray(t.required)?t.required:[],a=Object.getOwnPropertyNames(t.properties),l=Object.getOwnPropertyNames(n);for(const e of o)l.includes(e)||(yield y(g.ObjectRequiredProperty,t.properties[e],`${r}/${f(e)}`,void 0));if(!1===t.additionalProperties)for(const e of l)a.includes(e)||(yield y(g.ObjectAdditionalProperties,t,`${r}/${f(e)}`,n[e]));if("object"==typeof t.additionalProperties)for(const i of l)a.includes(i)||(yield*_(t.additionalProperties,e,`${r}/${f(i)}`,n[i]));for(const o of a){const a=t.properties[o];t.required&&t.required.includes(o)?(yield*_(a,e,`${r}/${f(o)}`,n[o]),(0,s.ExtendsUndefinedCheck)(t)&&!(o in n)&&(yield y(g.ObjectRequiredProperty,a,`${r}/${f(o)}`,void 0))):i.TypeSystemPolicy.IsExactOptionalProperty(n,o)&&(yield*_(a,e,`${r}/${f(o)}`,n[o]))}}(x,T,o,a);case"Promise":return yield*function*(t,e,i,r){(0,p.IsPromise)(r)||(yield y(g.Promise,t,i,r))}(x,0,o,a);case"Record":return yield*function*(t,e,r,n){if(!i.TypeSystemPolicy.IsRecordLike(n))return yield y(g.Object,t,r,n);!v(t.minProperties)||Object.getOwnPropertyNames(n).length>=t.minProperties||(yield y(g.ObjectMinProperties,t,r,n)),!v(t.maxProperties)||Object.getOwnPropertyNames(n).length<=t.maxProperties||(yield y(g.ObjectMaxProperties,t,r,n));const[s,o]=Object.entries(t.patternProperties)[0],a=new RegExp(s);for(const[t,i]of Object.entries(n))a.test(t)&&(yield*_(o,e,`${r}/${f(t)}`,i));if("object"==typeof t.additionalProperties)for(const[i,s]of Object.entries(n))a.test(i)||(yield*_(t.additionalProperties,e,`${r}/${f(i)}`,s));if(!1===t.additionalProperties)for(const[e,i]of Object.entries(n))if(!a.test(e))return yield y(g.ObjectAdditionalProperties,t,`${r}/${f(e)}`,i)}(x,T,o,a);case"Ref":case"This":return yield*function*(t,e,i,r){yield*_((0,l.Deref)(t,e),e,i,r)}(x,T,o,a);case"RegExp":return yield*function*(t,e,i,r){return(0,p.IsString)(r)?(!v(t.minLength)||r.length>=t.minLength||(yield y(g.StringMinLength,t,i,r)),!v(t.maxLength)||r.length<=t.maxLength||(yield y(g.StringMaxLength,t,i,r)),new RegExp(t.source,t.flags).test(r)?void 0:yield y(g.RegExp,t,i,r)):yield y(g.String,t,i,r)}(x,0,o,a);case"String":return yield*function*(t,e,i,r){if(!(0,p.IsString)(r))return yield y(g.String,t,i,r);!v(t.minLength)||r.length>=t.minLength||(yield y(g.StringMinLength,t,i,r)),!v(t.maxLength)||r.length<=t.maxLength||(yield y(g.StringMaxLength,t,i,r)),(0,p.IsString)(t.pattern)&&(new RegExp(t.pattern).test(r)||(yield y(g.StringPattern,t,i,r))),(0,p.IsString)(t.format)&&(n.FormatRegistry.Has(t.format)?n.FormatRegistry.Get(t.format)(r)||(yield y(g.StringFormat,t,i,r)):yield y(g.StringFormatUnknown,t,i,r))}(x,0,o,a);case"Symbol":return yield*function*(t,e,i,r){(0,p.IsSymbol)(r)||(yield y(g.Symbol,t,i,r))}(x,0,o,a);case"TemplateLiteral":return yield*function*(t,e,i,r){if(!(0,p.IsString)(r))return yield y(g.String,t,i,r);new RegExp(t.pattern).test(r)||(yield y(g.StringPattern,t,i,r))}(x,0,o,a);case"Tuple":return yield*function*(t,e,i,r){if(!(0,p.IsArray)(r))return yield y(g.Tuple,t,i,r);if(void 0===t.items&&0!==r.length)return yield y(g.TupleLength,t,i,r);if(r.length!==t.maxItems)return yield y(g.TupleLength,t,i,r);if(t.items)for(let n=0;n<t.items.length;n++)yield*_(t.items[n],e,`${i}/${n}`,r[n])}(x,T,o,a);case"Undefined":return yield*function*(t,e,i,r){(0,p.IsUndefined)(r)||(yield y(g.Undefined,t,i,r))}(x,0,o,a);case"Union":return yield*function*(t,e,i,r){if((0,d.Check)(t,e,r))return;const n=t.anyOf.map((t=>new b(_(t,e,i,r))));yield y(g.Union,t,i,r,n)}(x,T,o,a);case"Uint8Array":return yield*function*(t,e,i,r){if(!(0,p.IsUint8Array)(r))return yield y(g.Uint8Array,t,i,r);!v(t.maxByteLength)||r.length<=t.maxByteLength||(yield y(g.Uint8ArrayMaxByteLength,t,i,r)),!v(t.minByteLength)||r.length>=t.minByteLength||(yield y(g.Uint8ArrayMinByteLength,t,i,r))}(x,0,o,a);case"Void":return yield*function*(t,e,r,n){i.TypeSystemPolicy.IsVoidLike(n)||(yield y(g.Void,t,r,n))}(x,0,o,a);default:if(!n.TypeRegistry.Has(x[c.Kind]))throw new m(t);return yield*function*(t,e,i,r){n.TypeRegistry.Get(t[c.Kind])(t,r)||(yield y(g.Kind,t,i,r))}(x,0,o,a)}}exports.ValueErrorIterator=b},5281:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MultiValueHelper=void 0,exports.MultiValueHelper=class{constructor(t,e){this.item=t,this.attrAlias=e}insertOne(t){const e=this.get();return e.includes(t)||e.push(t),e.length?this.set(e):this.delete()}deleteOne(t){const e=this.get().filter((e=>e!=t));return e.length?this.set(e):this.delete()}has(t){return this.get().includes(t)}get(){var t;const e=null!==(t=this.item.getAttribute(this.attrAlias))&&void 0!==t?t:[];return Array.isArray(e)?e:[e]}set(t){return this.item.setAttribute(this.attrAlias,t)}delete(){return this.item.removeAttribute(this.attrAlias)}}},5358:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(65286),exports)},5965:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExcludeFromMappedResult=function(t,e){const n=function(t,e){return function(t,e){const i={};for(const n of globalThis.Object.getOwnPropertyNames(t))i[n]=(0,r.Exclude)(t[n],e);return i}(t.properties,e)}(t,e);return(0,i.MappedResult)(n)};const i=e(34013),r=e(83598)},6493:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DeliveryRollProcessor=void 0;const i=e(50508);exports.DeliveryRollProcessor=class{invoke(t,e){const r=new i.DeliveryRollHelper(t),n=t.getAttribute("delivery"),s=t.getAttribute("delivery_roll_item_margin"),o=t.getAttribute("delivery_roll_top_edge_margin"),a=t.getAttribute("delivery_roll_size_mm");if("roll"==n){let n;n=!this.isValidAndPositive(o)||Number(o)<i.DeliveryRollHelper.MIN_TOP_MARGIN?i.DeliveryRollHelper.MIN_TOP_MARGIN:Number(o)>=r.getTopMarginMax()&&r.getTopMarginMax()>=i.DeliveryRollHelper.MIN_TOP_MARGIN?r.getTopMarginMax():Number(Number(o).toFixed(1)),t.setAttribute("delivery_roll_top_edge_margin",n),r.isSizeTypeValid()||(t.setAttribute("delivery_roll_size_type",r.getSuitableSize()),t.setAttribute("delivery_roll_top_edge_margin",r.getTopMarginMid()),e.evaluate(t)),this.isValidAndPositive(a)||t.setAttribute("delivery_roll_size_mm",i.DeliveryRollHelper.DEFAULT_INNER_ROLL_SIZE),(!this.isValidAndPositive(s)||Number(s)<i.DeliveryRollHelper.MIN_ITEM_MARGIN)&&t.setAttribute("delivery_roll_item_margin",i.DeliveryRollHelper.MIN_ITEM_MARGIN)}}isValidAndPositive(t){return this.isValid(t)&&this.isPositive(t)}isValid(t){return!isNaN(Number(t))}isPositive(t){return Number(t)>0}}},6605:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Entries=function(){return new Map(e)},exports.Clear=function(){return e.clear()},exports.Delete=function(t){return e.delete(t)},exports.Has=function(t){return e.has(t)},exports.Set=function(t,i){e.set(t,i)},exports.Get=function(t){return e.get(t)};const e=new Map},6905:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(22802),exports)},7533:(t,e,i)=>{"use strict";i.d(e,{A:()=>a});var r=i(71354),n=i.n(r),s=i(76314),o=i.n(s)()(n());o.push([t.id,'/* Copyright 2024 Sticker App AB */\n\n.svgContainer {\n    background-color: #f5f5f5;\n  }\n  \n  .svgSheet {\n    fill: none;\n  }\n  \n  .svgSheet.sheet {\n    fill: white;\n    stroke-width: 1;\n  }\n  .svgSheet.skin {\n  }\n  .svgSheet.case {\n  }\n  .svgSheet.single {\n  }\n  \n  .svgSheetPath {\n    fill: none;\n    stroke: none;\n    stroke-width: 2;\n  }\n  \n  .svgSheetPath.sheet {\n  }\n  .svgSheetPath.skin {\n  }\n  .svgSheetPath.case {\n  }\n  .svgSheetPath.single {\n  }\n  \n  .svgPartPath {\n    fill: none;\n    stroke: #ff00ff;\n    stroke-width: 1;\n  }\n  \n  .svgPartPathHover {\n    stroke: #000;\n    stroke-width: 1.1;\n  }\n  \n  .svgPartPath.partImage {\n    fill: none;\n    stroke: none;\n    stroke-width: 1;\n  }\n  \n  .svgPartPathHover.partImage {\n    stroke: #000;\n    stroke-width: 1.1;\n  }\n  \n  .svgPartBleedPath {\n    fill: none;\n    stroke: #0096ff;\n    stroke-width: 1;\n    stroke-dasharray: 7;\n  }\n  /*\n  body.case .svgPartPath,\n  body.skin .svgPartPath {\n    fill: none;\n      stroke: rgb(0, 150, 255);\n  }\n  body.case .svgPartBleedPath,\n  body.skin .svgPartBleedPath {\n    fill: none;\n      stroke: rgb(255,0,255);\n  }\n  */\n  \n  .svgShadowSheet {\n    display: none;\n    fill: none;\n    stroke: black;\n    stroke-opacity: 0.5;\n    stroke-width: 1;\n  }\n  \n  .svgShadowPath {\n    fill: none;\n    stroke: black;\n    stroke-opacity: 0.5;\n    stroke-width: 0;\n  }\n  \n  .svgShadowOverlay {\n    fill: #e8e8e8;\n    stroke: none;\n    fill-opacity: 0.5;\n  }\n  \n  .svgCollageShadowOverlay {\n    fill: black;\n    stroke: none;\n    fill-opacity: 0.4;\n  }\n  \n  .svgHover {\n    stroke-width: 1px;\n    fill: none;\n    stroke: #000;\n    cursor: pointer;\n  }\n  .svgHover.move {\n    cursor: move;\n  }\n  \n  .svgSelect {\n    fill: none;\n    stroke: black;\n    stroke-width: 1;\n    cursor: move;\n  }\n  \n  .svgSelectCorner {\n    fill: white;\n    stroke: green;\n    stroke-width: 2;\n  }\n  \n  .svgSelectNW {\n    cursor: nw-resize;\n  }\n  \n  .svgSelectNE {\n    cursor: ne-resize;\n  }\n  \n  .svgSelectSE {\n    cursor: se-resize;\n  }\n  \n  .svgSelectSW {\n    cursor: sw-resize;\n  }\n  \n  .svgSelectN {\n    cursor: n-resize;\n  }\n  \n  .svgSelectE {\n    cursor: e-resize;\n  }\n  \n  .svgSelectS {\n    cursor: s-resize;\n  }\n  \n  .svgSelectW {\n    cursor: w-resize;\n  }\n  \n  .svgSelectRotate {\n    /*  fill : none;*/\n    /*  stroke : none; */\n    cursor: e-resize;\n  }\n  \n  .svgSelectRotateLine {\n    stroke: #000;\n    stroke-width: 1;\n  }\n  \n  .svgSelectIcon {\n    cursor: pointer;\n  }\n  \n  .svgPartSizeText {\n    fill: #000;\n    font-family: sans-serif;\n    pointer-events: none;\n  }\n  .svgPartInnerSizeText {\n    fill: #666;\n    font-family: sans-serif;\n    pointer-events: none;\n  }\n  .editor.preview-on .svgPartSizeText {\n    fill: #666;\n  }\n  \n  .svgSheetSizeText {\n    fill: #505050;\n    font-family: "FuturaPT", sans-serif;\n    pointer-events: none;\n  }\n  \n  .svgIcon {\n    stroke: none;\n    stroke-width: 2px;\n    fill: #363636;\n  }\n  .svgIcon:hover {\n    fill: #000;\n  }\n  \n  .svgIconRound {\n    padding: 12.5px;\n  }\n  \n  .svgIconRect {\n    padding: 25px;\n    border-radius: 25px;\n  }\n  \n  .svgIconMenu {\n    stroke: none;\n    stroke-width: 2px;\n    fill: #363636;\n    padding: 35px;\n    border-radius: 25px;\n    margin-left: 35px;\n    margin-top: 30px;\n  }\n  .svgIconMenu:hover {\n    fill: #000;\n  }\n  \n  .svgIconMenuTouch {\n    stroke: none;\n    fill: #363636;\n    padding: 35px;\n    border-radius: 25px;\n    margin-left: 40px;\n    margin-top: 32px;\n  }\n  \n  .svgCollagePath {\n    fill: none;\n    stroke: grey;\n    stroke-width: 0.5px;\n  }\n  \n  .svgCollagePath.drag {\n    fill: none;\n    stroke: black;\n    stroke-width: 1px;\n  }\n  \n  .svgCollagePath.drop {\n    fill: none;\n    stroke: black;\n    stroke-width: 1px;\n  }\n  ',"",{version:3,sources:["webpack://./src/tsc/components/editor/svg/style.css"],names:[],mappings:"AAAA,kCAAkC;;AAElC;IACI,yBAAyB;EAC3B;;EAEA;IACE,UAAU;EACZ;;EAEA;IACE,WAAW;IACX,eAAe;EACjB;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA;IACE,UAAU;IACV,YAAY;IACZ,eAAe;EACjB;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA;IACE,UAAU;IACV,eAAe;IACf,eAAe;EACjB;;EAEA;IACE,YAAY;IACZ,iBAAiB;EACnB;;EAEA;IACE,UAAU;IACV,YAAY;IACZ,eAAe;EACjB;;EAEA;IACE,YAAY;IACZ,iBAAiB;EACnB;;EAEA;IACE,UAAU;IACV,eAAe;IACf,eAAe;IACf,mBAAmB;EACrB;EACA;;;;;;;;;;;GAWC;;EAED;IACE,aAAa;IACb,UAAU;IACV,aAAa;IACb,mBAAmB;IACnB,eAAe;EACjB;;EAEA;IACE,UAAU;IACV,aAAa;IACb,mBAAmB;IACnB,eAAe;EACjB;;EAEA;IACE,aAAa;IACb,YAAY;IACZ,iBAAiB;EACnB;;EAEA;IACE,WAAW;IACX,YAAY;IACZ,iBAAiB;EACnB;;EAEA;IACE,iBAAiB;IACjB,UAAU;IACV,YAAY;IACZ,eAAe;EACjB;EACA;IACE,YAAY;EACd;;EAEA;IACE,UAAU;IACV,aAAa;IACb,eAAe;IACf,YAAY;EACd;;EAEA;IACE,WAAW;IACX,aAAa;IACb,eAAe;EACjB;;EAEA;IACE,iBAAiB;EACnB;;EAEA;IACE,iBAAiB;EACnB;;EAEA;IACE,iBAAiB;EACnB;;EAEA;IACE,iBAAiB;EACnB;;EAEA;IACE,gBAAgB;EAClB;;EAEA;IACE,gBAAgB;EAClB;;EAEA;IACE,gBAAgB;EAClB;;EAEA;IACE,gBAAgB;EAClB;;EAEA;IACE,iBAAiB;IACjB,oBAAoB;IACpB,gBAAgB;EAClB;;EAEA;IACE,YAAY;IACZ,eAAe;EACjB;;EAEA;IACE,eAAe;EACjB;;EAEA;IACE,UAAU;IACV,uBAAuB;IACvB,oBAAoB;EACtB;EACA;IACE,UAAU;IACV,uBAAuB;IACvB,oBAAoB;EACtB;EACA;IACE,UAAU;EACZ;;EAEA;IACE,aAAa;IACb,mCAAmC;IACnC,oBAAoB;EACtB;;EAEA;IACE,YAAY;IACZ,iBAAiB;IACjB,aAAa;EACf;EACA;IACE,UAAU;EACZ;;EAEA;IACE,eAAe;EACjB;;EAEA;IACE,aAAa;IACb,mBAAmB;EACrB;;EAEA;IACE,YAAY;IACZ,iBAAiB;IACjB,aAAa;IACb,aAAa;IACb,mBAAmB;IACnB,iBAAiB;IACjB,gBAAgB;EAClB;EACA;IACE,UAAU;EACZ;;EAEA;IACE,YAAY;IACZ,aAAa;IACb,aAAa;IACb,mBAAmB;IACnB,iBAAiB;IACjB,gBAAgB;EAClB;;EAEA;IACE,UAAU;IACV,YAAY;IACZ,mBAAmB;EACrB;;EAEA;IACE,UAAU;IACV,aAAa;IACb,iBAAiB;EACnB;;EAEA;IACE,UAAU;IACV,aAAa;IACb,iBAAiB;EACnB",sourcesContent:['/* Copyright 2024 Sticker App AB */\n\n.svgContainer {\n    background-color: #f5f5f5;\n  }\n  \n  .svgSheet {\n    fill: none;\n  }\n  \n  .svgSheet.sheet {\n    fill: white;\n    stroke-width: 1;\n  }\n  .svgSheet.skin {\n  }\n  .svgSheet.case {\n  }\n  .svgSheet.single {\n  }\n  \n  .svgSheetPath {\n    fill: none;\n    stroke: none;\n    stroke-width: 2;\n  }\n  \n  .svgSheetPath.sheet {\n  }\n  .svgSheetPath.skin {\n  }\n  .svgSheetPath.case {\n  }\n  .svgSheetPath.single {\n  }\n  \n  .svgPartPath {\n    fill: none;\n    stroke: #ff00ff;\n    stroke-width: 1;\n  }\n  \n  .svgPartPathHover {\n    stroke: #000;\n    stroke-width: 1.1;\n  }\n  \n  .svgPartPath.partImage {\n    fill: none;\n    stroke: none;\n    stroke-width: 1;\n  }\n  \n  .svgPartPathHover.partImage {\n    stroke: #000;\n    stroke-width: 1.1;\n  }\n  \n  .svgPartBleedPath {\n    fill: none;\n    stroke: #0096ff;\n    stroke-width: 1;\n    stroke-dasharray: 7;\n  }\n  /*\n  body.case .svgPartPath,\n  body.skin .svgPartPath {\n    fill: none;\n      stroke: rgb(0, 150, 255);\n  }\n  body.case .svgPartBleedPath,\n  body.skin .svgPartBleedPath {\n    fill: none;\n      stroke: rgb(255,0,255);\n  }\n  */\n  \n  .svgShadowSheet {\n    display: none;\n    fill: none;\n    stroke: black;\n    stroke-opacity: 0.5;\n    stroke-width: 1;\n  }\n  \n  .svgShadowPath {\n    fill: none;\n    stroke: black;\n    stroke-opacity: 0.5;\n    stroke-width: 0;\n  }\n  \n  .svgShadowOverlay {\n    fill: #e8e8e8;\n    stroke: none;\n    fill-opacity: 0.5;\n  }\n  \n  .svgCollageShadowOverlay {\n    fill: black;\n    stroke: none;\n    fill-opacity: 0.4;\n  }\n  \n  .svgHover {\n    stroke-width: 1px;\n    fill: none;\n    stroke: #000;\n    cursor: pointer;\n  }\n  .svgHover.move {\n    cursor: move;\n  }\n  \n  .svgSelect {\n    fill: none;\n    stroke: black;\n    stroke-width: 1;\n    cursor: move;\n  }\n  \n  .svgSelectCorner {\n    fill: white;\n    stroke: green;\n    stroke-width: 2;\n  }\n  \n  .svgSelectNW {\n    cursor: nw-resize;\n  }\n  \n  .svgSelectNE {\n    cursor: ne-resize;\n  }\n  \n  .svgSelectSE {\n    cursor: se-resize;\n  }\n  \n  .svgSelectSW {\n    cursor: sw-resize;\n  }\n  \n  .svgSelectN {\n    cursor: n-resize;\n  }\n  \n  .svgSelectE {\n    cursor: e-resize;\n  }\n  \n  .svgSelectS {\n    cursor: s-resize;\n  }\n  \n  .svgSelectW {\n    cursor: w-resize;\n  }\n  \n  .svgSelectRotate {\n    /*  fill : none;*/\n    /*  stroke : none; */\n    cursor: e-resize;\n  }\n  \n  .svgSelectRotateLine {\n    stroke: #000;\n    stroke-width: 1;\n  }\n  \n  .svgSelectIcon {\n    cursor: pointer;\n  }\n  \n  .svgPartSizeText {\n    fill: #000;\n    font-family: sans-serif;\n    pointer-events: none;\n  }\n  .svgPartInnerSizeText {\n    fill: #666;\n    font-family: sans-serif;\n    pointer-events: none;\n  }\n  .editor.preview-on .svgPartSizeText {\n    fill: #666;\n  }\n  \n  .svgSheetSizeText {\n    fill: #505050;\n    font-family: "FuturaPT", sans-serif;\n    pointer-events: none;\n  }\n  \n  .svgIcon {\n    stroke: none;\n    stroke-width: 2px;\n    fill: #363636;\n  }\n  .svgIcon:hover {\n    fill: #000;\n  }\n  \n  .svgIconRound {\n    padding: 12.5px;\n  }\n  \n  .svgIconRect {\n    padding: 25px;\n    border-radius: 25px;\n  }\n  \n  .svgIconMenu {\n    stroke: none;\n    stroke-width: 2px;\n    fill: #363636;\n    padding: 35px;\n    border-radius: 25px;\n    margin-left: 35px;\n    margin-top: 30px;\n  }\n  .svgIconMenu:hover {\n    fill: #000;\n  }\n  \n  .svgIconMenuTouch {\n    stroke: none;\n    fill: #363636;\n    padding: 35px;\n    border-radius: 25px;\n    margin-left: 40px;\n    margin-top: 32px;\n  }\n  \n  .svgCollagePath {\n    fill: none;\n    stroke: grey;\n    stroke-width: 0.5px;\n  }\n  \n  .svgCollagePath.drag {\n    fill: none;\n    stroke: black;\n    stroke-width: 1px;\n  }\n  \n  .svgCollagePath.drop {\n    fill: none;\n    stroke: black;\n    stroke-width: 1px;\n  }\n  '],sourceRoot:""}]);const a=o},7625:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.HasTransform=function(t,e){return a.clear(),o(t,e)};const i=e(62413),r=e(73967),n=e(4443),s=e(79968);function o(t,e){const l=(0,i.Pushref)(t,e),h=t;if(t.$id&&a.has(t.$id))return!1;switch(t.$id&&a.add(t.$id),t[r.Kind]){case"Array":case"AsyncIterator":case"Iterator":return function(t,e){return(0,n.IsTransform)(t)||o(t.items,e)}(h,l);case"Constructor":case"Function":return function(t,e){return(0,n.IsTransform)(t)||o(t.returns,e)||t.parameters.some((t=>o(t,e)))}(h,l);case"Intersect":return function(t,e){return(0,n.IsTransform)(t)||(0,n.IsTransform)(t.unevaluatedProperties)||t.allOf.some((t=>o(t,e)))}(h,l);case"Not":return function(t,e){return(0,n.IsTransform)(t)||o(t.not,e)}(h,l);case"Object":return function(t,e){return(0,n.IsTransform)(t)||Object.values(t.properties).some((t=>o(t,e)))||(0,n.IsSchema)(t.additionalProperties)&&o(t.additionalProperties,e)}(h,l);case"Promise":return function(t,e){return(0,n.IsTransform)(t)||o(t.item,e)}(h,l);case"Record":return function(t,e){const i=Object.getOwnPropertyNames(t.patternProperties)[0],r=t.patternProperties[i];return(0,n.IsTransform)(t)||o(r,e)||(0,n.IsSchema)(t.additionalProperties)&&(0,n.IsTransform)(t.additionalProperties)}(h,l);case"Ref":case"This":return function(t,e){return!!(0,n.IsTransform)(t)||o((0,i.Deref)(t,e),e)}(h,l);case"Tuple":return function(t,e){return(0,n.IsTransform)(t)||!(0,s.IsUndefined)(t.items)&&t.items.some((t=>o(t,e)))}(h,l);case"Union":return function(t,e){return(0,n.IsTransform)(t)||t.anyOf.some((t=>o(t,e)))}(h,l);default:return(0,n.IsTransform)(t)}}const a=new Set},8131:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OptionalFromMappedResult=function(t,e){const n=function(t,e){return function(t,e){const i={};for(const n of globalThis.Object.getOwnPropertyNames(t))i[n]=(0,r.Optional)(t[n],e);return i}(t.properties,e)}(t,e);return(0,i.MappedResult)(n)};const i=e(34013),r=e(21188)},8402:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Any=function(t){return(0,i.CreateType)({[r.Kind]:"Any"},t)};const i=e(10034),r=e(73967)},8668:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SizeConverter=void 0;const i=e(50861);exports.SizeConverter=class{constructor(t,e=0){this.item=t,this.mm=e}get inches(){return(0,i.convertMMToInches)(this.mm)}get cm(){return(0,i.convertMMToCM)(this.mm)}get px(){return(0,i.convertMMToPX)(this.mm)}get localized(){var t;return"true"===(null===(t=this.item.getAttribute("imperial_units"))||void 0===t?void 0:t.toString())?this.inches:this.cm}toObject(){return{mm:this.mm,inches:this.inches,cm:this.cm,px:this.px,localized:this.localized}}}},8852:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(1432),exports)},8926:(t,exports)=>{"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProductAttrValueType=void 0,function(t){t.STRING="string",t.INT="integer",t.BOOL="boolean",t.FLOAT="float"}(e||(exports.ProductAttrValueType=e={}))},9215:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(46878),exports)},9881:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TypeRegistry=exports.FormatRegistry=void 0,exports.FormatRegistry=e(32834),exports.TypeRegistry=e(6605)},10034:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(30768),exports)},10941:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConditionTestDataKeyNotFoundException=void 0;class e extends Error{constructor(t){super(t),this.name="ConditionTestDataKeyNotFoundException"}}exports.ConditionTestDataKeyNotFoundException=e},11231:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(47070),exports)},11359:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IndexPropertyKeys=a;const i=e(61198),r=e(51049);function n(t){return(0,i.TemplateLiteralGenerate)(t).map((t=>t.toString()))}function s(t){const e=[];for(const i of t)e.push(...a(i));return e}function o(t){return[t.toString()]}function a(t){return[...new Set((0,r.IsTemplateLiteral)(t)?n(t):(0,r.IsUnion)(t)?s(t.anyOf):(0,r.IsLiteral)(t)?o(t.const):(0,r.IsNumber)(t)||(0,r.IsInteger)(t)?["[number]"]:[])]}},11480:(t,e,i)=>{"use strict";i.d(e,{_:()=>r});class r{static filterOutNull(t){return t.filter((t=>null!=t))}static unique(t){return[...Array.from(new Set(t))]}}},11890:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Increment=function(t){return(parseInt(t)+1).toString()}},12260:(t,exports)=>{"use strict";function e(t){return exports.currencies[t]?exports.currencies[t].decimals:2}var i;Object.defineProperty(exports,"__esModule",{value:!0}),exports.currencies=exports.Currencies=void 0,exports.getDecimals=e,exports.toMajorUnits=function(t,i){return t/Math.pow(10,e(i))},exports.toMinorUnits=function(t,i){return Math.round(t*Math.pow(10,e(i)))},function(t){t.USD="USD",t.SEK="SEK",t.DKK="DKK",t.GBP="GBP",t.NOK="NOK",t.EUR="EUR",t.JPY="JPY",t.PLN="PLN",t.CAD="CAD"}(i||(exports.Currencies=i={})),exports.currencies={AED:{code:"AED",decimals:2},AFN:{code:"AFN",decimals:2},ALL:{code:"ALL",decimals:2},AMD:{code:"AMD",decimals:2},ANG:{code:"ANG",decimals:2},AOA:{code:"AOA",decimals:2},ARS:{code:"ARS",decimals:2},AUD:{code:"AUD",decimals:2},AWG:{code:"AWG",decimals:2},AZN:{code:"AZN",decimals:2},BAM:{code:"BAM",decimals:2},BBD:{code:"BBD",decimals:2},BDT:{code:"BDT",decimals:2},BGN:{code:"BGN",decimals:2},BHD:{code:"BHD",decimals:2},BIF:{code:"BIF",decimals:2},BMD:{code:"BMD",decimals:2},BND:{code:"BND",decimals:2},BOB:{code:"BOB",decimals:2},BRL:{code:"BRL",decimals:2},BSD:{code:"BSD",decimals:2},BTN:{code:"BTN",decimals:2},BWP:{code:"BWP",decimals:2},BYN:{code:"BYN",decimals:2},BZD:{code:"BZD",decimals:2},CAD:{code:"CAD",decimals:2},CDF:{code:"CDF",decimals:2},CHF:{code:"CHF",decimals:2},CLP:{code:"CLP",decimals:0},CNY:{code:"CNY",decimals:2},COP:{code:"COP",decimals:2},CRC:{code:"CRC",decimals:2},CUP:{code:"CUP",decimals:2},CVE:{code:"CVE",decimals:2},CZK:{code:"CZK",decimals:2},DJF:{code:"DJF",decimals:2},DKK:{code:"DKK",decimals:2},DOP:{code:"DOP",decimals:2},DZD:{code:"DZD",decimals:2},EGP:{code:"EGP",decimals:2},ERN:{code:"ERN",decimals:2},ETB:{code:"ETB",decimals:2},EUR:{code:"EUR",decimals:2},FJD:{code:"FJD",decimals:2},FKP:{code:"FKP",decimals:2},GBP:{code:"GBP",decimals:2},GEL:{code:"GEL",decimals:2},GHS:{code:"GHS",decimals:2},GIP:{code:"GIP",decimals:2},GMD:{code:"GMD",decimals:2},GNF:{code:"GNF",decimals:2},GTQ:{code:"GTQ",decimals:2},GYD:{code:"GYD",decimals:2},HKD:{code:"HKD",decimals:2},HNL:{code:"HNL",decimals:2},HTG:{code:"HTG",decimals:2},HUF:{code:"HUF",decimals:2},IDR:{code:"IDR",decimals:0},ILS:{code:"ILS",decimals:2},INR:{code:"INR",decimals:2},IQD:{code:"IQD",decimals:2},IRR:{code:"IRR",decimals:2},ISK:{code:"ISK",decimals:0},JMD:{code:"JMD",decimals:2},JOD:{code:"JOD",decimals:2},JPY:{code:"JPY",decimals:0},KES:{code:"KES",decimals:2},KGS:{code:"KGS",decimals:2},KHR:{code:"KHR",decimals:2},KMF:{code:"KMF",decimals:2},KPW:{code:"KPW",decimals:2},KRW:{code:"KRW",decimals:0},KWD:{code:"KWD",decimals:2},KYD:{code:"KYD",decimals:2},KZT:{code:"KZT",decimals:2},LAK:{code:"LAK",decimals:2},LBP:{code:"LBP",decimals:2},LKR:{code:"LKR",decimals:2},LRD:{code:"LRD",decimals:2},LSL:{code:"LSL",decimals:2},LYD:{code:"LYD",decimals:2},MAD:{code:"MAD",decimals:2},MDL:{code:"MDL",decimals:2},MGA:{code:"MGA",decimals:2},MKD:{code:"MKD",decimals:2},MMK:{code:"MMK",decimals:2},MNT:{code:"MNT",decimals:2},MOP:{code:"MOP",decimals:2},MRU:{code:"MRU",decimals:2},MUR:{code:"MUR",decimals:2},MVR:{code:"MVR",decimals:2},MWK:{code:"MWK",decimals:2},MXN:{code:"MXN",decimals:2},MYR:{code:"MYR",decimals:2},MZN:{code:"MZN",decimals:2},NAD:{code:"NAD",decimals:2},NGN:{code:"NGN",decimals:2},NIO:{code:"NIO",decimals:2},NOK:{code:"NOK",decimals:2},NPR:{code:"NPR",decimals:2},NZD:{code:"NZD",decimals:2},OMR:{code:"OMR",decimals:2},PAB:{code:"PAB",decimals:2},PEN:{code:"PEN",decimals:2},PGK:{code:"PGK",decimals:2},PHP:{code:"PHP",decimals:2},PKR:{code:"PKR",decimals:2},PLN:{code:"PLN",decimals:2},PYG:{code:"PYG",decimals:0},QAR:{code:"QAR",decimals:2},RON:{code:"RON",decimals:2},RSD:{code:"RSD",decimals:2},RUB:{code:"RUB",decimals:2},RWF:{code:"RWF",decimals:2},SAR:{code:"SAR",decimals:2},SBD:{code:"SBD",decimals:2},SCR:{code:"SCR",decimals:2},SDG:{code:"SDG",decimals:2},SEK:{code:"SEK",decimals:2},SGD:{code:"SGD",decimals:2},SHP:{code:"SHP",decimals:2},SLL:{code:"SLL",decimals:2},SOS:{code:"SOS",decimals:2},SRD:{code:"SRD",decimals:2},SSP:{code:"SSP",decimals:2},STN:{code:"STN",decimals:2},SYP:{code:"SYP",decimals:2},SZL:{code:"SZL",decimals:2},THB:{code:"THB",decimals:2},TJS:{code:"TJS",decimals:2},TMT:{code:"TMT",decimals:2},TND:{code:"TND",decimals:2},TOP:{code:"TOP",decimals:2},TRY:{code:"TRY",decimals:2},TTD:{code:"TTD",decimals:2},TWD:{code:"TWD",decimals:2},TZS:{code:"TZS",decimals:2},UAH:{code:"UAH",decimals:2},UGX:{code:"UGX",decimals:2},USD:{code:"USD",decimals:2},UYU:{code:"UYU",decimals:2},UZS:{code:"UZS",decimals:2},VES:{code:"VES",decimals:2},VND:{code:"VND",decimals:0},VUV:{code:"VUV",decimals:2},WST:{code:"WST",decimals:2},XAF:{code:"XAF",decimals:2},XCD:{code:"XCD",decimals:2},XOF:{code:"XOF",decimals:2},XPF:{code:"XPF",decimals:2},YER:{code:"YER",decimals:2},ZAR:{code:"ZAR",decimals:2},ZMW:{code:"ZMW",decimals:2},ZWL:{code:"ZWL",decimals:2}}},12586:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Extends=function(t,e,l,h,d){return(0,a.IsMappedResult)(t)?(0,o.ExtendsFromMappedResult)(t,e,l,h,d):(0,a.IsMappedKey)(t)?(0,i.CreateType)((0,s.ExtendsFromMappedKey)(t,e,l,h,d)):(0,i.CreateType)(function(t,e,i,s){const o=(0,n.ExtendsCheck)(t,e);return o===n.ExtendsResult.Union?(0,r.Union)([i,s]):o===n.ExtendsResult.True?i:s}(t,e,l,h),d)};const i=e(30768),r=e(85713),n=e(49507),s=e(75097),o=e(67241),a=e(51049)},12866:(t,exports)=>{"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProductAttrFilterMode=void 0,function(t){t.MODE_HIGHEST_SCORE_WINS="highest_score_wins",t.MODE_MERGE_ALL_WINNERS="merge_all_winners"}(e||(exports.ProductAttrFilterMode=e={}))},12881:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(91554),exports)},12931:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(23162),exports)},13167:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(59381),exports)},13204:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(92471),exports),r(e(15688),exports)},13703:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{x:()=>ProductAttrConditionEvaluator});var _athena_lib_ProductWizard_util_ArrayUtil__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(11480),_athena_lib_ProductWizard_util_productWizardLog__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(17723);class ProductAttrConditionEvaluator{constructor(){this.attributes={},this.regex=/[$][{].*?[}]/g,this.ignoredConstraints={},this.logEnabled=!1,this.debugEnabled=!1,this.debugList=[],this.debugConstraints={}}reset(t){this.attributes=t}clearDebug(){this.debugList=[],this.debugConstraints={}}debug(t){this.debugList.push(t)}debugConstraint(t,e,i){this.debugEnabled&&(Object.prototype.hasOwnProperty.call(this.debugConstraints,t)||(this.debugConstraints[t]={}),Object.prototype.hasOwnProperty.call(this.debugConstraints[t],e)||(this.debugConstraints[t][e]=[]),this.debugConstraints[t][e].push(i))}getDebugConstraints(t,e){return Object.prototype.hasOwnProperty.call(this.debugConstraints,t)&&Object.prototype.hasOwnProperty.call(this.debugConstraints[t],e)?this.debugConstraints[t][e]:null}log(...t){this.logEnabled&&_athena_lib_ProductWizard_util_productWizardLog__WEBPACK_IMPORTED_MODULE_0__.o.log(...t)}ignoreConstraintsFromTo(t,e){Object.prototype.hasOwnProperty.call(this.ignoredConstraints,t)||(this.ignoredConstraints[t]=[]),this.ignoredConstraints[t].push(e)}shouldIgnoreConstraints(t,e){return!(!Object.prototype.hasOwnProperty.call(this.ignoredConstraints,t)&&!Object.prototype.hasOwnProperty.call(this.ignoredConstraints,"*"))&&(this.ignoredConstraints[t].indexOf(e)>=0||this.ignoredConstraints[t].indexOf("*")>=0)}filter(t,e,i){var r;const n=this.getAttribute(e);let s=[],o=null;return n&&n.filters&&(o=n.filters.filter((e=>this.evalCondition(e.conditions,t))),o.sort(((t,e)=>e.conditionsComplexityScore-t.conditionsComplexityScore)),null==o?void 0:o.length)&&("merge_all_winners"===n.filterMode?(o.forEach((t=>{s=s.concat(t.values)})),s=[...Array.from(new Set(s))]):(_athena_lib_ProductWizard_util_productWizardLog__WEBPACK_IMPORTED_MODULE_0__.o.log("Winning filter for ",e,o[0]),s=null===(r=o[0])||void 0===r?void 0:r.values),n.isDynamicValue||(s=s.filter((t=>Object.prototype.hasOwnProperty.call(n.valuesAndConstraints,t))))),i?i(e,s,o):s}canIChangeAttribute(t,e,i){return!!this.doesCurrentItemAllowToChange(t,e,i)&&this.doesAttrValueAllowToBeCombinedWith(t,e,i)}doesAttrValueAllowToBeCombinedWith(t,e,i){const r=this.getConstraintsFor(e,i);if(r){let n=!0;const s=r.match(this.regex);if(s&&(s.forEach((e=>{const i=this.extractConditionedColumnName(e);i&&n&&(n=this.evalConditionAgainstChangeRequest(r,t,i,t[i]))})),!n&&this.debugEnabled)){let r="Blocked by ",n=[];s.forEach((e=>{const i=this.extractConditionedColumnName(e),r=null==i?void 0:i.replace("item.attributes.","");i&&n.push(`'${r}' (${t[i]})`)})),n=_athena_lib_ProductWizard_util_ArrayUtil__WEBPACK_IMPORTED_MODULE_1__._.unique(n),n.length>1&&(r+="any of these: "),r+=n.join(", "),this.debugConstraint(e,i,r),this.debug(r)}return n}return!0}doesCurrentItemAllowToChange(t,e,i){for(const r in t){const n=r.indexOf("item.attributes.")>=0&&r.replace("item.attributes.","");if(n&&n!=e&&!this.shouldIgnoreConstraints(n,e)){const s=this.getAttribute(n);if(s){let o=t[r];Array.isArray(o)||(o=[o]);for(const r in o){const a=o[r],l=this.getConstraintsFor(n,a);if(l){const r=this.evalConditionAgainstChangeRequest(l,t,"item.attributes."+e,i);if(!r){const t=`'${a} ${n}' doesn't allow '${e}' to be changed to '${i}'.`;return this.debugConstraint(e,i,`Blocked by '${n}' (${a})`),this.log(t,s,l),this.debug(t),r}this.log(`'${s}:${a}'`,!0)}}}}}return!0}evalConditionAgainstChangeRequest(condition,productItemAsOneDimensionalObject,columnNameToBeChanged,columnValueToBeChanged){let result=!0;if(condition.indexOf("${"+columnNameToBeChanged+"}")>=0){const replacedValues={},conditionedColumnNames=condition.match(this.regex);conditionedColumnNames&&conditionedColumnNames.forEach((t=>{const e=this.extractConditionedColumnName(t);e==columnNameToBeChanged?(condition=condition.replace(t,"columnValueToBeChanged"),replacedValues.columnValueToBeChanged=columnValueToBeChanged):(condition=condition.replace(t,"productItemAsOneDimensionalObject['"+e+"']"),replacedValues["productItemAsOneDimensionalObject["+e+"]"]=productItemAsOneDimensionalObject[e])}));try{this.log("testConditionAgainstChangeRequest:",condition,replacedValues),result=eval(condition)}catch(t){_athena_lib_ProductWizard_util_productWizardLog__WEBPACK_IMPORTED_MODULE_0__.o.error(t)}}return result}evalCondition(condition,productItemAsOneDimensionalObject){let result=!0;if(null==condition?void 0:condition.length){const replacedValues={},conditionedColumnNames=condition.match(this.regex);conditionedColumnNames&&conditionedColumnNames.forEach((t=>{const e=this.extractConditionedColumnName(t);condition=condition.replace(t,"productItemAsOneDimensionalObject['"+e+"']"),replacedValues["productItemAsOneDimensionalObject["+e+"]"]=productItemAsOneDimensionalObject[e]}));try{this.log("simpleConditionTest:",condition,replacedValues),result=eval(condition)}catch(t){_athena_lib_ProductWizard_util_productWizardLog__WEBPACK_IMPORTED_MODULE_0__.o.error(t)}}return result}isNotIn(t,e){return!t||(Array.isArray(t)&&!Array.isArray(e)?t.indexOf(e)<0:!Array.isArray(t)&&Array.isArray(e)?e.indexOf(t)<0:Array.isArray(t)&&Array.isArray(e)?0==e.filter((e=>t.indexOf(e)>=0)).length:!Array.isArray(t)&&!Array.isArray(e)&&t!=e)}isIn(t,e){return!!t&&(Array.isArray(t)&&!Array.isArray(e)?t.indexOf(e)>=0:!Array.isArray(t)&&Array.isArray(e)?e.indexOf(t)>=0:Array.isArray(t)&&Array.isArray(e)?e.filter((e=>t.indexOf(e)>=0)).length>0:!Array.isArray(t)&&!Array.isArray(e)&&t==e)}extractConditionedColumnName(t){var e;const i=null===(e=t.match(this.regex))||void 0===e?void 0:e.pop();return i?i.replace("$","").replace("{","").replace("}",""):null}getConstraintsFor(t,e){const i=this.getAttribute(t);return i&&Object.prototype.hasOwnProperty.call(i.valuesAndConstraints,e)?i.valuesAndConstraints[e]:null}getAttribute(t){return Object.prototype.hasOwnProperty.call(this.attributes,t)?this.attributes[t]:null}}},13863:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(22467),exports)},13969:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},14186:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},14295:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(35034),exports)},14472:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DeliverySheetSizeProcessor=void 0;const i=e(72577);exports.DeliverySheetSizeProcessor=class{constructor(t){this.sizeHelper=t}invoke(t){if("sheet"==t.getAttribute("delivery")){if(!t.getAttribute("delivery_sheet_width")&&!t.getAttribute("delivery_sheet_height"))return this.sizeHelper.deliverySheet.setDefaultValues(),"single_on_sheet"==t.getProductName()&&(t.setAttribute("delivery_sheet_height",.6*this.sizeHelper.deliverySheet.sheetHeight),t.setAttribute("delivery_sheet_width",.6*this.sizeHelper.deliverySheet.sheetWidth)),this.sizeHelper.deliverySheet.minimizeHeight(),void this.sizeHelper.deliverySheet.minimizeWidth();t.getAttribute("delivery_sheet_outside_padding")||t.setAttribute("delivery_sheet_outside_padding",String(i.DeliverySheetSizeHelper.OUTSIDE_PADDING_DEFAULT)),this.setDeliverySheetSizes(t)}}setDeliverySheetSizes(t){const e=this.sizeHelper.deliverySheet.insidePadding,r=this.sizeHelper.deliverySheet.outsidePadding,n=Number(t.getAttribute("width_mm")),s=e+Number(t.getAttribute("height_mm"))+e+2+r+r,o=e+n+e+2+r+r;this.sizeHelper.deliverySheet.sheetHeight<i.DeliverySheetSizeHelper.HEIGHT_MINIMUM&&t.setAttribute("delivery_sheet_height",i.DeliverySheetSizeHelper.HEIGHT_MINIMUM),this.sizeHelper.deliverySheet.sheetHeight<s&&t.setAttribute("delivery_sheet_height",s),this.sizeHelper.deliverySheet.sheetWidth<i.DeliverySheetSizeHelper.WIDTH_MINIMUM&&t.setAttribute("delivery_sheet_width",i.DeliverySheetSizeHelper.WIDTH_MINIMUM),this.sizeHelper.deliverySheet.sheetWidth<o&&t.setAttribute("delivery_sheet_width",o)}}},14479:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(56634),exports)},14501:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},14786:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Strict=function(t){return JSON.parse(JSON.stringify(t))}},14847:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(20909),exports)},15178:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Unknown=function(t){return(0,i.CreateType)({[r.Kind]:"Unknown"},t)};const i=e(30768),r=e(73967)},15442:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},15542:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ReturnType=function(t,e){return(0,i.CreateType)(t.returns,e)};const i=e(30768)},15688:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Readonly=function(t,e){const a=e??!0;return(0,o.IsMappedResult)(t)?(0,s.ReadonlyFromMappedResult)(t,a):function(t,e){return!1===e?function(t){return(0,i.CreateType)((0,n.Discard)(t,[r.ReadonlyKind]))}(t):function(t){return(0,i.CreateType)({...t,[r.ReadonlyKind]:"Readonly"})}(t)}(t,a)};const i=e(30768),r=e(73967),n=e(940),s=e(92471),o=e(51049)},15891:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(26942),exports)},16006:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProductAttrComputer=void 0;const i=e(8926),r=e(92153);exports.ProductAttrComputer=class{constructor(t=new r.ProductAttrConditionEvaluator){this.attrEvaluator=t,this.attributes={},this.attributesFiltersMatched={},this.attributesPreferred={},this.attributesOutOfStock={},this.attributesConstrained={},this.attributesSuggested={},this.attributesFiltered={},this.useFilters=!0}reset(t){this.attributes=t}getAttributes(){return this.attributes}evaluate(t,e,i){void 0!==i&&(this.useFilters=i),e&&(this.reset(e),this.attrEvaluator.reset(e)),this.evaluateFilteredValues(t),this.evaluateConstrainedValues(t),this.evaluateSuggestedValues(),this.evaluateOutOfStockValues()}evaluateFilteredValues(t){this.attributesFiltered={},this.attributesFiltersMatched={};for(const e in this.attributes){const[i,r]=this.attrEvaluator.filter(t.toTestableOneDimensionalArray(),e);this.attributesFiltered[e]=i,this.attributesFiltersMatched[e]=r.length}}evaluateConstrainedValues(t){this.attrEvaluator.clearDebug(),this.attributesConstrained={};for(const e in this.attributes){this.attributesConstrained[e]=[];for(const i of this.getAllValues(e))this.attrEvaluator.canIChangeAttribute(t.toTestableOneDimensionalArray(),e,String(i))||this.attributesConstrained[e].push(i)}}evaluateSuggestedValues(){this.attributesSuggested={};for(const t in this.attributes){let e=this.getFilteredValues(t);this.useFilters&&e.length||(e=this.getAllValues(t));let i=this.getPreferredValue(t);null!==i&&(Array.isArray(i)||(i=[i]),i=i.filter((i=>!this.isConstrained(t,i)&&this.canValueBe(t,i)&&e.indexOf(i)<0)),e=e.concat(i)),this.attributesSuggested[t]=e}}evaluateOutOfStockValues(){this.attributesOutOfStock={};for(const t in this.attributes){const e=this.attributes[t].outOfStockValues;e.length&&(this.attributesOutOfStock[t]=e)}}isAvailable(t,e){return!this.isConstrained(t,e)&&(this.isInSuggestedValues(t,e)||this.isDynamicValue(t))}getDefaultValue(t){if(this.isMultiValue(t))return[];const e=this.getFilteredValues(t).filter((e=>!this.isConstrained(t,e)));if(e.length)return e[0];const i=this.getSuggestedValues(t).filter((e=>!this.isConstrained(t,e)));return i.length?i[0]:null}getAllValues(t){return this.isSupported(t)?Object.keys(this.attributes[t].valuesAndConstraints).map((e=>{var i;return null!==(i=this.parseAttribute(t,e))&&void 0!==i?i:e})):[]}getHighestAvailableValue(t){const e=this.getSuggestedValues(t).filter((e=>!this.isConstrained(t,e))),i=Math.max(...e.map((t=>parseFloat(String(t)))));return isNaN(i)?null:i}getLowestAvailableValue(t){const e=this.getSuggestedValues(t).filter((e=>!this.isConstrained(t,e))),i=Math.min(...e.map((t=>parseFloat(String(t)))));return isNaN(i)?null:i}getSuggestedValues(t){return this.attributesSuggested.hasOwnProperty(t)?this.attributesSuggested[t]:[]}getFilteredValues(t){return this.attributesFiltered.hasOwnProperty(t)?this.attributesFiltered[t]:[]}hasBeenFiltered(t){return!!this.attributesFiltersMatched.hasOwnProperty(t)&&this.attributesFiltersMatched[t]>0}hasPreferredValue(t){return this.attributesPreferred.hasOwnProperty(t)}removePreferredValue(t,e){const i=this.getPreferredValue(t);this.isMultiValue(t)&&Array.isArray(i)?this.setPreferredValue(t,i.filter((t=>t!=e))):delete this.attributesPreferred[t]}getPreferredValue(t){return this.hasPreferredValue(t)?this.attributesPreferred[t]:null}setPreferredValue(t,e){this.attributesPreferred[t]=e}setPreferredValues(t){this.attributesPreferred=t}getConstrainedValues(t){return this.attributesConstrained.hasOwnProperty(t)?this.attributesConstrained[t]:[]}getOutOfStockValues(t){return this.attributesOutOfStock.hasOwnProperty(t)?this.attributesOutOfStock[t]:[]}getIcons(t){var e,i;return null!==(i=null===(e=this.attributes[t])||void 0===e?void 0:e.icons)&&void 0!==i?i:{}}isSupported(t){return this.attributes.hasOwnProperty(t)}isRequired(t){var e;return this.isSupported(t)&&(null===(e=this.attributes[t])||void 0===e?void 0:e.isRequired)}isMultiValue(t){var e;return this.isSupported(t)&&(null===(e=this.attributes[t])||void 0===e?void 0:e.isMultiValue)}isDynamicValue(t){var e;return this.isSupported(t)&&(null===(e=this.attributes[t])||void 0===e?void 0:e.isDynamicValue)}getValueType(t){var e,i;return null!==(i=null===(e=this.attributes[t])||void 0===e?void 0:e.valueType)&&void 0!==i?i:null}isBooleanType(t){return this.getValueType(t)===i.ProductAttrValueType.BOOL}isIntType(t){return this.getValueType(t)===i.ProductAttrValueType.INT}isFloatType(t){return this.getValueType(t)===i.ProductAttrValueType.FLOAT}isStringType(t){return this.getValueType(t)===i.ProductAttrValueType.STRING}isNumberType(t){return this.isIntType(t)||this.isFloatType(t)}isInFilteredValues(t,e){return this.getFilteredValues(t).includes(e)}isInSuggestedValues(t,e){return this.getSuggestedValues(t).includes(e)}isConstrained(t,e){return this.getConstrainedValues(t).includes(e)}isOutOfStock(t,e){return this.getOutOfStockValues(t).includes(e)}isRecommended(t,e){return!this.isConstrained(t,e)&&!this.isOutOfStock(t,e)&&this.hasBeenFiltered(t)&&this.isInFilteredValues(t,e)}canValueBe(t,e){var i;return!!this.isDynamicValue(t)||(null===(i=this.attributes[t])||void 0===i?void 0:i.valuesAndConstraints.hasOwnProperty(e.toString()))}parseAttribute(t,e){if(Array.isArray(e)){const i=[];for(const r of e){const e=this.parseAttribute(t,r);null!==e&&i.push(e)}return i.length>0?i:null}if(!["string","boolean","number"].includes(typeof e))return null;if(this.isStringType(t))return String(e);if(this.isBooleanType(t))try{const t=JSON.parse(e);if("boolean"==typeof t)return t}catch(t){}else{if(this.isIntType(t)){const t=parseInt(e);return isNaN(t)?null:t}if(this.isFloatType(t)){const t=parseFloat(e);return isNaN(t)?null:t}}return null}get debugList(){return this.attrEvaluator.debugList}set debugEnabled(t){this.attrEvaluator.debugEnabled=t}get debugEnabled(){return this.attrEvaluator.debugEnabled}}},16816:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},16866:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConstructorParameters=function(t,e){return(0,i.Tuple)(t.parameters,e)};const i=e(62700)},17174:t=>{t.exports='// Spectrum Colorpicker v1.8.1\n// https://github.com/bgrins/spectrum\n// Author: Brian Grinstead\n// License: MIT\n\n(function (factory) {\n    "use strict";\n\n    if (typeof define === \'function\' && define.amd) { // AMD\n        define([\'jquery\'], factory);\n    }\n    else if (typeof exports == "object" && typeof module == "object") { // CommonJS\n        module.exports = factory(require(\'jquery\'));\n    }\n    else { // Browser\n        factory(jQuery);\n    }\n})(function($, undefined) {\n    "use strict";\n\n    var defaultOpts = {\n\n        // Callbacks\n        beforeShow: noop,\n        move: noop,\n        change: noop,\n        show: noop,\n        hide: noop,\n\n        // Options\n        color: false,\n        flat: false,\n        showInput: false,\n        allowEmpty: false,\n        showButtons: true,\n        clickoutFiresChange: true,\n        showInitial: false,\n        showPalette: false,\n        showPaletteOnly: false,\n        hideAfterPaletteSelect: false,\n        togglePaletteOnly: false,\n        showSelectionPalette: true,\n        localStorageKey: false,\n        appendTo: "body",\n        maxSelectionSize: 7,\n        cancelText: "cancel",\n        chooseText: "choose",\n        togglePaletteMoreText: "more",\n        togglePaletteLessText: "less",\n        clearText: "Clear Color Selection",\n        noColorSelectedText: "No Color Selected",\n        preferredFormat: false,\n        className: "", // Deprecated - use containerClassName and replacerClassName instead.\n        containerClassName: "",\n        replacerClassName: "",\n        showAlpha: false,\n        theme: "sp-light",\n        palette: [["#ffffff", "#000000", "#ff0000", "#ff8000", "#ffff00", "#008000", "#0000ff", "#4b0082", "#9400d3"]],\n        selectionPalette: [],\n        disabled: false,\n        offset: null\n    },\n    spectrums = [],\n    IE = !!/msie/i.exec( window.navigator.userAgent ),\n    rgbaSupport = (function() {\n        function contains( str, substr ) {\n            return !!~(\'\' + str).indexOf(substr);\n        }\n\n        var elem = document.createElement(\'div\');\n        var style = elem.style;\n        style.cssText = \'background-color:rgba(0,0,0,.5)\';\n        return contains(style.backgroundColor, \'rgba\') || contains(style.backgroundColor, \'hsla\');\n    })(),\n    replaceInput = [\n        "<div class=\'sp-replacer\'>",\n            "<div class=\'sp-preview\'><div class=\'sp-preview-inner\'></div></div>",\n            "<div class=\'sp-dd\'>&#9660;</div>",\n        "</div>"\n    ].join(\'\'),\n    markup = (function () {\n\n        // IE does not support gradients with multiple stops, so we need to simulate\n        //  that for the rainbow slider with 8 divs that each have a single gradient\n        var gradientFix = "";\n        if (IE) {\n            for (var i = 1; i <= 6; i++) {\n                gradientFix += "<div class=\'sp-" + i + "\'></div>";\n            }\n        }\n\n        return [\n            "<div class=\'sp-container sp-hidden\'>",\n                "<div class=\'sp-palette-container\'>",\n                    "<div class=\'sp-palette sp-thumb sp-cf\'></div>",\n                    "<div class=\'sp-palette-button-container sp-cf\'>",\n                        "<button type=\'button\' class=\'sp-palette-toggle\'></button>",\n                    "</div>",\n                "</div>",\n                "<div class=\'sp-picker-container\'>",\n                    "<div class=\'sp-top sp-cf\'>",\n                        "<div class=\'sp-fill\'></div>",\n                        "<div class=\'sp-top-inner\'>",\n                            "<div class=\'sp-color\'>",\n                                "<div class=\'sp-sat\'>",\n                                    "<div class=\'sp-val\'>",\n                                        "<div class=\'sp-dragger\'></div>",\n                                    "</div>",\n                                "</div>",\n                            "</div>",\n                            "<div class=\'sp-clear sp-clear-display\'>",\n                            "</div>",\n                            "<div class=\'sp-hue\'>",\n                                "<div class=\'sp-slider\'></div>",\n                                gradientFix,\n                            "</div>",\n                        "</div>",\n                        "<div class=\'sp-alpha\'><div class=\'sp-alpha-inner\'><div class=\'sp-alpha-handle\'></div></div></div>",\n                    "</div>",\n                    "<div class=\'sp-input-container sp-cf\'>",\n                        "<input class=\'sp-input\' type=\'text\' spellcheck=\'false\'  />",\n                    "</div>",\n                    "<div class=\'sp-initial sp-thumb sp-cf\'></div>",\n                    "<div class=\'sp-button-container sp-cf\'>",\n                        "<a class=\'sp-cancel\' href=\'#\'></a>",\n                        "<button type=\'button\' class=\'sp-choose\'></button>",\n                    "</div>",\n                "</div>",\n            "</div>"\n        ].join("");\n    })();\n\n    function paletteTemplate (p, color, className, opts) {\n        var html = [];\n        for (var i = 0; i < p.length; i++) {\n            var current = p[i];\n            if(current) {\n                var tiny = tinycolor(current);\n                var c = tiny.toHsl().l < 0.5 ? "sp-thumb-el sp-thumb-dark" : "sp-thumb-el sp-thumb-light";\n                c += (tinycolor.equals(color, current)) ? " sp-thumb-active" : "";\n                var formattedString = tiny.toString(opts.preferredFormat || "rgb");\n                var swatchStyle = rgbaSupport ? ("background-color:" + tiny.toRgbString()) : "filter:" + tiny.toFilter();\n                html.push(\'<span title="\' + formattedString + \'" data-color="\' + tiny.toRgbString() + \'" class="\' + c + \'"><span class="sp-thumb-inner" style="\' + swatchStyle + \';"></span></span>\');\n            } else {\n                var cls = \'sp-clear-display\';\n                html.push($(\'<div />\')\n                    .append($(\'<span data-color="" style="background-color:transparent;" class="\' + cls + \'"></span>\')\n                        .attr(\'title\', opts.noColorSelectedText)\n                    )\n                    .html()\n                );\n            }\n        }\n        return "<div class=\'sp-cf " + className + "\'>" + html.join(\'\') + "</div>";\n    }\n\n    function hideAll() {\n        for (var i = 0; i < spectrums.length; i++) {\n            if (spectrums[i]) {\n                spectrums[i].hide();\n            }\n        }\n    }\n\n    function instanceOptions(o, callbackContext) {\n        var opts = $.extend({}, defaultOpts, o);\n        opts.callbacks = {\n            \'move\': bind(opts.move, callbackContext),\n            \'change\': bind(opts.change, callbackContext),\n            \'show\': bind(opts.show, callbackContext),\n            \'hide\': bind(opts.hide, callbackContext),\n            \'beforeShow\': bind(opts.beforeShow, callbackContext)\n        };\n\n        return opts;\n    }\n\n    function spectrum(element, o) {\n\n        var opts = instanceOptions(o, element),\n            flat = opts.flat,\n            showSelectionPalette = opts.showSelectionPalette,\n            localStorageKey = opts.localStorageKey,\n            theme = opts.theme,\n            callbacks = opts.callbacks,\n            resize = throttle(reflow, 10),\n            visible = false,\n            isDragging = false,\n            dragWidth = 0,\n            dragHeight = 0,\n            dragHelperHeight = 0,\n            slideHeight = 0,\n            slideWidth = 0,\n            alphaWidth = 0,\n            alphaSlideHelperWidth = 0,\n            slideHelperHeight = 0,\n            currentHue = 0,\n            currentSaturation = 0,\n            currentValue = 0,\n            currentAlpha = 1,\n            palette = [],\n            paletteArray = [],\n            paletteLookup = {},\n            selectionPalette = opts.selectionPalette.slice(0),\n            maxSelectionSize = opts.maxSelectionSize,\n            draggingClass = "sp-dragging",\n            shiftMovementDirection = null;\n\n        var doc = element.ownerDocument,\n            body = doc.body,\n            boundElement = $(element),\n            disabled = false,\n            container = $(markup, doc).addClass(theme),\n            pickerContainer = container.find(".sp-picker-container"),\n            dragger = container.find(".sp-color"),\n            dragHelper = container.find(".sp-dragger"),\n            slider = container.find(".sp-hue"),\n            slideHelper = container.find(".sp-slider"),\n            alphaSliderInner = container.find(".sp-alpha-inner"),\n            alphaSlider = container.find(".sp-alpha"),\n            alphaSlideHelper = container.find(".sp-alpha-handle"),\n            textInput = container.find(".sp-input"),\n            paletteContainer = container.find(".sp-palette"),\n            initialColorContainer = container.find(".sp-initial"),\n            cancelButton = container.find(".sp-cancel"),\n            clearButton = container.find(".sp-clear"),\n            chooseButton = container.find(".sp-choose"),\n            toggleButton = container.find(".sp-palette-toggle"),\n            isInput = boundElement.is("input"),\n            isInputTypeColor = isInput && boundElement.attr("type") === "color" && inputTypeColorSupport(),\n            shouldReplace = isInput && !flat,\n            replacer = (shouldReplace) ? $(replaceInput).addClass(theme).addClass(opts.className).addClass(opts.replacerClassName) : $([]),\n            offsetElement = (shouldReplace) ? replacer : boundElement,\n            previewElement = replacer.find(".sp-preview-inner"),\n            initialColor = opts.color || (isInput && boundElement.val()),\n            colorOnShow = false,\n            currentPreferredFormat = opts.preferredFormat,\n            clickoutFiresChange = !opts.showButtons || opts.clickoutFiresChange,\n            isEmpty = !initialColor,\n            allowEmpty = opts.allowEmpty && !isInputTypeColor;\n\n        function applyOptions() {\n\n            if (opts.showPaletteOnly) {\n                opts.showPalette = true;\n            }\n\n            toggleButton.text(opts.showPaletteOnly ? opts.togglePaletteMoreText : opts.togglePaletteLessText);\n\n            if (opts.palette) {\n                palette = opts.palette.slice(0);\n                paletteArray = $.isArray(palette[0]) ? palette : [palette];\n                paletteLookup = {};\n                for (var i = 0; i < paletteArray.length; i++) {\n                    for (var j = 0; j < paletteArray[i].length; j++) {\n                        var rgb = tinycolor(paletteArray[i][j]).toRgbString();\n                        paletteLookup[rgb] = true;\n                    }\n                }\n            }\n\n            container.toggleClass("sp-flat", flat);\n            container.toggleClass("sp-input-disabled", !opts.showInput);\n            container.toggleClass("sp-alpha-enabled", opts.showAlpha);\n            container.toggleClass("sp-clear-enabled", allowEmpty);\n            container.toggleClass("sp-buttons-disabled", !opts.showButtons);\n            container.toggleClass("sp-palette-buttons-disabled", !opts.togglePaletteOnly);\n            container.toggleClass("sp-palette-disabled", !opts.showPalette);\n            container.toggleClass("sp-palette-only", opts.showPaletteOnly);\n            container.toggleClass("sp-initial-disabled", !opts.showInitial);\n            container.addClass(opts.className).addClass(opts.containerClassName);\n\n            reflow();\n        }\n\n        function initialize() {\n\n            if (IE) {\n                container.find("*:not(input)").attr("unselectable", "on");\n            }\n\n            applyOptions();\n\n            if (shouldReplace) {\n                boundElement.after(replacer).hide();\n            }\n\n            if (!allowEmpty) {\n                clearButton.hide();\n            }\n\n            if (flat) {\n                boundElement.after(container).hide();\n            }\n            else {\n\n                var appendTo = opts.appendTo === "parent" ? boundElement.parent() : $(opts.appendTo);\n                if (appendTo.length !== 1) {\n                    appendTo = $("body");\n                }\n\n                appendTo.append(container);\n            }\n\n            updateSelectionPaletteFromStorage();\n\n            offsetElement.on("click.spectrum touchstart.spectrum", function (e) {\n                if (!disabled) {\n                    toggle();\n                }\n\n                e.stopPropagation();\n\n                if (!$(e.target).is("input")) {\n                    e.preventDefault();\n                }\n            });\n\n            if(boundElement.is(":disabled") || (opts.disabled === true)) {\n                disable();\n            }\n\n            // Prevent clicks from bubbling up to document.  This would cause it to be hidden.\n            container.click(stopPropagation);\n\n            // Handle user typed input\n            textInput.change(setFromTextInput);\n            textInput.on("paste", function () {\n                setTimeout(setFromTextInput, 1);\n            });\n            textInput.keydown(function (e) { if (e.keyCode == 13) { setFromTextInput(); } });\n\n            cancelButton.text(opts.cancelText);\n            cancelButton.on("click.spectrum", function (e) {\n                e.stopPropagation();\n                e.preventDefault();\n                revert();\n                hide();\n            });\n\n            clearButton.attr("title", opts.clearText);\n            clearButton.on("click.spectrum", function (e) {\n                e.stopPropagation();\n                e.preventDefault();\n                isEmpty = true;\n                move();\n\n                if(flat) {\n                    //for the flat style, this is a change event\n                    updateOriginalInput(true);\n                }\n            });\n\n            chooseButton.text(opts.chooseText);\n            chooseButton.on("click.spectrum", function (e) {\n                e.stopPropagation();\n                e.preventDefault();\n\n                if (IE && textInput.is(":focus")) {\n                    textInput.trigger(\'change\');\n                }\n\n                if (isValid()) {\n                    updateOriginalInput(true);\n                    hide();\n                }\n            });\n\n            toggleButton.text(opts.showPaletteOnly ? opts.togglePaletteMoreText : opts.togglePaletteLessText);\n            toggleButton.on("click.spectrum", function (e) {\n                e.stopPropagation();\n                e.preventDefault();\n\n                opts.showPaletteOnly = !opts.showPaletteOnly;\n\n                // To make sure the Picker area is drawn on the right, next to the\n                // Palette area (and not below the palette), first move the Palette\n                // to the left to make space for the picker, plus 5px extra.\n                // The \'applyOptions\' function puts the whole container back into place\n                // and takes care of the button-text and the sp-palette-only CSS class.\n                if (!opts.showPaletteOnly && !flat) {\n                    container.css(\'left\', \'-=\' + (pickerContainer.outerWidth(true) + 5));\n                }\n                applyOptions();\n            });\n\n            draggable(alphaSlider, function (dragX, dragY, e) {\n                currentAlpha = (dragX / alphaWidth);\n                isEmpty = false;\n                if (e.shiftKey) {\n                    currentAlpha = Math.round(currentAlpha * 10) / 10;\n                }\n\n                move();\n            }, dragStart, dragStop);\n\n            draggable(slider, function (dragX, dragY) {\n                currentHue = parseFloat(dragY / slideHeight);\n                isEmpty = false;\n                if (!opts.showAlpha) {\n                    currentAlpha = 1;\n                }\n                move();\n            }, dragStart, dragStop);\n\n            draggable(dragger, function (dragX, dragY, e) {\n\n                // shift+drag should snap the movement to either the x or y axis.\n                if (!e.shiftKey) {\n                    shiftMovementDirection = null;\n                }\n                else if (!shiftMovementDirection) {\n                    var oldDragX = currentSaturation * dragWidth;\n                    var oldDragY = dragHeight - (currentValue * dragHeight);\n                    var furtherFromX = Math.abs(dragX - oldDragX) > Math.abs(dragY - oldDragY);\n\n                    shiftMovementDirection = furtherFromX ? "x" : "y";\n                }\n\n                var setSaturation = !shiftMovementDirection || shiftMovementDirection === "x";\n                var setValue = !shiftMovementDirection || shiftMovementDirection === "y";\n\n                if (setSaturation) {\n                    currentSaturation = parseFloat(dragX / dragWidth);\n                }\n                if (setValue) {\n                    currentValue = parseFloat((dragHeight - dragY) / dragHeight);\n                }\n\n                isEmpty = false;\n                if (!opts.showAlpha) {\n                    currentAlpha = 1;\n                }\n\n                move();\n\n            }, dragStart, dragStop);\n\n            if (!!initialColor) {\n                set(initialColor);\n\n                // In case color was black - update the preview UI and set the format\n                // since the set function will not run (default color is black).\n                updateUI();\n                currentPreferredFormat = opts.preferredFormat || tinycolor(initialColor).format;\n\n                addColorToSelectionPalette(initialColor);\n            }\n            else {\n                updateUI();\n            }\n\n            if (flat) {\n                show();\n            }\n\n            function paletteElementClick(e) {\n                if (e.data && e.data.ignore) {\n                    set($(e.target).closest(".sp-thumb-el").data("color"));\n                    move();\n                }\n                else {\n                    set($(e.target).closest(".sp-thumb-el").data("color"));\n                    move();\n\n                    // If the picker is going to close immediately, a palette selection\n                    // is a change.  Otherwise, it\'s a move only.\n                    if (opts.hideAfterPaletteSelect) {\n                        updateOriginalInput(true);\n                        hide();\n                    } else {\n                        updateOriginalInput();\n                    }\n                }\n\n                return false;\n            }\n\n            var paletteEvent = IE ? "mousedown.spectrum" : "click.spectrum touchstart.spectrum";\n            paletteContainer.on(paletteEvent, ".sp-thumb-el", paletteElementClick);\n            initialColorContainer.on(paletteEvent, ".sp-thumb-el:nth-child(1)", { ignore: true }, paletteElementClick);\n        }\n\n        function updateSelectionPaletteFromStorage() {\n\n            if (localStorageKey && window.localStorage) {\n\n                // Migrate old palettes over to new format.  May want to remove this eventually.\n                try {\n                    var oldPalette = window.localStorage[localStorageKey].split(",#");\n                    if (oldPalette.length > 1) {\n                        delete window.localStorage[localStorageKey];\n                        $.each(oldPalette, function(i, c) {\n                             addColorToSelectionPalette(c);\n                        });\n                    }\n                }\n                catch(e) { }\n\n                try {\n                    selectionPalette = window.localStorage[localStorageKey].split(";");\n                }\n                catch (e) { }\n            }\n        }\n\n        function addColorToSelectionPalette(color) {\n            if (showSelectionPalette) {\n                var rgb = tinycolor(color).toRgbString();\n                if (!paletteLookup[rgb] && $.inArray(rgb, selectionPalette) === -1) {\n                    selectionPalette.push(rgb);\n                    while(selectionPalette.length > maxSelectionSize) {\n                        selectionPalette.shift();\n                    }\n                }\n\n                if (localStorageKey && window.localStorage) {\n                    try {\n                        window.localStorage[localStorageKey] = selectionPalette.join(";");\n                    }\n                    catch(e) { }\n                }\n            }\n        }\n\n        function getUniqueSelectionPalette() {\n            var unique = [];\n            if (opts.showPalette) {\n                for (var i = 0; i < selectionPalette.length; i++) {\n                    var rgb = tinycolor(selectionPalette[i]).toRgbString();\n\n                    if (!paletteLookup[rgb]) {\n                        unique.push(selectionPalette[i]);\n                    }\n                }\n            }\n\n            return unique.reverse().slice(0, opts.maxSelectionSize);\n        }\n\n        function drawPalette() {\n\n            var currentColor = get();\n\n            var html = $.map(paletteArray, function (palette, i) {\n                return paletteTemplate(palette, currentColor, "sp-palette-row sp-palette-row-" + i, opts);\n            });\n\n            updateSelectionPaletteFromStorage();\n\n            if (selectionPalette) {\n                html.push(paletteTemplate(getUniqueSelectionPalette(), currentColor, "sp-palette-row sp-palette-row-selection", opts));\n            }\n\n            paletteContainer.html(html.join(""));\n        }\n\n        function drawInitial() {\n            if (opts.showInitial) {\n                var initial = colorOnShow;\n                var current = get();\n                initialColorContainer.html(paletteTemplate([initial, current], current, "sp-palette-row-initial", opts));\n            }\n        }\n\n        function dragStart() {\n            if (dragHeight <= 0 || dragWidth <= 0 || slideHeight <= 0) {\n                reflow();\n            }\n            isDragging = true;\n            container.addClass(draggingClass);\n            shiftMovementDirection = null;\n            boundElement.trigger(\'dragstart.spectrum\', [ get() ]);\n        }\n\n        function dragStop() {\n            isDragging = false;\n            container.removeClass(draggingClass);\n            boundElement.trigger(\'dragstop.spectrum\', [ get() ]);\n        }\n\n        function setFromTextInput() {\n\n            var value = textInput.val();\n\n            if ((value === null || value === "") && allowEmpty) {\n                set(null);\n                move();\n                updateOriginalInput();\n            }\n            else {\n                var tiny = tinycolor(value);\n                if (tiny.isValid()) {\n                    set(tiny);\n                    move();\n                    updateOriginalInput();\n                }\n                else {\n                    textInput.addClass("sp-validation-error");\n                }\n            }\n        }\n\n        function toggle() {\n            if (visible) {\n                hide();\n            }\n            else {\n                show();\n            }\n        }\n\n        function show() {\n            var event = $.Event(\'beforeShow.spectrum\');\n\n            if (visible) {\n                reflow();\n                return;\n            }\n\n            boundElement.trigger(event, [ get() ]);\n\n            if (callbacks.beforeShow(get()) === false || event.isDefaultPrevented()) {\n                return;\n            }\n\n            hideAll();\n            visible = true;\n\n            $(doc).on("keydown.spectrum", onkeydown);\n            $(doc).on("click.spectrum", clickout);\n            $(window).on("resize.spectrum", resize);\n            replacer.addClass("sp-active");\n            container.removeClass("sp-hidden");\n\n            reflow();\n            updateUI();\n\n            colorOnShow = get();\n\n            drawInitial();\n            callbacks.show(colorOnShow);\n            boundElement.trigger(\'show.spectrum\', [ colorOnShow ]);\n        }\n\n        function onkeydown(e) {\n            // Close on ESC\n            if (e.keyCode === 27) {\n                hide();\n            }\n        }\n\n        function clickout(e) {\n            // Return on right click.\n            if (e.button == 2) { return; }\n\n            // If a drag event was happening during the mouseup, don\'t hide\n            // on click.\n            if (isDragging) { return; }\n\n            if (clickoutFiresChange) {\n                updateOriginalInput(true);\n            }\n            else {\n                revert();\n            }\n            hide();\n        }\n\n        function hide() {\n            // Return if hiding is unnecessary\n            if (!visible || flat) { return; }\n            visible = false;\n\n            $(doc).off("keydown.spectrum", onkeydown);\n            $(doc).off("click.spectrum", clickout);\n            $(window).off("resize.spectrum", resize);\n\n            replacer.removeClass("sp-active");\n            container.addClass("sp-hidden");\n\n            callbacks.hide(get());\n            boundElement.trigger(\'hide.spectrum\', [ get() ]);\n        }\n\n        function revert() {\n            set(colorOnShow, true);\n            updateOriginalInput(true);\n        }\n\n        function set(color, ignoreFormatChange) {\n            if (tinycolor.equals(color, get())) {\n                // Update UI just in case a validation error needs\n                // to be cleared.\n                updateUI();\n                return;\n            }\n\n            var newColor, newHsv;\n            if (!color && allowEmpty) {\n                isEmpty = true;\n            } else {\n                isEmpty = false;\n                newColor = tinycolor(color);\n                newHsv = newColor.toHsv();\n\n                currentHue = (newHsv.h % 360) / 360;\n                currentSaturation = newHsv.s;\n                currentValue = newHsv.v;\n                currentAlpha = newHsv.a;\n            }\n            updateUI();\n\n            if (newColor && newColor.isValid() && !ignoreFormatChange) {\n                currentPreferredFormat = opts.preferredFormat || newColor.getFormat();\n            }\n        }\n\n        function get(opts) {\n            opts = opts || { };\n\n            if (allowEmpty && isEmpty) {\n                return null;\n            }\n\n            return tinycolor.fromRatio({\n                h: currentHue,\n                s: currentSaturation,\n                v: currentValue,\n                a: Math.round(currentAlpha * 1000) / 1000\n            }, { format: opts.format || currentPreferredFormat });\n        }\n\n        function isValid() {\n            return !textInput.hasClass("sp-validation-error");\n        }\n\n        function move() {\n            updateUI();\n\n            callbacks.move(get());\n            boundElement.trigger(\'move.spectrum\', [ get() ]);\n        }\n\n        function updateUI() {\n\n            textInput.removeClass("sp-validation-error");\n\n            updateHelperLocations();\n\n            // Update dragger background color (gradients take care of saturation and value).\n            var flatColor = tinycolor.fromRatio({ h: currentHue, s: 1, v: 1 });\n            dragger.css("background-color", flatColor.toHexString());\n\n            // Get a format that alpha will be included in (hex and names ignore alpha)\n            var format = currentPreferredFormat;\n            if (currentAlpha < 1 && !(currentAlpha === 0 && format === "name")) {\n                if (format === "hex" || format === "hex3" || format === "hex6" || format === "name") {\n                    format = "rgb";\n                }\n            }\n\n            var realColor = get({ format: format }),\n                displayColor = \'\';\n\n             //reset background info for preview element\n            previewElement.removeClass("sp-clear-display");\n            previewElement.css(\'background-color\', \'transparent\');\n\n            if (!realColor && allowEmpty) {\n                // Update the replaced elements background with icon indicating no color selection\n                previewElement.addClass("sp-clear-display");\n            }\n            else {\n                var realHex = realColor.toHexString(),\n                    realRgb = realColor.toRgbString();\n\n                // Update the replaced elements background color (with actual selected color)\n                if (rgbaSupport || realColor.alpha === 1) {\n                    previewElement.css("background-color", realRgb);\n                }\n                else {\n                    previewElement.css("background-color", "transparent");\n                    previewElement.css("filter", realColor.toFilter());\n                }\n\n                if (opts.showAlpha) {\n                    var rgb = realColor.toRgb();\n                    rgb.a = 0;\n                    var realAlpha = tinycolor(rgb).toRgbString();\n                    var gradient = "linear-gradient(left, " + realAlpha + ", " + realHex + ")";\n\n                    if (IE) {\n                        alphaSliderInner.css("filter", tinycolor(realAlpha).toFilter({ gradientType: 1 }, realHex));\n                    }\n                    else {\n                        alphaSliderInner.css("background", "-webkit-" + gradient);\n                        alphaSliderInner.css("background", "-moz-" + gradient);\n                        alphaSliderInner.css("background", "-ms-" + gradient);\n                        // Use current syntax gradient on unprefixed property.\n                        alphaSliderInner.css("background",\n                            "linear-gradient(to right, " + realAlpha + ", " + realHex + ")");\n                    }\n                }\n\n                displayColor = realColor.toString(format);\n            }\n\n            // Update the text entry input as it changes happen\n            if (opts.showInput) {\n                textInput.val(displayColor);\n            }\n\n            if (opts.showPalette) {\n                drawPalette();\n            }\n\n            drawInitial();\n        }\n\n        function updateHelperLocations() {\n            var s = currentSaturation;\n            var v = currentValue;\n\n            if(allowEmpty && isEmpty) {\n                //if selected color is empty, hide the helpers\n                alphaSlideHelper.hide();\n                slideHelper.hide();\n                dragHelper.hide();\n            }\n            else {\n                //make sure helpers are visible\n                alphaSlideHelper.show();\n                slideHelper.show();\n                dragHelper.show();\n\n                // Where to show the little circle in that displays your current selected color\n                var dragX = s * dragWidth;\n                var dragY = dragHeight - (v * dragHeight);\n                dragX = Math.max(\n                    -dragHelperHeight,\n                    Math.min(dragWidth - dragHelperHeight, dragX - dragHelperHeight)\n                );\n                dragY = Math.max(\n                    -dragHelperHeight,\n                    Math.min(dragHeight - dragHelperHeight, dragY - dragHelperHeight)\n                );\n                dragHelper.css({\n                    "top": dragY + "px",\n                    "left": dragX + "px"\n                });\n\n                var alphaX = currentAlpha * alphaWidth;\n                alphaSlideHelper.css({\n                    "left": (alphaX - (alphaSlideHelperWidth / 2)) + "px"\n                });\n\n                // Where to show the bar that displays your current selected hue\n                var slideY = (currentHue) * slideHeight;\n                slideHelper.css({\n                    "top": (slideY - slideHelperHeight) + "px"\n                });\n            }\n        }\n\n        function updateOriginalInput(fireCallback) {\n            var color = get(),\n                displayColor = \'\',\n                hasChanged = !tinycolor.equals(color, colorOnShow);\n\n            if (color) {\n                displayColor = color.toString(currentPreferredFormat);\n                // Update the selection palette with the current color\n                addColorToSelectionPalette(color);\n            }\n\n            if (isInput) {\n                boundElement.val(displayColor);\n            }\n\n            if (fireCallback && hasChanged) {\n                callbacks.change(color);\n                boundElement.trigger(\'change\', [ color ]);\n            }\n        }\n\n        function reflow() {\n            if (!visible) {\n                return; // Calculations would be useless and wouldn\'t be reliable anyways\n            }\n            dragWidth = dragger.width();\n            dragHeight = dragger.height();\n            dragHelperHeight = dragHelper.height();\n            slideWidth = slider.width();\n            slideHeight = slider.height();\n            slideHelperHeight = slideHelper.height();\n            alphaWidth = alphaSlider.width();\n            alphaSlideHelperWidth = alphaSlideHelper.width();\n\n            if (!flat) {\n                container.css("position", "absolute");\n                if (opts.offset) {\n                    container.offset(opts.offset);\n                } else {\n                    container.offset(getOffset(container, offsetElement));\n                }\n            }\n\n            updateHelperLocations();\n\n            if (opts.showPalette) {\n                drawPalette();\n            }\n\n            boundElement.trigger(\'reflow.spectrum\');\n        }\n\n        function destroy() {\n            boundElement.show();\n            offsetElement.off("click.spectrum touchstart.spectrum");\n            container.remove();\n            replacer.remove();\n            spectrums[spect.id] = null;\n        }\n\n        function option(optionName, optionValue) {\n            if (optionName === undefined) {\n                return $.extend({}, opts);\n            }\n            if (optionValue === undefined) {\n                return opts[optionName];\n            }\n\n            opts[optionName] = optionValue;\n\n            if (optionName === "preferredFormat") {\n                currentPreferredFormat = opts.preferredFormat;\n            }\n            applyOptions();\n        }\n\n        function enable() {\n            disabled = false;\n            boundElement.attr("disabled", false);\n            offsetElement.removeClass("sp-disabled");\n        }\n\n        function disable() {\n            hide();\n            disabled = true;\n            boundElement.attr("disabled", true);\n            offsetElement.addClass("sp-disabled");\n        }\n\n        function setOffset(coord) {\n            opts.offset = coord;\n            reflow();\n        }\n\n        initialize();\n\n        var spect = {\n            show: show,\n            hide: hide,\n            toggle: toggle,\n            reflow: reflow,\n            option: option,\n            enable: enable,\n            disable: disable,\n            offset: setOffset,\n            set: function (c) {\n                set(c);\n                updateOriginalInput();\n            },\n            get: get,\n            destroy: destroy,\n            container: container\n        };\n\n        spect.id = spectrums.push(spect) - 1;\n\n        return spect;\n    }\n\n    /**\n    * checkOffset - get the offset below/above and left/right element depending on screen position\n    * Thanks https://github.com/jquery/jquery-ui/blob/master/ui/jquery.ui.datepicker.js\n    */\n    function getOffset(picker, input) {\n        var extraY = 0;\n        var dpWidth = picker.outerWidth();\n        var dpHeight = picker.outerHeight();\n        var inputHeight = input.outerHeight();\n        var doc = picker[0].ownerDocument;\n        var docElem = doc.documentElement;\n        var viewWidth = docElem.clientWidth + $(doc).scrollLeft();\n        var viewHeight = docElem.clientHeight + $(doc).scrollTop();\n        var offset = input.offset();\n        var offsetLeft = offset.left;\n        var offsetTop = offset.top;\n\n        offsetTop += inputHeight;\n\n        offsetLeft -=\n            Math.min(offsetLeft, (offsetLeft + dpWidth > viewWidth && viewWidth > dpWidth) ?\n            Math.abs(offsetLeft + dpWidth - viewWidth) : 0);\n\n        offsetTop -=\n            Math.min(offsetTop, ((offsetTop + dpHeight > viewHeight && viewHeight > dpHeight) ?\n            Math.abs(dpHeight + inputHeight - extraY) : extraY));\n\n        return {\n            top: offsetTop,\n            bottom: offset.bottom,\n            left: offsetLeft,\n            right: offset.right,\n            width: offset.width,\n            height: offset.height\n        };\n    }\n\n    /**\n    * noop - do nothing\n    */\n    function noop() {\n\n    }\n\n    /**\n    * stopPropagation - makes the code only doing this a little easier to read in line\n    */\n    function stopPropagation(e) {\n        e.stopPropagation();\n    }\n\n    /**\n    * Create a function bound to a given object\n    * Thanks to underscore.js\n    */\n    function bind(func, obj) {\n        var slice = Array.prototype.slice;\n        var args = slice.call(arguments, 2);\n        return function () {\n            return func.apply(obj, args.concat(slice.call(arguments)));\n        };\n    }\n\n    /**\n    * Lightweight drag helper.  Handles containment within the element, so that\n    * when dragging, the x is within [0,element.width] and y is within [0,element.height]\n    */\n    function draggable(element, onmove, onstart, onstop) {\n        onmove = onmove || function () { };\n        onstart = onstart || function () { };\n        onstop = onstop || function () { };\n        var doc = document;\n        var dragging = false;\n        var offset = {};\n        var maxHeight = 0;\n        var maxWidth = 0;\n        var hasTouch = (\'ontouchstart\' in window);\n\n        var duringDragEvents = {};\n        duringDragEvents["selectstart"] = prevent;\n        duringDragEvents["dragstart"] = prevent;\n        duringDragEvents["touchmove mousemove"] = move;\n        duringDragEvents["touchend mouseup"] = stop;\n\n        function prevent(e) {\n            if (e.stopPropagation) {\n                e.stopPropagation();\n            }\n            if (e.preventDefault) {\n                e.preventDefault();\n            }\n            e.returnValue = false;\n        }\n\n        function move(e) {\n            if (dragging) {\n                // Mouseup happened outside of window\n                if (IE && doc.documentMode < 9 && !e.button) {\n                    return stop();\n                }\n\n                var t0 = e.originalEvent && e.originalEvent.touches && e.originalEvent.touches[0];\n                var pageX = t0 && t0.pageX || e.pageX;\n                var pageY = t0 && t0.pageY || e.pageY;\n\n                var dragX = Math.max(0, Math.min(pageX - offset.left, maxWidth));\n                var dragY = Math.max(0, Math.min(pageY - offset.top, maxHeight));\n\n                if (hasTouch) {\n                    // Stop scrolling in iOS\n                    prevent(e);\n                }\n\n                onmove.apply(element, [dragX, dragY, e]);\n            }\n        }\n\n        function start(e) {\n            var rightclick = (e.which) ? (e.which == 3) : (e.button == 2);\n\n            if (!rightclick && !dragging) {\n                if (onstart.apply(element, arguments) !== false) {\n                    dragging = true;\n                    maxHeight = $(element).height();\n                    maxWidth = $(element).width();\n                    offset = $(element).offset();\n\n                    $(doc).on(duringDragEvents);\n                    $(doc.body).addClass("sp-dragging");\n\n                    move(e);\n\n                    prevent(e);\n                }\n            }\n        }\n\n        function stop() {\n            if (dragging) {\n                $(doc).off(duringDragEvents);\n                $(doc.body).removeClass("sp-dragging");\n\n                // Wait a tick before notifying observers to allow the click event\n                // to fire in Chrome.\n                setTimeout(function() {\n                    onstop.apply(element, arguments);\n                }, 0);\n            }\n            dragging = false;\n        }\n\n        $(element).on("touchstart mousedown", start);\n    }\n\n    function throttle(func, wait, debounce) {\n        var timeout;\n        return function () {\n            var context = this, args = arguments;\n            var throttler = function () {\n                timeout = null;\n                func.apply(context, args);\n            };\n            if (debounce) clearTimeout(timeout);\n            if (debounce || !timeout) timeout = setTimeout(throttler, wait);\n        };\n    }\n\n    function inputTypeColorSupport() {\n        return $.fn.spectrum.inputTypeColorSupport();\n    }\n\n    /**\n    * Define a jQuery plugin\n    */\n    var dataID = "spectrum.id";\n    $.fn.spectrum = function (opts, extra) {\n\n        if (typeof opts == "string") {\n\n            var returnValue = this;\n            var args = Array.prototype.slice.call( arguments, 1 );\n\n            this.each(function () {\n                var spect = spectrums[$(this).data(dataID)];\n                if (spect) {\n                    var method = spect[opts];\n                    if (!method) {\n                        throw new Error( "Spectrum: no such method: \'" + opts + "\'" );\n                    }\n\n                    if (opts == "get") {\n                        returnValue = spect.get();\n                    }\n                    else if (opts == "container") {\n                        returnValue = spect.container;\n                    }\n                    else if (opts == "option") {\n                        returnValue = spect.option.apply(spect, args);\n                    }\n                    else if (opts == "destroy") {\n                        spect.destroy();\n                        $(this).removeData(dataID);\n                    }\n                    else {\n                        method.apply(spect, args);\n                    }\n                }\n            });\n\n            return returnValue;\n        }\n\n        // Initializing a new instance of spectrum\n        return this.spectrum("destroy").each(function () {\n            var options = $.extend({}, $(this).data(), opts);\n            var spect = spectrum(this, options);\n            $(this).data(dataID, spect.id);\n        });\n    };\n\n    $.fn.spectrum.load = true;\n    $.fn.spectrum.loadOpts = {};\n    $.fn.spectrum.draggable = draggable;\n    $.fn.spectrum.defaults = defaultOpts;\n    $.fn.spectrum.inputTypeColorSupport = function inputTypeColorSupport() {\n        if (typeof inputTypeColorSupport._cachedResult === "undefined") {\n            var colorInput = $("<input type=\'color\'/>")[0]; // if color element is supported, value will default to not null\n            inputTypeColorSupport._cachedResult = colorInput.type === "color" && colorInput.value !== "";\n        }\n        return inputTypeColorSupport._cachedResult;\n    };\n\n    $.spectrum = { };\n    $.spectrum.localization = { };\n    $.spectrum.palettes = { };\n\n    $.fn.spectrum.processNativeColorInputs = function () {\n        var colorInputs = $("input[type=color]");\n        if (colorInputs.length && !inputTypeColorSupport()) {\n            colorInputs.spectrum({\n                preferredFormat: "hex6"\n            });\n        }\n    };\n\n    // TinyColor v1.1.2\n    // https://github.com/bgrins/TinyColor\n    // Brian Grinstead, MIT License\n\n    (function() {\n\n    var trimLeft = /^[\\s,#]+/,\n        trimRight = /\\s+$/,\n        tinyCounter = 0,\n        math = Math,\n        mathRound = math.round,\n        mathMin = math.min,\n        mathMax = math.max,\n        mathRandom = math.random;\n\n    var tinycolor = function(color, opts) {\n\n        color = (color) ? color : \'\';\n        opts = opts || { };\n\n        // If input is already a tinycolor, return itself\n        if (color instanceof tinycolor) {\n           return color;\n        }\n        // If we are called as a function, call using new instead\n        if (!(this instanceof tinycolor)) {\n            return new tinycolor(color, opts);\n        }\n\n        var rgb = inputToRGB(color);\n        this._originalInput = color;\n        this._r = rgb.r;\n        this._g = rgb.g;\n        this._b = rgb.b;\n        this._a = rgb.a;\n        this._roundA = mathRound(1000 * this._a) / 1000;\n        this._format = opts.format || rgb.format;\n        this._gradientType = opts.gradientType;\n\n        // Don\'t let the range of [0,255] come back in [0,1].\n        // Potentially lose a little bit of precision here, but will fix issues where\n        // .5 gets interpreted as half of the total, instead of half of 1\n        // If it was supposed to be 128, this was already taken care of by `inputToRgb`\n        if (this._r < 1) { this._r = mathRound(this._r); }\n        if (this._g < 1) { this._g = mathRound(this._g); }\n        if (this._b < 1) { this._b = mathRound(this._b); }\n\n        this._ok = rgb.ok;\n        this._tc_id = tinyCounter++;\n    };\n\n    tinycolor.prototype = {\n        isDark: function() {\n            return this.getBrightness() < 128;\n        },\n        isLight: function() {\n            return !this.isDark();\n        },\n        isValid: function() {\n            return this._ok;\n        },\n        getOriginalInput: function() {\n          return this._originalInput;\n        },\n        getFormat: function() {\n            return this._format;\n        },\n        getAlpha: function() {\n            return this._a;\n        },\n        getBrightness: function() {\n            var rgb = this.toRgb();\n            return (rgb.r * 299 + rgb.g * 587 + rgb.b * 114) / 1000;\n        },\n        setAlpha: function(value) {\n            this._a = boundAlpha(value);\n            this._roundA = mathRound(1000 * this._a) / 1000;\n            return this;\n        },\n        toHsv: function() {\n            var hsv = rgbToHsv(this._r, this._g, this._b);\n            return { h: hsv.h * 360, s: hsv.s, v: hsv.v, a: this._a };\n        },\n        toHsvString: function() {\n            var hsv = rgbToHsv(this._r, this._g, this._b);\n            var h = mathRound(hsv.h * 360), s = mathRound(hsv.s * 100), v = mathRound(hsv.v * 100);\n            return (this._a == 1) ?\n              "hsv("  + h + ", " + s + "%, " + v + "%)" :\n              "hsva(" + h + ", " + s + "%, " + v + "%, "+ this._roundA + ")";\n        },\n        toHsl: function() {\n            var hsl = rgbToHsl(this._r, this._g, this._b);\n            return { h: hsl.h * 360, s: hsl.s, l: hsl.l, a: this._a };\n        },\n        toHslString: function() {\n            var hsl = rgbToHsl(this._r, this._g, this._b);\n            var h = mathRound(hsl.h * 360), s = mathRound(hsl.s * 100), l = mathRound(hsl.l * 100);\n            return (this._a == 1) ?\n              "hsl("  + h + ", " + s + "%, " + l + "%)" :\n              "hsla(" + h + ", " + s + "%, " + l + "%, "+ this._roundA + ")";\n        },\n        toHex: function(allow3Char) {\n            return rgbToHex(this._r, this._g, this._b, allow3Char);\n        },\n        toHexString: function(allow3Char) {\n            return \'#\' + this.toHex(allow3Char);\n        },\n        toHex8: function() {\n            return rgbaToHex(this._r, this._g, this._b, this._a);\n        },\n        toHex8String: function() {\n            return \'#\' + this.toHex8();\n        },\n        toRgb: function() {\n            return { r: mathRound(this._r), g: mathRound(this._g), b: mathRound(this._b), a: this._a };\n        },\n        toRgbString: function() {\n            return (this._a == 1) ?\n              "rgb("  + mathRound(this._r) + ", " + mathRound(this._g) + ", " + mathRound(this._b) + ")" :\n              "rgba(" + mathRound(this._r) + ", " + mathRound(this._g) + ", " + mathRound(this._b) + ", " + this._roundA + ")";\n        },\n        toPercentageRgb: function() {\n            return { r: mathRound(bound01(this._r, 255) * 100) + "%", g: mathRound(bound01(this._g, 255) * 100) + "%", b: mathRound(bound01(this._b, 255) * 100) + "%", a: this._a };\n        },\n        toPercentageRgbString: function() {\n            return (this._a == 1) ?\n              "rgb("  + mathRound(bound01(this._r, 255) * 100) + "%, " + mathRound(bound01(this._g, 255) * 100) + "%, " + mathRound(bound01(this._b, 255) * 100) + "%)" :\n              "rgba(" + mathRound(bound01(this._r, 255) * 100) + "%, " + mathRound(bound01(this._g, 255) * 100) + "%, " + mathRound(bound01(this._b, 255) * 100) + "%, " + this._roundA + ")";\n        },\n        toName: function() {\n            if (this._a === 0) {\n                return "transparent";\n            }\n\n            if (this._a < 1) {\n                return false;\n            }\n\n            return hexNames[rgbToHex(this._r, this._g, this._b, true)] || false;\n        },\n        toFilter: function(secondColor) {\n            var hex8String = \'#\' + rgbaToHex(this._r, this._g, this._b, this._a);\n            var secondHex8String = hex8String;\n            var gradientType = this._gradientType ? "GradientType = 1, " : "";\n\n            if (secondColor) {\n                var s = tinycolor(secondColor);\n                secondHex8String = s.toHex8String();\n            }\n\n            return "progid:DXImageTransform.Microsoft.gradient("+gradientType+"startColorstr="+hex8String+",endColorstr="+secondHex8String+")";\n        },\n        toString: function(format) {\n            var formatSet = !!format;\n            format = format || this._format;\n\n            var formattedString = false;\n            var hasAlpha = this._a < 1 && this._a >= 0;\n            var needsAlphaFormat = !formatSet && hasAlpha && (format === "hex" || format === "hex6" || format === "hex3" || format === "name");\n\n            if (needsAlphaFormat) {\n                // Special case for "transparent", all other non-alpha formats\n                // will return rgba when there is transparency.\n                if (format === "name" && this._a === 0) {\n                    return this.toName();\n                }\n                return this.toRgbString();\n            }\n            if (format === "rgb") {\n                formattedString = this.toRgbString();\n            }\n            if (format === "prgb") {\n                formattedString = this.toPercentageRgbString();\n            }\n            if (format === "hex" || format === "hex6") {\n                formattedString = this.toHexString();\n            }\n            if (format === "hex3") {\n                formattedString = this.toHexString(true);\n            }\n            if (format === "hex8") {\n                formattedString = this.toHex8String();\n            }\n            if (format === "name") {\n                formattedString = this.toName();\n            }\n            if (format === "hsl") {\n                formattedString = this.toHslString();\n            }\n            if (format === "hsv") {\n                formattedString = this.toHsvString();\n            }\n\n            return formattedString || this.toHexString();\n        },\n\n        _applyModification: function(fn, args) {\n            var color = fn.apply(null, [this].concat([].slice.call(args)));\n            this._r = color._r;\n            this._g = color._g;\n            this._b = color._b;\n            this.setAlpha(color._a);\n            return this;\n        },\n        lighten: function() {\n            return this._applyModification(lighten, arguments);\n        },\n        brighten: function() {\n            return this._applyModification(brighten, arguments);\n        },\n        darken: function() {\n            return this._applyModification(darken, arguments);\n        },\n        desaturate: function() {\n            return this._applyModification(desaturate, arguments);\n        },\n        saturate: function() {\n            return this._applyModification(saturate, arguments);\n        },\n        greyscale: function() {\n            return this._applyModification(greyscale, arguments);\n        },\n        spin: function() {\n            return this._applyModification(spin, arguments);\n        },\n\n        _applyCombination: function(fn, args) {\n            return fn.apply(null, [this].concat([].slice.call(args)));\n        },\n        analogous: function() {\n            return this._applyCombination(analogous, arguments);\n        },\n        complement: function() {\n            return this._applyCombination(complement, arguments);\n        },\n        monochromatic: function() {\n            return this._applyCombination(monochromatic, arguments);\n        },\n        splitcomplement: function() {\n            return this._applyCombination(splitcomplement, arguments);\n        },\n        triad: function() {\n            return this._applyCombination(triad, arguments);\n        },\n        tetrad: function() {\n            return this._applyCombination(tetrad, arguments);\n        }\n    };\n\n    // If input is an object, force 1 into "1.0" to handle ratios properly\n    // String input requires "1.0" as input, so 1 will be treated as 1\n    tinycolor.fromRatio = function(color, opts) {\n        if (typeof color == "object") {\n            var newColor = {};\n            for (var i in color) {\n                if (color.hasOwnProperty(i)) {\n                    if (i === "a") {\n                        newColor[i] = color[i];\n                    }\n                    else {\n                        newColor[i] = convertToPercentage(color[i]);\n                    }\n                }\n            }\n            color = newColor;\n        }\n\n        return tinycolor(color, opts);\n    };\n\n    // Given a string or object, convert that input to RGB\n    // Possible string inputs:\n    //\n    //     "red"\n    //     "#f00" or "f00"\n    //     "#ff0000" or "ff0000"\n    //     "#ff000000" or "ff000000"\n    //     "rgb 255 0 0" or "rgb (255, 0, 0)"\n    //     "rgb 1.0 0 0" or "rgb (1, 0, 0)"\n    //     "rgba (255, 0, 0, 1)" or "rgba 255, 0, 0, 1"\n    //     "rgba (1.0, 0, 0, 1)" or "rgba 1.0, 0, 0, 1"\n    //     "hsl(0, 100%, 50%)" or "hsl 0 100% 50%"\n    //     "hsla(0, 100%, 50%, 1)" or "hsla 0 100% 50%, 1"\n    //     "hsv(0, 100%, 100%)" or "hsv 0 100% 100%"\n    //\n    function inputToRGB(color) {\n\n        var rgb = { r: 0, g: 0, b: 0 };\n        var a = 1;\n        var ok = false;\n        var format = false;\n\n        if (typeof color == "string") {\n            color = stringInputToObject(color);\n        }\n\n        if (typeof color == "object") {\n            if (color.hasOwnProperty("r") && color.hasOwnProperty("g") && color.hasOwnProperty("b")) {\n                rgb = rgbToRgb(color.r, color.g, color.b);\n                ok = true;\n                format = String(color.r).substr(-1) === "%" ? "prgb" : "rgb";\n            }\n            else if (color.hasOwnProperty("h") && color.hasOwnProperty("s") && color.hasOwnProperty("v")) {\n                color.s = convertToPercentage(color.s);\n                color.v = convertToPercentage(color.v);\n                rgb = hsvToRgb(color.h, color.s, color.v);\n                ok = true;\n                format = "hsv";\n            }\n            else if (color.hasOwnProperty("h") && color.hasOwnProperty("s") && color.hasOwnProperty("l")) {\n                color.s = convertToPercentage(color.s);\n                color.l = convertToPercentage(color.l);\n                rgb = hslToRgb(color.h, color.s, color.l);\n                ok = true;\n                format = "hsl";\n            }\n\n            if (color.hasOwnProperty("a")) {\n                a = color.a;\n            }\n        }\n\n        a = boundAlpha(a);\n\n        return {\n            ok: ok,\n            format: color.format || format,\n            r: mathMin(255, mathMax(rgb.r, 0)),\n            g: mathMin(255, mathMax(rgb.g, 0)),\n            b: mathMin(255, mathMax(rgb.b, 0)),\n            a: a\n        };\n    }\n\n\n    // Conversion Functions\n    // --------------------\n\n    // `rgbToHsl`, `rgbToHsv`, `hslToRgb`, `hsvToRgb` modified from:\n    // <http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript>\n\n    // `rgbToRgb`\n    // Handle bounds / percentage checking to conform to CSS color spec\n    // <http://www.w3.org/TR/css3-color/>\n    // *Assumes:* r, g, b in [0, 255] or [0, 1]\n    // *Returns:* { r, g, b } in [0, 255]\n    function rgbToRgb(r, g, b){\n        return {\n            r: bound01(r, 255) * 255,\n            g: bound01(g, 255) * 255,\n            b: bound01(b, 255) * 255\n        };\n    }\n\n    // `rgbToHsl`\n    // Converts an RGB color value to HSL.\n    // *Assumes:* r, g, and b are contained in [0, 255] or [0, 1]\n    // *Returns:* { h, s, l } in [0,1]\n    function rgbToHsl(r, g, b) {\n\n        r = bound01(r, 255);\n        g = bound01(g, 255);\n        b = bound01(b, 255);\n\n        var max = mathMax(r, g, b), min = mathMin(r, g, b);\n        var h, s, l = (max + min) / 2;\n\n        if(max == min) {\n            h = s = 0; // achromatic\n        }\n        else {\n            var d = max - min;\n            s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n            switch(max) {\n                case r: h = (g - b) / d + (g < b ? 6 : 0); break;\n                case g: h = (b - r) / d + 2; break;\n                case b: h = (r - g) / d + 4; break;\n            }\n\n            h /= 6;\n        }\n\n        return { h: h, s: s, l: l };\n    }\n\n    // `hslToRgb`\n    // Converts an HSL color value to RGB.\n    // *Assumes:* h is contained in [0, 1] or [0, 360] and s and l are contained [0, 1] or [0, 100]\n    // *Returns:* { r, g, b } in the set [0, 255]\n    function hslToRgb(h, s, l) {\n        var r, g, b;\n\n        h = bound01(h, 360);\n        s = bound01(s, 100);\n        l = bound01(l, 100);\n\n        function hue2rgb(p, q, t) {\n            if(t < 0) t += 1;\n            if(t > 1) t -= 1;\n            if(t < 1/6) return p + (q - p) * 6 * t;\n            if(t < 1/2) return q;\n            if(t < 2/3) return p + (q - p) * (2/3 - t) * 6;\n            return p;\n        }\n\n        if(s === 0) {\n            r = g = b = l; // achromatic\n        }\n        else {\n            var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n            var p = 2 * l - q;\n            r = hue2rgb(p, q, h + 1/3);\n            g = hue2rgb(p, q, h);\n            b = hue2rgb(p, q, h - 1/3);\n        }\n\n        return { r: r * 255, g: g * 255, b: b * 255 };\n    }\n\n    // `rgbToHsv`\n    // Converts an RGB color value to HSV\n    // *Assumes:* r, g, and b are contained in the set [0, 255] or [0, 1]\n    // *Returns:* { h, s, v } in [0,1]\n    function rgbToHsv(r, g, b) {\n\n        r = bound01(r, 255);\n        g = bound01(g, 255);\n        b = bound01(b, 255);\n\n        var max = mathMax(r, g, b), min = mathMin(r, g, b);\n        var h, s, v = max;\n\n        var d = max - min;\n        s = max === 0 ? 0 : d / max;\n\n        if(max == min) {\n            h = 0; // achromatic\n        }\n        else {\n            switch(max) {\n                case r: h = (g - b) / d + (g < b ? 6 : 0); break;\n                case g: h = (b - r) / d + 2; break;\n                case b: h = (r - g) / d + 4; break;\n            }\n            h /= 6;\n        }\n        return { h: h, s: s, v: v };\n    }\n\n    // `hsvToRgb`\n    // Converts an HSV color value to RGB.\n    // *Assumes:* h is contained in [0, 1] or [0, 360] and s and v are contained in [0, 1] or [0, 100]\n    // *Returns:* { r, g, b } in the set [0, 255]\n     function hsvToRgb(h, s, v) {\n\n        h = bound01(h, 360) * 6;\n        s = bound01(s, 100);\n        v = bound01(v, 100);\n\n        var i = math.floor(h),\n            f = h - i,\n            p = v * (1 - s),\n            q = v * (1 - f * s),\n            t = v * (1 - (1 - f) * s),\n            mod = i % 6,\n            r = [v, q, p, p, t, v][mod],\n            g = [t, v, v, q, p, p][mod],\n            b = [p, p, t, v, v, q][mod];\n\n        return { r: r * 255, g: g * 255, b: b * 255 };\n    }\n\n    // `rgbToHex`\n    // Converts an RGB color to hex\n    // Assumes r, g, and b are contained in the set [0, 255]\n    // Returns a 3 or 6 character hex\n    function rgbToHex(r, g, b, allow3Char) {\n\n        var hex = [\n            pad2(mathRound(r).toString(16)),\n            pad2(mathRound(g).toString(16)),\n            pad2(mathRound(b).toString(16))\n        ];\n\n        // Return a 3 character hex if possible\n        if (allow3Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1)) {\n            return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0);\n        }\n\n        return hex.join("");\n    }\n        // `rgbaToHex`\n        // Converts an RGBA color plus alpha transparency to hex\n        // Assumes r, g, b and a are contained in the set [0, 255]\n        // Returns an 8 character hex\n        function rgbaToHex(r, g, b, a) {\n\n            var hex = [\n                pad2(convertDecimalToHex(a)),\n                pad2(mathRound(r).toString(16)),\n                pad2(mathRound(g).toString(16)),\n                pad2(mathRound(b).toString(16))\n            ];\n\n            return hex.join("");\n        }\n\n    // `equals`\n    // Can be called with any tinycolor input\n    tinycolor.equals = function (color1, color2) {\n        if (!color1 || !color2) { return false; }\n        return tinycolor(color1).toRgbString() == tinycolor(color2).toRgbString();\n    };\n    tinycolor.random = function() {\n        return tinycolor.fromRatio({\n            r: mathRandom(),\n            g: mathRandom(),\n            b: mathRandom()\n        });\n    };\n\n\n    // Modification Functions\n    // ----------------------\n    // Thanks to less.js for some of the basics here\n    // <https://github.com/cloudhead/less.js/blob/master/lib/less/functions.js>\n\n    function desaturate(color, amount) {\n        amount = (amount === 0) ? 0 : (amount || 10);\n        var hsl = tinycolor(color).toHsl();\n        hsl.s -= amount / 100;\n        hsl.s = clamp01(hsl.s);\n        return tinycolor(hsl);\n    }\n\n    function saturate(color, amount) {\n        amount = (amount === 0) ? 0 : (amount || 10);\n        var hsl = tinycolor(color).toHsl();\n        hsl.s += amount / 100;\n        hsl.s = clamp01(hsl.s);\n        return tinycolor(hsl);\n    }\n\n    function greyscale(color) {\n        return tinycolor(color).desaturate(100);\n    }\n\n    function lighten (color, amount) {\n        amount = (amount === 0) ? 0 : (amount || 10);\n        var hsl = tinycolor(color).toHsl();\n        hsl.l += amount / 100;\n        hsl.l = clamp01(hsl.l);\n        return tinycolor(hsl);\n    }\n\n    function brighten(color, amount) {\n        amount = (amount === 0) ? 0 : (amount || 10);\n        var rgb = tinycolor(color).toRgb();\n        rgb.r = mathMax(0, mathMin(255, rgb.r - mathRound(255 * - (amount / 100))));\n        rgb.g = mathMax(0, mathMin(255, rgb.g - mathRound(255 * - (amount / 100))));\n        rgb.b = mathMax(0, mathMin(255, rgb.b - mathRound(255 * - (amount / 100))));\n        return tinycolor(rgb);\n    }\n\n    function darken (color, amount) {\n        amount = (amount === 0) ? 0 : (amount || 10);\n        var hsl = tinycolor(color).toHsl();\n        hsl.l -= amount / 100;\n        hsl.l = clamp01(hsl.l);\n        return tinycolor(hsl);\n    }\n\n    // Spin takes a positive or negative amount within [-360, 360] indicating the change of hue.\n    // Values outside of this range will be wrapped into this range.\n    function spin(color, amount) {\n        var hsl = tinycolor(color).toHsl();\n        var hue = (mathRound(hsl.h) + amount) % 360;\n        hsl.h = hue < 0 ? 360 + hue : hue;\n        return tinycolor(hsl);\n    }\n\n    // Combination Functions\n    // ---------------------\n    // Thanks to jQuery xColor for some of the ideas behind these\n    // <https://github.com/infusion/jQuery-xcolor/blob/master/jquery.xcolor.js>\n\n    function complement(color) {\n        var hsl = tinycolor(color).toHsl();\n        hsl.h = (hsl.h + 180) % 360;\n        return tinycolor(hsl);\n    }\n\n    function triad(color) {\n        var hsl = tinycolor(color).toHsl();\n        var h = hsl.h;\n        return [\n            tinycolor(color),\n            tinycolor({ h: (h + 120) % 360, s: hsl.s, l: hsl.l }),\n            tinycolor({ h: (h + 240) % 360, s: hsl.s, l: hsl.l })\n        ];\n    }\n\n    function tetrad(color) {\n        var hsl = tinycolor(color).toHsl();\n        var h = hsl.h;\n        return [\n            tinycolor(color),\n            tinycolor({ h: (h + 90) % 360, s: hsl.s, l: hsl.l }),\n            tinycolor({ h: (h + 180) % 360, s: hsl.s, l: hsl.l }),\n            tinycolor({ h: (h + 270) % 360, s: hsl.s, l: hsl.l })\n        ];\n    }\n\n    function splitcomplement(color) {\n        var hsl = tinycolor(color).toHsl();\n        var h = hsl.h;\n        return [\n            tinycolor(color),\n            tinycolor({ h: (h + 72) % 360, s: hsl.s, l: hsl.l}),\n            tinycolor({ h: (h + 216) % 360, s: hsl.s, l: hsl.l})\n        ];\n    }\n\n    function analogous(color, results, slices) {\n        results = results || 6;\n        slices = slices || 30;\n\n        var hsl = tinycolor(color).toHsl();\n        var part = 360 / slices;\n        var ret = [tinycolor(color)];\n\n        for (hsl.h = ((hsl.h - (part * results >> 1)) + 720) % 360; --results; ) {\n            hsl.h = (hsl.h + part) % 360;\n            ret.push(tinycolor(hsl));\n        }\n        return ret;\n    }\n\n    function monochromatic(color, results) {\n        results = results || 6;\n        var hsv = tinycolor(color).toHsv();\n        var h = hsv.h, s = hsv.s, v = hsv.v;\n        var ret = [];\n        var modification = 1 / results;\n\n        while (results--) {\n            ret.push(tinycolor({ h: h, s: s, v: v}));\n            v = (v + modification) % 1;\n        }\n\n        return ret;\n    }\n\n    // Utility Functions\n    // ---------------------\n\n    tinycolor.mix = function(color1, color2, amount) {\n        amount = (amount === 0) ? 0 : (amount || 50);\n\n        var rgb1 = tinycolor(color1).toRgb();\n        var rgb2 = tinycolor(color2).toRgb();\n\n        var p = amount / 100;\n        var w = p * 2 - 1;\n        var a = rgb2.a - rgb1.a;\n\n        var w1;\n\n        if (w * a == -1) {\n            w1 = w;\n        } else {\n            w1 = (w + a) / (1 + w * a);\n        }\n\n        w1 = (w1 + 1) / 2;\n\n        var w2 = 1 - w1;\n\n        var rgba = {\n            r: rgb2.r * w1 + rgb1.r * w2,\n            g: rgb2.g * w1 + rgb1.g * w2,\n            b: rgb2.b * w1 + rgb1.b * w2,\n            a: rgb2.a * p  + rgb1.a * (1 - p)\n        };\n\n        return tinycolor(rgba);\n    };\n\n\n    // Readability Functions\n    // ---------------------\n    // <http://www.w3.org/TR/AERT#color-contrast>\n\n    // `readability`\n    // Analyze the 2 colors and returns an object with the following properties:\n    //    `brightness`: difference in brightness between the two colors\n    //    `color`: difference in color/hue between the two colors\n    tinycolor.readability = function(color1, color2) {\n        var c1 = tinycolor(color1);\n        var c2 = tinycolor(color2);\n        var rgb1 = c1.toRgb();\n        var rgb2 = c2.toRgb();\n        var brightnessA = c1.getBrightness();\n        var brightnessB = c2.getBrightness();\n        var colorDiff = (\n            Math.max(rgb1.r, rgb2.r) - Math.min(rgb1.r, rgb2.r) +\n            Math.max(rgb1.g, rgb2.g) - Math.min(rgb1.g, rgb2.g) +\n            Math.max(rgb1.b, rgb2.b) - Math.min(rgb1.b, rgb2.b)\n        );\n\n        return {\n            brightness: Math.abs(brightnessA - brightnessB),\n            color: colorDiff\n        };\n    };\n\n    // `readable`\n    // http://www.w3.org/TR/AERT#color-contrast\n    // Ensure that foreground and background color combinations provide sufficient contrast.\n    // *Example*\n    //    tinycolor.isReadable("#000", "#111") => false\n    tinycolor.isReadable = function(color1, color2) {\n        var readability = tinycolor.readability(color1, color2);\n        return readability.brightness > 125 && readability.color > 500;\n    };\n\n    // `mostReadable`\n    // Given a base color and a list of possible foreground or background\n    // colors for that base, returns the most readable color.\n    // *Example*\n    //    tinycolor.mostReadable("#123", ["#fff", "#000"]) => "#000"\n    tinycolor.mostReadable = function(baseColor, colorList) {\n        var bestColor = null;\n        var bestScore = 0;\n        var bestIsReadable = false;\n        for (var i=0; i < colorList.length; i++) {\n\n            // We normalize both around the "acceptable" breaking point,\n            // but rank brightness constrast higher than hue.\n\n            var readability = tinycolor.readability(baseColor, colorList[i]);\n            var readable = readability.brightness > 125 && readability.color > 500;\n            var score = 3 * (readability.brightness / 125) + (readability.color / 500);\n\n            if ((readable && ! bestIsReadable) ||\n                (readable && bestIsReadable && score > bestScore) ||\n                ((! readable) && (! bestIsReadable) && score > bestScore)) {\n                bestIsReadable = readable;\n                bestScore = score;\n                bestColor = tinycolor(colorList[i]);\n            }\n        }\n        return bestColor;\n    };\n\n\n    // Big List of Colors\n    // ------------------\n    // <http://www.w3.org/TR/css3-color/#svg-color>\n    var names = tinycolor.names = {\n        aliceblue: "f0f8ff",\n        antiquewhite: "faebd7",\n        aqua: "0ff",\n        aquamarine: "7fffd4",\n        azure: "f0ffff",\n        beige: "f5f5dc",\n        bisque: "ffe4c4",\n        black: "000",\n        blanchedalmond: "ffebcd",\n        blue: "00f",\n        blueviolet: "8a2be2",\n        brown: "a52a2a",\n        burlywood: "deb887",\n        burntsienna: "ea7e5d",\n        cadetblue: "5f9ea0",\n        chartreuse: "7fff00",\n        chocolate: "d2691e",\n        coral: "ff7f50",\n        cornflowerblue: "6495ed",\n        cornsilk: "fff8dc",\n        crimson: "dc143c",\n        cyan: "0ff",\n        darkblue: "00008b",\n        darkcyan: "008b8b",\n        darkgoldenrod: "b8860b",\n        darkgray: "a9a9a9",\n        darkgreen: "006400",\n        darkgrey: "a9a9a9",\n        darkkhaki: "bdb76b",\n        darkmagenta: "8b008b",\n        darkolivegreen: "556b2f",\n        darkorange: "ff8c00",\n        darkorchid: "9932cc",\n        darkred: "8b0000",\n        darksalmon: "e9967a",\n        darkseagreen: "8fbc8f",\n        darkslateblue: "483d8b",\n        darkslategray: "2f4f4f",\n        darkslategrey: "2f4f4f",\n        darkturquoise: "00ced1",\n        darkviolet: "9400d3",\n        deeppink: "ff1493",\n        deepskyblue: "00bfff",\n        dimgray: "696969",\n        dimgrey: "696969",\n        dodgerblue: "1e90ff",\n        firebrick: "b22222",\n        floralwhite: "fffaf0",\n        forestgreen: "228b22",\n        fuchsia: "f0f",\n        gainsboro: "dcdcdc",\n        ghostwhite: "f8f8ff",\n        gold: "ffd700",\n        goldenrod: "daa520",\n        gray: "808080",\n        green: "008000",\n        greenyellow: "adff2f",\n        grey: "808080",\n        honeydew: "f0fff0",\n        hotpink: "ff69b4",\n        indianred: "cd5c5c",\n        indigo: "4b0082",\n        ivory: "fffff0",\n        khaki: "f0e68c",\n        lavender: "e6e6fa",\n        lavenderblush: "fff0f5",\n        lawngreen: "7cfc00",\n        lemonchiffon: "fffacd",\n        lightblue: "add8e6",\n        lightcoral: "f08080",\n        lightcyan: "e0ffff",\n        lightgoldenrodyellow: "fafad2",\n        lightgray: "d3d3d3",\n        lightgreen: "90ee90",\n        lightgrey: "d3d3d3",\n        lightpink: "ffb6c1",\n        lightsalmon: "ffa07a",\n        lightseagreen: "20b2aa",\n        lightskyblue: "87cefa",\n        lightslategray: "789",\n        lightslategrey: "789",\n        lightsteelblue: "b0c4de",\n        lightyellow: "ffffe0",\n        lime: "0f0",\n        limegreen: "32cd32",\n        linen: "faf0e6",\n        magenta: "f0f",\n        maroon: "800000",\n        mediumaquamarine: "66cdaa",\n        mediumblue: "0000cd",\n        mediumorchid: "ba55d3",\n        mediumpurple: "9370db",\n        mediumseagreen: "3cb371",\n        mediumslateblue: "7b68ee",\n        mediumspringgreen: "00fa9a",\n        mediumturquoise: "48d1cc",\n        mediumvioletred: "c71585",\n        midnightblue: "191970",\n        mintcream: "f5fffa",\n        mistyrose: "ffe4e1",\n        moccasin: "ffe4b5",\n        navajowhite: "ffdead",\n        navy: "000080",\n        oldlace: "fdf5e6",\n        olive: "808000",\n        olivedrab: "6b8e23",\n        orange: "ffa500",\n        orangered: "ff4500",\n        orchid: "da70d6",\n        palegoldenrod: "eee8aa",\n        palegreen: "98fb98",\n        paleturquoise: "afeeee",\n        palevioletred: "db7093",\n        papayawhip: "ffefd5",\n        peachpuff: "ffdab9",\n        peru: "cd853f",\n        pink: "ffc0cb",\n        plum: "dda0dd",\n        powderblue: "b0e0e6",\n        purple: "800080",\n        rebeccapurple: "663399",\n        red: "f00",\n        rosybrown: "bc8f8f",\n        royalblue: "4169e1",\n        saddlebrown: "8b4513",\n        salmon: "fa8072",\n        sandybrown: "f4a460",\n        seagreen: "2e8b57",\n        seashell: "fff5ee",\n        sienna: "a0522d",\n        silver: "c0c0c0",\n        skyblue: "87ceeb",\n        slateblue: "6a5acd",\n        slategray: "708090",\n        slategrey: "708090",\n        snow: "fffafa",\n        springgreen: "00ff7f",\n        steelblue: "4682b4",\n        tan: "d2b48c",\n        teal: "008080",\n        thistle: "d8bfd8",\n        tomato: "ff6347",\n        turquoise: "40e0d0",\n        violet: "ee82ee",\n        wheat: "f5deb3",\n        white: "fff",\n        whitesmoke: "f5f5f5",\n        yellow: "ff0",\n        yellowgreen: "9acd32"\n    };\n\n    // Make it easy to access colors via `hexNames[hex]`\n    var hexNames = tinycolor.hexNames = flip(names);\n\n\n    // Utilities\n    // ---------\n\n    // `{ \'name1\': \'val1\' }` becomes `{ \'val1\': \'name1\' }`\n    function flip(o) {\n        var flipped = { };\n        for (var i in o) {\n            if (o.hasOwnProperty(i)) {\n                flipped[o[i]] = i;\n            }\n        }\n        return flipped;\n    }\n\n    // Return a valid alpha value [0,1] with all invalid values being set to 1\n    function boundAlpha(a) {\n        a = parseFloat(a);\n\n        if (isNaN(a) || a < 0 || a > 1) {\n            a = 1;\n        }\n\n        return a;\n    }\n\n    // Take input from [0, n] and return it as [0, 1]\n    function bound01(n, max) {\n        if (isOnePointZero(n)) { n = "100%"; }\n\n        var processPercent = isPercentage(n);\n        n = mathMin(max, mathMax(0, parseFloat(n)));\n\n        // Automatically convert percentage into number\n        if (processPercent) {\n            n = parseInt(n * max, 10) / 100;\n        }\n\n        // Handle floating point rounding errors\n        if ((math.abs(n - max) < 0.000001)) {\n            return 1;\n        }\n\n        // Convert into [0, 1] range if it isn\'t already\n        return (n % max) / parseFloat(max);\n    }\n\n    // Force a number between 0 and 1\n    function clamp01(val) {\n        return mathMin(1, mathMax(0, val));\n    }\n\n    // Parse a base-16 hex value into a base-10 integer\n    function parseIntFromHex(val) {\n        return parseInt(val, 16);\n    }\n\n    // Need to handle 1.0 as 100%, since once it is a number, there is no difference between it and 1\n    // <http://stackoverflow.com/questions/7422072/javascript-how-to-detect-number-as-a-decimal-including-1-0>\n    function isOnePointZero(n) {\n        return typeof n == "string" && n.indexOf(\'.\') != -1 && parseFloat(n) === 1;\n    }\n\n    // Check to see if string passed in is a percentage\n    function isPercentage(n) {\n        return typeof n === "string" && n.indexOf(\'%\') != -1;\n    }\n\n    // Force a hex value to have 2 characters\n    function pad2(c) {\n        return c.length == 1 ? \'0\' + c : \'\' + c;\n    }\n\n    // Replace a decimal with it\'s percentage value\n    function convertToPercentage(n) {\n        if (n <= 1) {\n            n = (n * 100) + "%";\n        }\n\n        return n;\n    }\n\n    // Converts a decimal to a hex value\n    function convertDecimalToHex(d) {\n        return Math.round(parseFloat(d) * 255).toString(16);\n    }\n    // Converts a hex value to a decimal\n    function convertHexToDecimal(h) {\n        return (parseIntFromHex(h) / 255);\n    }\n\n    var matchers = (function() {\n\n        // <http://www.w3.org/TR/css3-values/#integers>\n        var CSS_INTEGER = "[-\\\\+]?\\\\d+%?";\n\n        // <http://www.w3.org/TR/css3-values/#number-value>\n        var CSS_NUMBER = "[-\\\\+]?\\\\d*\\\\.\\\\d+%?";\n\n        // Allow positive/negative integer/number.  Don\'t capture the either/or, just the entire outcome.\n        var CSS_UNIT = "(?:" + CSS_NUMBER + ")|(?:" + CSS_INTEGER + ")";\n\n        // Actual matching.\n        // Parentheses and commas are optional, but not required.\n        // Whitespace can take the place of commas or opening paren\n        var PERMISSIVE_MATCH3 = "[\\\\s|\\\\(]+(" + CSS_UNIT + ")[,|\\\\s]+(" + CSS_UNIT + ")[,|\\\\s]+(" + CSS_UNIT + ")\\\\s*\\\\)?";\n        var PERMISSIVE_MATCH4 = "[\\\\s|\\\\(]+(" + CSS_UNIT + ")[,|\\\\s]+(" + CSS_UNIT + ")[,|\\\\s]+(" + CSS_UNIT + ")[,|\\\\s]+(" + CSS_UNIT + ")\\\\s*\\\\)?";\n\n        return {\n            rgb: new RegExp("rgb" + PERMISSIVE_MATCH3),\n            rgba: new RegExp("rgba" + PERMISSIVE_MATCH4),\n            hsl: new RegExp("hsl" + PERMISSIVE_MATCH3),\n            hsla: new RegExp("hsla" + PERMISSIVE_MATCH4),\n            hsv: new RegExp("hsv" + PERMISSIVE_MATCH3),\n            hsva: new RegExp("hsva" + PERMISSIVE_MATCH4),\n            hex3: /^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\n            hex6: /^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,\n            hex8: /^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/\n        };\n    })();\n\n    // `stringInputToObject`\n    // Permissive string parsing.  Take in a number of formats, and output an object\n    // based on detected format.  Returns `{ r, g, b }` or `{ h, s, l }` or `{ h, s, v}`\n    function stringInputToObject(color) {\n\n        color = color.replace(trimLeft,\'\').replace(trimRight, \'\').toLowerCase();\n        var named = false;\n        if (names[color]) {\n            color = names[color];\n            named = true;\n        }\n        else if (color == \'transparent\') {\n            return { r: 0, g: 0, b: 0, a: 0, format: "name" };\n        }\n\n        // Try to match string input using regular expressions.\n        // Keep most of the number bounding out of this function - don\'t worry about [0,1] or [0,100] or [0,360]\n        // Just return an object and let the conversion functions handle that.\n        // This way the result will be the same whether the tinycolor is initialized with string or object.\n        var match;\n        if ((match = matchers.rgb.exec(color))) {\n            return { r: match[1], g: match[2], b: match[3] };\n        }\n        if ((match = matchers.rgba.exec(color))) {\n            return { r: match[1], g: match[2], b: match[3], a: match[4] };\n        }\n        if ((match = matchers.hsl.exec(color))) {\n            return { h: match[1], s: match[2], l: match[3] };\n        }\n        if ((match = matchers.hsla.exec(color))) {\n            return { h: match[1], s: match[2], l: match[3], a: match[4] };\n        }\n        if ((match = matchers.hsv.exec(color))) {\n            return { h: match[1], s: match[2], v: match[3] };\n        }\n        if ((match = matchers.hsva.exec(color))) {\n            return { h: match[1], s: match[2], v: match[3], a: match[4] };\n        }\n        if ((match = matchers.hex8.exec(color))) {\n            return {\n                a: convertHexToDecimal(match[1]),\n                r: parseIntFromHex(match[2]),\n                g: parseIntFromHex(match[3]),\n                b: parseIntFromHex(match[4]),\n                format: named ? "name" : "hex8"\n            };\n        }\n        if ((match = matchers.hex6.exec(color))) {\n            return {\n                r: parseIntFromHex(match[1]),\n                g: parseIntFromHex(match[2]),\n                b: parseIntFromHex(match[3]),\n                format: named ? "name" : "hex"\n            };\n        }\n        if ((match = matchers.hex3.exec(color))) {\n            return {\n                r: parseIntFromHex(match[1] + \'\' + match[1]),\n                g: parseIntFromHex(match[2] + \'\' + match[2]),\n                b: parseIntFromHex(match[3] + \'\' + match[3]),\n                format: named ? "name" : "hex"\n            };\n        }\n\n        return false;\n    }\n\n    window.tinycolor = tinycolor;\n    })();\n\n    $(function () {\n        if ($.fn.spectrum.load) {\n            $.fn.spectrum.processNativeColorInputs();\n        }\n    });\n\n});\n'},17723:(t,e,i)=>{"use strict";i.d(e,{o:()=>n});const r=()=>{},n=new Proxy({},{get:(t,e)=>r})},18100:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(8402),exports)},18146:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PatternNeverExact=exports.PatternStringExact=exports.PatternNumberExact=exports.PatternBooleanExact=exports.PatternNever=exports.PatternString=exports.PatternNumber=exports.PatternBoolean=void 0,exports.PatternBoolean="(true|false)",exports.PatternNumber="(0|[1-9][0-9]*)",exports.PatternString="(.*)",exports.PatternNever="(?!.*)",exports.PatternBooleanExact=`^${exports.PatternBoolean}$`,exports.PatternNumberExact=`^${exports.PatternNumber}$`,exports.PatternStringExact=`^${exports.PatternString}$`,exports.PatternNeverExact=`^${exports.PatternNever}$`},18274:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Intersect=function(t,e){if(0===t.length)return(0,r.Never)(e);if(1===t.length)return(0,i.CreateType)(t[0],e);if(t.some((t=>(0,s.IsTransform)(t))))throw new Error("Cannot intersect transform types");return(0,n.IntersectCreate)(t,e)};const i=e(30768),r=e(72492),n=e(3807),s=e(51049)},19263:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Decode=function(...t){const[e,s,o]=3===t.length?[t[0],t[1],t[2]]:[t[0],[],t[1]];if(!(0,r.Check)(e,s,o))throw new i.TransformDecodeCheckError(e,o,(0,n.Errors)(e,s,o).First());return(0,i.HasTransform)(e,s)?(0,i.TransformDecode)(e,s,o):o};const i=e(81069),r=e(97069),n=e(1358)},19898:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AttributeValueParserProcessor=void 0,exports.AttributeValueParserProcessor=class{constructor(t){this.cherryPicks=t}invoke(t,e){t.setAttributes(this.parseAttributes(t.getAttributes(),e)),this.cherryPicks.setAttributes(this.parseAttributes(this.cherryPicks.getAttributes(),e))}parseAttributes(t,e){var i;const r={};for(const[n,s]of Object.entries(t))(Array.isArray(s)&&s.length>0||["number","string","boolean"].includes(typeof s))&&(r[n]=null!==(i=e.parseAttribute(n,s))&&void 0!==i?i:s,r[n]);return r}}},19922:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Clone=function(t){return r(t)};const i=e(72862);function r(t){return i.IsArray(t)?function(t){return t.map((t=>r(t)))}(t):i.IsDate(t)?function(t){return new Date(t.getTime())}(t):i.IsUint8Array(t)?function(t){return new Uint8Array(t)}(t):i.IsRegExp(t)?function(t){return new RegExp(t.source,t.flags)}(t):i.IsObject(t)?function(t){const e={};for(const i of Object.getOwnPropertyNames(t))e[i]=r(t[i]);for(const i of Object.getOwnPropertySymbols(t))e[i]=r(t[i]);return e}(t):t}},20614:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},20909:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Ref=function(t,e){if((0,n.IsString)(t))return(0,i.CreateType)({[r.Kind]:"Ref",$ref:t},e);if((0,n.IsUndefined)(t.$id))throw new Error("Reference target type must specify an $id");return(0,i.CreateType)({[r.Kind]:"Ref",$ref:t.$id},e)};const i=e(30768),r=e(73967),n=e(72862)},21075:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CherryPickHelper=void 0,exports.CherryPickHelper=class{constructor(t,e={}){this.attrComputer=t,this.attributes=e,this.lostAttributes={}}reset(){this.attributes={},this.lostAttributes={}}hasLostAttributeValue(t,e){var i;if(this.hasLostAttribute(t)){if(this.attrComputer.isMultiValue(t)){const r=null!==(i=this.getLostAttribute(t))&&void 0!==i?i:[];return(Array.isArray(e)?e:[e]).some((t=>r.includes(t)))}return this.getLostAttribute(t)!=e}return!1}hasLostAttribute(t){return this.lostAttributes.hasOwnProperty(t)}maybeRegisterALost(t,e){var i;if(this.hasAttribute(t))if(this.attrComputer.isMultiValue(t)){const r=null!==(i=this.getAttribute(t))&&void 0!==i?i:[],n=Array.isArray(e)?e:[e],s=r.filter((t=>!n.includes(t)));if(s.length)return this.lostAttributes[t]=s,!0;delete this.lostAttributes[t]}else{const i=this.getAttribute(t),r=JSON.stringify(i),n=JSON.stringify(e);if(void 0!==i&&r!=n)return this.lostAttributes[t]=i,!0;this.hasLostAttribute(t)&&delete this.lostAttributes[t]}return!1}removeAttribute(t,e){var i;if(this.hasAttribute(t))if(this.attrComputer.isMultiValue(t)){const r=null!==(i=this.getAttribute(t))&&void 0!==i?i:[];this.attributes[t]=r.filter((t=>t!=e))}else delete this.attributes[t]}hasAttribute(t){return this.attributes.hasOwnProperty(t)}setAttributes(t){this.attributes=t}setAttribute(t,e){var i;this.attrComputer.isMultiValue(t)?(this.hasAttribute(t)||(this.attributes[t]=[]),null===(i=this.getAttribute(t))||void 0===i||i.push(e)):this.attributes[t]=e}getAttribute(t){return this.attributes[t]}getLostAttribute(t){return this.lostAttributes[t]}getLostAttributes(){return this.lostAttributes}getAttributes(){return this.attributes}}},21090:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MappedFunctionReturnType=E,exports.Mapped=function(t,e,r){const n=(0,_.IsSchema)(t)?(0,l.IndexPropertyKeys)(t):t,s=E(n,e({[i.Kind]:"MappedKey",keys:n}));return(0,u.Object)(s,r)};const i=e(73967),r=e(940),n=e(71927),s=e(47159),o=e(5358),a=e(62154),l=e(57083),h=e(65495),d=e(55344),c=e(12881),u=e(6905),p=e(27822),g=e(9215),m=e(13204),f=e(62700),v=e(85713),b=e(48607),y=e(87382),_=e(51049);function T(t,e){return t in e?w(t,e[t]):(0,y.MappedResult)(e)}function x(t,e){return e.map((e=>w(t,e)))}function w(t,e){const l={...e};return(0,_.IsOptional)(e)?(0,p.Optional)(w(t,(0,r.Discard)(e,[i.OptionalKind]))):(0,_.IsReadonly)(e)?(0,m.Readonly)(w(t,(0,r.Discard)(e,[i.ReadonlyKind]))):(0,_.IsMappedResult)(e)?T(t,e.properties):(0,_.IsMappedKey)(e)?function(t,e){return T(t,function(t,e){return(0,b.SetIncludes)(e,t)?function(t){return{[t]:(0,c.Literal)(t)}}(t):function(t){const e={};for(const i of t)e[i]=(0,c.Literal)(i);return e}(e)}(t,e))}(t,e.keys):(0,_.IsConstructor)(e)?(0,o.Constructor)(x(t,e.parameters),w(t,e.returns),l):(0,_.IsFunction)(e)?(0,a.Function)(x(t,e.parameters),w(t,e.returns),l):(0,_.IsAsyncIterator)(e)?(0,s.AsyncIterator)(w(t,e.items),l):(0,_.IsIterator)(e)?(0,d.Iterator)(w(t,e.items),l):(0,_.IsIntersect)(e)?(0,h.Intersect)(x(t,e.allOf),l):(0,_.IsUnion)(e)?(0,v.Union)(x(t,e.anyOf),l):(0,_.IsTuple)(e)?(0,f.Tuple)(x(t,e.items??[]),l):(0,_.IsObject)(e)?(0,u.Object)(function(t,e){const i={};for(const r of globalThis.Object.getOwnPropertyNames(e))i[r]=w(t,e[r]);return i}(t,e.properties),l):(0,_.IsArray)(e)?(0,n.Array)(w(t,e.items),l):(0,_.IsPromise)(e)?(0,g.Promise)(w(t,e.item),l):e}function E(t,e){const i={};for(const r of t)i[r]=w(r,e);return i}},21188:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Optional=function(t,e){const a=e??!0;return(0,o.IsMappedResult)(t)?(0,s.OptionalFromMappedResult)(t,a):function(t,e){return!1===e?function(t){return(0,i.CreateType)((0,n.Discard)(t,[r.OptionalKind]))}(t):function(t){return(0,i.CreateType)({...t,[r.OptionalKind]:"Optional"})}(t)}(t,a)};const i=e(30768),r=e(73967),n=e(940),s=e(8131),o=e(51049)},21890:(t,exports)=>{"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConditionOperators=void 0,function(t){t.EQUAL="===",t.NOT_EQUAL="!==",t.LESS_THAN="<",t.GREATER_THAN=">",t.LESS_THAN_OR_EQUAL="<=",t.GREATER_THAN_OR_EQUAL=">=",t.IN="IN",t.NOT_IN="NOT_IN",t.IS_EMPTY="IS_EMPTY",t.IS_NOT_EMPTY="IS_NOT_EMPTY"}(e||(exports.ConditionOperators=e={}))},22467:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ValueHashError=void 0,exports.Hash=function(t){return o=BigInt("14695981039346656037"),g(t),o};const i=e(79968),r=e(87580);class n extends r.TypeBoxError{constructor(t){super("Unable to hash value"),this.value=t}}var s;exports.ValueHashError=n,function(t){t[t.Undefined=0]="Undefined",t[t.Null=1]="Null",t[t.Boolean=2]="Boolean",t[t.Number=3]="Number",t[t.String=4]="String",t[t.Object=5]="Object",t[t.Array=6]="Array",t[t.Date=7]="Date",t[t.Uint8Array=8]="Uint8Array",t[t.Symbol=9]="Symbol",t[t.BigInt=10]="BigInt"}(s||(s={}));let o=BigInt("14695981039346656037");const[a,l]=[BigInt("1099511628211"),BigInt("18446744073709551616")],h=Array.from({length:256}).map(((t,e)=>BigInt(e))),d=new Float64Array(1),c=new DataView(d.buffer),u=new Uint8Array(d.buffer);function*p(t){const e=0===t?1:Math.ceil(Math.floor(Math.log2(t)+1)/8);for(let i=0;i<e;i++)yield t>>8*(e-1-i)&255}function g(t){if((0,i.IsArray)(t))return function(t){m(s.Array);for(const e of t)g(e)}(t);if((0,i.IsBoolean)(t))return function(t){m(s.Boolean),m(t?1:0)}(t);if((0,i.IsBigInt)(t))return function(t){m(s.BigInt),c.setBigInt64(0,t);for(const t of u)m(t)}(t);if((0,i.IsDate)(t))return function(t){m(s.Date),g(t.getTime())}(t);if(!(0,i.IsNull)(t)){if((0,i.IsNumber)(t))return function(t){m(s.Number),c.setFloat64(0,t);for(const t of u)m(t)}(t);if((0,i.IsObject)(t))return function(t){m(s.Object);for(const e of globalThis.Object.getOwnPropertyNames(t).sort())g(e),g(t[e])}(t);if((0,i.IsString)(t))return function(t){m(s.String);for(let e=0;e<t.length;e++)for(const i of p(t.charCodeAt(e)))m(i)}(t);if((0,i.IsSymbol)(t))return function(t){m(s.Symbol),g(t.description)}(t);if((0,i.IsUint8Array)(t))return function(t){m(s.Uint8Array);for(let e=0;e<t.length;e++)m(t[e])}(t);if((0,i.IsUndefined)(t))return m(s.Undefined);throw new n(t)}m(s.Null)}function m(t){o^=h[t],o=o*a%l}},22557:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PickFromMappedResult=function(t,e,s){const o=function(t,e,i){return function(t,e,i){const s={};for(const o of globalThis.Object.getOwnPropertyNames(t))s[o]=(0,r.Pick)(t[o],e,(0,n.Clone)(i));return s}(t.properties,e,i)}(t,e,s);return(0,i.MappedResult)(o)};const i=e(34013),r=e(28222),n=e(19922)},22802:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Object=void 0;const i=e(30768),r=e(73967),n=e(51049);exports.Object=function(t,e){const s=function(t){const e=[];for(let i in t)(0,n.IsOptional)(t[i])||e.push(i);return e}(t),o=s.length>0?{[r.Kind]:"Object",type:"object",properties:t,required:s}:{[r.Kind]:"Object",type:"object",properties:t};return(0,i.CreateType)(o,e)}},23010:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Awaited=function(t,e){return(0,n.CreateType)(a(t),e)};const i=e(65495),r=e(85713),n=e(30768),s=e(51049);function o(t){return t.map((t=>a(t)))}function a(t){return(0,s.IsIntersect)(t)?function(t){return(0,i.Intersect)(o(t))}(t.allOf):(0,s.IsUnion)(t)?function(t){return(0,r.Union)(o(t))}(t.anyOf):(0,s.IsPromise)(t)?function(t){return a(t)}(t.item):t}},23162:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Not=function(t,e){return(0,i.CreateType)({[r.Kind]:"Not",not:t},e)};const i=e(30768),r=e(73967)},23419:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(56145),exports),r(e(87352),exports),r(e(73842),exports)},23714:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(66252),exports)},23930:(t,exports)=>{"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConditionRelations=void 0,function(t){t.AND="AND",t.OR="OR"}(e||(exports.ConditionRelations=e={}))},23963:(t,exports)=>{"use strict";function e(t,e){return t.includes(e)}function i(t,e){return t.filter((t=>e.includes(t)))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.SetIncludes=e,exports.SetIsSubset=function(t,i){return t.every((t=>e(i,t)))},exports.SetDistinct=function(t){return[...new Set(t)]},exports.SetIntersect=i,exports.SetUnion=function(t,e){return[...t,...e]},exports.SetComplement=function(t,e){return t.filter((t=>!e.includes(t)))},exports.SetIntersectMany=function(t){return 1===t.length?t[0]:t.length>1?function(t,e){return t.reduce(((t,e)=>i(t,e)),e)}(t.slice(1),t[0]):[]},exports.SetUnionMany=function(t){const e=[];for(const i of t)e.push(...i);return e}},24570:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Number=function(t){return(0,i.CreateType)({[r.Kind]:"Number",type:"number"},t)};const i=e(30768),r=e(73967)},24855:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CloneRest=function(t){return t.map((t=>r(t)))},exports.CloneType=r;const i=e(19922);function r(t,e){return void 0===e?(0,i.Clone)(t):(0,i.Clone)({...e,...t})}},24906:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(3665),exports)},25730:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},26076:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TypeSystemPolicy=void 0;const i=e(79968);var r;!function(t){function e(e){const r=(0,i.IsObject)(e);return t.AllowArrayObject?r:r&&!(0,i.IsArray)(e)}t.InstanceMode="default",t.ExactOptionalPropertyTypes=!1,t.AllowArrayObject=!1,t.AllowNaN=!1,t.AllowNullVoid=!1,t.IsExactOptionalProperty=function(e,i){return t.ExactOptionalPropertyTypes?i in e:void 0!==e[i]},t.IsObjectLike=e,t.IsRecordLike=function(t){return e(t)&&!(t instanceof Date)&&!(t instanceof Uint8Array)},t.IsNumberLike=function(e){return t.AllowNaN?(0,i.IsNumber)(e):Number.isFinite(e)},t.IsVoidLike=function(e){const r=(0,i.IsUndefined)(e);return t.AllowNullVoid?r||null===e:r}}(r||(exports.TypeSystemPolicy=r={}))},26284:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},26299:(t,e,i)=>{i(94642)(i(17174))},26538:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Undefined=function(t){return(0,i.CreateType)({[r.Kind]:"Undefined",type:"undefined"},t)};const i=e(30768),r=e(73967)},26942:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Record=function(t,e,i={}){return(0,c.IsUnion)(t)?function(t,e,i){return p((0,l.IndexPropertyKeys)((0,s.Union)(t)),e,i)}(t.anyOf,e,i):(0,c.IsTemplateLiteral)(t)?function(t,e,i){return(0,o.IsTemplateLiteralFinite)(t)?p((0,l.IndexPropertyKeys)(t),e,i):u(t.pattern,e,i)}(t,e,i):(0,c.IsLiteral)(t)?function(t,e,i){return p([t.toString()],e,i)}(t.const,e,i):(0,c.IsInteger)(t)||(0,c.IsNumber)(t)?function(t,e,i){return u(a.PatternNumberExact,e,i)}(0,e,i):(0,c.IsRegExp)(t)?function(t,e,i){return u(t.source,e,i)}(t,e,i):(0,c.IsString)(t)?function(t,e,i){return u((0,d.IsUndefined)(t.pattern)?a.PatternStringExact:t.pattern,e,i)}(t,e,i):(0,c.IsAny)(t)?function(t,e,i){return u(a.PatternStringExact,e,i)}(0,e,i):(0,c.IsNever)(t)?function(t,e,i){return u(a.PatternNeverExact,e,i)}(0,e,i):(0,n.Never)(i)};const i=e(30768),r=e(6905),n=e(72492),s=e(85713),o=e(61198),a=e(64873),l=e(57083),h=e(73967),d=e(72862),c=e(51049);function u(t,e,r){return(0,i.CreateType)({[h.Kind]:"Record",type:"object",patternProperties:{[t]:e}},r)}function p(t,e,i){const n={};for(const i of t)n[i]=e;return(0,r.Object)(n,{...i,[h.Hint]:"Record"})}},27006:(t,exports)=>{"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProductAttrFilterMode=void 0,function(t){t.MODE_HIGHEST_SCORE_WINS="highest_score_wins",t.MODE_MERGE_ALL_WINNERS="merge_all_winners"}(e||(exports.ProductAttrFilterMode=e={}))},27025:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OmitFromMappedResult=function(t,e,s){const o=function(t,e,i){return function(t,e,i){const s={};for(const o of globalThis.Object.getOwnPropertyNames(t))s[o]=(0,r.Omit)(t[o],e,(0,n.Clone)(i));return s}(t.properties,e,i)}(t,e,s);return(0,i.MappedResult)(o)};const i=e(34013),r=e(86706),n=e(19922)},27593:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(61417),exports)},27822:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(8131),exports),r(e(21188),exports)},28222:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Pick=function(t,e,r){if((0,c.IsMappedKey)(e))return(0,l.PickFromMappedKey)(t,e,r);if((0,c.IsMappedResult)(t))return(0,h.PickFromMappedResult)(t,e,r);const n=(0,c.IsSchema)(e)?(0,a.IndexPropertyKeys)(e):e;return(0,i.CreateType)({...u(t,n),...r})};const i=e(30768),r=e(76166),n=e(65495),s=e(85713),o=e(6905),a=e(57083),l=e(98493),h=e(22557),d=e(93714),c=e(51049);function u(t,e){return(0,c.IsIntersect)(t)?(0,n.Intersect)(function(t,e){return t.map((t=>u(t,e)))}(t.allOf,e)):(0,c.IsUnion)(t)?(0,s.Union)(function(t,e){return t.map((t=>u(t,e)))}(t.anyOf,e)):(0,c.IsObject)(t)?function(t,e){const i=(0,r.Discard)(t,[d.TransformKind,"$id","required","properties"]),n=function(t,e){const i={};for(const r of e)r in t&&(i[r]=t[r]);return i}(t.properties,e);return(0,o.Object)(n,i)}(t,e):(0,o.Object)({})}},28288:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Function=function(t,e,n){return(0,i.CreateType)({[r.Kind]:"Function",type:"Function",parameters:t,returns:e},n)};const i=e(30768),r=e(73967)},28640:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Void=function(t){return(0,i.CreateType)({[r.Kind]:"Void",type:"void"},t)};const i=e(30768),r=e(73967)},28790:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Tuple=function(t,e){return(0,i.CreateType)(t.length>0?{[r.Kind]:"Tuple",type:"array",items:t,additionalItems:!1,minItems:t.length,maxItems:t.length}:{[r.Kind]:"Tuple",type:"array",minItems:t.length,maxItems:t.length},e)};const i=e(30768),r=e(73967)},29104:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProductWizardContext=void 0;const i=e(3047),r=e(36595),n=e(67387),s=e(30270),o=e(68505);class a extends o.ProductContext{constructor(){super(),this.attributesRequiredByWizard=["size","imperial_units","shape"],this.neverDisable=["quantity"],this.quantityAndPriceOptions=[],this.isBusy=!1,this.sizeHelper=new s.SizeHelper(this.attrComputer,this.productItem);const t=new i.AutoPickAttrProcessor(["laminate"],this.cherryPicks,(t=>!this.canAttrValuesBeDisabled(t)),(t=>this.isAttributeRequired(t)));this.processors.registerProcessor(r.ProductProcessorsEnum.AUTOPICK,t),this.processors.registerProcessor(r.ProductProcessorsEnum.SIZE,new n.SizeProcessor(this.sizeHelper)),this.attrEvaluator.ignoreConstraintsFromTo("feature","laminate"),this.attrEvaluator.ignoreConstraintsFromTo("ink","laminate")}resetQuantity(t){this.quantityAndPriceOptions=t;const e=this.quantityAndPriceOptions.find((t=>0!==t.quantity)),i=e?e.quantity:0;!this.cherryPicks.hasAttribute("quantity")&&i&&this.productItem.setAttribute("quantity",i)}canAttrValuesBeDisabled(t){return this.neverDisable.indexOf(t)<0}isAttributeRequired(t){return this.attrComputer.isRequired(t)||this.attributesRequiredByWizard.indexOf(t)>=0}getAttributeOptions(t,e=!0){const i=this.productItem.getAttribute(t),r=this.attrComputer.getSuggestedValues(t);if(this.attrComputer.isDynamicValue(t)){const e=this.attrComputer.parseAttribute(t,i);null===e||Array.isArray(e)||r.includes(e)||r.push(e)}const n=[...this.canAttrValuesBeDisabled(t)?this.attrComputer.getConstrainedValues(t):[],...e?this.attrComputer.getOutOfStockValues(t):[]],s=this.attrComputer.getIcons(t),o=r.map((e=>{var r;return{value:e,disabled:n.includes(e),icon:null!==(r=s[e.toString()])&&void 0!==r?r:null,selected:Array.isArray(i)?i.includes(e):String(i)===String(e),out_of_stock:this.attrComputer.isOutOfStock(t,e)}}));return this.sortOptions(t,o)}sortOptions(t,e){const i=e.reduce(((e,i)=>(i.disabled?e.low.push(i):this.attrComputer.hasBeenFiltered(t)&&!this.attrComputer.isInFilteredValues(t,i.value)?e.medium.push(i):e.high.push(i),e)),{high:[],medium:[],low:[]});return[...i.high,...i.medium,...i.low]}}exports.ProductWizardContext=a},29944:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(98623),exports)},29988:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(35875),exports),r(e(10034),exports),r(e(87580),exports),r(e(54199),exports),r(e(94099),exports),r(e(64873),exports),r(e(9881),exports),r(e(48607),exports),r(e(73967),exports),r(e(18100),exports),r(e(71927),exports),r(e(47159),exports),r(e(75933),exports),r(e(63317),exports),r(e(99974),exports),r(e(78993),exports),r(e(90897),exports),r(e(5358),exports),r(e(96937),exports),r(e(23714),exports),r(e(74118),exports),r(e(33663),exports),r(e(90079),exports),r(e(35595),exports),r(e(23419),exports),r(e(62154),exports),r(e(57083),exports),r(e(84384),exports),r(e(48652),exports),r(e(65495),exports),r(e(55344),exports),r(e(40633),exports),r(e(39260),exports),r(e(12881),exports),r(e(34013),exports),r(e(72492),exports),r(e(12931),exports),r(e(14479),exports),r(e(3251),exports),r(e(6905),exports),r(e(41735),exports),r(e(27822),exports),r(e(69038),exports),r(e(93479),exports),r(e(61359),exports),r(e(9215),exports),r(e(13204),exports),r(e(97439),exports),r(e(15891),exports),r(e(98146),exports),r(e(14847),exports),r(e(40915),exports),r(e(50919),exports),r(e(29944),exports),r(e(83143),exports),r(e(78653),exports),r(e(82984),exports),r(e(54031),exports),r(e(11231),exports),r(e(48902),exports),r(e(61198),exports),r(e(46054),exports),r(e(62700),exports),r(e(14295),exports),r(e(36210),exports),r(e(85713),exports),r(e(78272),exports),r(e(8852),exports),r(e(65924),exports),r(e(64430),exports)},30270:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SizeHelper=void 0;const i=e(34749),r=e(98255),n=e(50861),s=e(8668);class o{constructor(t,e){this.attrComputer=t,this.productItem=e,this.fixedSize=!1,this.transform=new r.TransformHelper(this),this.deliverySheet=new i.DeliverySheetSizeHelper(e),this.minSize=new s.SizeConverter(e),this.maxSize=new s.SizeConverter(e),this.maxSizeOtherSide=new s.SizeConverter(e)}toString(){return`|${this.width.mm}|${this.height.mm}|${this.minSize.mm}|${this.maxSize.mm}|${this.fixedSize}|${this.isImperialUnits()}|`}evaluate(){this.evaluateMaxSize(),this.evaluateMinSize(),this.evaluateMaxSizeOtherSide(),this.evaluateFixedSize()}getSizeOptions(){return this.attrComputer.getSuggestedValues("size")}canBeProductionLine(t){return!this.attrComputer.isConstrained("production_line",t)}formatDisplayableMeassure(t){return`${t} ${this.meassureDisplayAbbr}`}extractMeassuresFromString(t){var e,i;const[r,n]=(null!==(i=null===(e=t.match(/([\d]{1,3}\.?[\d]{1,3})|([\d]{1,3})/g))||void 0===e?void 0:e.map(Number))&&void 0!==i?i:[]).slice(-2);return{width:r,height:n}}setMeasureAttrLocalized(t,e){return this.setMeasureAttrInMM(t,this.localizedToMM(e))}localizedToMM(t){return this.isImperialUnits()?(0,n.convertInchesToMM)(t):(0,n.convertCMToMM)(t)}setMeasureAttrInMM(t,e){return t=this.sanitizeMeasureAttrName(t),this.maxSize.mm&&e>this.maxSize.mm?e=this.maxSize.mm:this.minSize.mm&&e<this.minSize.mm&&(e=this.minSize.mm),e=(0,n.formatMM)(e),this.productItem.setAttribute(t,e),e}getSizeByMM(t){return new s.SizeConverter(this.productItem,t)}getSizeByAttribute(t){t=this.sanitizeMeasureAttrName(t);const e=Number(this.productItem.getAttribute(t)||"0");return this.getSizeByMM(e)}isImperialUnits(){var t;return"true"===(null===(t=this.productItem.getAttribute("imperial_units"))||void 0===t?void 0:t.toString())}isSizeFixed(){return this.fixedSize}hasMaxSizeOtherSide(){return this.maxSizeOtherSide.mm!=this.maxSize.mm}get sqm(){const t=Number(this.productItem.getAttribute("quantity"));return this.width.mm*this.height.mm*t/1e6}get meassureDisplayAbbr(){return this.isImperialUnits()?'"':"cm"}get width(){return this.getSizeByAttribute("width_mm")}get height(){return this.getSizeByAttribute("height_mm")}evaluateFixedSize(){let t=this.productItem.getAttribute("fixed_size");void 0===t&&(t=this.attrComputer.isInFilteredValues("fixed_size",!0)),this.fixedSize=t}evaluateMaxSize(){var t;let e=this.canBeProductionLine("digital")?o.MAX_SIZE_MM_DIGITAL:o.MAX_SIZE_MM_LASER,i=this.productItem.getAttribute("max_size_mm");if(i||(i=null!==(t=this.attrComputer.getHighestAvailableValue("max_size_mm"))&&void 0!==t?t:void 0),"labels_on_roll"==this.productItem.getProductName()||"gitd_industrial"==this.productItem.getAttribute("material")){const t=this.attrComputer.getFilteredValues("max_size_mm");t.length&&t[0]<o.MAX_SIZE_MM_DIGITAL&&(i=t[0],e=o.MAX_SIZE_MM_DIGITAL)}else this.attrComputer.useFilters||this.canBeProductionLine("digital")||(e=800);this.maxSize.mm=Math.min(Number(i)||1/0,e)}evaluateMinSize(){var t;let e=this.productItem.getAttribute("min_size_mm");e||(e=null!==(t=this.attrComputer.getLowestAvailableValue("min_size_mm"))&&void 0!==t?t:o.MIN_SIZE_MM_DEFAULT),this.minSize.mm=e}evaluateMaxSizeOtherSide(){let t=this.productItem.getAttribute("max_size_other_side_mm");if(!t){const e=this.attrComputer.getFilteredValues("max_size_other_side_mm");e.length?t=e[0]:this.attrComputer.useFilters||this.canBeProductionLine("digital")||(t=o.MAX_SIZE_MM_LASER)}this.maxSize.mm||this.evaluateMaxSize(),this.minSize.mm||this.evaluateMinSize(),!t||t>this.maxSize.mm?t=this.maxSize.mm:t<this.minSize.mm&&(t=this.minSize.mm),this.maxSizeOtherSide.mm=t}sanitizeMeasureAttrName(t){return t.indexOf("_mm")<0&&(t+="_mm"),t}}exports.SizeHelper=o,o.MAX_SIZE_MM_DIGITAL=1200,o.MAX_SIZE_MM_LASER=275,o.MIN_SIZE_MM_DEFAULT=25},30341:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PartialFromMappedResult=function(t,e){const s=function(t,e){return function(t,e){const i={};for(const s of globalThis.Object.getOwnPropertyNames(t))i[s]=(0,r.Partial)(t[s],(0,n.Clone)(e));return i}(t.properties,e)}(t,e);return(0,i.MappedResult)(s)};const i=e(34013),r=e(3110),n=e(19922)},30561:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OmitFromMappedKey=function(t,e,r){const n=function(t,e,i){return function(t,e,i){return e.reduce(((e,r)=>({...e,...s(t,r,i)})),{})}(t,e.keys,i)}(t,e,r);return(0,i.MappedResult)(n)};const i=e(34013),r=e(86706),n=e(19922);function s(t,e,i){return{[e]:(0,r.Omit)(t,[e],(0,n.Clone)(i))}}},30768:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CreateType=function(t,e){const s=void 0!==e?{...e,...t}:t;switch(i.TypeSystemPolicy.InstanceMode){case"freeze":return(0,r.Immutable)(s);case"clone":return(0,n.Clone)(s);default:return s}};const i=e(26076),r=e(694),n=e(19922)},31410:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Array=function(t,e){return(0,i.CreateType)({[r.Kind]:"Array",type:"array",items:t},e)};const i=e(30768),r=e(73967)},32595:(t,exports)=>{"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.PriceProviderType=void 0,function(t){t.STATIC="static",t.DYNAMIC="dynamic"}(e||(exports.PriceProviderType=e={}))},32807:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isEmpty=function(t){return null==t||""===t||Array.isArray(t)&&0===t.length},exports.toArray=function(t){return Array.isArray(t)?t:[t]},exports.unique=function(...t){return[...new Set(t.flat())]}},32834:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Entries=function(){return new Map(e)},exports.Clear=function(){return e.clear()},exports.Delete=function(t){return e.delete(t)},exports.Has=function(t){return e.has(t)},exports.Set=function(t,i){e.set(t,i)},exports.Get=function(t){return e.get(t)};const e=new Map},33663:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(97658),exports)},34013:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(39712),exports),r(e(87382),exports),r(e(21090),exports)},34085:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IndexFromMappedKey=function(t,e,i){const n=function(t,e,i){return function(t,e,i){return e.reduce(((e,r)=>({...e,...s(t,r,i)})),{})}(t,e.keys,i)}(t,e,i);return(0,r.MappedResult)(n)};const i=e(53094),r=e(34013),n=e(19922);function s(t,e,r){return{[e]:(0,i.Index)(t,[e],(0,n.Clone)(r))}}},34749:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DeliverySheetSizeHelper=void 0;class e{constructor(t){this.productItem=t}minimizeWidth(){var t;const e=null!==(t=this.productItem.getAttribute("width_mm"))&&void 0!==t?t:0,i=Math.floor(this.sheetWidth/(this.insidePadding+e+this.insidePadding))*(this.insidePadding+e+this.insidePadding)+2+this.outsidePadding+this.outsidePadding;this.productItem.setAttribute("delivery_sheet_width",i)}minimizeHeight(){var t;const e=null!==(t=this.productItem.getAttribute("height_mm"))&&void 0!==t?t:0,i=Math.floor(this.sheetHeight/(this.insidePadding+e+this.insidePadding))*(this.insidePadding+e+this.insidePadding)+2+this.outsidePadding+this.outsidePadding;this.productItem.setAttribute("delivery_sheet_height",i)}setDefaultValues(){this.productItem.setAttribute("delivery_sheet_width",e.WIDTH_DEFAULT),this.productItem.setAttribute("delivery_sheet_height",e.HEIGHT_DEFAULT),this.productItem.setAttribute("delivery_sheet_inside_padding",e.INSIDE_PADDING_DEFAULT),this.productItem.setAttribute("delivery_sheet_outside_padding",e.OUTSIDE_PADDING_DEFAULT)}get sheetHeight(){return this.toFixedInt(this.productItem.getAttribute("delivery_sheet_height"))}get sheetWidth(){return this.toFixedInt(this.productItem.getAttribute("delivery_sheet_width"))}get insidePadding(){return this.toFixedInt(this.productItem.getAttribute("delivery_sheet_inside_padding"))}get outsidePadding(){return this.toFixedInt(this.productItem.getAttribute("delivery_sheet_outside_padding"))}toFixedInt(t){const e=parseInt(Number(t).toFixed(0));return isNaN(e)?0:e}}exports.DeliverySheetSizeHelper=e,e.WIDTH_DEFAULT=204,e.HEIGHT_DEFAULT=270,e.WIDTH_MINIMUM=25,e.HEIGHT_MINIMUM=25,e.INSIDE_PADDING_DEFAULT=2,e.OUTSIDE_PADDING_DEFAULT=0},34826:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.KeyOfPropertyKeysToRest=h,exports.KeyOf=function(t,e){if((0,l.IsMappedResult)(t))return(0,a.KeyOfFromMappedResult)(t,e);{const r=h((0,s.KeyOfPropertyKeys)(t)),n=(0,o.UnionEvaluated)(r);return(0,i.CreateType)(n,e)}};const i=e(30768),r=e(12881),n=e(3251),s=e(2531),o=e(85713),a=e(39945),l=e(51049);function h(t){return t.map((t=>"[number]"===t?(0,n.Number)():(0,r.Literal)(t)))}},35034:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Uint8Array=function(t){return(0,i.CreateType)({[r.Kind]:"Uint8Array",type:"Uint8Array"},t)};const i=e(30768),r=e(73967)},35222:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Required=function(t,e){return(0,h.IsMappedResult)(t)?(0,l.RequiredFromMappedResult)(t,e):(0,i.CreateType)({...c(t),...e})};const i=e(30768),r=e(65495),n=e(85713),s=e(6905),o=e(73967),a=e(940),l=e(81826),h=e(51049);function d(t){return t.map((t=>c(t)))}function c(t){return(0,h.IsIntersect)(t)?(0,r.Intersect)(d(t.allOf)):(0,h.IsUnion)(t)?(0,n.Union)(d(t.anyOf)):(0,h.IsObject)(t)?function(t){const e=(0,a.Discard)(t,[o.TransformKind,"$id","required","properties"]),i=function(t){const e={};for(const i of globalThis.Object.getOwnPropertyNames(t))e[i]=(0,a.Discard)(t[i],[o.OptionalKind]);return e}(t.properties);return(0,s.Object)(i,e)}(t):(0,s.Object)({})}},35595:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(49507),exports),r(e(75097),exports),r(e(67241),exports),r(e(38551),exports),r(e(12586),exports)},35645:(t,exports)=>{"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.UnitTypeNames=void 0,function(t){t.SquareMeter="square_meter",t.PerPiece="per_piece",t.SquareMeterWithBleed="square_meter_with_bleed"}(e||(exports.UnitTypeNames=e={}))},35772:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},35875:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(24855),exports),r(e(19922),exports)},36083:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(53410),exports),r(e(14186),exports),r(e(56767),exports),r(e(58440),exports),r(e(50508),exports),r(e(72577),exports),r(e(5281),exports),r(e(32595),exports),r(e(44930),exports),r(e(77837),exports),r(e(12866),exports),r(e(3233),exports),r(e(79706),exports),r(e(50247),exports),r(e(83775),exports),r(e(67092),exports),r(e(69864),exports),r(e(85994),exports),r(e(71283),exports),r(e(94225),exports),r(e(84985),exports),r(e(96347),exports),r(e(76967),exports),r(e(80276),exports),r(e(13969),exports),r(e(16816),exports),r(e(21890),exports),r(e(83198),exports),r(e(58906),exports),r(e(15442),exports),r(e(10941),exports),r(e(71948),exports),r(e(76221),exports),r(e(54788),exports),r(e(92590),exports),r(e(26284),exports),r(e(73778),exports),r(e(1039),exports),r(e(43902),exports),r(e(72915),exports),r(e(6493),exports),r(e(14472),exports),r(e(74703),exports),r(e(72823),exports)},36210:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(26538),exports)},36384:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Capitalize=function(t,e={}){return(0,i.Intrinsic)(t,"Capitalize",e)};const i=e(786)},36595:(t,exports)=>{"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProductProcessorsEnum=void 0,function(t){t.ATTR_VALUE_PARSER="attr_value_parser",t.AUTOPICK="autopick",t.SIZE="size",t.DELIVERY_SHEET_SIZES="delivery_sheet_sizes",t.DELIVERY_ROLL="delivery_roll",t.OUT_OF_STOCK="out_of_stock"}(e||(exports.ProductProcessorsEnum=e={}))},37617:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Parse=function(...t){return 3===t.length?h(t[0],t[1],t[2]):h(t[0],[],t[1])};const i=e(81069),r=e(43456),n=e(78349),s=e(3665),o=e(58305),a=e(41120),l=[(t,e,i)=>(0,a.Clone)(i),(t,e,i)=>(0,n.Default)(t,e,i),(t,e,i)=>(0,o.Clean)(t,e,i),(t,e,i)=>(0,s.Convert)(t,e,i),(t,e,i)=>((0,r.Assert)(t,e,i),i),(t,e,r)=>(0,i.HasTransform)(t,e)?(0,i.TransformDecode)(t,e,r):r];function h(t,e,i){return l.reduce(((i,r)=>r(t,e,i)),i)}},38521:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(47735),exports)},38551:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExtendsUndefinedCheck=function t(e){return"Intersect"===e[i.Kind]?function(e){return e.allOf.every((e=>t(e)))}(e):"Union"===e[i.Kind]?function(e){return e.anyOf.some((e=>t(e)))}(e):"Not"===e[i.Kind]?function(e){return!t(e.not)}(e):"Undefined"===e[i.Kind]};const i=e(73967)},38717:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(43456),exports)},39039:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UnionCreate=function(t,e){return(0,i.CreateType)({[r.Kind]:"Union",anyOf:t},e)};const i=e(30768),r=e(73967)},39260:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(39945),exports),r(e(91927),exports),r(e(2531),exports),r(e(34826),exports)},39712:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MappedKey=function(t){return(0,i.CreateType)({[r.Kind]:"MappedKey",keys:t})};const i=e(30768),r=e(73967)},39945:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.KeyOfFromMappedResult=function(t,e){const s=function(t,e){return function(t,e){const i={};for(const s of globalThis.Object.getOwnPropertyNames(t))i[s]=(0,r.KeyOf)(t[s],(0,n.Clone)(e));return i}(t.properties,e)}(t,e);return(0,i.MappedResult)(s)};const i=e(34013),r=e(34826),n=e(19922)},40078:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},40633:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(36384),exports),r(e(64833),exports),r(e(786),exports),r(e(78192),exports),r(e(93700),exports),r(e(77901),exports)},40844:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.String=exports.ReturnType=exports.Rest=exports.Required=exports.RegExp=exports.Ref=exports.Recursive=exports.Record=exports.ReadonlyOptional=exports.Readonly=exports.Promise=exports.Pick=exports.Partial=exports.Parameters=exports.Optional=exports.Omit=exports.Object=exports.Number=exports.Null=exports.Not=exports.Never=exports.Mapped=exports.Literal=exports.KeyOf=exports.Iterator=exports.Uppercase=exports.Lowercase=exports.Uncapitalize=exports.Capitalize=exports.Intersect=exports.Integer=exports.InstanceType=exports.Index=exports.Function=exports.Extract=exports.Extends=exports.Exclude=exports.Enum=exports.Deref=exports.Date=exports.ConstructorParameters=exports.Constructor=exports.Const=exports.Composite=exports.Boolean=exports.BigInt=exports.Awaited=exports.AsyncIterator=exports.Array=exports.Any=void 0,exports.Void=exports.Unsafe=exports.Unknown=exports.Union=exports.Undefined=exports.Uint8Array=exports.Tuple=exports.Transform=exports.TemplateLiteral=exports.Symbol=exports.Strict=void 0;var i=e(18100);Object.defineProperty(exports,"Any",{enumerable:!0,get:function(){return i.Any}});var r=e(71927);Object.defineProperty(exports,"Array",{enumerable:!0,get:function(){return r.Array}});var n=e(47159);Object.defineProperty(exports,"AsyncIterator",{enumerable:!0,get:function(){return n.AsyncIterator}});var s=e(75933);Object.defineProperty(exports,"Awaited",{enumerable:!0,get:function(){return s.Awaited}});var o=e(63317);Object.defineProperty(exports,"BigInt",{enumerable:!0,get:function(){return o.BigInt}});var a=e(99974);Object.defineProperty(exports,"Boolean",{enumerable:!0,get:function(){return a.Boolean}});var l=e(78993);Object.defineProperty(exports,"Composite",{enumerable:!0,get:function(){return l.Composite}});var h=e(90897);Object.defineProperty(exports,"Const",{enumerable:!0,get:function(){return h.Const}});var d=e(5358);Object.defineProperty(exports,"Constructor",{enumerable:!0,get:function(){return d.Constructor}});var c=e(96937);Object.defineProperty(exports,"ConstructorParameters",{enumerable:!0,get:function(){return c.ConstructorParameters}});var u=e(23714);Object.defineProperty(exports,"Date",{enumerable:!0,get:function(){return u.Date}});var p=e(74118);Object.defineProperty(exports,"Deref",{enumerable:!0,get:function(){return p.Deref}});var g=e(33663);Object.defineProperty(exports,"Enum",{enumerable:!0,get:function(){return g.Enum}});var m=e(90079);Object.defineProperty(exports,"Exclude",{enumerable:!0,get:function(){return m.Exclude}});var f=e(35595);Object.defineProperty(exports,"Extends",{enumerable:!0,get:function(){return f.Extends}});var v=e(23419);Object.defineProperty(exports,"Extract",{enumerable:!0,get:function(){return v.Extract}});var b=e(62154);Object.defineProperty(exports,"Function",{enumerable:!0,get:function(){return b.Function}});var y=e(57083);Object.defineProperty(exports,"Index",{enumerable:!0,get:function(){return y.Index}});var _=e(84384);Object.defineProperty(exports,"InstanceType",{enumerable:!0,get:function(){return _.InstanceType}});var T=e(48652);Object.defineProperty(exports,"Integer",{enumerable:!0,get:function(){return T.Integer}});var x=e(65495);Object.defineProperty(exports,"Intersect",{enumerable:!0,get:function(){return x.Intersect}});var w=e(40633);Object.defineProperty(exports,"Capitalize",{enumerable:!0,get:function(){return w.Capitalize}}),Object.defineProperty(exports,"Uncapitalize",{enumerable:!0,get:function(){return w.Uncapitalize}}),Object.defineProperty(exports,"Lowercase",{enumerable:!0,get:function(){return w.Lowercase}}),Object.defineProperty(exports,"Uppercase",{enumerable:!0,get:function(){return w.Uppercase}});var E=e(55344);Object.defineProperty(exports,"Iterator",{enumerable:!0,get:function(){return E.Iterator}});var A=e(39260);Object.defineProperty(exports,"KeyOf",{enumerable:!0,get:function(){return A.KeyOf}});var P=e(12881);Object.defineProperty(exports,"Literal",{enumerable:!0,get:function(){return P.Literal}});var S=e(34013);Object.defineProperty(exports,"Mapped",{enumerable:!0,get:function(){return S.Mapped}});var O=e(72492);Object.defineProperty(exports,"Never",{enumerable:!0,get:function(){return O.Never}});var M=e(12931);Object.defineProperty(exports,"Not",{enumerable:!0,get:function(){return M.Not}});var C=e(14479);Object.defineProperty(exports,"Null",{enumerable:!0,get:function(){return C.Null}});var I=e(3251);Object.defineProperty(exports,"Number",{enumerable:!0,get:function(){return I.Number}});var k=e(6905);Object.defineProperty(exports,"Object",{enumerable:!0,get:function(){return k.Object}});var N=e(41735);Object.defineProperty(exports,"Omit",{enumerable:!0,get:function(){return N.Omit}});var L=e(27822);Object.defineProperty(exports,"Optional",{enumerable:!0,get:function(){return L.Optional}});var D=e(69038);Object.defineProperty(exports,"Parameters",{enumerable:!0,get:function(){return D.Parameters}});var B=e(93479);Object.defineProperty(exports,"Partial",{enumerable:!0,get:function(){return B.Partial}});var R=e(61359);Object.defineProperty(exports,"Pick",{enumerable:!0,get:function(){return R.Pick}});var j=e(9215);Object.defineProperty(exports,"Promise",{enumerable:!0,get:function(){return j.Promise}});var q=e(13204);Object.defineProperty(exports,"Readonly",{enumerable:!0,get:function(){return q.Readonly}});var V=e(97439);Object.defineProperty(exports,"ReadonlyOptional",{enumerable:!0,get:function(){return V.ReadonlyOptional}});var F=e(15891);Object.defineProperty(exports,"Record",{enumerable:!0,get:function(){return F.Record}});var H=e(98146);Object.defineProperty(exports,"Recursive",{enumerable:!0,get:function(){return H.Recursive}});var z=e(14847);Object.defineProperty(exports,"Ref",{enumerable:!0,get:function(){return z.Ref}});var U=e(40915);Object.defineProperty(exports,"RegExp",{enumerable:!0,get:function(){return U.RegExp}});var G=e(50919);Object.defineProperty(exports,"Required",{enumerable:!0,get:function(){return G.Required}});var Z=e(29944);Object.defineProperty(exports,"Rest",{enumerable:!0,get:function(){return Z.Rest}});var W=e(83143);Object.defineProperty(exports,"ReturnType",{enumerable:!0,get:function(){return W.ReturnType}});var K=e(11231);Object.defineProperty(exports,"String",{enumerable:!0,get:function(){return K.String}});var Y=e(54031);Object.defineProperty(exports,"Strict",{enumerable:!0,get:function(){return Y.Strict}});var X=e(48902);Object.defineProperty(exports,"Symbol",{enumerable:!0,get:function(){return X.Symbol}});var Q=e(61198);Object.defineProperty(exports,"TemplateLiteral",{enumerable:!0,get:function(){return Q.TemplateLiteral}});var J=e(46054);Object.defineProperty(exports,"Transform",{enumerable:!0,get:function(){return J.Transform}});var tt=e(62700);Object.defineProperty(exports,"Tuple",{enumerable:!0,get:function(){return tt.Tuple}});var et=e(14295);Object.defineProperty(exports,"Uint8Array",{enumerable:!0,get:function(){return et.Uint8Array}});var it=e(36210);Object.defineProperty(exports,"Undefined",{enumerable:!0,get:function(){return it.Undefined}});var rt=e(85713);Object.defineProperty(exports,"Union",{enumerable:!0,get:function(){return rt.Union}});var nt=e(78272);Object.defineProperty(exports,"Unknown",{enumerable:!0,get:function(){return nt.Unknown}});var st=e(8852);Object.defineProperty(exports,"Unsafe",{enumerable:!0,get:function(){return st.Unsafe}});var ot=e(65924);Object.defineProperty(exports,"Void",{enumerable:!0,get:function(){return ot.Void}})},40915:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(77990),exports)},41120:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(99469),exports)},41372:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Symbol=function(t){return(0,i.CreateType)({[r.Kind]:"Symbol",type:"symbol"},t)};const i=e(30768),r=e(73967)},41735:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(30561),exports),r(e(27025),exports),r(e(86706),exports)},42555:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TypeSystem=exports.TypeSystemDuplicateFormat=exports.TypeSystemDuplicateTypeKind=void 0;const i=e(9881),r=e(8852),n=e(73967),s=e(87580);class o extends s.TypeBoxError{constructor(t){super(`Duplicate type kind '${t}' detected`)}}exports.TypeSystemDuplicateTypeKind=o;class a extends s.TypeBoxError{constructor(t){super(`Duplicate string format '${t}' detected`)}}var l;exports.TypeSystemDuplicateFormat=a,function(t){t.Type=function(t,e){if(i.TypeRegistry.Has(t))throw new o(t);return i.TypeRegistry.Set(t,e),(e={})=>(0,r.Unsafe)({...e,[n.Kind]:t})},t.Format=function(t,e){if(i.FormatRegistry.Has(t))throw new a(t);return i.FormatRegistry.Set(t,e),t}}(l||(exports.TypeSystem=l={}))},43456:function(t,exports,e){"use strict";var i,r,n,s=this&&this.__classPrivateFieldSet||function(t,e,i,r,n){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?n.call(t,i):n?n.value=i:e.set(t,i),i},o=this&&this.__classPrivateFieldGet||function(t,e,i,r){if("a"===i&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?r:"a"===i?r.call(t):r?r.value:e.get(t)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.AssertError=void 0,exports.Assert=function(...t){return 3===t.length?c(t[0],t[1],t[2]):c(t[0],[],t[1])};const a=e(1358),l=e(51014),h=e(43665);class d extends l.TypeBoxError{constructor(t){const e=t.First();super(void 0===e?"Invalid Value":e.message),i.add(this),r.set(this,void 0),s(this,r,t,"f"),this.error=e}Errors(){return new a.ValueErrorIterator(o(this,i,"m",n).call(this))}}function c(t,e,i){if(!(0,h.Check)(t,e,i))throw new d((0,a.Errors)(t,e,i))}exports.AssertError=d,r=new WeakMap,i=new WeakSet,n=function*(){this.error&&(yield this.error),yield*o(this,r,"f")}},43665:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ValueCheckUnknownTypeError=void 0,exports.Check=function(...t){return 3===t.length?f(t[0],t[1],t[2]):f(t[0],[],t[1])};const i=e(90816),r=e(62413),n=e(13863),s=e(73967),o=e(39260),a=e(35595),l=e(9881),h=e(87580),d=e(72492),c=e(79968),u=e(4443);class p extends h.TypeBoxError{constructor(t){super("Unknown type"),this.schema=t}}function g(t){return"Any"===t[s.Kind]||"Unknown"===t[s.Kind]}function m(t){return void 0!==t}function f(t,e,h){const v=m(t.$id)?[...e,t]:e,b=t;switch(b[s.Kind]){case"Any":case"Unknown":return!0;case"Array":return function(t,e,i){if(!(0,c.IsArray)(i))return!1;if(m(t.minItems)&&!(i.length>=t.minItems))return!1;if(m(t.maxItems)&&!(i.length<=t.maxItems))return!1;if(!i.every((i=>f(t.items,e,i))))return!1;if(!0===t.uniqueItems&&!function(){const t=new Set;for(const e of i){const i=(0,n.Hash)(e);if(t.has(i))return!1;t.add(i)}return!0}())return!1;if(!(m(t.contains)||(0,c.IsNumber)(t.minContains)||(0,c.IsNumber)(t.maxContains)))return!0;const r=m(t.contains)?t.contains:(0,d.Never)(),s=i.reduce(((t,i)=>f(r,e,i)?t+1:t),0);return!(0===s||(0,c.IsNumber)(t.minContains)&&s<t.minContains||(0,c.IsNumber)(t.maxContains)&&s>t.maxContains)}(b,v,h);case"AsyncIterator":return function(t,e,i){return(0,c.IsAsyncIterator)(i)}(0,0,h);case"BigInt":return function(t,e,i){return!(!(0,c.IsBigInt)(i)||m(t.exclusiveMaximum)&&!(i<t.exclusiveMaximum)||m(t.exclusiveMinimum)&&!(i>t.exclusiveMinimum)||m(t.maximum)&&!(i<=t.maximum)||m(t.minimum)&&!(i>=t.minimum)||m(t.multipleOf)&&i%t.multipleOf!==BigInt(0))}(b,0,h);case"Boolean":return function(t,e,i){return(0,c.IsBoolean)(i)}(0,0,h);case"Constructor":return function(t,e,i){return f(t.returns,e,i.prototype)}(b,v,h);case"Date":return function(t,e,i){return!(!(0,c.IsDate)(i)||m(t.exclusiveMaximumTimestamp)&&!(i.getTime()<t.exclusiveMaximumTimestamp)||m(t.exclusiveMinimumTimestamp)&&!(i.getTime()>t.exclusiveMinimumTimestamp)||m(t.maximumTimestamp)&&!(i.getTime()<=t.maximumTimestamp)||m(t.minimumTimestamp)&&!(i.getTime()>=t.minimumTimestamp)||m(t.multipleOfTimestamp)&&i.getTime()%t.multipleOfTimestamp!=0)}(b,0,h);case"Function":return function(t,e,i){return(0,c.IsFunction)(i)}(0,0,h);case"Integer":return function(t,e,i){return!(!(0,c.IsInteger)(i)||m(t.exclusiveMaximum)&&!(i<t.exclusiveMaximum)||m(t.exclusiveMinimum)&&!(i>t.exclusiveMinimum)||m(t.maximum)&&!(i<=t.maximum)||m(t.minimum)&&!(i>=t.minimum)||m(t.multipleOf)&&i%t.multipleOf!=0)}(b,0,h);case"Intersect":return function(t,e,i){const r=t.allOf.every((t=>f(t,e,i)));if(!1===t.unevaluatedProperties){const e=new RegExp((0,o.KeyOfPattern)(t)),n=Object.getOwnPropertyNames(i).every((t=>e.test(t)));return r&&n}if((0,u.IsSchema)(t.unevaluatedProperties)){const n=new RegExp((0,o.KeyOfPattern)(t)),s=Object.getOwnPropertyNames(i).every((r=>n.test(r)||f(t.unevaluatedProperties,e,i[r])));return r&&s}return r}(b,v,h);case"Iterator":return function(t,e,i){return(0,c.IsIterator)(i)}(0,0,h);case"Literal":return function(t,e,i){return i===t.const}(b,0,h);case"Never":return!1;case"Not":return function(t,e,i){return!f(t.not,e,i)}(b,v,h);case"Null":return function(t,e,i){return(0,c.IsNull)(i)}(0,0,h);case"Number":return function(t,e,r){return!(!i.TypeSystemPolicy.IsNumberLike(r)||m(t.exclusiveMaximum)&&!(r<t.exclusiveMaximum)||m(t.exclusiveMinimum)&&!(r>t.exclusiveMinimum)||m(t.minimum)&&!(r>=t.minimum)||m(t.maximum)&&!(r<=t.maximum)||m(t.multipleOf)&&r%t.multipleOf!=0)}(b,0,h);case"Object":return function(t,e,r){if(!i.TypeSystemPolicy.IsObjectLike(r))return!1;if(m(t.minProperties)&&!(Object.getOwnPropertyNames(r).length>=t.minProperties))return!1;if(m(t.maxProperties)&&!(Object.getOwnPropertyNames(r).length<=t.maxProperties))return!1;const n=Object.getOwnPropertyNames(t.properties);for(const s of n){const n=t.properties[s];if(t.required&&t.required.includes(s)){if(!f(n,e,r[s]))return!1;if(((0,a.ExtendsUndefinedCheck)(n)||g(n))&&!(s in r))return!1}else if(i.TypeSystemPolicy.IsExactOptionalProperty(r,s)&&!f(n,e,r[s]))return!1}if(!1===t.additionalProperties){const e=Object.getOwnPropertyNames(r);return!(!t.required||t.required.length!==n.length||e.length!==n.length)||e.every((t=>n.includes(t)))}return"object"!=typeof t.additionalProperties||Object.getOwnPropertyNames(r).every((i=>n.includes(i)||f(t.additionalProperties,e,r[i])))}(b,v,h);case"Promise":return function(t,e,i){return(0,c.IsPromise)(i)}(0,0,h);case"Record":return function(t,e,r){if(!i.TypeSystemPolicy.IsRecordLike(r))return!1;if(m(t.minProperties)&&!(Object.getOwnPropertyNames(r).length>=t.minProperties))return!1;if(m(t.maxProperties)&&!(Object.getOwnPropertyNames(r).length<=t.maxProperties))return!1;const[n,s]=Object.entries(t.patternProperties)[0],o=new RegExp(n),a=Object.entries(r).every((([t,i])=>!o.test(t)||f(s,e,i))),l="object"!=typeof t.additionalProperties||Object.entries(r).every((([i,r])=>!!o.test(i)||f(t.additionalProperties,e,r))),h=!1!==t.additionalProperties||Object.getOwnPropertyNames(r).every((t=>o.test(t)));return a&&l&&h}(b,v,h);case"Ref":case"This":return function(t,e,i){return f((0,r.Deref)(t,e),e,i)}(b,v,h);case"RegExp":return function(t,e,i){const r=new RegExp(t.source,t.flags);return(!m(t.minLength)||i.length>=t.minLength)&&(!m(t.maxLength)||i.length<=t.maxLength)&&r.test(i)}(b,0,h);case"String":return function(t,e,i){return!!(0,c.IsString)(i)&&((!m(t.minLength)||i.length>=t.minLength)&&((!m(t.maxLength)||i.length<=t.maxLength)&&(!(m(t.pattern)&&!new RegExp(t.pattern).test(i))&&(!m(t.format)||!!l.FormatRegistry.Has(t.format)&&l.FormatRegistry.Get(t.format)(i)))))}(b,0,h);case"Symbol":return function(t,e,i){return(0,c.IsSymbol)(i)}(0,0,h);case"TemplateLiteral":return function(t,e,i){return(0,c.IsString)(i)&&new RegExp(t.pattern).test(i)}(b,0,h);case"Tuple":return function(t,e,i){if(!(0,c.IsArray)(i))return!1;if(void 0===t.items&&0!==i.length)return!1;if(i.length!==t.maxItems)return!1;if(!t.items)return!0;for(let r=0;r<t.items.length;r++)if(!f(t.items[r],e,i[r]))return!1;return!0}(b,v,h);case"Undefined":return function(t,e,i){return(0,c.IsUndefined)(i)}(0,0,h);case"Union":return function(t,e,i){return t.anyOf.some((t=>f(t,e,i)))}(b,v,h);case"Uint8Array":return function(t,e,i){return!!(0,c.IsUint8Array)(i)&&(!m(t.maxByteLength)||i.length<=t.maxByteLength)&&(!m(t.minByteLength)||i.length>=t.minByteLength)}(b,0,h);case"Void":return function(t,e,r){return i.TypeSystemPolicy.IsVoidLike(r)}(0,0,h);default:if(!l.TypeRegistry.Has(b[s.Kind]))throw new p(b);return function(t,e,i){return!!l.TypeRegistry.Has(t[s.Kind])&&l.TypeRegistry.Get(t[s.Kind])(t,i)}(b,0,h)}}exports.ValueCheckUnknownTypeError=p},43902:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AttributeValueParserProcessor=void 0,exports.AttributeValueParserProcessor=class{constructor(t){this.cherryPicks=t}invoke(t,e){t.setAttributes(this.parseAttributes(t.getAttributes(),e)),this.cherryPicks.setAttributes(this.parseAttributes(this.cherryPicks.getAttributes(),e))}parseAttributes(t,e){var i;const r={};for(const[n,s]of Object.entries(t))(Array.isArray(s)&&s.length>0||["number","string","boolean"].includes(typeof s))&&(r[n]=null!==(i=e.parseAttribute(n,s))&&void 0!==i?i:s,r[n]);return r}}},44802:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Const=function(t,e){return(0,m.CreateType)(b(t,!0),e)};const i=e(18100),r=e(63317),n=e(23714),s=e(62154),o=e(12881),a=e(14479),l=e(6905),h=e(48902),d=e(62700),c=e(13204),u=e(36210),p=e(14295),g=e(78272),m=e(10034),f=e(72862);function v(t,e){return!0===e?t:(0,c.Readonly)(t)}function b(t,e){return(0,f.IsAsyncIterator)(t)||(0,f.IsIterator)(t)?v((0,i.Any)(),e):(0,f.IsArray)(t)?(0,c.Readonly)((0,d.Tuple)(t.map((t=>b(t,!1))))):(0,f.IsUint8Array)(t)?(0,p.Uint8Array)():(0,f.IsDate)(t)?(0,n.Date)():(0,f.IsObject)(t)?v((0,l.Object)(function(t){const e={};for(const i of globalThis.Object.getOwnPropertyNames(t))e[i]=(0,c.Readonly)(b(t[i],!1));return e}(t)),e):(0,f.IsFunction)(t)?v((0,s.Function)([],(0,g.Unknown)()),e):(0,f.IsUndefined)(t)?(0,u.Undefined)():(0,f.IsNull)(t)?(0,a.Null)():(0,f.IsSymbol)(t)?(0,h.Symbol)():(0,f.IsBigInt)(t)?(0,r.BigInt)():(0,f.IsNumber)(t)||(0,f.IsBoolean)(t)||(0,f.IsString)(t)?(0,o.Literal)(t):(0,l.Object)({})}},44930:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProductAttrComputer=void 0;const i=e(79706),r=e(77837);exports.ProductAttrComputer=class{constructor(t=new r.ProductAttrConditionEvaluator){this.attrEvaluator=t,this.attributes={},this.attributesFiltersMatched={},this.attributesPreferred={},this.attributesOutOfStock={},this.attributesConstrained={},this.attributesSuggested={},this.attributesFiltered={},this.useFilters=!0}reset(t){this.attributes=t}getAttributes(){return this.attributes}evaluate(t,e,i){void 0!==i&&(this.useFilters=i),e&&(this.reset(e),this.attrEvaluator.reset(e)),this.evaluateFilteredValues(t),this.evaluateConstrainedValues(t),this.evaluateSuggestedValues(),this.evaluateOutOfStockValues()}evaluateFilteredValues(t){this.attributesFiltered={},this.attributesFiltersMatched={};for(const e in this.attributes){const[i,r]=this.attrEvaluator.filter(t.toTestableOneDimensionalArray(),e);this.attributesFiltered[e]=i,this.attributesFiltersMatched[e]=r.length}}evaluateConstrainedValues(t){this.attrEvaluator.clearDebug(),this.attributesConstrained={};for(const e in this.attributes){this.attributesConstrained[e]=[];for(const i of this.getAllValues(e))this.attrEvaluator.canIChangeAttribute(t.toTestableOneDimensionalArray(),e,String(i))||this.attributesConstrained[e].push(i)}}evaluateSuggestedValues(){this.attributesSuggested={};for(const t in this.attributes){let e=this.getFilteredValues(t);this.useFilters&&e.length||(e=this.getAllValues(t));let i=this.getPreferredValue(t);null!==i&&(Array.isArray(i)||(i=[i]),i=i.filter((i=>!this.isConstrained(t,i)&&this.canValueBe(t,i)&&e.indexOf(i)<0)),e=e.concat(i)),this.attributesSuggested[t]=e}}evaluateOutOfStockValues(){this.attributesOutOfStock={};for(const t in this.attributes){const e=this.attributes[t].outOfStockValues;e.length&&(this.attributesOutOfStock[t]=e)}}isAvailable(t,e){return!this.isConstrained(t,e)&&(this.isInSuggestedValues(t,e)||this.isDynamicValue(t))}getDefaultValue(t){if(this.isMultiValue(t))return[];const e=this.getFilteredValues(t).filter((e=>!this.isConstrained(t,e)));if(e.length)return e[0];const i=this.getSuggestedValues(t).filter((e=>!this.isConstrained(t,e)));return i.length?i[0]:null}getAllValues(t){return this.isSupported(t)?Object.keys(this.attributes[t].valuesAndConstraints).map((e=>{var i;return null!==(i=this.parseAttribute(t,e))&&void 0!==i?i:e})):[]}getHighestAvailableValue(t){const e=this.getSuggestedValues(t).filter((e=>!this.isConstrained(t,e))),i=Math.max(...e.map((t=>parseFloat(String(t)))));return isNaN(i)?null:i}getLowestAvailableValue(t){const e=this.getSuggestedValues(t).filter((e=>!this.isConstrained(t,e))),i=Math.min(...e.map((t=>parseFloat(String(t)))));return isNaN(i)?null:i}getSuggestedValues(t){return this.attributesSuggested.hasOwnProperty(t)?this.attributesSuggested[t]:[]}getFilteredValues(t){return this.attributesFiltered.hasOwnProperty(t)?this.attributesFiltered[t]:[]}hasBeenFiltered(t){return!!this.attributesFiltersMatched.hasOwnProperty(t)&&this.attributesFiltersMatched[t]>0}hasPreferredValue(t){return this.attributesPreferred.hasOwnProperty(t)}removePreferredValue(t,e){const i=this.getPreferredValue(t);this.isMultiValue(t)&&Array.isArray(i)?this.setPreferredValue(t,i.filter((t=>t!=e))):delete this.attributesPreferred[t]}getPreferredValue(t){return this.hasPreferredValue(t)?this.attributesPreferred[t]:null}setPreferredValue(t,e){this.attributesPreferred[t]=e}setPreferredValues(t){this.attributesPreferred=t}getConstrainedValues(t){return this.attributesConstrained.hasOwnProperty(t)?this.attributesConstrained[t]:[]}getOutOfStockValues(t){return this.attributesOutOfStock.hasOwnProperty(t)?this.attributesOutOfStock[t]:[]}getIcons(t){var e,i;return null!==(i=null===(e=this.attributes[t])||void 0===e?void 0:e.icons)&&void 0!==i?i:{}}isSupported(t){return this.attributes.hasOwnProperty(t)}isRequired(t){var e;return this.isSupported(t)&&(null===(e=this.attributes[t])||void 0===e?void 0:e.isRequired)}isMultiValue(t){var e;return this.isSupported(t)&&(null===(e=this.attributes[t])||void 0===e?void 0:e.isMultiValue)}isDynamicValue(t){var e;return this.isSupported(t)&&(null===(e=this.attributes[t])||void 0===e?void 0:e.isDynamicValue)}getValueType(t){var e,i;return null!==(i=null===(e=this.attributes[t])||void 0===e?void 0:e.valueType)&&void 0!==i?i:null}isBooleanType(t){return this.getValueType(t)===i.ProductAttrValueType.BOOL}isIntType(t){return this.getValueType(t)===i.ProductAttrValueType.INT}isFloatType(t){return this.getValueType(t)===i.ProductAttrValueType.FLOAT}isStringType(t){return this.getValueType(t)===i.ProductAttrValueType.STRING}isNumberType(t){return this.isIntType(t)||this.isFloatType(t)}isInFilteredValues(t,e){return this.getFilteredValues(t).includes(e)}isInSuggestedValues(t,e){return this.getSuggestedValues(t).includes(e)}isConstrained(t,e){return this.getConstrainedValues(t).includes(e)}isOutOfStock(t,e){return this.getOutOfStockValues(t).includes(e)}isRecommended(t,e){return!this.isConstrained(t,e)&&!this.isOutOfStock(t,e)&&this.hasBeenFiltered(t)&&this.isInFilteredValues(t,e)}canValueBe(t,e){var i;return!!this.isDynamicValue(t)||(null===(i=this.attributes[t])||void 0===i?void 0:i.valuesAndConstraints.hasOwnProperty(e.toString()))}parseAttribute(t,e){if(Array.isArray(e)){const i=[];for(const r of e){const e=this.parseAttribute(t,r);null!==e&&i.push(e)}return i.length>0?i:null}if(!["string","boolean","number"].includes(typeof e))return null;if(this.isStringType(t))return String(e);if(this.isBooleanType(t))try{const t=JSON.parse(e);if("boolean"==typeof t)return t}catch(t){}else{if(this.isIntType(t)){const t=parseInt(e);return isNaN(t)?null:t}if(this.isFloatType(t)){const t=parseFloat(e);return isNaN(t)?null:t}}return null}get debugList(){return this.attrEvaluator.debugList}set debugEnabled(t){this.attrEvaluator.debugEnabled=t}get debugEnabled(){return this.attrEvaluator.debugEnabled}}},45522:t=>{"use strict";var e=Object.defineProperty,i=(t,i,r)=>((t,i,r)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[i]=r)(t,"symbol"!=typeof i?i+"":i,r);const $={a:1,b:0,c:0,d:1,e:0,f:0,m11:1,m12:0,m13:0,m14:0,m21:0,m22:1,m23:0,m24:0,m31:0,m32:0,m33:1,m34:0,m41:0,m42:0,m43:0,m44:1,is2D:!0,isIdentity:!0},r=t=>(t instanceof Float64Array||t instanceof Float32Array||Array.isArray(t)&&t.every((t=>"number"==typeof t)))&&[6,16].some((e=>t.length===e)),n=t=>t instanceof DOMMatrix||t instanceof v||"object"==typeof t&&Object.keys($).every((e=>t&&e in t)),s=t=>{const e=new v,i=Array.from(t);if(!r(i))throw TypeError(`CSSMatrix: "${i.join(",")}" must be an array with 6/16 numbers.`);if(16===i.length){const[t,r,n,s,o,a,l,h,d,c,u,p,g,m,f,v]=i;e.m11=t,e.a=t,e.m21=o,e.c=o,e.m31=d,e.m41=g,e.e=g,e.m12=r,e.b=r,e.m22=a,e.d=a,e.m32=c,e.m42=m,e.f=m,e.m13=n,e.m23=l,e.m33=u,e.m43=f,e.m14=s,e.m24=h,e.m34=p,e.m44=v}else if(6===i.length){const[t,r,n,s,o,a]=i;e.m11=t,e.a=t,e.m12=r,e.b=r,e.m21=n,e.c=n,e.m22=s,e.d=s,e.m41=o,e.e=o,e.m42=a,e.f=a}return e},o=t=>{if(n(t))return s([t.m11,t.m12,t.m13,t.m14,t.m21,t.m22,t.m23,t.m24,t.m31,t.m32,t.m33,t.m34,t.m41,t.m42,t.m43,t.m44]);throw TypeError(`CSSMatrix: "${JSON.stringify(t)}" is not a DOMMatrix / CSSMatrix / JSON compatible object.`)},a=t=>{if("string"!=typeof t)throw TypeError(`CSSMatrix: "${JSON.stringify(t)}" is not a string.`);const e=String(t).replace(/\s/g,"");let i=new v;const r=`CSSMatrix: invalid transform string "${t}"`;return e.split(")").filter((t=>t)).forEach((t=>{const[e,n]=t.split("(");if(!n)throw TypeError(r);const o=n.split(",").map((t=>t.includes("rad")?parseFloat(t)*(180/Math.PI):parseFloat(t))),[a,l,h,d]=o,c=[a,l,h],u=[a,l,h,d];if("perspective"===e&&a&&[l,h].every((t=>void 0===t)))i.m34=-1/a;else if(e.includes("matrix")&&[6,16].includes(o.length)&&o.every((t=>!Number.isNaN(+t)))){const t=o.map((t=>Math.abs(t)<1e-6?0:t));i=i.multiply(s(t))}else if("translate3d"===e&&c.every((t=>!Number.isNaN(+t))))i=i.translate(a,l,h);else if("translate"===e&&a&&void 0===h)i=i.translate(a,l||0,0);else if("rotate3d"===e&&u.every((t=>!Number.isNaN(+t)))&&d)i=i.rotateAxisAngle(a,l,h,d);else if("rotate"===e&&a&&[l,h].every((t=>void 0===t)))i=i.rotate(0,0,a);else if("scale3d"===e&&c.every((t=>!Number.isNaN(+t)))&&c.some((t=>1!==t)))i=i.scale(a,l,h);else if("scale"!==e||Number.isNaN(a)||1===a&&1===l||void 0!==h)if("skew"===e&&(a||!Number.isNaN(a)&&l)&&void 0===h)i=i.skew(a,l||0);else{if(!(["translate","rotate","scale","skew"].some((t=>e.includes(t)))&&/[XYZ]/.test(e)&&a&&[l,h].every((t=>void 0===t))))throw TypeError(r);if("skewX"===e||"skewY"===e)i=i[e](a);else{const t=e.replace(/[XYZ]/,""),r=e.replace(t,""),n=["X","Y","Z"].indexOf(r),s="scale"===t?1:0,o=[0===n?a:s,1===n?a:s,2===n?a:s];i=i[t](...o)}}else{const t=Number.isNaN(+l)?a:l;i=i.scale(a,t,1)}})),i},l=(t,e)=>e?[t.a,t.b,t.c,t.d,t.e,t.f]:[t.m11,t.m12,t.m13,t.m14,t.m21,t.m22,t.m23,t.m24,t.m31,t.m32,t.m33,t.m34,t.m41,t.m42,t.m43,t.m44],h=(t,e,i)=>{const r=new v;return r.m41=t,r.e=t,r.m42=e,r.f=e,r.m43=i,r},d=(t,e,i)=>{const r=new v,n=Math.PI/180,s=t*n,o=e*n,a=i*n,l=Math.cos(s),h=-Math.sin(s),d=Math.cos(o),c=-Math.sin(o),u=Math.cos(a),p=-Math.sin(a),g=d*u,m=-d*p;r.m11=g,r.a=g,r.m12=m,r.b=m,r.m13=c;const f=h*c*u+l*p;r.m21=f,r.c=f;const b=l*u-h*c*p;return r.m22=b,r.d=b,r.m23=-h*d,r.m31=h*p-l*c*u,r.m32=h*u+l*c*p,r.m33=l*d,r},c=(t,e,i,r)=>{const n=new v,s=Math.sqrt(t*t+e*e+i*i);if(0===s)return n;const o=t/s,a=e/s,l=i/s,h=r*(Math.PI/360),d=Math.sin(h),c=Math.cos(h),u=d*d,p=o*o,g=a*a,m=l*l,f=1-2*(g+m)*u;n.m11=f,n.a=f;const b=2*(o*a*u+l*d*c);n.m12=b,n.b=b,n.m13=2*(o*l*u-a*d*c);const y=2*(a*o*u-l*d*c);n.m21=y,n.c=y;const _=1-2*(m+p)*u;return n.m22=_,n.d=_,n.m23=2*(a*l*u+o*d*c),n.m31=2*(l*o*u+a*d*c),n.m32=2*(l*a*u-o*d*c),n.m33=1-2*(p+g)*u,n},u=(t,e,i)=>{const r=new v;return r.m11=t,r.a=t,r.m22=e,r.d=e,r.m33=i,r},p=(t,e)=>{const i=new v;if(t){const e=t*Math.PI/180,r=Math.tan(e);i.m21=r,i.c=r}if(e){const t=e*Math.PI/180,r=Math.tan(t);i.m12=r,i.b=r}return i},g=t=>p(t,0),m=t=>p(0,t),f=(t,e)=>{const i=e.m11*t.m11+e.m12*t.m21+e.m13*t.m31+e.m14*t.m41,r=e.m11*t.m12+e.m12*t.m22+e.m13*t.m32+e.m14*t.m42,n=e.m11*t.m13+e.m12*t.m23+e.m13*t.m33+e.m14*t.m43,o=e.m11*t.m14+e.m12*t.m24+e.m13*t.m34+e.m14*t.m44,a=e.m21*t.m11+e.m22*t.m21+e.m23*t.m31+e.m24*t.m41,l=e.m21*t.m12+e.m22*t.m22+e.m23*t.m32+e.m24*t.m42,h=e.m21*t.m13+e.m22*t.m23+e.m23*t.m33+e.m24*t.m43,d=e.m21*t.m14+e.m22*t.m24+e.m23*t.m34+e.m24*t.m44,c=e.m31*t.m11+e.m32*t.m21+e.m33*t.m31+e.m34*t.m41,u=e.m31*t.m12+e.m32*t.m22+e.m33*t.m32+e.m34*t.m42,p=e.m31*t.m13+e.m32*t.m23+e.m33*t.m33+e.m34*t.m43,g=e.m31*t.m14+e.m32*t.m24+e.m33*t.m34+e.m34*t.m44,m=e.m41*t.m11+e.m42*t.m21+e.m43*t.m31+e.m44*t.m41,f=e.m41*t.m12+e.m42*t.m22+e.m43*t.m32+e.m44*t.m42,v=e.m41*t.m13+e.m42*t.m23+e.m43*t.m33+e.m44*t.m43,b=e.m41*t.m14+e.m42*t.m24+e.m43*t.m34+e.m44*t.m44;return s([i,r,n,o,a,l,h,d,c,u,p,g,m,f,v,b])};class v{constructor(t){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1,t?this.setMatrixValue(t):this}get isIdentity(){return 1===this.m11&&0===this.m12&&0===this.m13&&0===this.m14&&0===this.m21&&1===this.m22&&0===this.m23&&0===this.m24&&0===this.m31&&0===this.m32&&1===this.m33&&0===this.m34&&0===this.m41&&0===this.m42&&0===this.m43&&1===this.m44}get is2D(){return 0===this.m31&&0===this.m32&&1===this.m33&&0===this.m34&&0===this.m43&&1===this.m44}setMatrixValue(t){return"string"==typeof t&&t.length&&"none"!==t?a(t):Array.isArray(t)||t instanceof Float64Array||t instanceof Float32Array?s(t):"object"==typeof t?o(t):this}toFloat32Array(t){return Float32Array.from(l(this,t))}toFloat64Array(t){return Float64Array.from(l(this,t))}toString(){const{is2D:t}=this;return`${t?"matrix":"matrix3d"}(${this.toFloat64Array(t).join(", ")})`}toJSON(){const{is2D:t,isIdentity:e}=this;return{...this,is2D:t,isIdentity:e}}multiply(t){return f(this,t)}translate(t,e,i){let r=e,n=i;return typeof r>"u"&&(r=0),typeof n>"u"&&(n=0),f(this,h(t,r,n))}scale(t,e,i){let r=e,n=i;return typeof r>"u"&&(r=t),typeof n>"u"&&(n=1),f(this,u(t,r,n))}rotate(t,e,i){let r=t,n=e||0,s=i||0;return"number"==typeof t&&typeof e>"u"&&typeof i>"u"&&(s=r,r=0,n=0),f(this,d(r,n,s))}rotateAxisAngle(t,e,i,r){if([t,e,i,r].some((t=>Number.isNaN(+t))))throw new TypeError("CSSMatrix: expecting 4 values");return f(this,c(t,e,i,r))}skewX(t){return f(this,g(t))}skewY(t){return f(this,m(t))}skew(t,e){return f(this,p(t,e))}transformPoint(t){const e=this.m11*t.x+this.m21*t.y+this.m31*t.z+this.m41*t.w,i=this.m12*t.x+this.m22*t.y+this.m32*t.z+this.m42*t.w,r=this.m13*t.x+this.m23*t.y+this.m33*t.z+this.m43*t.w,n=this.m14*t.x+this.m24*t.y+this.m34*t.z+this.m44*t.w;return t instanceof DOMPoint?new DOMPoint(e,i,r,n):{x:e,y:i,z:r,w:n}}}i(v,"Translate",h),i(v,"Rotate",d),i(v,"RotateAxisAngle",c),i(v,"Scale",u),i(v,"SkewX",g),i(v,"SkewY",m),i(v,"Skew",p),i(v,"Multiply",f),i(v,"fromArray",s),i(v,"fromMatrix",o),i(v,"fromString",a),i(v,"toArray",l),i(v,"isCompatibleArray",r),i(v,"isCompatibleObject",n),t.exports=v},46054:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(64586),exports)},46516:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DefaultErrorFunction=n,exports.SetErrorFunction=function(t){s=t},exports.GetErrorFunction=function(){return s};const i=e(73967),r=e(5171);function n(t){switch(t.errorType){case r.ValueErrorType.ArrayContains:return"Expected array to contain at least one matching value";case r.ValueErrorType.ArrayMaxContains:return`Expected array to contain no more than ${t.schema.maxContains} matching values`;case r.ValueErrorType.ArrayMinContains:return`Expected array to contain at least ${t.schema.minContains} matching values`;case r.ValueErrorType.ArrayMaxItems:return`Expected array length to be less or equal to ${t.schema.maxItems}`;case r.ValueErrorType.ArrayMinItems:return`Expected array length to be greater or equal to ${t.schema.minItems}`;case r.ValueErrorType.ArrayUniqueItems:return"Expected array elements to be unique";case r.ValueErrorType.Array:return"Expected array";case r.ValueErrorType.AsyncIterator:return"Expected AsyncIterator";case r.ValueErrorType.BigIntExclusiveMaximum:return`Expected bigint to be less than ${t.schema.exclusiveMaximum}`;case r.ValueErrorType.BigIntExclusiveMinimum:return`Expected bigint to be greater than ${t.schema.exclusiveMinimum}`;case r.ValueErrorType.BigIntMaximum:return`Expected bigint to be less or equal to ${t.schema.maximum}`;case r.ValueErrorType.BigIntMinimum:return`Expected bigint to be greater or equal to ${t.schema.minimum}`;case r.ValueErrorType.BigIntMultipleOf:return`Expected bigint to be a multiple of ${t.schema.multipleOf}`;case r.ValueErrorType.BigInt:return"Expected bigint";case r.ValueErrorType.Boolean:return"Expected boolean";case r.ValueErrorType.DateExclusiveMinimumTimestamp:return`Expected Date timestamp to be greater than ${t.schema.exclusiveMinimumTimestamp}`;case r.ValueErrorType.DateExclusiveMaximumTimestamp:return`Expected Date timestamp to be less than ${t.schema.exclusiveMaximumTimestamp}`;case r.ValueErrorType.DateMinimumTimestamp:return`Expected Date timestamp to be greater or equal to ${t.schema.minimumTimestamp}`;case r.ValueErrorType.DateMaximumTimestamp:return`Expected Date timestamp to be less or equal to ${t.schema.maximumTimestamp}`;case r.ValueErrorType.DateMultipleOfTimestamp:return`Expected Date timestamp to be a multiple of ${t.schema.multipleOfTimestamp}`;case r.ValueErrorType.Date:return"Expected Date";case r.ValueErrorType.Function:return"Expected function";case r.ValueErrorType.IntegerExclusiveMaximum:return`Expected integer to be less than ${t.schema.exclusiveMaximum}`;case r.ValueErrorType.IntegerExclusiveMinimum:return`Expected integer to be greater than ${t.schema.exclusiveMinimum}`;case r.ValueErrorType.IntegerMaximum:return`Expected integer to be less or equal to ${t.schema.maximum}`;case r.ValueErrorType.IntegerMinimum:return`Expected integer to be greater or equal to ${t.schema.minimum}`;case r.ValueErrorType.IntegerMultipleOf:return`Expected integer to be a multiple of ${t.schema.multipleOf}`;case r.ValueErrorType.Integer:return"Expected integer";case r.ValueErrorType.IntersectUnevaluatedProperties:return"Unexpected property";case r.ValueErrorType.Intersect:return"Expected all values to match";case r.ValueErrorType.Iterator:return"Expected Iterator";case r.ValueErrorType.Literal:return`Expected ${"string"==typeof t.schema.const?`'${t.schema.const}'`:t.schema.const}`;case r.ValueErrorType.Never:return"Never";case r.ValueErrorType.Not:return"Value should not match";case r.ValueErrorType.Null:return"Expected null";case r.ValueErrorType.NumberExclusiveMaximum:return`Expected number to be less than ${t.schema.exclusiveMaximum}`;case r.ValueErrorType.NumberExclusiveMinimum:return`Expected number to be greater than ${t.schema.exclusiveMinimum}`;case r.ValueErrorType.NumberMaximum:return`Expected number to be less or equal to ${t.schema.maximum}`;case r.ValueErrorType.NumberMinimum:return`Expected number to be greater or equal to ${t.schema.minimum}`;case r.ValueErrorType.NumberMultipleOf:return`Expected number to be a multiple of ${t.schema.multipleOf}`;case r.ValueErrorType.Number:return"Expected number";case r.ValueErrorType.Object:return"Expected object";case r.ValueErrorType.ObjectAdditionalProperties:return"Unexpected property";case r.ValueErrorType.ObjectMaxProperties:return`Expected object to have no more than ${t.schema.maxProperties} properties`;case r.ValueErrorType.ObjectMinProperties:return`Expected object to have at least ${t.schema.minProperties} properties`;case r.ValueErrorType.ObjectRequiredProperty:return"Expected required property";case r.ValueErrorType.Promise:return"Expected Promise";case r.ValueErrorType.RegExp:return"Expected string to match regular expression";case r.ValueErrorType.StringFormatUnknown:return`Unknown format '${t.schema.format}'`;case r.ValueErrorType.StringFormat:return`Expected string to match '${t.schema.format}' format`;case r.ValueErrorType.StringMaxLength:return`Expected string length less or equal to ${t.schema.maxLength}`;case r.ValueErrorType.StringMinLength:return`Expected string length greater or equal to ${t.schema.minLength}`;case r.ValueErrorType.StringPattern:return`Expected string to match '${t.schema.pattern}'`;case r.ValueErrorType.String:return"Expected string";case r.ValueErrorType.Symbol:return"Expected symbol";case r.ValueErrorType.TupleLength:return`Expected tuple to have ${t.schema.maxItems||0} elements`;case r.ValueErrorType.Tuple:return"Expected tuple";case r.ValueErrorType.Uint8ArrayMaxByteLength:return`Expected byte length less or equal to ${t.schema.maxByteLength}`;case r.ValueErrorType.Uint8ArrayMinByteLength:return`Expected byte length greater or equal to ${t.schema.minByteLength}`;case r.ValueErrorType.Uint8Array:return"Expected Uint8Array";case r.ValueErrorType.Undefined:return"Expected undefined";case r.ValueErrorType.Union:return"Expected union value";case r.ValueErrorType.Void:return"Expected void";case r.ValueErrorType.Kind:return`Expected kind '${t.schema[i.Kind]}'`;default:return"Unknown error type"}}let s=n},46573:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},46878:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Promise=function(t,e){return(0,i.CreateType)({[r.Kind]:"Promise",type:"Promise",item:t},e)};const i=e(30768),r=e(73967)},47035:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),e(73967)},47070:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.String=function(t){return(0,i.CreateType)({[r.Kind]:"String",type:"string"},t)};const i=e(30768),r=e(73967)},47159:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(4830),exports)},47660:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TemplateLiteral=function(t,e){const a=(0,s.IsString)(t)?(0,n.TemplateLiteralPattern)((0,r.TemplateLiteralSyntax)(t)):(0,n.TemplateLiteralPattern)(t);return(0,i.CreateType)({[o.Kind]:"TemplateLiteral",type:"string",pattern:a},e)};const i=e(30768),r=e(4195),n=e(78876),s=e(72862),o=e(73967)},47735:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Encode=function(...t){const[e,s,o]=3===t.length?[t[0],t[1],t[2]]:[t[0],[],t[1]],a=(0,i.HasTransform)(e,s)?(0,i.TransformEncode)(e,s,o):o;if(!(0,r.Check)(e,s,a))throw new i.TransformEncodeCheckError(e,a,(0,n.Errors)(e,s,a).First());return a};const i=e(81069),r=e(97069),n=e(1358)},48109:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ValueDiffError=exports.Edit=exports.Delete=exports.Update=exports.Insert=void 0,exports.Diff=function(t,e){return[...v("",t,e)]},exports.Patch=function(t,e){if(function(t){return t.length>0&&""===t[0].path&&"update"===t[0].type}(e))return(0,n.Clone)(e[0].value);if(function(t){return 0===t.length}(e))return(0,n.Clone)(t);const i=(0,n.Clone)(t);for(const t of e)switch(t.type){case"insert":case"update":r.ValuePointer.Set(i,t.path,t.value);break;case"delete":r.ValuePointer.Delete(i,t.path)}return i};const i=e(79968),r=e(51056),n=e(41120),s=e(61417),o=e(87580),a=e(12881),l=e(6905),h=e(11231),d=e(78272),c=e(85713);exports.Insert=(0,l.Object)({type:(0,a.Literal)("insert"),path:(0,h.String)(),value:(0,d.Unknown)()}),exports.Update=(0,l.Object)({type:(0,a.Literal)("update"),path:(0,h.String)(),value:(0,d.Unknown)()}),exports.Delete=(0,l.Object)({type:(0,a.Literal)("delete"),path:(0,h.String)()}),exports.Edit=(0,c.Union)([exports.Insert,exports.Update,exports.Delete]);class u extends o.TypeBoxError{constructor(t,e){super(e),this.value=t}}function p(t,e){return{type:"update",path:t,value:e}}function g(t,e){return{type:"insert",path:t,value:e}}function m(t){return{type:"delete",path:t}}function f(t){if(globalThis.Object.getOwnPropertySymbols(t).length>0)throw new u(t,"Cannot diff objects with symbols")}function*v(t,e,r){if((0,i.IsStandardObject)(e))return yield*function*(t,e,r){if(f(e),f(r),!(0,i.IsStandardObject)(r))return yield p(t,r);const n=globalThis.Object.getOwnPropertyNames(e),o=globalThis.Object.getOwnPropertyNames(r);for(const n of o)(0,i.HasPropertyKey)(e,n)||(yield g(`${t}/${n}`,r[n]));for(const o of n)(0,i.HasPropertyKey)(r,o)&&((0,s.Equal)(e,r)||(yield*v(`${t}/${o}`,e[o],r[o])));for(const e of n)(0,i.HasPropertyKey)(r,e)||(yield m(`${t}/${e}`))}(t,e,r);if((0,i.IsArray)(e))return yield*function*(t,e,r){if(!(0,i.IsArray)(r))return yield p(t,r);for(let i=0;i<Math.min(e.length,r.length);i++)yield*v(`${t}/${i}`,e[i],r[i]);for(let i=0;i<r.length;i++)i<e.length||(yield g(`${t}/${i}`,r[i]));for(let i=e.length-1;i>=0;i--)i<r.length||(yield m(`${t}/${i}`))}(t,e,r);if((0,i.IsTypedArray)(e))return yield*function*(t,e,r){if(!(0,i.IsTypedArray)(r)||e.length!==r.length||globalThis.Object.getPrototypeOf(e).constructor.name!==globalThis.Object.getPrototypeOf(r).constructor.name)return yield p(t,r);for(let i=0;i<Math.min(e.length,r.length);i++)yield*v(`${t}/${i}`,e[i],r[i])}(t,e,r);if((0,i.IsValueType)(e))return yield*function*(t,e,i){e!==i&&(yield p(t,i))}(t,e,r);throw new u(e,"Unable to diff value")}exports.ValueDiffError=u},48514:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Composite=function(t,e){const r=function(t){const e=[];for(const i of t)e.push(...(0,n.KeyOfPropertyKeys)(i));return(0,o.SetDistinct)(e)}(t),a=function(t,e){const r={};for(const n of e)r[n]=(0,i.IntersectEvaluated)(l(t,n));return r}(t,r);return(0,s.Object)(a,e)};const i=e(65495),r=e(57083),n=e(39260),s=e(6905),o=e(48607),a=e(51049);function l(t,e){const i=[];for(const n of t)i.push(...(0,r.IndexFromPropertyKeys)(n,[e]));return function(t){return t.filter((t=>!(0,a.IsNever)(t)))}(i)}},48607:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(23963),exports)},48652:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(64434),exports)},48772:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DeliverySheetSizeProcessor=void 0;const i=e(34749);exports.DeliverySheetSizeProcessor=class{constructor(t){this.sizeHelper=t}invoke(t){if("sheet"==t.getAttribute("delivery")){if(!t.getAttribute("delivery_sheet_width")&&!t.getAttribute("delivery_sheet_height"))return this.sizeHelper.deliverySheet.setDefaultValues(),"single_on_sheet"==t.getProductName()&&(t.setAttribute("delivery_sheet_height",.6*this.sizeHelper.deliverySheet.sheetHeight),t.setAttribute("delivery_sheet_width",.6*this.sizeHelper.deliverySheet.sheetWidth)),this.sizeHelper.deliverySheet.minimizeHeight(),void this.sizeHelper.deliverySheet.minimizeWidth();t.getAttribute("delivery_sheet_outside_padding")||t.setAttribute("delivery_sheet_outside_padding",String(i.DeliverySheetSizeHelper.OUTSIDE_PADDING_DEFAULT)),this.setDeliverySheetSizes(t)}}setDeliverySheetSizes(t){const e=this.sizeHelper.deliverySheet.insidePadding,r=this.sizeHelper.deliverySheet.outsidePadding,n=Number(t.getAttribute("width_mm")),s=e+Number(t.getAttribute("height_mm"))+e+2+r+r,o=e+n+e+2+r+r;this.sizeHelper.deliverySheet.sheetHeight<i.DeliverySheetSizeHelper.HEIGHT_MINIMUM&&t.setAttribute("delivery_sheet_height",i.DeliverySheetSizeHelper.HEIGHT_MINIMUM),this.sizeHelper.deliverySheet.sheetHeight<s&&t.setAttribute("delivery_sheet_height",s),this.sizeHelper.deliverySheet.sheetWidth<i.DeliverySheetSizeHelper.WIDTH_MINIMUM&&t.setAttribute("delivery_sheet_width",i.DeliverySheetSizeHelper.WIDTH_MINIMUM),this.sizeHelper.deliverySheet.sheetWidth<o&&t.setAttribute("delivery_sheet_width",o)}}},48902:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(41372),exports)},49250:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Deref=l;const i=e(24855),r=e(940),n=e(72862),s=e(51049);function o(t,e){return t.map((t=>l(t,e)))}function a(t,e){return(0,s.IsConstructor)(t)||(0,s.IsFunction)(t)?function(t,e){return t.parameters=o(t.parameters,e),t.returns=l(t.returns,e),t}(t,e):(0,s.IsIntersect)(t)?function(t,e){return t.allOf=o(t.allOf,e),t}(t,e):(0,s.IsUnion)(t)?function(t,e){return t.anyOf=o(t.anyOf,e),t}(t,e):(0,s.IsTuple)(t)?function(t,e){return(0,n.IsUndefined)(t.items)||(t.items=o(t.items,e)),t}(t,e):(0,s.IsArray)(t)?function(t,e){return t.items=l(t.items,e),t}(t,e):(0,s.IsObject)(t)?function(t,e){return t.properties=function(t,e){const i={};for(const r of globalThis.Object.getOwnPropertyNames(t))i[r]=l(t[r],e);return i}(t.properties,e),t}(t,e):(0,s.IsPromise)(t)?function(t,e){return t.item=l(t.item,e),t}(t,e):(0,s.IsAsyncIterator)(t)||(0,s.IsIterator)(t)?function(t,e){return t.items=l(t.items,e),t}(t,e):(0,s.IsRef)(t)?function(t,e){const i=e.find((e=>e.$id===t.$ref));if(void 0===i)throw Error(`Unable to dereference schema with $id ${t.$ref}`);return l((0,r.Discard)(i,["$id"]),e)}(t,e):t}function l(t,e){return a((0,i.CloneType)(t),(0,i.CloneRest)(e))}},49507:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExtendsResult=exports.ExtendsResolverError=void 0,exports.ExtendsCheck=function(t,e){return q(t,e)};const i=e(18100),r=e(62154),n=e(3251),s=e(11231),o=e(78272),a=e(61198),l=e(64873),h=e(73967),d=e(87580),c=e(54199);class u extends d.TypeBoxError{}var p;function g(t){return t===p.False?t:p.True}function m(t){throw new u(t)}function f(t){return c.TypeGuard.IsNever(t)||c.TypeGuard.IsIntersect(t)||c.TypeGuard.IsUnion(t)||c.TypeGuard.IsUnknown(t)||c.TypeGuard.IsAny(t)}function v(t,e){return c.TypeGuard.IsNever(e)?x():c.TypeGuard.IsIntersect(e)?T(t,e):c.TypeGuard.IsUnion(e)?R(t,e):c.TypeGuard.IsUnknown(e)?j():c.TypeGuard.IsAny(e)?b():m("StructuralRight")}function b(t,e){return p.True}function y(t,e){return c.TypeGuard.IsLiteralBoolean(t)||c.TypeGuard.IsBoolean(t)?p.True:p.False}function _(t,e){return c.TypeGuard.IsLiteral(t)&&c.ValueGuard.IsNumber(t.const)||c.TypeGuard.IsNumber(t)||c.TypeGuard.IsInteger(t)?p.True:p.False}function T(t,e){return e.allOf.every((e=>q(t,e)===p.True))?p.True:p.False}function x(t,e){return p.False}function w(t){let[e,i]=[t,0];for(;c.TypeGuard.IsNot(e);)e=e.not,i+=1;return i%2==0?e:(0,o.Unknown)()}function E(t,e){return c.TypeGuard.IsLiteralNumber(t)||c.TypeGuard.IsNumber(t)||c.TypeGuard.IsInteger(t)?p.True:p.False}function A(t,e){return Object.getOwnPropertyNames(t.properties).length===e}function P(t){return C(t)}function S(t){return A(t,0)||A(t,1)&&"description"in t.properties&&c.TypeGuard.IsUnion(t.properties.description)&&2===t.properties.description.anyOf.length&&(c.TypeGuard.IsString(t.properties.description.anyOf[0])&&c.TypeGuard.IsUndefined(t.properties.description.anyOf[1])||c.TypeGuard.IsString(t.properties.description.anyOf[1])&&c.TypeGuard.IsUndefined(t.properties.description.anyOf[0]))}function O(t){return A(t,0)}function M(t){return A(t,0)}function C(t){const e=(0,n.Number)();return A(t,0)||A(t,1)&&"length"in t.properties&&g(q(t.properties.length,e))===p.True}function I(t,e){return q(t,e)===p.False||c.TypeGuard.IsOptional(t)&&!c.TypeGuard.IsOptional(e)?p.False:p.True}function k(t,e){return c.TypeGuard.IsUnknown(t)?p.False:c.TypeGuard.IsAny(t)?p.Union:c.TypeGuard.IsNever(t)||c.TypeGuard.IsLiteralString(t)&&P(e)||c.TypeGuard.IsLiteralNumber(t)&&O(e)||c.TypeGuard.IsLiteralBoolean(t)&&M(e)||c.TypeGuard.IsSymbol(t)&&S(e)||c.TypeGuard.IsBigInt(t)&&A(e,0)||c.TypeGuard.IsString(t)&&P(e)||c.TypeGuard.IsSymbol(t)&&S(e)||c.TypeGuard.IsNumber(t)&&O(e)||c.TypeGuard.IsInteger(t)&&O(e)||c.TypeGuard.IsBoolean(t)&&M(e)||c.TypeGuard.IsUint8Array(t)&&C(e)||c.TypeGuard.IsDate(t)&&function(t){return A(t,0)}(e)||c.TypeGuard.IsConstructor(t)&&function(t){return A(t,0)}(e)||c.TypeGuard.IsFunction(t)&&function(t){const e=(0,n.Number)();return A(t,0)||A(t,1)&&"length"in t.properties&&g(q(t.properties.length,e))===p.True}(e)?p.True:c.TypeGuard.IsRecord(t)&&c.TypeGuard.IsString(N(t))?"Record"===e[h.Hint]?p.True:p.False:c.TypeGuard.IsRecord(t)&&c.TypeGuard.IsNumber(N(t))&&A(e,0)?p.True:p.False}function N(t){return l.PatternNumberExact in t.patternProperties?(0,n.Number)():l.PatternStringExact in t.patternProperties?(0,s.String)():m("Unknown record key pattern")}function L(t){return l.PatternNumberExact in t.patternProperties?t.patternProperties[l.PatternNumberExact]:l.PatternStringExact in t.patternProperties?t.patternProperties[l.PatternStringExact]:m("Unable to get record value schema")}function D(t,e){const[i,r]=[N(e),L(e)];return c.TypeGuard.IsLiteralString(t)&&c.TypeGuard.IsNumber(i)&&g(q(t,r))===p.True?p.True:c.TypeGuard.IsUint8Array(t)&&c.TypeGuard.IsNumber(i)||c.TypeGuard.IsString(t)&&c.TypeGuard.IsNumber(i)||c.TypeGuard.IsArray(t)&&c.TypeGuard.IsNumber(i)?q(t,r):c.TypeGuard.IsObject(t)?(()=>{for(const e of Object.getOwnPropertyNames(t.properties))if(I(r,t.properties[e])===p.False)return p.False;return p.True})():p.False}function B(t,e){return c.TypeGuard.IsLiteral(t)&&c.ValueGuard.IsString(t.const)||c.TypeGuard.IsString(t)?p.True:p.False}function R(t,e){return e.anyOf.some((e=>q(t,e)===p.True))?p.True:p.False}function j(t,e){return p.True}function q(t,e){return c.TypeGuard.IsTemplateLiteral(t)||c.TypeGuard.IsTemplateLiteral(e)?function(t,e){return c.TypeGuard.IsTemplateLiteral(t)?q((0,a.TemplateLiteralToUnion)(t),e):c.TypeGuard.IsTemplateLiteral(e)?q(t,(0,a.TemplateLiteralToUnion)(e)):m("Invalid fallthrough for TemplateLiteral")}(t,e):c.TypeGuard.IsRegExp(t)||c.TypeGuard.IsRegExp(e)?function(t,e){return q(c.TypeGuard.IsRegExp(t)?(0,s.String)():t,c.TypeGuard.IsRegExp(e)?(0,s.String)():e)}(t,e):c.TypeGuard.IsNot(t)||c.TypeGuard.IsNot(e)?function(t,e){return c.TypeGuard.IsNot(t)?q(w(t),e):c.TypeGuard.IsNot(e)?q(t,w(e)):m("Invalid fallthrough for Not")}(t,e):c.TypeGuard.IsAny(t)?function(t,e){return c.TypeGuard.IsIntersect(e)?T(t,e):c.TypeGuard.IsUnion(e)&&e.anyOf.some((t=>c.TypeGuard.IsAny(t)||c.TypeGuard.IsUnknown(t)))?p.True:c.TypeGuard.IsUnion(e)?p.Union:c.TypeGuard.IsUnknown(e)||c.TypeGuard.IsAny(e)?p.True:p.Union}(t,e):c.TypeGuard.IsArray(t)?function(t,e){return c.TypeGuard.IsObject(e)&&C(e)?p.True:f(e)?v(t,e):c.TypeGuard.IsArray(e)?g(q(t.items,e.items)):p.False}(t,e):c.TypeGuard.IsBigInt(t)?function(t,e){return f(e)?v(t,e):c.TypeGuard.IsObject(e)?k(t,e):c.TypeGuard.IsRecord(e)?D(t,e):c.TypeGuard.IsBigInt(e)?p.True:p.False}(t,e):c.TypeGuard.IsBoolean(t)?function(t,e){return f(e)?v(t,e):c.TypeGuard.IsObject(e)?k(t,e):c.TypeGuard.IsRecord(e)?D(t,e):c.TypeGuard.IsBoolean(e)?p.True:p.False}(t,e):c.TypeGuard.IsAsyncIterator(t)?function(t,e){return f(e)?v(t,e):c.TypeGuard.IsAsyncIterator(e)?g(q(t.items,e.items)):p.False}(t,e):c.TypeGuard.IsConstructor(t)?function(t,e){return f(e)?v(t,e):c.TypeGuard.IsObject(e)?k(t,e):c.TypeGuard.IsConstructor(e)?t.parameters.length>e.parameters.length?p.False:t.parameters.every(((t,i)=>g(q(e.parameters[i],t))===p.True))?g(q(t.returns,e.returns)):p.False:p.False}(t,e):c.TypeGuard.IsDate(t)?function(t,e){return f(e)?v(t,e):c.TypeGuard.IsObject(e)?k(t,e):c.TypeGuard.IsRecord(e)?D(t,e):c.TypeGuard.IsDate(e)?p.True:p.False}(t,e):c.TypeGuard.IsFunction(t)?function(t,e){return f(e)?v(t,e):c.TypeGuard.IsObject(e)?k(t,e):c.TypeGuard.IsFunction(e)?t.parameters.length>e.parameters.length?p.False:t.parameters.every(((t,i)=>g(q(e.parameters[i],t))===p.True))?g(q(t.returns,e.returns)):p.False:p.False}(t,e):c.TypeGuard.IsInteger(t)?function(t,e){return c.TypeGuard.IsInteger(e)||c.TypeGuard.IsNumber(e)?p.True:f(e)?v(t,e):c.TypeGuard.IsObject(e)?k(t,e):c.TypeGuard.IsRecord(e)?D(t,e):p.False}(t,e):c.TypeGuard.IsIntersect(t)?function(t,e){return t.allOf.some((t=>q(t,e)===p.True))?p.True:p.False}(t,e):c.TypeGuard.IsIterator(t)?function(t,e){return f(e)?v(t,e):c.TypeGuard.IsIterator(e)?g(q(t.items,e.items)):p.False}(t,e):c.TypeGuard.IsLiteral(t)?function(t,e){return c.TypeGuard.IsLiteral(e)&&e.const===t.const?p.True:f(e)?v(t,e):c.TypeGuard.IsObject(e)?k(t,e):c.TypeGuard.IsRecord(e)?D(t,e):c.TypeGuard.IsString(e)?B(t):c.TypeGuard.IsNumber(e)?E(t):c.TypeGuard.IsInteger(e)?_(t):c.TypeGuard.IsBoolean(e)?y(t):p.False}(t,e):c.TypeGuard.IsNever(t)?p.True:c.TypeGuard.IsNull(t)?function(t,e){return f(e)?v(t,e):c.TypeGuard.IsObject(e)?k(t,e):c.TypeGuard.IsRecord(e)?D(t,e):c.TypeGuard.IsNull(e)?p.True:p.False}(t,e):c.TypeGuard.IsNumber(t)?function(t,e){return f(e)?v(t,e):c.TypeGuard.IsObject(e)?k(t,e):c.TypeGuard.IsRecord(e)?D(t,e):c.TypeGuard.IsInteger(e)||c.TypeGuard.IsNumber(e)?p.True:p.False}(t,e):c.TypeGuard.IsObject(t)?function(t,e){return f(e)?v(t,e):c.TypeGuard.IsRecord(e)?D(t,e):c.TypeGuard.IsObject(e)?(()=>{for(const i of Object.getOwnPropertyNames(e.properties)){if(!(i in t.properties)&&!c.TypeGuard.IsOptional(e.properties[i]))return p.False;if(c.TypeGuard.IsOptional(e.properties[i]))return p.True;if(I(t.properties[i],e.properties[i])===p.False)return p.False}return p.True})():p.False}(t,e):c.TypeGuard.IsRecord(t)?function(t,e){return f(e)?v(t,e):c.TypeGuard.IsObject(e)?k(t,e):c.TypeGuard.IsRecord(e)?q(L(t),L(e)):p.False}(t,e):c.TypeGuard.IsString(t)?function(t,e){return f(e)?v(t,e):c.TypeGuard.IsObject(e)?k(t,e):c.TypeGuard.IsRecord(e)?D(t,e):c.TypeGuard.IsString(e)?p.True:p.False}(t,e):c.TypeGuard.IsSymbol(t)?function(t,e){return f(e)?v(t,e):c.TypeGuard.IsObject(e)?k(t,e):c.TypeGuard.IsRecord(e)?D(t,e):c.TypeGuard.IsSymbol(e)?p.True:p.False}(t,e):c.TypeGuard.IsTuple(t)?function(t,e){return f(e)?v(t,e):c.TypeGuard.IsObject(e)&&C(e)||c.TypeGuard.IsArray(e)&&function(t,e){return c.TypeGuard.IsArray(e)&&void 0!==t.items&&t.items.every((t=>q(t,e.items)===p.True))}(t,e)?p.True:c.TypeGuard.IsTuple(e)?c.ValueGuard.IsUndefined(t.items)&&!c.ValueGuard.IsUndefined(e.items)||!c.ValueGuard.IsUndefined(t.items)&&c.ValueGuard.IsUndefined(e.items)?p.False:c.ValueGuard.IsUndefined(t.items)&&!c.ValueGuard.IsUndefined(e.items)||t.items.every(((t,i)=>q(t,e.items[i])===p.True))?p.True:p.False:p.False}(t,e):c.TypeGuard.IsPromise(t)?function(t,e){return f(e)?v(t,e):c.TypeGuard.IsObject(e)&&function(t){const e=(0,r.Function)([(0,i.Any)()],(0,i.Any)());return A(t,0)||A(t,1)&&"then"in t.properties&&g(q(t.properties.then,e))===p.True}(e)?p.True:c.TypeGuard.IsPromise(e)?g(q(t.item,e.item)):p.False}(t,e):c.TypeGuard.IsUint8Array(t)?function(t,e){return f(e)?v(t,e):c.TypeGuard.IsObject(e)?k(t,e):c.TypeGuard.IsRecord(e)?D(t,e):c.TypeGuard.IsUint8Array(e)?p.True:p.False}(t,e):c.TypeGuard.IsUndefined(t)?function(t,e){return f(e)?v(t,e):c.TypeGuard.IsObject(e)?k(t,e):c.TypeGuard.IsRecord(e)?D(t,e):c.TypeGuard.IsVoid(e)?function(t){return c.TypeGuard.IsUndefined(t)||c.TypeGuard.IsUndefined(t)?p.True:p.False}(t):c.TypeGuard.IsUndefined(e)?p.True:p.False}(t,e):c.TypeGuard.IsUnion(t)?function(t,e){return t.anyOf.every((t=>q(t,e)===p.True))?p.True:p.False}(t,e):c.TypeGuard.IsUnknown(t)?function(t,e){return c.TypeGuard.IsNever(e)?x():c.TypeGuard.IsIntersect(e)?T(t,e):c.TypeGuard.IsUnion(e)?R(t,e):c.TypeGuard.IsAny(e)?b():c.TypeGuard.IsString(e)?B(t):c.TypeGuard.IsNumber(e)?E(t):c.TypeGuard.IsInteger(e)?_(t):c.TypeGuard.IsBoolean(e)?y(t):c.TypeGuard.IsArray(e)?function(t){return c.TypeGuard.IsUnknown(t)?p.False:c.TypeGuard.IsAny(t)?p.Union:c.TypeGuard.IsNever(t)?p.True:p.False}(t):c.TypeGuard.IsTuple(e)?function(t){return c.TypeGuard.IsNever(t)?p.True:c.TypeGuard.IsUnknown(t)?p.False:c.TypeGuard.IsAny(t)?p.Union:p.False}(t):c.TypeGuard.IsObject(e)?k(t,e):c.TypeGuard.IsUnknown(e)?p.True:p.False}(t,e):c.TypeGuard.IsVoid(t)?function(t,e){return c.TypeGuard.IsIntersect(e)?T(t,e):c.TypeGuard.IsUnion(e)?R(t,e):c.TypeGuard.IsUnknown(e)?j():c.TypeGuard.IsAny(e)?b():c.TypeGuard.IsObject(e)?k(t,e):c.TypeGuard.IsVoid(e)?p.True:p.False}(t,e):m(`Unknown left type operand '${t[h.Kind]}'`)}exports.ExtendsResolverError=u,function(t){t[t.Union=0]="Union",t[t.True=1]="True",t[t.False=2]="False"}(p||(exports.ExtendsResult=p={}))},50247:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProductItem=void 0,exports.ProductItem=class{constructor(t,e,i={}){this.attributes={},this.productFamilyName=t,this.productName=e,this.attributes=i}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}removeAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}getAttributes(){return this.attributes}setAttributes(t){this.attributes=t}getProductName(){return this.productName}getProductFamilyName(){return this.productFamilyName}reset(t){return this.productFamilyName=t.productFamilyName,this.productName=t.productName,this.attributes=t.attributes,this}toTestableOneDimensionalArray(){const t={};t["item.productFamilyName"]=this.productFamilyName,t["item.productName"]=this.productName;for(const e in this.attributes)t["item.attributes."+e]=this.attributes[e];return t}}},50508:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DeliveryRollHelper=void 0;class e{constructor(t,e=!1){this.productItem=t,this.calcCols=e}setCalcRols(t){this.calcCols=t}static getProdDirection(t){return{bottom_first:"top_first",top_first:"bottom_first",left_first:"right_first",right_first:"left_first"}[t]||null}static findRollSizeByType(t){const e=Object.entries(this.SIZE_TYPES).find((([e])=>e.toLowerCase()==t.toLowerCase()));return e?e[1]:null}static findRollTypeBySize(t){const e=Object.entries(this.SIZE_TYPES).find((([e,i])=>i==t));return e?e[0]:"custom"}static findSuitableSize(t){var e;return null!==(e=Object.values(this.SIZE_TYPES).sort(((t,e)=>t-e)).find((e=>e>=t)))&&void 0!==e?e:t}static isCustomSize(t){return"custom"===e.findRollTypeBySize(t)}getCalcHeight(){return["top_first","bottom_first"].includes(this.cutDirection)?this.widthMM:this.heightMM}getCalcWidth(){return["top_first","bottom_first"].includes(this.cutDirection)?this.heightMM:this.widthMM}getCols(){return this.calcCols?Math.floor(this.sizeType/(this.getCalcHeight()+2*e.MIN_TOP_MARGIN)):1}getTopMarginMax(){const t=this.sizeType/this.getCols()-this.getCalcHeight()-e.MIN_TOP_MARGIN;return Number(t.toFixed(1))}getTopMarginMid(){const t=(this.sizeType-this.getCols()*this.getCalcHeight())/(2*this.getCols());return Number(t.toFixed(1))}getCalcMinRollWidth(){return this.getCols()*(this.getCalcHeight()+2*e.MIN_TOP_MARGIN)}getSuitableSize(){return e.findSuitableSize(this.getCalcMinRollWidth())}isSizeTypeValid(){return!isNaN(this.sizeType)&&this.sizeType>=this.getCalcMinRollWidth()&&this.sizeType>=e.MIN_ROLL_SIZE&&this.sizeType<=e.MAX_ROLL_SIZE}get topEdgeMargin(){const t=Number(this.productItem.getAttribute("delivery_roll_top_edge_margin"));return Number(t.toFixed(1))}get sizeType(){return Number(this.productItem.getAttribute("delivery_roll_size_type"))}get widthMM(){return Number(this.productItem.getAttribute("width_mm"))}get heightMM(){return Number(this.productItem.getAttribute("height_mm"))}get cutDirection(){var t;return null!==(t=this.productItem.getAttribute("cut_direction"))&&void 0!==t?t:""}}exports.DeliveryRollHelper=e,e.DEFAULT_INNER_ROLL_SIZE=76,e.MAX_ROLL_SIZE=280,e.MIN_ROLL_SIZE=32,e.MIN_ITEM_MARGIN=4,e.MIN_TOP_MARGIN=2,e.SIZE_TYPES={small:35,medium:56,large:70,xlarge:93,xxlarge:140,full_width:280}},50861:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.convertMMToInches=function(t){const r=i(t)/e.inches_to_mm;return Math.round(10*r)/10},exports.convertInchesToMM=function(t){return i(t*e.inches_to_mm)},exports.convertMMToCM=function(t){return r(t/10,1)},exports.convertCMToMM=function(t){return r(10*t,0)},exports.convertMMToPX=function(t){return t*e.mm_to_px},exports.convertPXToMM=function(t){return i(t/e.mm_to_px)},exports.formatMM=i;const e={mm_to_px:2.83465,inches_to_mm:25.4};function i(t){return r(t=Math.round(10*t)/10,0)}function r(t,e){return Number(t.toFixed(e))}},50919:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(81826),exports),r(e(35222),exports)},51014:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TypeBoxError=void 0;class e extends Error{constructor(t){super(t)}}exports.TypeBoxError=e},51049:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IsReadonly=function(t){return i.IsObject(t)&&"Readonly"===t[r.ReadonlyKind]},exports.IsOptional=function(t){return i.IsObject(t)&&"Optional"===t[r.OptionalKind]},exports.IsAny=n,exports.IsArray=s,exports.IsAsyncIterator=o,exports.IsBigInt=a,exports.IsBoolean=l,exports.IsConstructor=h,exports.IsDate=d,exports.IsFunction=c,exports.IsInteger=u,exports.IsProperties=function(t){return i.IsObject(t)},exports.IsIntersect=p,exports.IsIterator=g,exports.IsKindOf=m,exports.IsLiteralString=function(t){return f(t)&&i.IsString(t.const)},exports.IsLiteralNumber=function(t){return f(t)&&i.IsNumber(t.const)},exports.IsLiteralBoolean=function(t){return f(t)&&i.IsBoolean(t.const)},exports.IsLiteral=f,exports.IsMappedKey=v,exports.IsMappedResult=b,exports.IsNever=y,exports.IsNot=_,exports.IsNull=T,exports.IsNumber=x,exports.IsObject=w,exports.IsPromise=E,exports.IsRecord=A,exports.IsRecursive=function(t){return i.IsObject(t)&&r.Hint in t&&"Recursive"===t[r.Hint]},exports.IsRef=P,exports.IsRegExp=S,exports.IsString=O,exports.IsSymbol=M,exports.IsTemplateLiteral=C,exports.IsThis=I,exports.IsTransform=function(t){return i.IsObject(t)&&r.TransformKind in t},exports.IsTuple=k,exports.IsUndefined=N,exports.IsUnion=L,exports.IsUint8Array=D,exports.IsUnknown=B,exports.IsUnsafe=R,exports.IsVoid=j,exports.IsKind=q,exports.IsSchema=function(t){return n(t)||s(t)||l(t)||a(t)||o(t)||h(t)||d(t)||c(t)||u(t)||p(t)||g(t)||f(t)||v(t)||b(t)||y(t)||_(t)||T(t)||x(t)||w(t)||E(t)||A(t)||P(t)||S(t)||O(t)||M(t)||C(t)||I(t)||k(t)||N(t)||L(t)||D(t)||B(t)||R(t)||j(t)||q(t)};const i=e(72862),r=e(73967);function n(t){return m(t,"Any")}function s(t){return m(t,"Array")}function o(t){return m(t,"AsyncIterator")}function a(t){return m(t,"BigInt")}function l(t){return m(t,"Boolean")}function h(t){return m(t,"Constructor")}function d(t){return m(t,"Date")}function c(t){return m(t,"Function")}function u(t){return m(t,"Integer")}function p(t){return m(t,"Intersect")}function g(t){return m(t,"Iterator")}function m(t,e){return i.IsObject(t)&&r.Kind in t&&t[r.Kind]===e}function f(t){return m(t,"Literal")}function v(t){return m(t,"MappedKey")}function b(t){return m(t,"MappedResult")}function y(t){return m(t,"Never")}function _(t){return m(t,"Not")}function T(t){return m(t,"Null")}function x(t){return m(t,"Number")}function w(t){return m(t,"Object")}function E(t){return m(t,"Promise")}function A(t){return m(t,"Record")}function P(t){return m(t,"Ref")}function S(t){return m(t,"RegExp")}function O(t){return m(t,"String")}function M(t){return m(t,"Symbol")}function C(t){return m(t,"TemplateLiteral")}function I(t){return m(t,"This")}function k(t){return m(t,"Tuple")}function N(t){return m(t,"Undefined")}function L(t){return m(t,"Union")}function D(t){return m(t,"Uint8Array")}function B(t){return m(t,"Unknown")}function R(t){return m(t,"Unsafe")}function j(t){return m(t,"Void")}function q(t){return i.IsObject(t)&&r.Kind in t&&i.IsString(t[r.Kind])}},51056:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ValuePointer=void 0,exports.ValuePointer=e(83605)},51346:function(t,e,i){t.exports=function(){var t="1.13.7",e="object"==typeof self&&self.self===self&&self||"object"==typeof i.g&&i.g.global===i.g&&i.g||Function("return this")()||{},r=Array.prototype,n=Object.prototype,s="undefined"!=typeof Symbol?Symbol.prototype:null,o=r.push,a=r.slice,l=n.toString,h=n.hasOwnProperty,d="undefined"!=typeof ArrayBuffer,c="undefined"!=typeof DataView,u=Array.isArray,p=Object.keys,g=Object.create,m=d&&ArrayBuffer.isView,f=isNaN,v=isFinite,b=!{toString:null}.propertyIsEnumerable("toString"),y=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],_=Math.pow(2,53)-1;function T(t,e){return e=null==e?t.length-1:+e,function(){for(var i=Math.max(arguments.length-e,0),r=Array(i),n=0;n<i;n++)r[n]=arguments[n+e];switch(e){case 0:return t.call(this,r);case 1:return t.call(this,arguments[0],r);case 2:return t.call(this,arguments[0],arguments[1],r)}var s=Array(e+1);for(n=0;n<e;n++)s[n]=arguments[n];return s[e]=r,t.apply(this,s)}}function x(t){var e=typeof t;return"function"===e||"object"===e&&!!t}function w(t){return void 0===t}function E(t){return!0===t||!1===t||"[object Boolean]"===l.call(t)}function A(t){var e="[object "+t+"]";return function(t){return l.call(t)===e}}var P=A("String"),S=A("Number"),O=A("Date"),M=A("RegExp"),C=A("Error"),I=A("Symbol"),k=A("ArrayBuffer"),N=A("Function"),L=e.document&&e.document.childNodes;"object"!=typeof Int8Array&&"function"!=typeof L&&(N=function(t){return"function"==typeof t||!1});var D=N,B=A("Object"),R=c&&(!/\[native code\]/.test(String(DataView))||B(new DataView(new ArrayBuffer(8)))),j="undefined"!=typeof Map&&B(new Map),q=A("DataView");var V=R?function(t){return null!=t&&D(t.getInt8)&&k(t.buffer)}:q,F=u||A("Array");function H(t,e){return null!=t&&h.call(t,e)}var z=A("Arguments");!function(){z(arguments)||(z=function(t){return H(t,"callee")})}();var U=z;function G(t){return S(t)&&f(t)}function Z(t){return function(){return t}}function W(t){return function(e){var i=t(e);return"number"==typeof i&&i>=0&&i<=_}}function K(t){return function(e){return null==e?void 0:e[t]}}var Y=K("byteLength"),X=W(Y),Q=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var J=d?function(t){return m?m(t)&&!V(t):X(t)&&Q.test(l.call(t))}:Z(!1),tt=K("length");function et(t,e){e=function(t){for(var e={},i=t.length,r=0;r<i;++r)e[t[r]]=!0;return{contains:function(t){return!0===e[t]},push:function(i){return e[i]=!0,t.push(i)}}}(e);var i=y.length,r=t.constructor,s=D(r)&&r.prototype||n,o="constructor";for(H(t,o)&&!e.contains(o)&&e.push(o);i--;)(o=y[i])in t&&t[o]!==s[o]&&!e.contains(o)&&e.push(o)}function it(t){if(!x(t))return[];if(p)return p(t);var e=[];for(var i in t)H(t,i)&&e.push(i);return b&&et(t,e),e}function rt(t,e){var i=it(e),r=i.length;if(null==t)return!r;for(var n=Object(t),s=0;s<r;s++){var o=i[s];if(e[o]!==n[o]||!(o in n))return!1}return!0}function nt(t){return t instanceof nt?t:this instanceof nt?void(this._wrapped=t):new nt(t)}function st(t){return new Uint8Array(t.buffer||t,t.byteOffset||0,Y(t))}nt.VERSION=t,nt.prototype.value=function(){return this._wrapped},nt.prototype.valueOf=nt.prototype.toJSON=nt.prototype.value,nt.prototype.toString=function(){return String(this._wrapped)};var ot="[object DataView]";function at(t,e,i,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var n=typeof t;return("function"===n||"object"===n||"object"==typeof e)&&lt(t,e,i,r)}function lt(t,e,i,r){t instanceof nt&&(t=t._wrapped),e instanceof nt&&(e=e._wrapped);var n=l.call(t);if(n!==l.call(e))return!1;if(R&&"[object Object]"==n&&V(t)){if(!V(e))return!1;n=ot}switch(n){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return s.valueOf.call(t)===s.valueOf.call(e);case"[object ArrayBuffer]":case ot:return lt(st(t),st(e),i,r)}var o="[object Array]"===n;if(!o&&J(t)){if(Y(t)!==Y(e))return!1;if(t.buffer===e.buffer&&t.byteOffset===e.byteOffset)return!0;o=!0}if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var a=t.constructor,h=e.constructor;if(a!==h&&!(D(a)&&a instanceof a&&D(h)&&h instanceof h)&&"constructor"in t&&"constructor"in e)return!1}r=r||[];for(var d=(i=i||[]).length;d--;)if(i[d]===t)return r[d]===e;if(i.push(t),r.push(e),o){if((d=t.length)!==e.length)return!1;for(;d--;)if(!at(t[d],e[d],i,r))return!1}else{var c,u=it(t);if(d=u.length,it(e).length!==d)return!1;for(;d--;)if(!H(e,c=u[d])||!at(t[c],e[c],i,r))return!1}return i.pop(),r.pop(),!0}function ht(t){if(!x(t))return[];var e=[];for(var i in t)e.push(i);return b&&et(t,e),e}function dt(t){var e=tt(t);return function(i){if(null==i)return!1;var r=ht(i);if(tt(r))return!1;for(var n=0;n<e;n++)if(!D(i[t[n]]))return!1;return t!==mt||!D(i[ct])}}var ct="forEach",ut=["clear","delete"],pt=["get","has","set"],gt=ut.concat(ct,pt),mt=ut.concat(pt),ft=["add"].concat(ut,ct,"has"),vt=j?dt(gt):A("Map"),bt=j?dt(mt):A("WeakMap"),yt=j?dt(ft):A("Set"),_t=A("WeakSet");function Tt(t){for(var e=it(t),i=e.length,r=Array(i),n=0;n<i;n++)r[n]=t[e[n]];return r}function xt(t){for(var e={},i=it(t),r=0,n=i.length;r<n;r++)e[t[i[r]]]=i[r];return e}function wt(t){var e=[];for(var i in t)D(t[i])&&e.push(i);return e.sort()}function Et(t,e){return function(i){var r=arguments.length;if(e&&(i=Object(i)),r<2||null==i)return i;for(var n=1;n<r;n++)for(var s=arguments[n],o=t(s),a=o.length,l=0;l<a;l++){var h=o[l];e&&void 0!==i[h]||(i[h]=s[h])}return i}}var At=Et(ht),Pt=Et(it),St=Et(ht,!0);function Ot(t){if(!x(t))return{};if(g)return g(t);var e=function(){};e.prototype=t;var i=new e;return e.prototype=null,i}function Mt(t){return F(t)?t:[t]}function Ct(t){return nt.toPath(t)}function It(t,e){for(var i=e.length,r=0;r<i;r++){if(null==t)return;t=t[e[r]]}return i?t:void 0}function kt(t,e,i){var r=It(t,Ct(e));return w(r)?i:r}function Nt(t){return t}function Lt(t){return t=Pt({},t),function(e){return rt(e,t)}}function Dt(t){return t=Ct(t),function(e){return It(e,t)}}function Bt(t,e,i){if(void 0===e)return t;switch(null==i?3:i){case 1:return function(i){return t.call(e,i)};case 3:return function(i,r,n){return t.call(e,i,r,n)};case 4:return function(i,r,n,s){return t.call(e,i,r,n,s)}}return function(){return t.apply(e,arguments)}}function Rt(t,e,i){return null==t?Nt:D(t)?Bt(t,e,i):x(t)&&!F(t)?Lt(t):Dt(t)}function $t(t,e){return Rt(t,e,1/0)}function jt(t,e,i){return nt.iteratee!==$t?nt.iteratee(t,e):Rt(t,e,i)}function qt(){}function Vt(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))}nt.toPath=Mt,nt.iteratee=$t;var Ft=Date.now||function(){return(new Date).getTime()};function Ht(t){var e=function(e){return t[e]},i="(?:"+it(t).join("|")+")",r=RegExp(i),n=RegExp(i,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(n,e):t}}var zt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},Ut=Ht(zt),Gt=Ht(xt(zt)),Zt=nt.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},Wt=/(.)^/,Kt={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Yt=/\\|'|\r|\n|\u2028|\u2029/g;function Xt(t){return"\\"+Kt[t]}var Qt=/^\s*(\w|\$)+\s*$/;var Jt=0;function te(t,e,i,r,n){if(!(r instanceof e))return t.apply(i,n);var s=Ot(t.prototype),o=t.apply(s,n);return x(o)?o:s}var ee=T((function(t,e){var i=ee.placeholder,r=function(){for(var n=0,s=e.length,o=Array(s),a=0;a<s;a++)o[a]=e[a]===i?arguments[n++]:e[a];for(;n<arguments.length;)o.push(arguments[n++]);return te(t,r,this,this,o)};return r}));ee.placeholder=nt;var ie=T((function(t,e,i){if(!D(t))throw new TypeError("Bind must be called on a function");var r=T((function(n){return te(t,r,e,this,i.concat(n))}));return r})),re=W(tt);function ne(t,e,i,r){if(r=r||[],e||0===e){if(e<=0)return r.concat(t)}else e=1/0;for(var n=r.length,s=0,o=tt(t);s<o;s++){var a=t[s];if(re(a)&&(F(a)||U(a)))if(e>1)ne(a,e-1,i,r),n=r.length;else for(var l=0,h=a.length;l<h;)r[n++]=a[l++];else i||(r[n++]=a)}return r}var se=T((function(t,e){var i=(e=ne(e,!1,!1)).length;if(i<1)throw new Error("bindAll must be passed function names");for(;i--;){var r=e[i];t[r]=ie(t[r],t)}return t}));var oe=T((function(t,e,i){return setTimeout((function(){return t.apply(null,i)}),e)})),ae=ee(oe,nt,1);function le(t){return function(){return!t.apply(this,arguments)}}function he(t,e){var i;return function(){return--t>0&&(i=e.apply(this,arguments)),t<=1&&(e=null),i}}var de=ee(he,2);function ce(t,e,i){e=jt(e,i);for(var r,n=it(t),s=0,o=n.length;s<o;s++)if(e(t[r=n[s]],r,t))return r}function ue(t){return function(e,i,r){i=jt(i,r);for(var n=tt(e),s=t>0?0:n-1;s>=0&&s<n;s+=t)if(i(e[s],s,e))return s;return-1}}var pe=ue(1),ge=ue(-1);function me(t,e,i,r){for(var n=(i=jt(i,r,1))(e),s=0,o=tt(t);s<o;){var a=Math.floor((s+o)/2);i(t[a])<n?s=a+1:o=a}return s}function fe(t,e,i){return function(r,n,s){var o=0,l=tt(r);if("number"==typeof s)t>0?o=s>=0?s:Math.max(s+l,o):l=s>=0?Math.min(s+1,l):s+l+1;else if(i&&s&&l)return r[s=i(r,n)]===n?s:-1;if(n!=n)return(s=e(a.call(r,o,l),G))>=0?s+o:-1;for(s=t>0?o:l-1;s>=0&&s<l;s+=t)if(r[s]===n)return s;return-1}}var ve=fe(1,pe,me),be=fe(-1,ge);function ye(t,e,i){var r=(re(t)?pe:ce)(t,e,i);if(void 0!==r&&-1!==r)return t[r]}function _e(t,e,i){var r,n;if(e=Bt(e,i),re(t))for(r=0,n=t.length;r<n;r++)e(t[r],r,t);else{var s=it(t);for(r=0,n=s.length;r<n;r++)e(t[s[r]],s[r],t)}return t}function Te(t,e,i){e=jt(e,i);for(var r=!re(t)&&it(t),n=(r||t).length,s=Array(n),o=0;o<n;o++){var a=r?r[o]:o;s[o]=e(t[a],a,t)}return s}function xe(t){return function(e,i,r,n){var s=arguments.length>=3;return function(e,i,r,n){var s=!re(e)&&it(e),o=(s||e).length,a=t>0?0:o-1;for(n||(r=e[s?s[a]:a],a+=t);a>=0&&a<o;a+=t){var l=s?s[a]:a;r=i(r,e[l],l,e)}return r}(e,Bt(i,n,4),r,s)}}var we=xe(1),Ee=xe(-1);function Ae(t,e,i){var r=[];return e=jt(e,i),_e(t,(function(t,i,n){e(t,i,n)&&r.push(t)})),r}function Pe(t,e,i){e=jt(e,i);for(var r=!re(t)&&it(t),n=(r||t).length,s=0;s<n;s++){var o=r?r[s]:s;if(!e(t[o],o,t))return!1}return!0}function Se(t,e,i){e=jt(e,i);for(var r=!re(t)&&it(t),n=(r||t).length,s=0;s<n;s++){var o=r?r[s]:s;if(e(t[o],o,t))return!0}return!1}function Oe(t,e,i,r){return re(t)||(t=Tt(t)),("number"!=typeof i||r)&&(i=0),ve(t,e,i)>=0}var Me=T((function(t,e,i){var r,n;return D(e)?n=e:(e=Ct(e),r=e.slice(0,-1),e=e[e.length-1]),Te(t,(function(t){var s=n;if(!s){if(r&&r.length&&(t=It(t,r)),null==t)return;s=t[e]}return null==s?s:s.apply(t,i)}))}));function Ce(t,e){return Te(t,Dt(e))}function Ie(t,e,i){var r,n,s=-1/0,o=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var a=0,l=(t=re(t)?t:Tt(t)).length;a<l;a++)null!=(r=t[a])&&r>s&&(s=r);else e=jt(e,i),_e(t,(function(t,i,r){((n=e(t,i,r))>o||n===-1/0&&s===-1/0)&&(s=t,o=n)}));return s}var ke=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function Ne(t){return t?F(t)?a.call(t):P(t)?t.match(ke):re(t)?Te(t,Nt):Tt(t):[]}function Le(t,e,i){if(null==e||i)return re(t)||(t=Tt(t)),t[Vt(t.length-1)];var r=Ne(t),n=tt(r);e=Math.max(Math.min(e,n),0);for(var s=n-1,o=0;o<e;o++){var a=Vt(o,s),l=r[o];r[o]=r[a],r[a]=l}return r.slice(0,e)}function De(t,e){return function(i,r,n){var s=e?[[],[]]:{};return r=jt(r,n),_e(i,(function(e,n){var o=r(e,n,i);t(s,e,o)})),s}}var Be=De((function(t,e,i){H(t,i)?t[i].push(e):t[i]=[e]})),Re=De((function(t,e,i){t[i]=e})),$e=De((function(t,e,i){H(t,i)?t[i]++:t[i]=1})),je=De((function(t,e,i){t[i?0:1].push(e)}),!0);function qe(t,e,i){return e in i}var Ve=T((function(t,e){var i={},r=e[0];if(null==t)return i;D(r)?(e.length>1&&(r=Bt(r,e[1])),e=ht(t)):(r=qe,e=ne(e,!1,!1),t=Object(t));for(var n=0,s=e.length;n<s;n++){var o=e[n],a=t[o];r(a,o,t)&&(i[o]=a)}return i})),Fe=T((function(t,e){var i,r=e[0];return D(r)?(r=le(r),e.length>1&&(i=e[1])):(e=Te(ne(e,!1,!1),String),r=function(t,i){return!Oe(e,i)}),Ve(t,r,i)}));function He(t,e,i){return a.call(t,0,Math.max(0,t.length-(null==e||i?1:e)))}function ze(t,e,i){return null==t||t.length<1?null==e||i?void 0:[]:null==e||i?t[0]:He(t,t.length-e)}function Ue(t,e,i){return a.call(t,null==e||i?1:e)}var Ge=T((function(t,e){return e=ne(e,!0,!0),Ae(t,(function(t){return!Oe(e,t)}))})),Ze=T((function(t,e){return Ge(t,e)}));function We(t,e,i,r){E(e)||(r=i,i=e,e=!1),null!=i&&(i=jt(i,r));for(var n=[],s=[],o=0,a=tt(t);o<a;o++){var l=t[o],h=i?i(l,o,t):l;e&&!i?(o&&s===h||n.push(l),s=h):i?Oe(s,h)||(s.push(h),n.push(l)):Oe(n,l)||n.push(l)}return n}var Ke=T((function(t){return We(ne(t,!0,!0))}));function Ye(t){for(var e=t&&Ie(t,tt).length||0,i=Array(e),r=0;r<e;r++)i[r]=Ce(t,r);return i}var Xe=T(Ye);function Qe(t,e){return t._chain?nt(e).chain():e}function Je(t){return _e(wt(t),(function(e){var i=nt[e]=t[e];nt.prototype[e]=function(){var t=[this._wrapped];return o.apply(t,arguments),Qe(this,i.apply(nt,t))}})),nt}_e(["pop","push","reverse","shift","sort","splice","unshift"],(function(t){var e=r[t];nt.prototype[t]=function(){var i=this._wrapped;return null!=i&&(e.apply(i,arguments),"shift"!==t&&"splice"!==t||0!==i.length||delete i[0]),Qe(this,i)}})),_e(["concat","join","slice"],(function(t){var e=r[t];nt.prototype[t]=function(){var t=this._wrapped;return null!=t&&(t=e.apply(t,arguments)),Qe(this,t)}}));var ti=Je({__proto__:null,VERSION:t,restArguments:T,isObject:x,isNull:function(t){return null===t},isUndefined:w,isBoolean:E,isElement:function(t){return!(!t||1!==t.nodeType)},isString:P,isNumber:S,isDate:O,isRegExp:M,isError:C,isSymbol:I,isArrayBuffer:k,isDataView:V,isArray:F,isFunction:D,isArguments:U,isFinite:function(t){return!I(t)&&v(t)&&!isNaN(parseFloat(t))},isNaN:G,isTypedArray:J,isEmpty:function(t){if(null==t)return!0;var e=tt(t);return"number"==typeof e&&(F(t)||P(t)||U(t))?0===e:0===tt(it(t))},isMatch:rt,isEqual:function(t,e){return at(t,e)},isMap:vt,isWeakMap:bt,isSet:yt,isWeakSet:_t,keys:it,allKeys:ht,values:Tt,pairs:function(t){for(var e=it(t),i=e.length,r=Array(i),n=0;n<i;n++)r[n]=[e[n],t[e[n]]];return r},invert:xt,functions:wt,methods:wt,extend:At,extendOwn:Pt,assign:Pt,defaults:St,create:function(t,e){var i=Ot(t);return e&&Pt(i,e),i},clone:function(t){return x(t)?F(t)?t.slice():At({},t):t},tap:function(t,e){return e(t),t},get:kt,has:function(t,e){for(var i=(e=Ct(e)).length,r=0;r<i;r++){var n=e[r];if(!H(t,n))return!1;t=t[n]}return!!i},mapObject:function(t,e,i){e=jt(e,i);for(var r=it(t),n=r.length,s={},o=0;o<n;o++){var a=r[o];s[a]=e(t[a],a,t)}return s},identity:Nt,constant:Z,noop:qt,toPath:Mt,property:Dt,propertyOf:function(t){return null==t?qt:function(e){return kt(t,e)}},matcher:Lt,matches:Lt,times:function(t,e,i){var r=Array(Math.max(0,t));e=Bt(e,i,1);for(var n=0;n<t;n++)r[n]=e(n);return r},random:Vt,now:Ft,escape:Ut,unescape:Gt,templateSettings:Zt,template:function(t,e,i){!e&&i&&(e=i),e=St({},e,nt.templateSettings);var r=RegExp([(e.escape||Wt).source,(e.interpolate||Wt).source,(e.evaluate||Wt).source].join("|")+"|$","g"),n=0,s="__p+='";t.replace(r,(function(e,i,r,o,a){return s+=t.slice(n,a).replace(Yt,Xt),n=a+e.length,i?s+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":r?s+="'+\n((__t=("+r+"))==null?'':__t)+\n'":o&&(s+="';\n"+o+"\n__p+='"),e})),s+="';\n";var o,a=e.variable;if(a){if(!Qt.test(a))throw new Error("variable is not a bare identifier: "+a)}else s="with(obj||{}){\n"+s+"}\n",a="obj";s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{o=new Function(a,"_",s)}catch(t){throw t.source=s,t}var l=function(t){return o.call(this,t,nt)};return l.source="function("+a+"){\n"+s+"}",l},result:function(t,e,i){var r=(e=Ct(e)).length;if(!r)return D(i)?i.call(t):i;for(var n=0;n<r;n++){var s=null==t?void 0:t[e[n]];void 0===s&&(s=i,n=r),t=D(s)?s.call(t):s}return t},uniqueId:function(t){var e=++Jt+"";return t?t+e:e},chain:function(t){var e=nt(t);return e._chain=!0,e},iteratee:$t,partial:ee,bind:ie,bindAll:se,memoize:function(t,e){var i=function(r){var n=i.cache,s=""+(e?e.apply(this,arguments):r);return H(n,s)||(n[s]=t.apply(this,arguments)),n[s]};return i.cache={},i},delay:oe,defer:ae,throttle:function(t,e,i){var r,n,s,o,a=0;i||(i={});var l=function(){a=!1===i.leading?0:Ft(),r=null,o=t.apply(n,s),r||(n=s=null)},h=function(){var h=Ft();a||!1!==i.leading||(a=h);var d=e-(h-a);return n=this,s=arguments,d<=0||d>e?(r&&(clearTimeout(r),r=null),a=h,o=t.apply(n,s),r||(n=s=null)):r||!1===i.trailing||(r=setTimeout(l,d)),o};return h.cancel=function(){clearTimeout(r),a=0,r=n=s=null},h},debounce:function(t,e,i){var r,n,s,o,a,l=function(){var h=Ft()-n;e>h?r=setTimeout(l,e-h):(r=null,i||(o=t.apply(a,s)),r||(s=a=null))},h=T((function(h){return a=this,s=h,n=Ft(),r||(r=setTimeout(l,e),i&&(o=t.apply(a,s))),o}));return h.cancel=function(){clearTimeout(r),r=s=a=null},h},wrap:function(t,e){return ee(e,t)},negate:le,compose:function(){var t=arguments,e=t.length-1;return function(){for(var i=e,r=t[e].apply(this,arguments);i--;)r=t[i].call(this,r);return r}},after:function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},before:he,once:de,findKey:ce,findIndex:pe,findLastIndex:ge,sortedIndex:me,indexOf:ve,lastIndexOf:be,find:ye,detect:ye,findWhere:function(t,e){return ye(t,Lt(e))},each:_e,forEach:_e,map:Te,collect:Te,reduce:we,foldl:we,inject:we,reduceRight:Ee,foldr:Ee,filter:Ae,select:Ae,reject:function(t,e,i){return Ae(t,le(jt(e)),i)},every:Pe,all:Pe,some:Se,any:Se,contains:Oe,includes:Oe,include:Oe,invoke:Me,pluck:Ce,where:function(t,e){return Ae(t,Lt(e))},max:Ie,min:function(t,e,i){var r,n,s=1/0,o=1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var a=0,l=(t=re(t)?t:Tt(t)).length;a<l;a++)null!=(r=t[a])&&r<s&&(s=r);else e=jt(e,i),_e(t,(function(t,i,r){((n=e(t,i,r))<o||n===1/0&&s===1/0)&&(s=t,o=n)}));return s},shuffle:function(t){return Le(t,1/0)},sample:Le,sortBy:function(t,e,i){var r=0;return e=jt(e,i),Ce(Te(t,(function(t,i,n){return{value:t,index:r++,criteria:e(t,i,n)}})).sort((function(t,e){var i=t.criteria,r=e.criteria;if(i!==r){if(i>r||void 0===i)return 1;if(i<r||void 0===r)return-1}return t.index-e.index})),"value")},groupBy:Be,indexBy:Re,countBy:$e,partition:je,toArray:Ne,size:function(t){return null==t?0:re(t)?t.length:it(t).length},pick:Ve,omit:Fe,first:ze,head:ze,take:ze,initial:He,last:function(t,e,i){return null==t||t.length<1?null==e||i?void 0:[]:null==e||i?t[t.length-1]:Ue(t,Math.max(0,t.length-e))},rest:Ue,tail:Ue,drop:Ue,compact:function(t){return Ae(t,Boolean)},flatten:function(t,e){return ne(t,e,!1)},without:Ze,uniq:We,unique:We,union:Ke,intersection:function(t){for(var e=[],i=arguments.length,r=0,n=tt(t);r<n;r++){var s=t[r];if(!Oe(e,s)){var o;for(o=1;o<i&&Oe(arguments[o],s);o++);o===i&&e.push(s)}}return e},difference:Ge,unzip:Ye,transpose:Ye,zip:Xe,object:function(t,e){for(var i={},r=0,n=tt(t);r<n;r++)e?i[t[r]]=e[r]:i[t[r][0]]=t[r][1];return i},range:function(t,e,i){null==e&&(e=t||0,t=0),i||(i=e<t?-1:1);for(var r=Math.max(Math.ceil((e-t)/i),0),n=Array(r),s=0;s<r;s++,t+=i)n[s]=t;return n},chunk:function(t,e){if(null==e||e<1)return[];for(var i=[],r=0,n=t.length;r<n;)i.push(a.call(t,r,r+=e));return i},mixin:Je,default:nt});return ti._=ti,ti}()},51758:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProductProcessorsCollection=void 0,exports.ProductProcessorsCollection=class{constructor(){this.processors=new Map}invokeProcessors(t,e){this.processors.forEach(((i,r)=>{i(t,e)}))}registerProcessor(t,e){if(this.processors.has(t.valueOf()))throw Error(`Processor with id ${t} already exists.`);"invoke"in e?this.processors.set(t.valueOf(),((t,i)=>e.invoke(t,i))):this.processors.set(t.valueOf(),e)}unregisterProcessor(t){return!!this.processors.has(t.valueOf())&&this.processors.delete(t.valueOf())}}},51966:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Boolean=function(t){return(0,r.CreateType)({[i.Kind]:"Boolean",type:"boolean"},t)};const i=e(73967),r=e(10034)},52667:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProductItem=void 0,exports.ProductItem=class{constructor(t,e,i={}){this.attributes={},this.productFamilyName=t,this.productName=e,this.attributes=i}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}removeAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}getAttributes(){return this.attributes}setAttributes(t){this.attributes=t}getProductName(){return this.productName}getProductFamilyName(){return this.productFamilyName}reset(t){return this.productFamilyName=t.productFamilyName,this.productName=t.productName,this.attributes=t.attributes,this}toTestableOneDimensionalArray(){const t={};t["item.productFamilyName"]=this.productFamilyName,t["item.productName"]=this.productName;for(const e in this.attributes)t["item.attributes."+e]=this.attributes[e];return t}}},53094:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IndexFromPropertyKey=c,exports.IndexFromPropertyKeys=u,exports.Index=function(t,e,r){return(0,h.IsMappedResult)(e)?(0,l.IndexFromMappedResult)(t,e,r):(0,h.IsMappedKey)(e)?(0,a.IndexFromMappedKey)(t,e,r):(0,i.CreateType)((0,h.IsSchema)(e)?p(t,(0,o.IndexPropertyKeys)(e)):p(t,e),r)};const i=e(30768),r=e(72492),n=e(65495),s=e(85713),o=e(11359),a=e(34085),l=e(57605),h=e(51049);function d(t,e){return t.map((t=>c(t,e)))}function c(t,e){return(0,h.IsIntersect)(t)?function(t,e){return(0,n.IntersectEvaluated)(function(t){return t.filter((t=>!(0,h.IsNever)(t)))}(d(t,e)))}(t.allOf,e):(0,h.IsUnion)(t)?function(t,e){return(0,s.UnionEvaluated)(function(t){return t.some((t=>(0,h.IsNever)(t)))?[]:t}(d(t,e)))}(t.anyOf,e):(0,h.IsTuple)(t)?function(t,e){return e in t?t[e]:"[number]"===e?(0,s.UnionEvaluated)(t):(0,r.Never)()}(t.items??[],e):(0,h.IsArray)(t)?function(t,e){return"[number]"===e?t:(0,r.Never)()}(t.items,e):(0,h.IsObject)(t)?function(t,e){return e in t?t[e]:(0,r.Never)()}(t.properties,e):(0,r.Never)()}function u(t,e){return e.map((e=>c(t,e)))}function p(t,e){return(0,s.UnionEvaluated)(u(t,e))}},53214:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Recursive=function(t,e={}){(0,n.IsUndefined)(e.$id)&&(e.$id="T"+o++);const a=(0,i.CloneType)(t({[s.Kind]:"This",$ref:`${e.$id}`}));return a.$id=e.$id,(0,r.CreateType)({[s.Hint]:"Recursive",...a},e)};const i=e(24855),r=e(30768),n=e(72862),s=e(73967);let o=0},53410:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},54031:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(14786),exports)},54040:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(58305),exports)},54199:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ValueGuard=exports.TypeGuard=exports.KindGuard=void 0,exports.KindGuard=e(51049),exports.TypeGuard=e(4443),exports.ValueGuard=e(72862)},54718:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},54788:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProductWizardContext=void 0;const i=e(72915),r=e(1039),n=e(72823),s=e(85994),o=e(76221);class a extends o.ProductContext{constructor(){super(),this.attributesRequiredByWizard=["size","imperial_units","shape"],this.neverDisable=["quantity"],this.quantityAndPriceOptions=[],this.isBusy=!1,this.sizeHelper=new s.SizeHelper(this.attrComputer,this.productItem);const t=new i.AutoPickAttrProcessor(["laminate"],this.cherryPicks,(t=>!this.canAttrValuesBeDisabled(t)),(t=>this.isAttributeRequired(t)));this.processors.registerProcessor(r.ProductProcessorsEnum.AUTOPICK,t),this.processors.registerProcessor(r.ProductProcessorsEnum.SIZE,new n.SizeProcessor(this.sizeHelper)),this.attrEvaluator.ignoreConstraintsFromTo("feature","laminate"),this.attrEvaluator.ignoreConstraintsFromTo("ink","laminate")}resetQuantity(t){this.quantityAndPriceOptions=t;const e=this.quantityAndPriceOptions.find((t=>0!==t.quantity)),i=e?e.quantity:0;!this.cherryPicks.hasAttribute("quantity")&&i&&this.productItem.setAttribute("quantity",i)}canAttrValuesBeDisabled(t){return this.neverDisable.indexOf(t)<0}isAttributeRequired(t){return this.attrComputer.isRequired(t)||this.attributesRequiredByWizard.indexOf(t)>=0}getAttributeOptions(t,e=!0){const i=this.productItem.getAttribute(t),r=this.attrComputer.getSuggestedValues(t);if(this.attrComputer.isDynamicValue(t)){const e=this.attrComputer.parseAttribute(t,i);null===e||Array.isArray(e)||r.includes(e)||r.push(e)}const n=[...this.canAttrValuesBeDisabled(t)?this.attrComputer.getConstrainedValues(t):[],...e?this.attrComputer.getOutOfStockValues(t):[]],s=this.attrComputer.getIcons(t),o=r.map((e=>{var r;return{value:e,disabled:n.includes(e),icon:null!==(r=s[e.toString()])&&void 0!==r?r:null,selected:Array.isArray(i)?i.includes(e):String(i)===String(e),out_of_stock:this.attrComputer.isOutOfStock(t,e)}}));return this.sortOptions(t,o)}sortOptions(t,e){const i=e.reduce(((e,i)=>(i.disabled?e.low.push(i):this.attrComputer.hasBeenFiltered(t)&&!this.attrComputer.isInFilteredValues(t,i.value)?e.medium.push(i):e.high.push(i),e)),{high:[],medium:[],low:[]});return[...i.high,...i.medium,...i.low]}}exports.ProductWizardContext=a},55143:(t,exports)=>{"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.PriceProviderType=void 0,function(t){t.STATIC="static",t.DYNAMIC="dynamic"}(e||(exports.PriceProviderType=e={}))},55160:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Value=void 0,exports.Value=e(77085)},55344:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(56524),exports)},55687:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(40078),exports),r(e(57366),exports),r(e(21075),exports),r(e(12260),exports),r(e(90728),exports),r(e(34749),exports),r(e(85725),exports),r(e(55143),exports),r(e(16006),exports),r(e(92153),exports),r(e(27006),exports),r(e(46573),exports),r(e(8926),exports),r(e(52667),exports),r(e(60523),exports),r(e(68696),exports),r(e(8668),exports),r(e(30270),exports),r(e(98255),exports),r(e(35645),exports),r(e(50861),exports),r(e(32807),exports),r(e(89027),exports),r(e(63800),exports),r(e(14501),exports),r(e(35772),exports),r(e(67574),exports),r(e(23930),exports),r(e(54718),exports),r(e(20614),exports),r(e(64985),exports),r(e(71032),exports),r(e(68505),exports),r(e(29104),exports),r(e(25730),exports),r(e(67272),exports),r(e(51758),exports),r(e(36595),exports),r(e(19898),exports),r(e(3047),exports),r(e(72441),exports),r(e(48772),exports),r(e(61603),exports),r(e(67387),exports)},56145:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExtractFromMappedResult=function(t,e){const n=function(t,e){return function(t,e){const i={};for(const n of globalThis.Object.getOwnPropertyNames(t))i[n]=(0,r.Extract)(t[n],e);return i}(t.properties,e)}(t,e);return(0,i.MappedResult)(n)};const i=e(34013),r=e(73842)},56524:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Iterator=function(t,e){return(0,i.CreateType)({[r.Kind]:"Iterator",type:"Iterator",items:t},e)};const i=e(30768),r=e(73967)},56634:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Null=function(t){return(0,i.CreateType)({[r.Kind]:"Null",type:"null"},t)};const i=e(30768),r=e(73967)},56767:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CherryPickHelper=void 0,exports.CherryPickHelper=class{constructor(t,e={}){this.attrComputer=t,this.attributes=e,this.lostAttributes={}}reset(){this.attributes={},this.lostAttributes={}}hasLostAttributeValue(t,e){var i;if(this.hasLostAttribute(t)){if(this.attrComputer.isMultiValue(t)){const r=null!==(i=this.getLostAttribute(t))&&void 0!==i?i:[];return(Array.isArray(e)?e:[e]).some((t=>r.includes(t)))}return this.getLostAttribute(t)!=e}return!1}hasLostAttribute(t){return this.lostAttributes.hasOwnProperty(t)}maybeRegisterALost(t,e){var i;if(this.hasAttribute(t))if(this.attrComputer.isMultiValue(t)){const r=null!==(i=this.getAttribute(t))&&void 0!==i?i:[],n=Array.isArray(e)?e:[e],s=r.filter((t=>!n.includes(t)));if(s.length)return this.lostAttributes[t]=s,!0;delete this.lostAttributes[t]}else{const i=this.getAttribute(t),r=JSON.stringify(i),n=JSON.stringify(e);if(void 0!==i&&r!=n)return this.lostAttributes[t]=i,!0;this.hasLostAttribute(t)&&delete this.lostAttributes[t]}return!1}removeAttribute(t,e){var i;if(this.hasAttribute(t))if(this.attrComputer.isMultiValue(t)){const r=null!==(i=this.getAttribute(t))&&void 0!==i?i:[];this.attributes[t]=r.filter((t=>t!=e))}else delete this.attributes[t]}hasAttribute(t){return this.attributes.hasOwnProperty(t)}setAttributes(t){this.attributes=t}setAttribute(t,e){var i;this.attrComputer.isMultiValue(t)?(this.hasAttribute(t)||(this.attributes[t]=[]),null===(i=this.getAttribute(t))||void 0===i||i.push(e)):this.attributes[t]=e}getAttribute(t){return this.attributes[t]}getLostAttribute(t){return this.lostAttributes[t]}getLostAttributes(){return this.lostAttributes}getAttributes(){return this.attributes}}},56791:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TemplateLiteralFiniteError=void 0,exports.IsTemplateLiteralExpressionFinite=s,exports.IsTemplateLiteralFinite=function(t){return s((0,i.TemplateLiteralParseExact)(t.pattern))};const i=e(95421),r=e(87580);class n extends r.TypeBoxError{}function s(t){return!function(t){return"or"===t.type&&2===t.expr.length&&"const"===t.expr[0].type&&"0"===t.expr[0].const&&"const"===t.expr[1].type&&"[1-9][0-9]*"===t.expr[1].const}(t)&&!function(t){return"const"===t.type&&".*"===t.const}(t)&&(!!function(t){return"or"===t.type&&2===t.expr.length&&"const"===t.expr[0].type&&"true"===t.expr[0].const&&"const"===t.expr[1].type&&"false"===t.expr[1].const}(t)||("and"===t.type||"or"===t.type?t.expr.every((t=>s(t))):"const"===t.type||(()=>{throw new n("Unknown expression type")})()))}exports.TemplateLiteralFiniteError=n},57083:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(34085),exports),r(e(57605),exports),r(e(11359),exports),r(e(53094),exports)},57234:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(37617),exports)},57366:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},57605:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IndexFromMappedResult=function(t,e,s){const o=function(t,e,i){return function(t,e,i){const s={};for(const o of Object.getOwnPropertyNames(e))s[o]=(0,n.Index)(t,(0,r.IndexPropertyKeys)(e[o]),i);return s}(t,e.properties,i)}(t,e,s);return(0,i.MappedResult)(o)};const i=e(34013),r=e(11359),n=e(57083)},57996:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Parameters=function(t,e){return(0,i.Tuple)(t.parameters,e)};const i=e(62700)},58305:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Clean=function(...t){return 3===t.length?d(t[0],t[1],t[2]):d(t[0],[],t[1])};const i=e(39260),r=e(97069),n=e(41120),s=e(62413),o=e(73967),a=e(79968),l=e(51049);function h(t){return(0,l.IsKind)(t)&&"Unsafe"!==t[o.Kind]}function d(t,e,c){const u=(0,a.IsString)(t.$id)?[...e,t]:e,p=t;switch(p[o.Kind]){case"Array":return function(t,e,i){return(0,a.IsArray)(i)?i.map((i=>d(t.items,e,i))):i}(p,u,c);case"Intersect":return function(t,e,s){const o=t.unevaluatedProperties,h=t.allOf.map((t=>d(t,e,(0,n.Clone)(s)))).reduce(((t,e)=>(0,a.IsObject)(e)?{...t,...e}:e),{});if(!(0,a.IsObject)(s)||!(0,a.IsObject)(h)||!(0,l.IsKind)(o))return h;const c=(0,i.KeyOfPropertyKeys)(t);for(const t of Object.getOwnPropertyNames(s))c.includes(t)||(0,r.Check)(o,e,s[t])&&(h[t]=d(o,e,s[t]));return h}(p,u,c);case"Object":return function(t,e,i){if(!(0,a.IsObject)(i)||(0,a.IsArray)(i))return i;const n=t.additionalProperties;for(const s of Object.getOwnPropertyNames(i))(0,a.HasPropertyKey)(t.properties,s)?i[s]=d(t.properties[s],e,i[s]):(0,l.IsKind)(n)&&(0,r.Check)(n,e,i[s])?i[s]=d(n,e,i[s]):delete i[s];return i}(p,u,c);case"Record":return function(t,e,i){if(!(0,a.IsObject)(i))return i;const n=t.additionalProperties,s=Object.getOwnPropertyNames(i),[o,h]=Object.entries(t.patternProperties)[0],c=new RegExp(o);for(const t of s)c.test(t)?i[t]=d(h,e,i[t]):(0,l.IsKind)(n)&&(0,r.Check)(n,e,i[t])?i[t]=d(n,e,i[t]):delete i[t];return i}(p,u,c);case"Ref":case"This":return function(t,e,i){return d((0,s.Deref)(t,e),e,i)}(p,u,c);case"Tuple":return function(t,e,i){if(!(0,a.IsArray)(i))return i;if((0,a.IsUndefined)(t.items))return[];const r=Math.min(i.length,t.items.length);for(let n=0;n<r;n++)i[n]=d(t.items[n],e,i[n]);return i.length>r?i.slice(0,r):i}(p,u,c);case"Union":return function(t,e,i){for(const n of t.anyOf)if(h(n)&&(0,r.Check)(n,e,i))return d(n,e,i);return i}(p,u,c);default:return c}}},58440:(t,exports)=>{"use strict";function e(t){return exports.currencies[t]?exports.currencies[t].decimals:2}var i;Object.defineProperty(exports,"__esModule",{value:!0}),exports.currencies=exports.Currencies=void 0,exports.getDecimals=e,exports.toMajorUnits=function(t,i){return t/Math.pow(10,e(i))},exports.toMinorUnits=function(t,i){return Math.round(t*Math.pow(10,e(i)))},function(t){t.USD="USD",t.SEK="SEK",t.DKK="DKK",t.GBP="GBP",t.NOK="NOK",t.EUR="EUR",t.JPY="JPY",t.PLN="PLN",t.CAD="CAD"}(i||(exports.Currencies=i={})),exports.currencies={AED:{code:"AED",decimals:2},AFN:{code:"AFN",decimals:2},ALL:{code:"ALL",decimals:2},AMD:{code:"AMD",decimals:2},ANG:{code:"ANG",decimals:2},AOA:{code:"AOA",decimals:2},ARS:{code:"ARS",decimals:2},AUD:{code:"AUD",decimals:2},AWG:{code:"AWG",decimals:2},AZN:{code:"AZN",decimals:2},BAM:{code:"BAM",decimals:2},BBD:{code:"BBD",decimals:2},BDT:{code:"BDT",decimals:2},BGN:{code:"BGN",decimals:2},BHD:{code:"BHD",decimals:2},BIF:{code:"BIF",decimals:2},BMD:{code:"BMD",decimals:2},BND:{code:"BND",decimals:2},BOB:{code:"BOB",decimals:2},BRL:{code:"BRL",decimals:2},BSD:{code:"BSD",decimals:2},BTN:{code:"BTN",decimals:2},BWP:{code:"BWP",decimals:2},BYN:{code:"BYN",decimals:2},BZD:{code:"BZD",decimals:2},CAD:{code:"CAD",decimals:2},CDF:{code:"CDF",decimals:2},CHF:{code:"CHF",decimals:2},CLP:{code:"CLP",decimals:0},CNY:{code:"CNY",decimals:2},COP:{code:"COP",decimals:2},CRC:{code:"CRC",decimals:2},CUP:{code:"CUP",decimals:2},CVE:{code:"CVE",decimals:2},CZK:{code:"CZK",decimals:2},DJF:{code:"DJF",decimals:2},DKK:{code:"DKK",decimals:2},DOP:{code:"DOP",decimals:2},DZD:{code:"DZD",decimals:2},EGP:{code:"EGP",decimals:2},ERN:{code:"ERN",decimals:2},ETB:{code:"ETB",decimals:2},EUR:{code:"EUR",decimals:2},FJD:{code:"FJD",decimals:2},FKP:{code:"FKP",decimals:2},GBP:{code:"GBP",decimals:2},GEL:{code:"GEL",decimals:2},GHS:{code:"GHS",decimals:2},GIP:{code:"GIP",decimals:2},GMD:{code:"GMD",decimals:2},GNF:{code:"GNF",decimals:2},GTQ:{code:"GTQ",decimals:2},GYD:{code:"GYD",decimals:2},HKD:{code:"HKD",decimals:2},HNL:{code:"HNL",decimals:2},HTG:{code:"HTG",decimals:2},HUF:{code:"HUF",decimals:2},IDR:{code:"IDR",decimals:0},ILS:{code:"ILS",decimals:2},INR:{code:"INR",decimals:2},IQD:{code:"IQD",decimals:2},IRR:{code:"IRR",decimals:2},ISK:{code:"ISK",decimals:0},JMD:{code:"JMD",decimals:2},JOD:{code:"JOD",decimals:2},JPY:{code:"JPY",decimals:0},KES:{code:"KES",decimals:2},KGS:{code:"KGS",decimals:2},KHR:{code:"KHR",decimals:2},KMF:{code:"KMF",decimals:2},KPW:{code:"KPW",decimals:2},KRW:{code:"KRW",decimals:0},KWD:{code:"KWD",decimals:2},KYD:{code:"KYD",decimals:2},KZT:{code:"KZT",decimals:2},LAK:{code:"LAK",decimals:2},LBP:{code:"LBP",decimals:2},LKR:{code:"LKR",decimals:2},LRD:{code:"LRD",decimals:2},LSL:{code:"LSL",decimals:2},LYD:{code:"LYD",decimals:2},MAD:{code:"MAD",decimals:2},MDL:{code:"MDL",decimals:2},MGA:{code:"MGA",decimals:2},MKD:{code:"MKD",decimals:2},MMK:{code:"MMK",decimals:2},MNT:{code:"MNT",decimals:2},MOP:{code:"MOP",decimals:2},MRU:{code:"MRU",decimals:2},MUR:{code:"MUR",decimals:2},MVR:{code:"MVR",decimals:2},MWK:{code:"MWK",decimals:2},MXN:{code:"MXN",decimals:2},MYR:{code:"MYR",decimals:2},MZN:{code:"MZN",decimals:2},NAD:{code:"NAD",decimals:2},NGN:{code:"NGN",decimals:2},NIO:{code:"NIO",decimals:2},NOK:{code:"NOK",decimals:2},NPR:{code:"NPR",decimals:2},NZD:{code:"NZD",decimals:2},OMR:{code:"OMR",decimals:2},PAB:{code:"PAB",decimals:2},PEN:{code:"PEN",decimals:2},PGK:{code:"PGK",decimals:2},PHP:{code:"PHP",decimals:2},PKR:{code:"PKR",decimals:2},PLN:{code:"PLN",decimals:2},PYG:{code:"PYG",decimals:0},QAR:{code:"QAR",decimals:2},RON:{code:"RON",decimals:2},RSD:{code:"RSD",decimals:2},RUB:{code:"RUB",decimals:2},RWF:{code:"RWF",decimals:2},SAR:{code:"SAR",decimals:2},SBD:{code:"SBD",decimals:2},SCR:{code:"SCR",decimals:2},SDG:{code:"SDG",decimals:2},SEK:{code:"SEK",decimals:2},SGD:{code:"SGD",decimals:2},SHP:{code:"SHP",decimals:2},SLL:{code:"SLL",decimals:2},SOS:{code:"SOS",decimals:2},SRD:{code:"SRD",decimals:2},SSP:{code:"SSP",decimals:2},STN:{code:"STN",decimals:2},SYP:{code:"SYP",decimals:2},SZL:{code:"SZL",decimals:2},THB:{code:"THB",decimals:2},TJS:{code:"TJS",decimals:2},TMT:{code:"TMT",decimals:2},TND:{code:"TND",decimals:2},TOP:{code:"TOP",decimals:2},TRY:{code:"TRY",decimals:2},TTD:{code:"TTD",decimals:2},TWD:{code:"TWD",decimals:2},TZS:{code:"TZS",decimals:2},UAH:{code:"UAH",decimals:2},UGX:{code:"UGX",decimals:2},USD:{code:"USD",decimals:2},UYU:{code:"UYU",decimals:2},UZS:{code:"UZS",decimals:2},VES:{code:"VES",decimals:2},VND:{code:"VND",decimals:0},VUV:{code:"VUV",decimals:2},WST:{code:"WST",decimals:2},XAF:{code:"XAF",decimals:2},XCD:{code:"XCD",decimals:2},XOF:{code:"XOF",decimals:2},XPF:{code:"XPF",decimals:2},YER:{code:"YER",decimals:2},ZAR:{code:"ZAR",decimals:2},ZMW:{code:"ZMW",decimals:2},ZWL:{code:"ZWL",decimals:2}}},58503:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ValueCreateError=void 0,exports.Create=function(...t){return f=0,2===t.length?g(t[0],t[1]):g(t[0],[])};const i=e(79968),r=e(97069),n=e(41120),s=e(62413),o=e(61198),a=e(64873),l=e(9881),h=e(73967),d=e(87580),c=e(60585);class u extends d.TypeBoxError{constructor(t,e){super(e),this.schema=t}}function p(t){return(0,c.IsFunction)(t)?t():(0,n.Clone)(t)}function g(t,e){const n=(0,s.Pushref)(t,e),d=t;switch(d[h.Kind]){case"Any":case"Unknown":return function(t){return(0,i.HasPropertyKey)(t,"default")?p(t.default):{}}(d);case"Array":return function(t,e){if(!0!==t.uniqueItems||(0,i.HasPropertyKey)(t,"default")){if("contains"in t&&!(0,i.HasPropertyKey)(t,"default"))throw new u(t,"Array with the contains constraint requires a default value");return"default"in t?p(t.default):void 0!==t.minItems?Array.from({length:t.minItems}).map((i=>g(t.items,e))):[]}throw new u(t,"Array with the uniqueItems constraint requires a default value")}(d,n);case"AsyncIterator":return function(t){return(0,i.HasPropertyKey)(t,"default")?p(t.default):async function*(){}()}(d);case"BigInt":return function(t){return(0,i.HasPropertyKey)(t,"default")?p(t.default):BigInt(0)}(d);case"Boolean":return function(t){return!!(0,i.HasPropertyKey)(t,"default")&&p(t.default)}(d);case"Constructor":return function(t,e){if((0,i.HasPropertyKey)(t,"default"))return p(t.default);{const i=g(t.returns,e);return"object"!=typeof i||Array.isArray(i)?class{}:class{constructor(){for(const[t,e]of Object.entries(i))this[t]=e}}}}(d,n);case"Date":return function(t){return(0,i.HasPropertyKey)(t,"default")?p(t.default):void 0!==t.minimumTimestamp?new Date(t.minimumTimestamp):new Date}(d);case"Function":return function(t,e){return(0,i.HasPropertyKey)(t,"default")?p(t.default):()=>g(t.returns,e)}(d,n);case"Integer":case"Number":return function(t){return(0,i.HasPropertyKey)(t,"default")?p(t.default):void 0!==t.minimum?t.minimum:0}(d);case"Intersect":return function(t,e){if((0,i.HasPropertyKey)(t,"default"))return p(t.default);{const i=t.allOf.reduce(((t,i)=>{const r=g(i,e);return"object"==typeof r?{...t,...r}:r}),{});if(!(0,r.Check)(t,e,i))throw new u(t,"Intersect produced invalid value. Consider using a default value.");return i}}(d,n);case"Iterator":return function(t){return(0,i.HasPropertyKey)(t,"default")?p(t.default):function*(){}()}(d);case"Literal":return function(t){return(0,i.HasPropertyKey)(t,"default")?p(t.default):t.const}(d);case"Never":return function(t){if((0,i.HasPropertyKey)(t,"default"))return p(t.default);throw new u(t,"Never types cannot be created. Consider using a default value.")}(d);case"Not":return function(t){if((0,i.HasPropertyKey)(t,"default"))return p(t.default);throw new u(t,"Not types must have a default value")}(d);case"Null":return function(t){return(0,i.HasPropertyKey)(t,"default")?p(t.default):null}(d);case"Object":return function(t,e){if((0,i.HasPropertyKey)(t,"default"))return p(t.default);{const i=new Set(t.required),r={};for(const[n,s]of Object.entries(t.properties))i.has(n)&&(r[n]=g(s,e));return r}}(d,n);case"Promise":return function(t,e){return(0,i.HasPropertyKey)(t,"default")?p(t.default):Promise.resolve(g(t.item,e))}(d,n);case"Record":return function(t,e){const[r,n]=Object.entries(t.patternProperties)[0];if((0,i.HasPropertyKey)(t,"default"))return p(t.default);if(r!==a.PatternStringExact&&r!==a.PatternNumberExact){const t=r.slice(1,r.length-1).split("|"),i={};for(const r of t)i[r]=g(n,e);return i}return{}}(d,n);case"Ref":return function(t,e){return(0,i.HasPropertyKey)(t,"default")?p(t.default):g((0,s.Deref)(t,e),e)}(d,n);case"RegExp":return function(t){if((0,i.HasPropertyKey)(t,"default"))return p(t.default);throw new u(t,"RegExp types cannot be created. Consider using a default value.")}(d);case"String":return function(t){if(void 0!==t.pattern){if((0,i.HasPropertyKey)(t,"default"))return p(t.default);throw new u(t,"String types with patterns must specify a default value")}if(void 0!==t.format){if((0,i.HasPropertyKey)(t,"default"))return p(t.default);throw new u(t,"String types with formats must specify a default value")}return(0,i.HasPropertyKey)(t,"default")?p(t.default):void 0!==t.minLength?Array.from({length:t.minLength}).map((()=>" ")).join(""):""}(d);case"Symbol":return function(t){return(0,i.HasPropertyKey)(t,"default")?p(t.default):"value"in t?Symbol.for(t.value):Symbol()}(d);case"TemplateLiteral":return function(t){if((0,i.HasPropertyKey)(t,"default"))return p(t.default);if(!(0,o.IsTemplateLiteralFinite)(t))throw new u(t,"Can only create template literals that produce a finite variants. Consider using a default value.");return(0,o.TemplateLiteralGenerate)(t)[0]}(d);case"This":return function(t,e){if(f++>m)throw new u(t,"Cannot create recursive type as it appears possibly infinite. Consider using a default.");return(0,i.HasPropertyKey)(t,"default")?p(t.default):g((0,s.Deref)(t,e),e)}(d,n);case"Tuple":return function(t,e){return(0,i.HasPropertyKey)(t,"default")?p(t.default):void 0===t.items?[]:Array.from({length:t.minItems}).map(((i,r)=>g(t.items[r],e)))}(d,n);case"Undefined":case"Void":return function(t){return(0,i.HasPropertyKey)(t,"default")?p(t.default):void 0}(d);case"Union":return function(t,e){if((0,i.HasPropertyKey)(t,"default"))return p(t.default);if(0===t.anyOf.length)throw new Error("ValueCreate.Union: Cannot create Union with zero variants");return g(t.anyOf[0],e)}(d,n);case"Uint8Array":return function(t){return(0,i.HasPropertyKey)(t,"default")?p(t.default):void 0!==t.minByteLength?new Uint8Array(t.minByteLength):new Uint8Array(0)}(d);default:if(!l.TypeRegistry.Has(d[h.Kind]))throw new u(d,"Unknown type");return function(t){if((0,i.HasPropertyKey)(t,"default"))return p(t.default);throw new Error("User defined types must specify a default value")}(d)}}exports.ValueCreateError=u;const m=512;let f=0},58906:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},59381:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ValueCastError=void 0,exports.Cast=u;const i=e(79968),r=e(87580),n=e(73967),s=e(1151),o=e(97069),a=e(41120),l=e(62413);class h extends r.TypeBoxError{constructor(t,e){super(e),this.schema=t}}function d(t,e,r){if("Object"!==t[n.Kind]||"object"!=typeof r||(0,i.IsNull)(r))return(0,o.Check)(t,e,r)?1:0;{const i=t,s=Object.getOwnPropertyNames(r),a=Object.entries(i.properties),[l,h]=[1/a.length,a.length];return a.reduce(((t,[i,a])=>t+(("Literal"===a[n.Kind]&&a.const===r[i]?h:0)+((0,o.Check)(a,e,r[i])?l:0)+(s.includes(i)?l:0))),0)}}function c(t,e,r){const p=(0,i.IsString)(t.$id)?[...e,t]:e,g=t;switch(t[n.Kind]){case"Array":return function(t,e,r){if((0,o.Check)(t,e,r))return(0,a.Clone)(r);const n=(0,i.IsArray)(r)?(0,a.Clone)(r):(0,s.Create)(t,e),l=(0,i.IsNumber)(t.minItems)&&n.length<t.minItems?[...n,...Array.from({length:t.minItems-n.length},(()=>null))]:n,d=((0,i.IsNumber)(t.maxItems)&&l.length>t.maxItems?l.slice(0,t.maxItems):l).map((i=>c(t.items,e,i)));if(!0!==t.uniqueItems)return d;const u=[...new Set(d)];if(!(0,o.Check)(t,e,u))throw new h(t,"Array cast produced invalid data due to uniqueItems constraint");return u}(g,p,r);case"Constructor":return function(t,e,i){if((0,o.Check)(t,e,i))return(0,s.Create)(t,e);const r=new Set(t.returns.required||[]),n=function(){};for(const[s,o]of Object.entries(t.returns.properties))(r.has(s)||void 0!==i.prototype[s])&&(n.prototype[s]=c(o,e,i.prototype[s]));return n}(g,p,r);case"Intersect":return function(t,e,r){const n=(0,s.Create)(t,e),a=(0,i.IsObject)(n)&&(0,i.IsObject)(r)?{...n,...r}:r;return(0,o.Check)(t,e,a)?a:(0,s.Create)(t,e)}(g,p,r);case"Never":return function(t){throw new h(t,"Never types cannot be cast")}(g);case"Object":return function(t,e,i){if((0,o.Check)(t,e,i))return i;if(null===i||"object"!=typeof i)return(0,s.Create)(t,e);const r=new Set(t.required||[]),n={};for(const[s,o]of Object.entries(t.properties))(r.has(s)||void 0!==i[s])&&(n[s]=c(o,e,i[s]));if("object"==typeof t.additionalProperties){const r=Object.getOwnPropertyNames(t.properties);for(const s of Object.getOwnPropertyNames(i))r.includes(s)||(n[s]=c(t.additionalProperties,e,i[s]))}return n}(g,p,r);case"Record":return function(t,e,i){if((0,o.Check)(t,e,i))return(0,a.Clone)(i);if(null===i||"object"!=typeof i||Array.isArray(i)||i instanceof Date)return(0,s.Create)(t,e);const r=Object.getOwnPropertyNames(t.patternProperties)[0],n=t.patternProperties[r],l={};for(const[t,r]of Object.entries(i))l[t]=c(n,e,r);return l}(g,p,r);case"Ref":case"This":return function(t,e,i){return c((0,l.Deref)(t,e),e,i)}(g,p,r);case"Tuple":return function(t,e,r){return(0,o.Check)(t,e,r)?(0,a.Clone)(r):(0,i.IsArray)(r)?void 0===t.items?[]:t.items.map(((t,i)=>c(t,e,r[i]))):(0,s.Create)(t,e)}(g,p,r);case"Union":return function(t,e,i){return(0,o.Check)(t,e,i)?(0,a.Clone)(i):function(t,e,i){if("default"in t)return"function"==typeof i?t.default:(0,a.Clone)(t.default);{const r=function(t,e,i){const r=t.anyOf.map((t=>(0,l.Deref)(t,e)));let[n,s]=[r[0],0];for(const t of r){const r=d(t,e,i);r>s&&(n=t,s=r)}return n}(t,e,i);return u(r,e,i)}}(t,e,i)}(g,p,r);case"Date":case"Symbol":case"Uint8Array":return function(t,e,i){return(0,o.Check)(t,e,i)?(0,a.Clone)(i):(0,s.Create)(t,e)}(t,e,r);default:return function(t,e,i){return(0,o.Check)(t,e,i)?i:(0,s.Create)(t,e)}(g,p,r)}}function u(...t){return 3===t.length?c(t[0],t[1],t[2]):c(t[0],[],t[1])}exports.ValueCastError=h},60523:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProductItemHelper=void 0;const i=e(85725);exports.ProductItemHelper=class{constructor(t){this.item=t,this.feature=new i.MultiValueHelper(t,"feature")}getSheetType(){return this.item.getAttribute("sheet_type")}setSheetType(t){this.item.setAttribute("sheet_type",t)}getMaterial(){return this.item.getAttribute("material")}setMaterial(t){this.item.setAttribute("material",t)}getLaminate(){return this.item.getAttribute("laminate")}setLaminate(t){this.item.setAttribute("laminate",t)}getWidthMM(){return this.item.getAttribute("width_mm")}setWidthMM(t){this.item.setAttribute("width_mm",t)}getHeightMM(){return this.item.getAttribute("height_mm")}setHeightMM(t){this.item.setAttribute("height_mm",t)}getQuantity(){return this.item.getAttribute("quantity")}setQuantity(t){this.item.setAttribute("quantity",t)}getPriceMarginPercentage(){return this.item.getAttribute("price_margin_percentage")}setPriceMarginPercentage(t){this.item.setAttribute("price_margin_percentage",t)}getChanged(){return this.item.getAttribute("changed")}setChanged(t){this.item.setAttribute("changed",t)}getFigureID(){return this.item.getAttribute("figure_id")}setFigureID(t){this.item.setAttribute("figure_id",t)}getReorderID(){return this.item.getAttribute("reorder_id")}isReorder(){var t;return(null!==(t=this.getReorderID())&&void 0!==t?t:0)>0}setReorderID(t){this.item.setAttribute("reorder_id",t)}getNote(){return this.item.getAttribute("note")}setNote(t){this.item.setAttribute("note",t)}getSheetTypeSaveAs(){return this.item.getAttribute("sheet_type_save_as")||this.getSheetType()}setSheetTypeSaveAs(t){this.item.setAttribute("sheet_type_save_as",t)}getSheetName(){return this.item.getAttribute("sheet_name")}setSheetName(t){this.item.setAttribute("sheet_name",t)}getTemplateID(){return this.item.getAttribute("template_id")}setTemplateID(t){this.item.setAttribute("template_id",t)}getSize(){return this.item.getAttribute("size")}setSize(t){this.item.setAttribute("size",t)}getImperialUnits(){return this.item.getAttribute("imperial_units")}setImperialUnits(t){this.item.setAttribute("imperial_units",t)}getProductionLine(){return this.item.getAttribute("production_line")}setProductionLine(t){this.item.setAttribute("production_line",t)}getProductionInstruction(){return this.item.getAttribute("production_instruction")}setProductionInstruction(t){this.item.setAttribute("production_instruction",t)}getDelivery(){return this.item.getAttribute("delivery")}setDelivery(t){this.item.setAttribute("delivery",t)}getEpoxyTemplateID(){return this.item.getAttribute("epoxy_template_id")}setEpoxyTemplateID(t){this.item.setAttribute("epoxy_template_id",t)}getInnerCutAsKissCut(){return this.item.getAttribute("innercut_as_kisscut")}setInnerCutAsKissCut(t){this.item.setAttribute("innercut_as_kisscut",t)}getOpacityLayer(){return this.item.getAttribute("opacity_layer")}setOpacityLayer(t){this.item.setAttribute("opacity_layer",t)}getWhiteLayer(){return this.item.getAttribute("white_layer")}setWhiteLayer(t){this.item.setAttribute("white_layer",t)}getCutDirection(){return this.item.getAttribute("cut_direction")}setCutDirection(t){this.item.setAttribute("cut_direction",t)}getImageFilters(){return this.item.getAttribute("image_filters")}setImageFilters(t){this.item.setAttribute("image_filters",t)}getOutline(){return this.item.getAttribute("outline")}setOutline(t){this.item.setAttribute("outline",t)}getInk(){return this.item.getAttribute("ink")}setInk(t){this.item.setAttribute("ink",t)}getMaxSizeMM(){return this.item.getAttribute("max_size_mm")}setMaxSizeMM(t){this.item.setAttribute("max_size_mm",t)}getMinSizeMM(){return this.item.getAttribute("min_size_mm")}setMinSizeMM(t){this.item.setAttribute("min_size_mm",t)}getMaxSizeOtherSideMM(){return this.item.getAttribute("max_size_other_side_mm")}setMaxSizeOtherSideMM(t){this.item.setAttribute("max_size_other_side_mm",t)}getFixedSize(){return this.item.getAttribute("fixed_size")}setFixedSize(t){this.item.setAttribute("fixed_size",t)}getFixedQuantity(){return this.item.getAttribute("fixed_quantity")}setFixedQuantity(t){this.item.setAttribute("fixed_quantity",t)}getMarket(){return this.item.getAttribute("market")}setMarket(t){this.item.setAttribute("market",t)}getDeliveryRollSizeType(){return this.item.getAttribute("delivery_roll_size_type")}setDeliveryRollSizeType(t){this.item.setAttribute("delivery_roll_size_type",t)}getDeliveryRollSizeMM(){return this.item.getAttribute("delivery_roll_size_mm")}setDeliveryRollSizeMM(t){this.item.setAttribute("delivery_roll_size_mm",t)}getDeliveryRollTopEdgeMargin(){return this.item.getAttribute("delivery_roll_top_edge_margin")}setDeliveryRollTopEdgeMargin(t){this.item.setAttribute("delivery_roll_top_edge_margin",t)}getDeliveryRollItemMargin(){return this.item.getAttribute("delivery_roll_item_margin")}setDeliveryRollItemMargin(t){this.item.setAttribute("delivery_roll_item_margin",t)}getDeliverySheetWidth(){return this.item.getAttribute("delivery_sheet_width")}setDeliverySheetWidth(t){this.item.setAttribute("delivery_sheet_width",t)}getDeliverySheetHeight(){return this.item.getAttribute("delivery_sheet_height")}setDeliverySheetHeight(t){this.item.setAttribute("delivery_sheet_height",t)}getDeliverySheetInsidePadding(){return this.item.getAttribute("delivery_sheet_inside_padding")}setDeliverySheetInsidePadding(t){this.item.setAttribute("delivery_sheet_inside_padding",t)}getDeliverySheetOutsidePadding(){return this.item.getAttribute("delivery_sheet_outside_padding")}setDeliverySheetOutsidePadding(t){this.item.setAttribute("delivery_sheet_outside_padding",t)}getEffectLayerFileName(){return this.item.getAttribute("effect_layer_file_name")}setEffectLayerFileName(t){this.item.setAttribute("effect_layer_file_name",t)}getEffectLayerFileAppID(){return this.item.getAttribute("effect_layer_upload_fileapp_id")}setEffectLayerFileAppID(t){this.item.setAttribute("effect_layer_upload_fileapp_id",t)}getLivePreviewOpacityMask(){return this.item.getAttribute("live_preview_opacity_mask")}setLivePreviewOpacityMask(t){this.item.setAttribute("live_preview_opacity_mask",t)}getLivePreviewWhiteLayerMask(){return this.item.getAttribute("live_preview_white_layer_mask")}setLivePreviewWhiteLayerMask(t){this.item.setAttribute("live_preview_white_layer_mask",t)}isCustomizableSheet(){return["sheet","sheet_kiss_cut"].includes(this.item.getProductName())}isLabelSheet(){return"sheet_legacy"===this.item.getProductName()}isProductLabelsOnRoll(){return"labels_on_roll"===this.item.getProductName()}isCustomStickerFamily(){return"custom_sticker"===this.item.getProductFamilyName()}}},60585:(t,exports)=>{"use strict";function e(t){return null!==t&&"object"==typeof t}function i(t){return Array.isArray(t)&&!ArrayBuffer.isView(t)}function r(t){return void 0===t}function n(t){return null===t}function s(t){return"boolean"==typeof t}function o(t){return"number"==typeof t}function a(t){return"bigint"==typeof t}function l(t){return"string"==typeof t}function h(t){return"function"==typeof t}function d(t){return"symbol"==typeof t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.IsAsyncIterator=function(t){return e(t)&&Symbol.asyncIterator in t},exports.IsIterator=function(t){return e(t)&&Symbol.iterator in t},exports.IsStandardObject=function(t){return e(t)&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))},exports.IsInstanceObject=function(t){return e(t)&&!i(t)&&h(t.constructor)&&"Object"!==t.constructor.name},exports.IsPromise=function(t){return t instanceof Promise},exports.IsDate=function(t){return t instanceof Date&&Number.isFinite(t.getTime())},exports.IsMap=function(t){return t instanceof globalThis.Map},exports.IsSet=function(t){return t instanceof globalThis.Set},exports.IsRegExp=function(t){return t instanceof globalThis.RegExp},exports.IsTypedArray=function(t){return ArrayBuffer.isView(t)},exports.IsInt8Array=function(t){return t instanceof globalThis.Int8Array},exports.IsUint8Array=function(t){return t instanceof globalThis.Uint8Array},exports.IsUint8ClampedArray=function(t){return t instanceof globalThis.Uint8ClampedArray},exports.IsInt16Array=function(t){return t instanceof globalThis.Int16Array},exports.IsUint16Array=function(t){return t instanceof globalThis.Uint16Array},exports.IsInt32Array=function(t){return t instanceof globalThis.Int32Array},exports.IsUint32Array=function(t){return t instanceof globalThis.Uint32Array},exports.IsFloat32Array=function(t){return t instanceof globalThis.Float32Array},exports.IsFloat64Array=function(t){return t instanceof globalThis.Float64Array},exports.IsBigInt64Array=function(t){return t instanceof globalThis.BigInt64Array},exports.IsBigUint64Array=function(t){return t instanceof globalThis.BigUint64Array},exports.HasPropertyKey=function(t,e){return e in t},exports.IsObject=e,exports.IsArray=i,exports.IsUndefined=r,exports.IsNull=n,exports.IsBoolean=s,exports.IsNumber=o,exports.IsInteger=function(t){return Number.isInteger(t)},exports.IsBigInt=a,exports.IsString=l,exports.IsFunction=h,exports.IsSymbol=d,exports.IsValueType=function(t){return a(t)||s(t)||n(t)||o(t)||l(t)||d(t)||r(t)}},61198:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(56791),exports),r(e(82415),exports),r(e(4195),exports),r(e(95421),exports),r(e(78876),exports),r(e(94641),exports),r(e(47660),exports)},61359:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(98493),exports),r(e(22557),exports),r(e(28222),exports)},61417:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Equal=function t(e,r){if((0,i.IsDate)(e))return function(t,e){return(0,i.IsDate)(e)&&t.getTime()===e.getTime()}(e,r);if((0,i.IsTypedArray)(e))return function(e,r){return!(!(0,i.IsTypedArray)(r)||e.length!==r.length||Object.getPrototypeOf(e).constructor.name!==Object.getPrototypeOf(r).constructor.name)&&e.every(((e,i)=>t(e,r[i])))}(e,r);if((0,i.IsArray)(e))return function(e,r){return!(!(0,i.IsArray)(r)||e.length!==r.length)&&e.every(((e,i)=>t(e,r[i])))}(e,r);if((0,i.IsObject)(e))return function(e,r){if(!(0,i.IsObject)(r))return!1;const n=[...Object.keys(e),...Object.getOwnPropertySymbols(e)],s=[...Object.keys(r),...Object.getOwnPropertySymbols(r)];return n.length===s.length&&n.every((i=>t(e[i],r[i])))}(e,r);if((0,i.IsValueType)(e))return function(t,e){return t===e}(e,r);throw new Error("ValueEquals: Unable to compare value")};const i=e(79968)},61603:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OutOfStockProcessor=void 0,exports.OutOfStockProcessor=class{invoke(t,e){const i={};if(t.getAttributes())for(const[r,n]of Object.entries(t.getAttributes())){const t=null==n?void 0:n.toString();t&&e.isOutOfStock(r,t)&&(i[r]=t)}i&&t.setAttribute("outOfStock",i)}}},62154:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(28288),exports)},62413:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(94401),exports)},62700:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(28790),exports)},62946:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BigInt=function(t){return(0,r.CreateType)({[i.Kind]:"BigInt",type:"bigint"},t)};const i=e(73967),r=e(10034)},63317:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(62946),exports)},63800:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConditionBuilder=void 0;const i=e(89027),r=e(23930),n=e(64985);class s{constructor(t={conditions:[]},e=t=>t){var i,n,s;this.conditions=[],this.baseComplexityScore=0,this.relationMode=null!==(i=t.relationMode)&&void 0!==i?i:r.ConditionRelations.AND,this.baseComplexityScore=null!==(n=t.baseComplexityScore)&&void 0!==n?n:0;for(const i of null!==(s=t.conditions)&&void 0!==s?s:[])"operator"in i?this.addCondition(i,e):this.addSubGroup(i,e)}calculateComplexityScore(){let t=this.baseComplexityScore;this.relationMode==r.ConditionRelations.AND&&this.count()>=2&&(t+=5);for(const e of Object.values(this.conditions))e instanceof s?(t+=100,t+=e.calculateComplexityScore()):t+=10;return t}count(){return Object.keys(this.conditions).length}addSubGroup(t={conditions:[]},e=t=>t){const i=new s(t,e);return this.conditions.push(i),i}addCondition(t,e=t=>t){return this.conditions.push(new i.Condition(t,e)),this}test(t){let e;for(const i of Object.values(this.conditions)){let s=null;try{s=i.test(t)}catch(t){if(!(t instanceof n.ConditionTestDataKeyNotFoundException))throw t;e=t}if(null!==s)switch(this.relationMode){case r.ConditionRelations.AND:if(!1===s)return!1;break;case r.ConditionRelations.OR:if(!0===s)return!0}}if(e)throw e;return!(this.relationMode==r.ConditionRelations.OR&&this.count()>0)}getBaseComplexityScore(){return this.baseComplexityScore}setBaseComplexityScore(t){return this.baseComplexityScore=t,this}getConditions(){return this.conditions}toString(){const t=this.relationMode===r.ConditionRelations.OR?"||":"&&";return Object.values(this.conditions).map((t=>t instanceof s?`(${t})`:`${t}`)).join(` ${t} `)}}exports.ConditionBuilder=s},64430:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Type=exports.JavaScriptTypeBuilder=exports.JsonTypeBuilder=void 0;var i=e(87814);Object.defineProperty(exports,"JsonTypeBuilder",{enumerable:!0,get:function(){return i.JsonTypeBuilder}});const r=e(40844),n=e(84559);Object.defineProperty(exports,"JavaScriptTypeBuilder",{enumerable:!0,get:function(){return n.JavaScriptTypeBuilder}});const s=r;exports.Type=s},64434:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Integer=function(t){return(0,i.CreateType)({[r.Kind]:"Integer",type:"integer"},t)};const i=e(30768),r=e(73967)},64586:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TransformEncodeBuilder=exports.TransformDecodeBuilder=void 0,exports.Transform=function(t){return new n(t)};const i=e(73967),r=e(51049);class n{constructor(t){this.schema=t}Decode(t){return new s(this.schema,t)}}exports.TransformDecodeBuilder=n;class s{constructor(t,e){this.schema=t,this.decode=e}EncodeTransform(t,e){const r={Encode:r=>e[i.TransformKind].Encode(t(r)),Decode:t=>this.decode(e[i.TransformKind].Decode(t))};return{...e,[i.TransformKind]:r}}EncodeSchema(t,e){const r={Decode:this.decode,Encode:t};return{...e,[i.TransformKind]:r}}Encode(t){return(0,r.IsTransform)(this.schema)?this.EncodeTransform(t,this.schema):this.EncodeSchema(t,this.schema)}}exports.TransformEncodeBuilder=s},64833:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IntrinsicFromMappedKey=function(t,e,r){const n=function(t,e,i){return function(t,e,i){return t.reduce(((t,r)=>({...t,...o(r,e,i)})),{})}(t.keys,e,i)}(t,e,r);return(0,i.MappedResult)(n)};const i=e(34013),r=e(786),n=e(12881),s=e(19922);function o(t,e,i){return{[t]:(0,r.Intrinsic)((0,n.Literal)(t),e,(0,s.Clone)(i))}}},64873:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(18146),exports)},64895:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(48109),exports)},64985:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConditionTestDataKeyNotFoundException=void 0;class e extends Error{constructor(t){super(t),this.name="ConditionTestDataKeyNotFoundException"}}exports.ConditionTestDataKeyNotFoundException=e},65286:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Constructor=function(t,e,n){return(0,i.CreateType)({[r.Kind]:"Constructor",type:"Constructor",parameters:t,returns:e},n)};const i=e(30768),r=e(73967)},65495:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(72218),exports),r(e(99899),exports),r(e(18274),exports)},65924:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(28640),exports)},66252:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Date=function(t){return(0,r.CreateType)({[i.Kind]:"Date",type:"Date"},t)};const i=e(73967),r=e(30768)},67092:(t,exports)=>{"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RateProviderType=void 0,function(t){t.RATE_LIST="rate-list",t.RATE_FUNCTION="rate-function"}(e||(exports.RateProviderType=e={}))},67241:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExtendsFromMappedResult=function(t,e,s,o,a){const l=function(t,e,i,s,o){return function(t,e,i,s,o){const a={};for(const l of globalThis.Object.getOwnPropertyNames(t))a[l]=(0,r.Extends)(t[l],e,i,s,(0,n.Clone)(o));return a}(t.properties,e,i,s,o)}(t,e,s,o,a);return(0,i.MappedResult)(l)};const i=e(34013),r=e(12586),n=e(19922)},67272:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},67387:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SizeProcessor=void 0;class e{constructor(t){this.sizeHelper=t,this.lastEvaluation="",this.name=e.name}invoke(t,e){this.sizeHelper.evaluate();const i=this.sizeHelper.toString();if(this.lastEvaluation!=i){this.lastEvaluation=i;let r=this.sizeHelper.width.mm,n=this.sizeHelper.height.mm;if(this.sizeHelper.fixedSize){let i=!1;const s=e.getSuggestedValues("size");let o=null,a=null;const l=[];for(const t in s){const e=s[t],h=this.sizeHelper.extractMeassuresFromString(e);a||(a=h,o=e);const d=this.sizeHelper.localizedToMM(h.width),c=this.sizeHelper.localizedToMM(h.height);if(l[t]=[d,c],r==d&&c==n){i=!0;break}}if(!i&&a&&o){const e=this.findClosestMatch(l,r,n);(null==e?void 0:e.distance)&&e.distance<1.5?t.setAttribute("size",String(e.index)):(t.setAttribute("size",o),r=this.sizeHelper.setMeasureAttrLocalized("width_mm",a.width),n=this.sizeHelper.setMeasureAttrLocalized("height_mm",a.height))}}const s=Math.max(r,n),o=Math.min(r,n);if(this.sizeHelper.hasMaxSizeOtherSide()&&[s,o].every((t=>t>this.sizeHelper.maxSizeOtherSide.mm))){const t=o/this.sizeHelper.maxSizeOtherSide.mm;this.sizeHelper.setMeasureAttrInMM("width_mm",r/t),this.sizeHelper.setMeasureAttrInMM("height_mm",n/t)}else if(s>this.sizeHelper.maxSize.mm){const t=s/this.sizeHelper.maxSize.mm;this.sizeHelper.setMeasureAttrInMM("width_mm",r/t),this.sizeHelper.setMeasureAttrInMM("height_mm",n/t)}else if(o<this.sizeHelper.minSize.mm){const t=this.sizeHelper.minSize.mm/o;this.sizeHelper.setMeasureAttrInMM("width_mm",r*t),this.sizeHelper.setMeasureAttrInMM("height_mm",n*t)}}}findClosestMatch(t,e,i){let r=null,n=Number.MAX_SAFE_INTEGER;for(let s=0;s<t.length;s++){const o=Math.abs(e-t[s][0])+Math.abs(i-t[s][1]);o<n&&(n=o,r={index:s,distance:o})}return r}}exports.SizeProcessor=e},67574:(t,exports)=>{"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConditionOperators=void 0,function(t){t.EQUAL="===",t.NOT_EQUAL="!==",t.LESS_THAN="<",t.GREATER_THAN=">",t.LESS_THAN_OR_EQUAL="<=",t.GREATER_THAN_OR_EQUAL=">=",t.IN="IN",t.NOT_IN="NOT_IN",t.IS_EMPTY="IS_EMPTY",t.IS_NOT_EMPTY="IS_NOT_EMPTY"}(e||(exports.ConditionOperators=e={}))},68490:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),e(73967)},68505:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProductContext=void 0;const i=e(51758),r=e(36595),n=e(52667),s=e(16006),o=e(92153),a=e(21075),l=e(19898);exports.ProductContext=class{constructor(){this.processors=new i.ProductProcessorsCollection,this.sku="",this.productItem=new n.ProductItem("",""),this.attrEvaluator=new o.ProductAttrConditionEvaluator,this.attrComputer=new s.ProductAttrComputer(this.attrEvaluator),this.cherryPicks=new a.CherryPickHelper(this.attrComputer,{}),this.processors.registerProcessor(r.ProductProcessorsEnum.ATTR_VALUE_PARSER,new l.AttributeValueParserProcessor(this.cherryPicks))}reset(t,e,i=!1){this.productItem.reset(t),this.attrComputer.reset(e),this.attrEvaluator.reset(e),i||this.cherryPicks.reset(),this.sku=t.sku}getSKU(){return this.sku}invokeProcessors(){this.processors.invokeProcessors(this.productItem,this.attrComputer)}setCherryPicks(t,e=!1){this.cherryPicks.setAttributes(t),e&&this.attrComputer.setPreferredValues(JSON.parse(JSON.stringify(t)))}}},68696:(t,exports)=>{"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RateProviderType=void 0,function(t){t.RATE_LIST="rate-list",t.RATE_FUNCTION="rate-function"}(e||(exports.RateProviderType=e={}))},69038:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(57996),exports)},69864:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SizeConverter=void 0;const i=e(84985);exports.SizeConverter=class{constructor(t,e=0){this.item=t,this.mm=e}get inches(){return(0,i.convertMMToInches)(this.mm)}get cm(){return(0,i.convertMMToCM)(this.mm)}get px(){return(0,i.convertMMToPX)(this.mm)}get localized(){var t;return"true"===(null===(t=this.item.getAttribute("imperial_units"))||void 0===t?void 0:t.toString())?this.inches:this.cm}toObject(){return{mm:this.mm,inches:this.inches,cm:this.cm,px:this.px,localized:this.localized}}}},71032:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConditionTestFailedException=void 0;class e extends Error{constructor(t){super(t),this.name="ConditionTestFailedException"}}exports.ConditionTestFailedException=e},71283:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TransformHelper=void 0,exports.TransformHelper=class{constructor(t){this.size=t}evaluateScale(t,e){const i=Math.max(...e),r=Math.min(...e);return e=e.map((e=>e*t)),this.areDimensionsValid("min_size_mm",e)?this.size.hasMaxSizeOtherSide()&&!this.areDimensionsValid("max_size_other_side_mm",e)&&i/r<this.size.maxSize.mm/this.size.maxSizeOtherSide.mm?this.size.maxSizeOtherSide.mm/r:this.areDimensionsValid("max_size_mm",e)?t:this.size.maxSize.mm/i:this.size.minSize.mm/r}areDimensionsValid(t,e){switch(t){case"min_size_mm":return!e.some((t=>t<this.size.minSize.mm));case"max_size_other_side_mm":return!e.every((t=>t>this.size.maxSizeOtherSide.mm));case"max_size_mm":return!e.some((t=>t>this.size.maxSize.mm));default:return!1}}}},71354:t=>{"use strict";t.exports=function(t){var e=t[1],i=t[3];if(!i)return e;if("function"==typeof btoa){var r=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),s="/*# ".concat(n," */");return[e].concat([s]).join("\n")}return[e].join("\n")}},71508:t=>{function e(t){var i,r,n="";if("string"==typeof t||"number"==typeof t)n+=t;else if("object"==typeof t)if(Array.isArray(t)){var s=t.length;for(i=0;i<s;i++)t[i]&&(r=e(t[i]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function i(){for(var t,i,r=0,n="",s=arguments.length;r<s;r++)(t=arguments[r])&&(i=e(t))&&(n&&(n+=" "),n+=i);return n}t.exports=i,t.exports.clsx=i},71571:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TransformEncodeError=exports.TransformEncodeCheckError=void 0,exports.TransformEncode=function(t,e,i){return p(t,e,"",i)};const i=e(26076),r=e(73967),n=e(87580),s=e(39260),o=e(62413),a=e(97069),l=e(79968),h=e(4443);class d extends n.TypeBoxError{constructor(t,e,i){super("The encoded value does not match the expected schema"),this.schema=t,this.value=e,this.error=i}}exports.TransformEncodeCheckError=d;class c extends n.TypeBoxError{constructor(t,e,i,r){super(`${r instanceof Error?r.message:"Unknown error"}`),this.schema=t,this.path=e,this.value=i,this.error=r}}function u(t,e,i){try{return(0,h.IsTransform)(t)?t[r.TransformKind].Encode(i):i}catch(r){throw new c(t,e,i,r)}}function p(t,e,n,d){const c=(0,o.Pushref)(t,e),g=t;switch(t[r.Kind]){case"Array":return function(t,e,i,r){const n=u(t,i,r);return(0,l.IsArray)(n)?n.map(((r,n)=>p(t.items,e,`${i}/${n}`,r))):n}(g,c,n,d);case"Intersect":return function(t,e,i,r){const n=u(t,i,r);if(!(0,l.IsObject)(r)||(0,l.IsValueType)(r))return n;const o=(0,s.KeyOfPropertyEntries)(t),a=o.map((t=>t[0])),d={...n};for(const[t,r]of o)t in d&&(d[t]=p(r,e,`${i}/${t}`,d[t]));if(!(0,h.IsTransform)(t.unevaluatedProperties))return d;const c=Object.getOwnPropertyNames(d),g=t.unevaluatedProperties,m={...d};for(const t of c)a.includes(t)||(m[t]=u(g,`${i}/${t}`,m[t]));return m}(g,c,n,d);case"Not":return function(t,e,i,r){return u(t.not,i,u(t,i,r))}(g,0,n,d);case"Object":return function(t,e,r,n){const o=u(t,r,n);if(!(0,l.IsObject)(o))return o;const a=(0,s.KeyOfPropertyKeys)(t),d={...o};for(const n of a)(0,l.HasPropertyKey)(d,n)&&(!(0,l.IsUndefined)(d[n])||(0,h.IsUndefined)(t.properties[n])&&!i.TypeSystemPolicy.IsExactOptionalProperty(d,n))&&(d[n]=p(t.properties[n],e,`${r}/${n}`,d[n]));if(!(0,h.IsSchema)(t.additionalProperties))return d;const c=Object.getOwnPropertyNames(d),g=t.additionalProperties,m={...d};for(const t of c)a.includes(t)||(m[t]=u(g,`${r}/${t}`,m[t]));return m}(g,c,n,d);case"Record":return function(t,e,i,r){const n=u(t,i,r);if(!(0,l.IsObject)(r))return n;const s=Object.getOwnPropertyNames(t.patternProperties)[0],o=new RegExp(s),a={...n};for(const n of Object.getOwnPropertyNames(r))o.test(n)&&(a[n]=p(t.patternProperties[s],e,`${i}/${n}`,a[n]));if(!(0,h.IsSchema)(t.additionalProperties))return a;const d=Object.getOwnPropertyNames(a),c=t.additionalProperties,g={...a};for(const t of d)o.test(t)||(g[t]=u(c,`${i}/${t}`,g[t]));return g}(g,c,n,d);case"Ref":case"This":return function(t,e,i,r){return u(t,i,p((0,o.Deref)(t,e),e,i,r))}(g,c,n,d);case"Tuple":return function(t,e,i,r){const n=u(t,i,r);return(0,l.IsArray)(t.items)?t.items.map(((t,r)=>p(t,e,`${i}/${r}`,n[r]))):[]}(g,c,n,d);case"Union":return function(t,e,i,r){for(const n of t.anyOf)if((0,a.Check)(n,e,r))return u(t,i,p(n,e,i,r));for(const n of t.anyOf){const s=p(n,e,i,r);if((0,a.Check)(t,e,s))return u(t,i,s)}return u(t,i,r)}(g,c,n,d);default:return u(g,n,d)}}exports.TransformEncodeError=c},71927:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(31410),exports)},71948:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConditionTestFailedException=void 0;class e extends Error{constructor(t){super(t),this.name="ConditionTestFailedException"}}exports.ConditionTestFailedException=e},72218:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IntersectEvaluated=function(t,e={}){if(0===t.length)return(0,s.Never)(e);if(1===t.length)return(0,r.CreateType)(t[0],e);if(t.some((t=>(0,l.IsTransform)(t))))throw new Error("Cannot intersect transform types");return function(t,e){return function(t){return t.every((t=>(0,l.IsOptional)(t)))}(t)?(0,o.Optional)((0,a.IntersectCreate)(h(t),e)):(0,a.IntersectCreate)(h(t),e)}(t,e)};const i=e(73967),r=e(30768),n=e(940),s=e(72492),o=e(27822),a=e(3807),l=e(51049);function h(t){return t.map((t=>(0,l.IsOptional)(t)?function(t){return(0,n.Discard)(t,[i.OptionalKind])}(t):t))}},72441:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DeliveryRollProcessor=void 0;const i=e(90728);exports.DeliveryRollProcessor=class{invoke(t,e){const r=new i.DeliveryRollHelper(t),n=t.getAttribute("delivery"),s=t.getAttribute("delivery_roll_item_margin"),o=t.getAttribute("delivery_roll_top_edge_margin"),a=t.getAttribute("delivery_roll_size_mm");if("roll"==n){let n;n=!this.isValidAndPositive(o)||Number(o)<i.DeliveryRollHelper.MIN_TOP_MARGIN?i.DeliveryRollHelper.MIN_TOP_MARGIN:Number(o)>=r.getTopMarginMax()&&r.getTopMarginMax()>=i.DeliveryRollHelper.MIN_TOP_MARGIN?r.getTopMarginMax():Number(Number(o).toFixed(1)),t.setAttribute("delivery_roll_top_edge_margin",n),r.isSizeTypeValid()||(t.setAttribute("delivery_roll_size_type",r.getSuitableSize()),t.setAttribute("delivery_roll_top_edge_margin",r.getTopMarginMid()),e.evaluate(t)),this.isValidAndPositive(a)||t.setAttribute("delivery_roll_size_mm",i.DeliveryRollHelper.DEFAULT_INNER_ROLL_SIZE),(!this.isValidAndPositive(s)||Number(s)<i.DeliveryRollHelper.MIN_ITEM_MARGIN)&&t.setAttribute("delivery_roll_item_margin",i.DeliveryRollHelper.MIN_ITEM_MARGIN)}}isValidAndPositive(t){return this.isValid(t)&&this.isPositive(t)}isValid(t){return!isNaN(Number(t))}isPositive(t){return Number(t)>0}}},72492:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(83726),exports)},72577:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DeliverySheetSizeHelper=void 0;class e{constructor(t){this.productItem=t}minimizeWidth(){var t;const e=null!==(t=this.productItem.getAttribute("width_mm"))&&void 0!==t?t:0,i=Math.floor(this.sheetWidth/(this.insidePadding+e+this.insidePadding))*(this.insidePadding+e+this.insidePadding)+2+this.outsidePadding+this.outsidePadding;this.productItem.setAttribute("delivery_sheet_width",i)}minimizeHeight(){var t;const e=null!==(t=this.productItem.getAttribute("height_mm"))&&void 0!==t?t:0,i=Math.floor(this.sheetHeight/(this.insidePadding+e+this.insidePadding))*(this.insidePadding+e+this.insidePadding)+2+this.outsidePadding+this.outsidePadding;this.productItem.setAttribute("delivery_sheet_height",i)}setDefaultValues(){this.productItem.setAttribute("delivery_sheet_width",e.WIDTH_DEFAULT),this.productItem.setAttribute("delivery_sheet_height",e.HEIGHT_DEFAULT),this.productItem.setAttribute("delivery_sheet_inside_padding",e.INSIDE_PADDING_DEFAULT),this.productItem.setAttribute("delivery_sheet_outside_padding",e.OUTSIDE_PADDING_DEFAULT)}get sheetHeight(){return this.toFixedInt(this.productItem.getAttribute("delivery_sheet_height"))}get sheetWidth(){return this.toFixedInt(this.productItem.getAttribute("delivery_sheet_width"))}get insidePadding(){return this.toFixedInt(this.productItem.getAttribute("delivery_sheet_inside_padding"))}get outsidePadding(){return this.toFixedInt(this.productItem.getAttribute("delivery_sheet_outside_padding"))}toFixedInt(t){const e=parseInt(Number(t).toFixed(0));return isNaN(e)?0:e}}exports.DeliverySheetSizeHelper=e,e.WIDTH_DEFAULT=204,e.HEIGHT_DEFAULT=270,e.WIDTH_MINIMUM=25,e.HEIGHT_MINIMUM=25,e.INSIDE_PADDING_DEFAULT=2,e.OUTSIDE_PADDING_DEFAULT=0},72823:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SizeProcessor=void 0;class e{constructor(t){this.sizeHelper=t,this.lastEvaluation="",this.name=e.name}invoke(t,e){this.sizeHelper.evaluate();const i=this.sizeHelper.toString();if(this.lastEvaluation!=i){this.lastEvaluation=i;let r=this.sizeHelper.width.mm,n=this.sizeHelper.height.mm;if(this.sizeHelper.fixedSize){let i=!1;const s=e.getSuggestedValues("size");let o=null,a=null;const l=[];for(const t in s){const e=s[t],h=this.sizeHelper.extractMeassuresFromString(e);a||(a=h,o=e);const d=this.sizeHelper.localizedToMM(h.width),c=this.sizeHelper.localizedToMM(h.height);if(l[t]=[d,c],r==d&&c==n){i=!0;break}}if(!i&&a&&o){const e=this.findClosestMatch(l,r,n);(null==e?void 0:e.distance)&&e.distance<1.5?t.setAttribute("size",String(e.index)):(t.setAttribute("size",o),r=this.sizeHelper.setMeasureAttrLocalized("width_mm",a.width),n=this.sizeHelper.setMeasureAttrLocalized("height_mm",a.height))}}const s=Math.max(r,n),o=Math.min(r,n);if(this.sizeHelper.hasMaxSizeOtherSide()&&[s,o].every((t=>t>this.sizeHelper.maxSizeOtherSide.mm))){const t=o/this.sizeHelper.maxSizeOtherSide.mm;this.sizeHelper.setMeasureAttrInMM("width_mm",r/t),this.sizeHelper.setMeasureAttrInMM("height_mm",n/t)}else if(s>this.sizeHelper.maxSize.mm){const t=s/this.sizeHelper.maxSize.mm;this.sizeHelper.setMeasureAttrInMM("width_mm",r/t),this.sizeHelper.setMeasureAttrInMM("height_mm",n/t)}else if(o<this.sizeHelper.minSize.mm){const t=this.sizeHelper.minSize.mm/o;this.sizeHelper.setMeasureAttrInMM("width_mm",r*t),this.sizeHelper.setMeasureAttrInMM("height_mm",n*t)}}}findClosestMatch(t,e,i){let r=null,n=Number.MAX_SAFE_INTEGER;for(let s=0;s<t.length;s++){const o=Math.abs(e-t[s][0])+Math.abs(i-t[s][1]);o<n&&(n=o,r={index:s,distance:o})}return r}}exports.SizeProcessor=e},72862:(t,exports)=>{"use strict";function e(t){return Array.isArray(t)}function i(t){return"object"==typeof t&&null!==t}function r(t){return t instanceof globalThis.Uint8Array}Object.defineProperty(exports,"__esModule",{value:!0}),exports.HasPropertyKey=function(t,e){return e in t},exports.IsAsyncIterator=function(t){return i(t)&&!e(t)&&!r(t)&&Symbol.asyncIterator in t},exports.IsArray=e,exports.IsBigInt=function(t){return"bigint"==typeof t},exports.IsBoolean=function(t){return"boolean"==typeof t},exports.IsDate=function(t){return t instanceof globalThis.Date},exports.IsFunction=function(t){return"function"==typeof t},exports.IsIterator=function(t){return i(t)&&!e(t)&&!r(t)&&Symbol.iterator in t},exports.IsNull=function(t){return null===t},exports.IsNumber=function(t){return"number"==typeof t},exports.IsObject=i,exports.IsRegExp=function(t){return t instanceof globalThis.RegExp},exports.IsString=function(t){return"string"==typeof t},exports.IsSymbol=function(t){return"symbol"==typeof t},exports.IsUint8Array=r,exports.IsUndefined=function(t){return void 0===t}},72915:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AutoPickAttrProcessor=void 0,exports.AutoPickAttrProcessor=class{constructor(t,e,i,r){this.autoOptDefaultValue=t,this.cherryPicks=e,this.ignoreAttributeFromAutoPickerCallback=i,this.isAttributeRequiredCallback=r}invoke(t,e){let i=!0,r=0;for(;i&&(r++,e.evaluate(t),i=this.autoPickAttributes(t,e),!(r>=5)););for(i=!0,r=0;i&&(r++,e.evaluate(t),i=this.tryAutoPickFromCherries(t,e),!(r>=5)););return!i&&1==r}autoPickAttributes(t,e){const i=this.getAttributesAsString(t);for(const i in e.getAttributes()){if(this.ignoreAttributeFromAutoPickerCallback(i))continue;const r=null==t?void 0:t.getAttribute(i);if(r||this.isAttributeRequiredCallback(i)){const n=this.cherryPicks.getAttribute(i);this.autoPick(t,e,i,r,n)}}return i!=this.getAttributesAsString(t)}tryAutoPickFromCherries(t,e){const i=this.getAttributesAsString(t);for(const i in e.getAttributes())if(this.cherryPicks.hasAttribute(i)){const r=this.cherryPicks.getAttribute(i),n=null==t?void 0:t.getAttribute(i);n&&n==r||this.autoPick(t,e,i,n,r)}return i!=this.getAttributesAsString(t)}autoPick(t,e,i,r,n){if(null==e?void 0:e.isMultiValue(i)){Array.isArray(r)||(r=[r]);let s=r.filter((t=>e.isAvailable(i,t)));n&&(n=n.filter((t=>e.isAvailable(i,t)&&s.indexOf(t)<0)),s=[...s,...n]),this.cherryPicks.maybeRegisterALost(i,s),null==t||t.setAttribute(i,s)}else{const s=e.getDefaultValue(i);let o=null==r&&!this.isAttributeRequiredCallback(i)||e.isAvailable(i,r)?r:s;!o&&e.isDynamicValue(i)&&s&&(o=s),n&&e.isAvailable(i,n)&&!e.isDynamicValue(i)&&(o=n),this.cherryPicks.maybeRegisterALost(i,o),t.setAttribute(i,o)}}shouldAutoOptForDefaultValue(t){return this.autoOptDefaultValue.indexOf(t)>=0}getAttributesAsString(t){return Object.entries(t.getAttributes()).map((([t,e])=>`|${t}:${e}|`)).join("")}}},73778:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProductProcessorsCollection=void 0,exports.ProductProcessorsCollection=class{constructor(){this.processors=new Map}invokeProcessors(t,e){this.processors.forEach(((i,r)=>{i(t,e)}))}registerProcessor(t,e){if(this.processors.has(t.valueOf()))throw Error(`Processor with id ${t} already exists.`);"invoke"in e?this.processors.set(t.valueOf(),((t,i)=>e.invoke(t,i))):this.processors.set(t.valueOf(),e)}unregisterProcessor(t){return!!this.processors.has(t.valueOf())&&this.processors.delete(t.valueOf())}}},73842:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Extract=function(t,e,h){return(0,l.IsTemplateLiteral)(t)?(0,i.CreateType)((0,a.ExtractFromTemplateLiteral)(t,e),h):(0,l.IsMappedResult)(t)?(0,i.CreateType)((0,o.ExtractFromMappedResult)(t,e),h):(0,i.CreateType)((0,l.IsUnion)(t)?function(t,e){const i=t.filter((t=>(0,s.ExtendsCheck)(t,e)!==s.ExtendsResult.False));return 1===i.length?i[0]:(0,r.Union)(i)}(t.anyOf,e):(0,s.ExtendsCheck)(t,e)!==s.ExtendsResult.False?t:(0,n.Never)(),h)};const i=e(30768),r=e(85713),n=e(72492),s=e(35595),o=e(56145),a=e(87352),l=e(51049)},73967:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(93714),exports)},74118:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(49250),exports)},74703:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OutOfStockProcessor=void 0,exports.OutOfStockProcessor=class{invoke(t,e){const i={};if(t.getAttributes())for(const[r,n]of Object.entries(t.getAttributes())){const t=null==n?void 0:n.toString();t&&e.isOutOfStock(r,t)&&(i[r]=t)}i&&t.setAttribute("outOfStock",i)}}},75097:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExtendsFromMappedKey=function(t,e,r,n,s){const a=function(t,e,i,r,n){return function(t,e,i,r,n){return t.reduce(((t,s)=>({...t,...o(s,e,i,r,n)})),{})}(t.keys,e,i,r,n)}(t,e,r,n,s);return(0,i.MappedResult)(a)};const i=e(34013),r=e(12881),n=e(12586),s=e(19922);function o(t,e,i,o,a){return{[t]:(0,n.Extends)((0,r.Literal)(t),e,i,o,(0,s.Clone)(a))}}},75933:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(23010),exports)},76166:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Discard=function(t,e){return e.reduce(((t,e)=>function(t,e){const{[e]:i,...r}=t;return r}(t,e)),t)}},76221:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProductContext=void 0;const i=e(73778),r=e(1039),n=e(50247),s=e(44930),o=e(77837),a=e(56767),l=e(43902);exports.ProductContext=class{constructor(){this.processors=new i.ProductProcessorsCollection,this.sku="",this.productItem=new n.ProductItem("",""),this.attrEvaluator=new o.ProductAttrConditionEvaluator,this.attrComputer=new s.ProductAttrComputer(this.attrEvaluator),this.cherryPicks=new a.CherryPickHelper(this.attrComputer,{}),this.processors.registerProcessor(r.ProductProcessorsEnum.ATTR_VALUE_PARSER,new l.AttributeValueParserProcessor(this.cherryPicks))}reset(t,e,i=!1){this.productItem.reset(t),this.attrComputer.reset(e),this.attrEvaluator.reset(e),i||this.cherryPicks.reset(),this.sku=t.sku}getSKU(){return this.sku}invokeProcessors(){this.processors.invokeProcessors(this.productItem,this.attrComputer)}setCherryPicks(t,e=!1){this.cherryPicks.setAttributes(t),e&&this.attrComputer.setPreferredValues(JSON.parse(JSON.stringify(t)))}}},76314:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i="",r=void 0!==e[5];return e[4]&&(i+="@supports (".concat(e[4],") {")),e[2]&&(i+="@media ".concat(e[2]," {")),r&&(i+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),i+=t(e),r&&(i+="}"),e[2]&&(i+="}"),e[4]&&(i+="}"),i})).join("")},e.i=function(t,i,r,n,s){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(r)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(o[l]=!0)}for(var h=0;h<t.length;h++){var d=[].concat(t[h]);r&&o[d[0]]||(void 0!==s&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=s),i&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=i):d[2]=i),n&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=n):d[4]="".concat(n)),e.push(d))}},e}},76503:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TransformDecodeError=exports.TransformDecodeCheckError=void 0,exports.TransformDecode=function(t,e,i){return p(t,e,"",i)};const i=e(26076),r=e(73967),n=e(87580),s=e(39260),o=e(62413),a=e(97069),l=e(79968),h=e(4443);class d extends n.TypeBoxError{constructor(t,e,i){super("Unable to decode value as it does not match the expected schema"),this.schema=t,this.value=e,this.error=i}}exports.TransformDecodeCheckError=d;class c extends n.TypeBoxError{constructor(t,e,i,r){super(r instanceof Error?r.message:"Unknown error"),this.schema=t,this.path=e,this.value=i,this.error=r}}function u(t,e,i){try{return(0,h.IsTransform)(t)?t[r.TransformKind].Decode(i):i}catch(r){throw new c(t,e,i,r)}}function p(t,e,n,d){const c=(0,o.Pushref)(t,e),g=t;switch(t[r.Kind]){case"Array":return function(t,e,i,r){return(0,l.IsArray)(r)?u(t,i,r.map(((r,n)=>p(t.items,e,`${i}/${n}`,r)))):u(t,i,r)}(g,c,n,d);case"Intersect":return function(t,e,i,r){if(!(0,l.IsObject)(r)||(0,l.IsValueType)(r))return u(t,i,r);const n=(0,s.KeyOfPropertyEntries)(t),o=n.map((t=>t[0])),a={...r};for(const[t,r]of n)t in a&&(a[t]=p(r,e,`${i}/${t}`,a[t]));if(!(0,h.IsTransform)(t.unevaluatedProperties))return u(t,i,a);const d=Object.getOwnPropertyNames(a),c=t.unevaluatedProperties,g={...a};for(const t of d)o.includes(t)||(g[t]=u(c,`${i}/${t}`,g[t]));return u(t,i,g)}(g,c,n,d);case"Not":return function(t,e,i,r){return u(t,i,p(t.not,e,i,r))}(g,c,n,d);case"Object":return function(t,e,r,n){if(!(0,l.IsObject)(n))return u(t,r,n);const o=(0,s.KeyOfPropertyKeys)(t),a={...n};for(const n of o)(0,l.HasPropertyKey)(a,n)&&(!(0,l.IsUndefined)(a[n])||(0,h.IsUndefined)(t.properties[n])&&!i.TypeSystemPolicy.IsExactOptionalProperty(a,n))&&(a[n]=p(t.properties[n],e,`${r}/${n}`,a[n]));if(!(0,h.IsSchema)(t.additionalProperties))return u(t,r,a);const d=Object.getOwnPropertyNames(a),c=t.additionalProperties,g={...a};for(const t of d)o.includes(t)||(g[t]=u(c,`${r}/${t}`,g[t]));return u(t,r,g)}(g,c,n,d);case"Record":return function(t,e,i,r){if(!(0,l.IsObject)(r))return u(t,i,r);const n=Object.getOwnPropertyNames(t.patternProperties)[0],s=new RegExp(n),o={...r};for(const a of Object.getOwnPropertyNames(r))s.test(a)&&(o[a]=p(t.patternProperties[n],e,`${i}/${a}`,o[a]));if(!(0,h.IsSchema)(t.additionalProperties))return u(t,i,o);const a=Object.getOwnPropertyNames(o),d=t.additionalProperties,c={...o};for(const t of a)s.test(t)||(c[t]=u(d,`${i}/${t}`,c[t]));return u(t,i,c)}(g,c,n,d);case"Ref":case"This":return function(t,e,i,r){return u(t,i,p((0,o.Deref)(t,e),e,i,r))}(g,c,n,d);case"Symbol":default:return u(g,n,d);case"Tuple":return function(t,e,i,r){return(0,l.IsArray)(r)&&(0,l.IsArray)(t.items)?u(t,i,t.items.map(((t,n)=>p(t,e,`${i}/${n}`,r[n])))):u(t,i,r)}(g,c,n,d);case"Union":return function(t,e,i,r){for(const n of t.anyOf)if((0,a.Check)(n,e,r))return u(t,i,p(n,e,i,r));return u(t,i,r)}(g,c,n,d)}}exports.TransformDecodeError=c},76948:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExcludeFromTemplateLiteral=function(t,e){return(0,i.Exclude)((0,r.TemplateLiteralToUnion)(t),e)};const i=e(83598),r=e(61198)},76967:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Condition=void 0;const i=e(96347),r=e(21890),n=e(10941),s=e(71948);exports.Condition=class{constructor(t,e=t=>t){this.key=t.key,this.operator=t.operator,this.value=e(t.value)}test(t){var e;let o=!1;if(null==t[this.key]&&this.operator!=r.ConditionOperators.IS_EMPTY&&this.operator!=r.ConditionOperators.IS_NOT_EMPTY&&this.operator!=r.ConditionOperators.NOT_IN&&this.operator!=r.ConditionOperators.NOT_EQUAL)throw new n.ConditionTestDataKeyNotFoundException("Couldn't perform test because test data doesn't contain conditioned key: "+this.key);const a=null!==(e=t[this.key])&&void 0!==e?e:void 0;if(this.operator==r.ConditionOperators.IS_EMPTY)return(0,i.isEmpty)(a);if(this.operator==r.ConditionOperators.IS_NOT_EMPTY)return!(0,i.isEmpty)(a);if(this.operator==r.ConditionOperators.IN||this.operator==r.ConditionOperators.NOT_IN)if(Array.isArray(a)&&!Array.isArray(this.value))o=this.operator==r.ConditionOperators.NOT_IN?!a.includes(this.value):a.includes(this.value);else if(Array.isArray(this.value)&&!Array.isArray(a)&&void 0!==a)o=this.operator==r.ConditionOperators.NOT_IN?!this.value.includes(a.toString()):this.value.includes(a.toString());else if(Array.isArray(a)&&Array.isArray(this.value)){const t=this.value.length,e=this.value.filter((t=>!a.includes(t))).length;if(this.operator==r.ConditionOperators.NOT_IN)return t==e;if(this.operator==r.ConditionOperators.IN)return e<t}else{if("string"!=typeof a||"string"!=typeof this.value){if(this.operator==r.ConditionOperators.NOT_IN&&(0,i.isEmpty)(a))return!0;if(this.operator==r.ConditionOperators.IN&&(0,i.isEmpty)(a))return!1;throw new s.ConditionTestFailedException("Trying to do CONTAINS in a special case that is not yet supported. "+this.key+" is "+a+")")}o=this.operator==r.ConditionOperators.NOT_IN?!a.includes(this.value):a.includes(this.value)}else{const t=`return ${JSON.stringify(a)} ${this.operator} ${JSON.stringify(this.value)};`;try{o=Function(t)()}catch(t){return!1}}return o}toString(){const t=JSON.stringify(this.value);switch(this.operator){case r.ConditionOperators.IS_EMPTY:return"!${"+this.key+"}";case r.ConditionOperators.IS_NOT_EMPTY:return"!!${"+this.key+"}";case r.ConditionOperators.NOT_IN:return"this.isNotIn(${"+this.key+"}, "+t+")";case r.ConditionOperators.IN:return"this.isIn(${"+this.key+"}, "+t+")";default:return"${"+this.key+"} "+this.operator+" "+t}}}},77085:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Parse=exports.Mutate=exports.Hash=exports.Equal=exports.Encode=exports.Edit=exports.Patch=exports.Diff=exports.Default=exports.Decode=exports.Create=exports.Convert=exports.Clone=exports.Clean=exports.Check=exports.Cast=exports.Assert=exports.ValueErrorIterator=exports.Errors=void 0;var i=e(1358);Object.defineProperty(exports,"Errors",{enumerable:!0,get:function(){return i.Errors}}),Object.defineProperty(exports,"ValueErrorIterator",{enumerable:!0,get:function(){return i.ValueErrorIterator}});var r=e(38717);Object.defineProperty(exports,"Assert",{enumerable:!0,get:function(){return r.Assert}});var n=e(13167);Object.defineProperty(exports,"Cast",{enumerable:!0,get:function(){return n.Cast}});var s=e(97069);Object.defineProperty(exports,"Check",{enumerable:!0,get:function(){return s.Check}});var o=e(54040);Object.defineProperty(exports,"Clean",{enumerable:!0,get:function(){return o.Clean}});var a=e(41120);Object.defineProperty(exports,"Clone",{enumerable:!0,get:function(){return a.Clone}});var l=e(24906);Object.defineProperty(exports,"Convert",{enumerable:!0,get:function(){return l.Convert}});var h=e(1151);Object.defineProperty(exports,"Create",{enumerable:!0,get:function(){return h.Create}});var d=e(85221);Object.defineProperty(exports,"Decode",{enumerable:!0,get:function(){return d.Decode}});var c=e(97476);Object.defineProperty(exports,"Default",{enumerable:!0,get:function(){return c.Default}});var u=e(64895);Object.defineProperty(exports,"Diff",{enumerable:!0,get:function(){return u.Diff}}),Object.defineProperty(exports,"Patch",{enumerable:!0,get:function(){return u.Patch}}),Object.defineProperty(exports,"Edit",{enumerable:!0,get:function(){return u.Edit}});var p=e(38521);Object.defineProperty(exports,"Encode",{enumerable:!0,get:function(){return p.Encode}});var g=e(27593);Object.defineProperty(exports,"Equal",{enumerable:!0,get:function(){return g.Equal}});var m=e(13863);Object.defineProperty(exports,"Hash",{enumerable:!0,get:function(){return m.Hash}});var f=e(92217);Object.defineProperty(exports,"Mutate",{enumerable:!0,get:function(){return f.Mutate}});var v=e(57234);Object.defineProperty(exports,"Parse",{enumerable:!0,get:function(){return v.Parse}})},77346:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Union=function(t,e){return 0===t.length?(0,i.Never)(e):1===t.length?(0,r.CreateType)(t[0],e):(0,n.UnionCreate)(t,e)};const i=e(72492),r=e(30768),n=e(39039)},77837:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProductAttrConditionEvaluator=void 0;const ProductAttrFilterMode_1=__webpack_require__(12866);class ProductAttrConditionEvaluator{constructor(){this.debugEnabled=!1,this.debugList=[],this.attributes={},this.ignoredConstraints={},this.debugConstraints={},this.regex=/[$][{].*?[}]/g,this.logEnabled=!1}reset(t){this.attributes=t}clearDebug(){this.debugList=[],this.debugConstraints={}}debug(t){this.debugList.push(t)}debugConstraint(t,e,i){this.debugEnabled&&(this.debugConstraints.hasOwnProperty(t)||(this.debugConstraints[t]={}),this.debugConstraints[t].hasOwnProperty(e)||(this.debugConstraints[t][e]=[]),this.debugConstraints[t][e].push(i))}getDebugConstraints(t,e){return this.debugConstraints.hasOwnProperty(t)&&this.debugConstraints[t].hasOwnProperty(e)?this.debugConstraints[t][e]:null}log(...t){this.logEnabled}ignoreConstraintsFromTo(t,e){this.ignoredConstraints.hasOwnProperty(t)||(this.ignoredConstraints[t]=[]),this.ignoredConstraints[t].push(e)}shouldIgnoreConstraints(t,e){return!(!this.ignoredConstraints.hasOwnProperty(t)&&!this.ignoredConstraints.hasOwnProperty("*"))&&(this.ignoredConstraints[t].indexOf(e)>=0||this.ignoredConstraints[t].indexOf("*")>=0)}filter(t,e){const i=this.getAttribute(e);let r=[],n=[];return(null==i?void 0:i.filters)&&(n=i.filters.filter((e=>this.evalCondition(e.conditions,t))),n.sort(((t,e)=>e.conditionsComplexityScore-t.conditionsComplexityScore)),n.length)&&(i.filterMode===ProductAttrFilterMode_1.ProductAttrFilterMode.MODE_MERGE_ALL_WINNERS?(n.forEach((t=>r=r.concat(t.values))),r=[...new Set(r)]):r=n[0].values,i.isDynamicValue||(r=r.filter((t=>i.valuesAndConstraints.hasOwnProperty(t.toString()))))),[r,n]}canIChangeAttribute(t,e,i){return!!this.doesCurrentItemAllowToChange(t,e,i)&&this.doesAttrValueAllowToBeCombinedWith(t,e,i)}doesAttrValueAllowToBeCombinedWith(t,e,i){const r=this.getConstraintsFor(e,i);if(r){let n=!0;const s=r.match(this.regex);if(s&&(s.forEach((e=>{const i=this.extractConditionedColumnName(e);i&&n&&(n=this.evalConditionAgainstChangeRequest(r,t,i,t[i]))})),!n&&this.debugEnabled)){let r="Blocked by ",n=[];s.forEach((e=>{const i=this.extractConditionedColumnName(e);if(i){const e=i.replace("item.attributes.","");n.push(`'${e}' (${t[i]})`)}})),n=[...new Set(n)],n.length>1&&(r+="any of these: "),r+=n.join(", "),this.debugConstraint(e,i,r),this.debug(r)}return n}return!0}doesCurrentItemAllowToChange(t,e,i){for(const r in t){const n=r.indexOf("item.attributes.")>=0&&r.replace("item.attributes.","");if(n&&n!=e&&!this.shouldIgnoreConstraints(n,e)){const s=this.getAttribute(n);if(s){let o=t[r];Array.isArray(o)||(o=[o]);for(const r in o){const a=o[r],l=this.getConstraintsFor(n,`${a}`);if(l){const r=this.evalConditionAgainstChangeRequest(l,t,"item.attributes."+e,i);if(!r){const t=`'${a} ${n}' doesn't allow '${e}' to be changed to '${i}'.`;return this.debugConstraint(e,i,`Blocked by '${n}' (${a})`),this.log(t,s,l),this.debug(t),r}this.log(`'${s}:${a}'`,!0)}}}}}return!0}evalConditionAgainstChangeRequest(condition,productItemAsOneDimensionalObject,columnNameToBeChanged,columnValueToBeChanged){let result=!0;if(condition.indexOf("${"+columnNameToBeChanged+"}")>=0){const replacedValues={},conditionedColumnNames=condition.match(this.regex);conditionedColumnNames&&conditionedColumnNames.forEach((t=>{const e=this.extractConditionedColumnName(t);e==columnNameToBeChanged?(condition=condition.replace(t,"columnValueToBeChanged"),replacedValues.columnValueToBeChanged=columnValueToBeChanged):(condition=condition.replace(t,"productItemAsOneDimensionalObject['"+e+"']"),replacedValues["productItemAsOneDimensionalObject["+e+"]"]=productItemAsOneDimensionalObject[e])}));try{this.log("testConditionAgainstChangeRequest:",condition,replacedValues),result=eval(condition)}catch(t){}}return result}evalCondition(condition,productItemAsOneDimensionalObject){let result=!0;if(condition&&condition.length){const replacedValues={},conditionedColumnNames=condition.match(this.regex);conditionedColumnNames&&conditionedColumnNames.forEach((t=>{const e=this.extractConditionedColumnName(t);condition=condition.replace(t,"productItemAsOneDimensionalObject['"+e+"']"),replacedValues["productItemAsOneDimensionalObject["+e+"]"]=productItemAsOneDimensionalObject[e]}));try{this.log("simpleConditionTest:",condition,replacedValues),result=eval(condition)}catch(t){}}return result}isNotIn(t,e){return!t||(Array.isArray(t)&&!Array.isArray(e)?t.indexOf(e)<0:!Array.isArray(t)&&Array.isArray(e)?e.indexOf(t)<0:Array.isArray(t)&&Array.isArray(e)?0==e.filter((e=>t.indexOf(e)>=0)).length:!Array.isArray(t)&&!Array.isArray(e)&&t!=e)}isIn(t,e){return!!t&&(Array.isArray(t)&&!Array.isArray(e)?t.indexOf(e)>=0:!Array.isArray(t)&&Array.isArray(e)?e.indexOf(t)>=0:Array.isArray(t)&&Array.isArray(e)?e.filter((e=>t.indexOf(e)>=0)).length>0:!Array.isArray(t)&&!Array.isArray(e)&&t==e)}extractConditionedColumnName(t){var e;const i=null===(e=t.match(this.regex))||void 0===e?void 0:e.pop();return i?i.replace("$","").replace("{","").replace("}",""):null}getConstraintsFor(t,e){const i=this.getAttribute(t);return i&&i.valuesAndConstraints.hasOwnProperty(e)?i.valuesAndConstraints[e]:null}getAttribute(t){return this.attributes.hasOwnProperty(t)?this.attributes[t]:null}}exports.ProductAttrConditionEvaluator=ProductAttrConditionEvaluator},77901:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Uppercase=function(t,e={}){return(0,i.Intrinsic)(t,"Uppercase",e)};const i=e(786)},77990:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RegExp=function(t,e){const s=(0,r.IsString)(t)?new globalThis.RegExp(t):t;return(0,i.CreateType)({[n.Kind]:"RegExp",type:"RegExp",source:s.source,flags:s.flags},e)};const i=e(30768),r=e(72862),n=e(73967)},78192:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Lowercase=function(t,e={}){return(0,i.Intrinsic)(t,"Lowercase",e)};const i=e(786)},78272:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(15178),exports)},78349:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Default=function(...t){return 3===t.length?d(t[0],t[1],t[2]):d(t[0],[],t[1])};const i=e(97069),r=e(41120),n=e(62413),s=e(73967),o=e(79968),a=e(51049);function l(t,e){const i=(0,o.HasPropertyKey)(t,"default")?t.default:void 0,n=(0,o.IsFunction)(i)?i():(0,r.Clone)(i);return(0,o.IsUndefined)(e)?n:(0,o.IsObject)(e)&&(0,o.IsObject)(n)?Object.assign(n,e):e}function h(t){return(0,a.IsKind)(t)&&"default"in t}function d(t,e,a){const c=(0,n.Pushref)(t,e),u=t;switch(u[s.Kind]){case"Array":return function(t,e,i){const r=l(t,i);if(!(0,o.IsArray)(r))return r;for(let i=0;i<r.length;i++)r[i]=d(t.items,e,r[i]);return r}(u,c,a);case"Date":return function(t,e,i){return(0,o.IsDate)(i)?i:l(t,i)}(u,0,a);case"Intersect":return function(t,e,i){const r=l(t,i);return t.allOf.reduce(((t,i)=>{const n=d(i,e,r);return(0,o.IsObject)(n)?{...t,...n}:n}),{})}(u,c,a);case"Object":return function(t,e,i){const r=l(t,i);if(!(0,o.IsObject)(r))return r;const n=Object.getOwnPropertyNames(t.properties);for(const i of n){const n=d(t.properties[i],e,r[i]);(0,o.IsUndefined)(n)||(r[i]=d(t.properties[i],e,r[i]))}if(!h(t.additionalProperties))return r;for(const i of Object.getOwnPropertyNames(r))n.includes(i)||(r[i]=d(t.additionalProperties,e,r[i]));return r}(u,c,a);case"Record":return function(t,e,i){const r=l(t,i);if(!(0,o.IsObject)(r))return r;const n=t.additionalProperties,[s,a]=Object.entries(t.patternProperties)[0],c=new RegExp(s);for(const t of Object.getOwnPropertyNames(r))c.test(t)&&h(a)&&(r[t]=d(a,e,r[t]));if(!h(n))return r;for(const t of Object.getOwnPropertyNames(r))c.test(t)||(r[t]=d(n,e,r[t]));return r}(u,c,a);case"Ref":return function(t,e,i){return d((0,n.Deref)(t,e),e,l(t,i))}(u,c,a);case"This":return function(t,e,i){return d((0,n.Deref)(t,e),e,i)}(u,c,a);case"Tuple":return function(t,e,i){const r=l(t,i);if(!(0,o.IsArray)(r)||(0,o.IsUndefined)(t.items))return r;const[n,s]=[t.items,Math.max(t.items.length,r.length)];for(let t=0;t<s;t++)t<n.length&&(r[t]=d(n[t],e,r[t]));return r}(u,c,a);case"Union":return function(t,e,n){const s=l(t,n);for(const n of t.anyOf){const t=d(n,e,(0,r.Clone)(s));if((0,i.Check)(n,e,t))return t}return s}(u,c,a);default:return l(u,a)}}},78653:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(312),exports),r(e(68490),exports)},78876:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TemplateLiteralPatternError=void 0,exports.TemplateLiteralPattern=function(t){return`^${t.map((t=>a(t,""))).join("")}$`};const i=e(64873),r=e(73967),n=e(87580),s=e(51049);class o extends n.TypeBoxError{}function a(t,e){return(0,s.IsTemplateLiteral)(t)?t.pattern.slice(1,t.pattern.length-1):(0,s.IsUnion)(t)?`(${t.anyOf.map((t=>a(t,e))).join("|")})`:(0,s.IsNumber)(t)||(0,s.IsInteger)(t)||(0,s.IsBigInt)(t)?`${e}${i.PatternNumber}`:(0,s.IsString)(t)?`${e}${i.PatternString}`:(0,s.IsLiteral)(t)?`${e}${n=t.const.toString(),n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}`:(0,s.IsBoolean)(t)?`${e}${i.PatternBoolean}`:(()=>{throw new o(`Unexpected Kind '${t[r.Kind]}'`)})();var n}exports.TemplateLiteralPatternError=o},78993:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(48514),exports)},79706:(t,exports)=>{"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProductAttrValueType=void 0,function(t){t.STRING="string",t.INT="integer",t.BOOL="boolean",t.FLOAT="float"}(e||(exports.ProductAttrValueType=e={}))},79968:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(60585),exports)},80276:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConditionBuilder=void 0;const i=e(76967),r=e(83198),n=e(10941);class s{constructor(t={conditions:[]},e=t=>t){var i,n,s;this.conditions=[],this.baseComplexityScore=0,this.relationMode=null!==(i=t.relationMode)&&void 0!==i?i:r.ConditionRelations.AND,this.baseComplexityScore=null!==(n=t.baseComplexityScore)&&void 0!==n?n:0;for(const i of null!==(s=t.conditions)&&void 0!==s?s:[])"operator"in i?this.addCondition(i,e):this.addSubGroup(i,e)}calculateComplexityScore(){let t=this.baseComplexityScore;this.relationMode==r.ConditionRelations.AND&&this.count()>=2&&(t+=5);for(const e of Object.values(this.conditions))e instanceof s?(t+=100,t+=e.calculateComplexityScore()):t+=10;return t}count(){return Object.keys(this.conditions).length}addSubGroup(t={conditions:[]},e=t=>t){const i=new s(t,e);return this.conditions.push(i),i}addCondition(t,e=t=>t){return this.conditions.push(new i.Condition(t,e)),this}test(t){let e;for(const i of Object.values(this.conditions)){let s=null;try{s=i.test(t)}catch(t){if(!(t instanceof n.ConditionTestDataKeyNotFoundException))throw t;e=t}if(null!==s)switch(this.relationMode){case r.ConditionRelations.AND:if(!1===s)return!1;break;case r.ConditionRelations.OR:if(!0===s)return!0}}if(e)throw e;return!(this.relationMode==r.ConditionRelations.OR&&this.count()>0)}getBaseComplexityScore(){return this.baseComplexityScore}setBaseComplexityScore(t){return this.baseComplexityScore=t,this}getConditions(){return this.conditions}toString(){const t=this.relationMode===r.ConditionRelations.OR?"||":"&&";return Object.values(this.conditions).map((t=>t instanceof s?`(${t})`:`${t}`)).join(` ${t} `)}}exports.ConditionBuilder=s},80371:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ValueMutateError=void 0,exports.Mutate=function(t,e){if(l(t)||l(e))throw new o("Only object and array types can be mutated at the root level");if(function(t,e){return(0,i.IsObject)(t)&&(0,i.IsArray)(e)||(0,i.IsArray)(t)&&(0,i.IsObject)(e)}(t,e))throw new o("Cannot assign due type mismatch of assignable values");a(t,"",t,e)};const i=e(79968),r=e(51056),n=e(41120),s=e(87580);class o extends s.TypeBoxError{constructor(t){super(t)}}function a(t,e,s,o){return(0,i.IsArray)(o)?function(t,e,s,o){if((0,i.IsArray)(s)){for(let i=0;i<o.length;i++)a(t,`${e}/${i}`,s[i],o[i]);s.splice(o.length)}else r.ValuePointer.Set(t,e,(0,n.Clone)(o))}(t,e,s,o):(0,i.IsTypedArray)(o)?function(t,e,s,o){if((0,i.IsTypedArray)(s)&&s.length===o.length)for(let t=0;t<s.length;t++)s[t]=o[t];else r.ValuePointer.Set(t,e,(0,n.Clone)(o))}(t,e,s,o):(0,i.IsObject)(o)?function(t,e,s,o){if((0,i.IsObject)(s)){const i=Object.getOwnPropertyNames(s),r=Object.getOwnPropertyNames(o);for(const t of i)r.includes(t)||delete s[t];for(const t of r)i.includes(t)||(s[t]=null);for(const i of r)a(t,`${e}/${i}`,s[i],o[i])}else r.ValuePointer.Set(t,e,(0,n.Clone)(o))}(t,e,s,o):(0,i.IsValueType)(o)?function(t,e,i,n){i!==n&&r.ValuePointer.Set(t,e,n)}(t,e,s,o):void 0}function l(t){return(0,i.IsTypedArray)(t)||(0,i.IsValueType)(t)}exports.ValueMutateError=o},81069:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(76503),exports),r(e(71571),exports),r(e(7625),exports)},81826:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RequiredFromMappedResult=function(t,e){const n=function(t,e){return function(t,e){const i={};for(const n of globalThis.Object.getOwnPropertyNames(t))i[n]=(0,r.Required)(t[n],e);return i}(t.properties,e)}(t,e);return(0,i.MappedResult)(n)};const i=e(34013),r=e(35222)},82415:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TemplateLiteralGenerateError=void 0,exports.TemplateLiteralExpressionGenerate=l,exports.TemplateLiteralGenerate=function(t){const e=(0,r.TemplateLiteralParseExact)(t.pattern);return(0,i.IsTemplateLiteralExpressionFinite)(e)?[...l(e)]:[]};const i=e(56791),r=e(95421),n=e(87580);class s extends n.TypeBoxError{}function*o(t){if(1===t.length)return yield*t[0];for(const e of t[0])for(const i of o(t.slice(1)))yield`${e}${i}`}function*a(t){return yield*o(t.expr.map((t=>[...l(t)])))}function*l(t){return"and"===t.type?yield*a(t):"or"===t.type?yield*function*(t){for(const e of t.expr)yield*l(e)}(t):"const"===t.type?yield*function*(t){return yield t.const}(t):(()=>{throw new s("Unknown expression")})()}exports.TemplateLiteralGenerateError=s},82984:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(968),exports)},83143:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(15542),exports)},83198:(t,exports)=>{"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.ConditionRelations=void 0,function(t){t.AND="AND",t.OR="OR"}(e||(exports.ConditionRelations=e={}))},83598:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Exclude=function(t,e,h={}){return(0,l.IsTemplateLiteral)(t)?(0,i.CreateType)((0,a.ExcludeFromTemplateLiteral)(t,e),h):(0,l.IsMappedResult)(t)?(0,i.CreateType)((0,o.ExcludeFromMappedResult)(t,e),h):(0,i.CreateType)((0,l.IsUnion)(t)?function(t,e){const i=t.filter((t=>(0,s.ExtendsCheck)(t,e)===s.ExtendsResult.False));return 1===i.length?i[0]:(0,r.Union)(i)}(t.anyOf,e):(0,s.ExtendsCheck)(t,e)!==s.ExtendsResult.False?(0,n.Never)():t,h)};const i=e(30768),r=e(85713),n=e(72492),s=e(35595),o=e(5965),a=e(76948),l=e(51049)},83605:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ValuePointerRootDeleteError=exports.ValuePointerRootSetError=void 0,exports.Format=o,exports.Set=function(t,e,i){if(""===e)throw new r(t,e,i);let[n,s,a]=[null,t,""];for(const t of o(e))void 0===s[t]&&(s[t]={}),n=s,s=s[t],a=t;n[a]=i},exports.Delete=function(t,e){if(""===e)throw new n(t,e);let[i,r,s]=[null,t,""];for(const t of o(e)){if(void 0===r[t]||null===r[t])return;i=r,r=r[t],s=t}if(Array.isArray(i)){const t=parseInt(s);i.splice(t,1)}else delete i[s]},exports.Has=function(t,e){if(""===e)return!0;let[i,r,n]=[null,t,""];for(const t of o(e)){if(void 0===r[t])return!1;i=r,r=r[t],n=t}return Object.getOwnPropertyNames(i).includes(n)},exports.Get=function(t,e){if(""===e)return t;let i=t;for(const t of o(e)){if(void 0===i[t])return;i=i[t]}return i};const i=e(87580);class r extends i.TypeBoxError{constructor(t,e,i){super("Cannot set root value"),this.value=t,this.path=e,this.update=i}}exports.ValuePointerRootSetError=r;class n extends i.TypeBoxError{constructor(t,e){super("Cannot delete root value"),this.value=t,this.path=e}}function s(t){return-1===t.indexOf("~")?t:t.replace(/~1/g,"/").replace(/~0/g,"~")}function*o(t){if(""===t)return;let[e,i]=[0,0];for(let r=0;r<t.length;r++)"/"===t.charAt(r)?(0===r||(i=r,yield s(t.slice(e,i))),e=r+1):i=r;yield s(t.slice(e))}exports.ValuePointerRootDeleteError=n},83726:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Never=function(t){return(0,i.CreateType)({[r.Kind]:"Never",not:{}},t)};const i=e(30768),r=e(73967)},83775:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProductItemHelper=void 0;const i=e(5281);exports.ProductItemHelper=class{constructor(t){this.item=t,this.feature=new i.MultiValueHelper(t,"feature")}getSheetType(){return this.item.getAttribute("sheet_type")}setSheetType(t){this.item.setAttribute("sheet_type",t)}getMaterial(){return this.item.getAttribute("material")}setMaterial(t){this.item.setAttribute("material",t)}getLaminate(){return this.item.getAttribute("laminate")}setLaminate(t){this.item.setAttribute("laminate",t)}getWidthMM(){return this.item.getAttribute("width_mm")}setWidthMM(t){this.item.setAttribute("width_mm",t)}getHeightMM(){return this.item.getAttribute("height_mm")}setHeightMM(t){this.item.setAttribute("height_mm",t)}getQuantity(){return this.item.getAttribute("quantity")}setQuantity(t){this.item.setAttribute("quantity",t)}getPriceMarginPercentage(){return this.item.getAttribute("price_margin_percentage")}setPriceMarginPercentage(t){this.item.setAttribute("price_margin_percentage",t)}getChanged(){return this.item.getAttribute("changed")}setChanged(t){this.item.setAttribute("changed",t)}getFigureID(){return this.item.getAttribute("figure_id")}setFigureID(t){this.item.setAttribute("figure_id",t)}getReorderID(){return this.item.getAttribute("reorder_id")}isReorder(){var t;return(null!==(t=this.getReorderID())&&void 0!==t?t:0)>0}setReorderID(t){this.item.setAttribute("reorder_id",t)}getNote(){return this.item.getAttribute("note")}setNote(t){this.item.setAttribute("note",t)}getSheetTypeSaveAs(){return this.item.getAttribute("sheet_type_save_as")||this.getSheetType()}setSheetTypeSaveAs(t){this.item.setAttribute("sheet_type_save_as",t)}getSheetName(){return this.item.getAttribute("sheet_name")}setSheetName(t){this.item.setAttribute("sheet_name",t)}getTemplateID(){return this.item.getAttribute("template_id")}setTemplateID(t){this.item.setAttribute("template_id",t)}getSize(){return this.item.getAttribute("size")}setSize(t){this.item.setAttribute("size",t)}getImperialUnits(){return this.item.getAttribute("imperial_units")}setImperialUnits(t){this.item.setAttribute("imperial_units",t)}getProductionLine(){return this.item.getAttribute("production_line")}setProductionLine(t){this.item.setAttribute("production_line",t)}getProductionInstruction(){return this.item.getAttribute("production_instruction")}setProductionInstruction(t){this.item.setAttribute("production_instruction",t)}getDelivery(){return this.item.getAttribute("delivery")}setDelivery(t){this.item.setAttribute("delivery",t)}getEpoxyTemplateID(){return this.item.getAttribute("epoxy_template_id")}setEpoxyTemplateID(t){this.item.setAttribute("epoxy_template_id",t)}getInnerCutAsKissCut(){return this.item.getAttribute("innercut_as_kisscut")}setInnerCutAsKissCut(t){this.item.setAttribute("innercut_as_kisscut",t)}getOpacityLayer(){return this.item.getAttribute("opacity_layer")}setOpacityLayer(t){this.item.setAttribute("opacity_layer",t)}getWhiteLayer(){return this.item.getAttribute("white_layer")}setWhiteLayer(t){this.item.setAttribute("white_layer",t)}getCutDirection(){return this.item.getAttribute("cut_direction")}setCutDirection(t){this.item.setAttribute("cut_direction",t)}getImageFilters(){return this.item.getAttribute("image_filters")}setImageFilters(t){this.item.setAttribute("image_filters",t)}getOutline(){return this.item.getAttribute("outline")}setOutline(t){this.item.setAttribute("outline",t)}getInk(){return this.item.getAttribute("ink")}setInk(t){this.item.setAttribute("ink",t)}getMaxSizeMM(){return this.item.getAttribute("max_size_mm")}setMaxSizeMM(t){this.item.setAttribute("max_size_mm",t)}getMinSizeMM(){return this.item.getAttribute("min_size_mm")}setMinSizeMM(t){this.item.setAttribute("min_size_mm",t)}getMaxSizeOtherSideMM(){return this.item.getAttribute("max_size_other_side_mm")}setMaxSizeOtherSideMM(t){this.item.setAttribute("max_size_other_side_mm",t)}getFixedSize(){return this.item.getAttribute("fixed_size")}setFixedSize(t){this.item.setAttribute("fixed_size",t)}getFixedQuantity(){return this.item.getAttribute("fixed_quantity")}setFixedQuantity(t){this.item.setAttribute("fixed_quantity",t)}getMarket(){return this.item.getAttribute("market")}setMarket(t){this.item.setAttribute("market",t)}getDeliveryRollSizeType(){return this.item.getAttribute("delivery_roll_size_type")}setDeliveryRollSizeType(t){this.item.setAttribute("delivery_roll_size_type",t)}getDeliveryRollSizeMM(){return this.item.getAttribute("delivery_roll_size_mm")}setDeliveryRollSizeMM(t){this.item.setAttribute("delivery_roll_size_mm",t)}getDeliveryRollTopEdgeMargin(){return this.item.getAttribute("delivery_roll_top_edge_margin")}setDeliveryRollTopEdgeMargin(t){this.item.setAttribute("delivery_roll_top_edge_margin",t)}getDeliveryRollItemMargin(){return this.item.getAttribute("delivery_roll_item_margin")}setDeliveryRollItemMargin(t){this.item.setAttribute("delivery_roll_item_margin",t)}getDeliverySheetWidth(){return this.item.getAttribute("delivery_sheet_width")}setDeliverySheetWidth(t){this.item.setAttribute("delivery_sheet_width",t)}getDeliverySheetHeight(){return this.item.getAttribute("delivery_sheet_height")}setDeliverySheetHeight(t){this.item.setAttribute("delivery_sheet_height",t)}getDeliverySheetInsidePadding(){return this.item.getAttribute("delivery_sheet_inside_padding")}setDeliverySheetInsidePadding(t){this.item.setAttribute("delivery_sheet_inside_padding",t)}getDeliverySheetOutsidePadding(){return this.item.getAttribute("delivery_sheet_outside_padding")}setDeliverySheetOutsidePadding(t){this.item.setAttribute("delivery_sheet_outside_padding",t)}getEffectLayerFileName(){return this.item.getAttribute("effect_layer_file_name")}setEffectLayerFileName(t){this.item.setAttribute("effect_layer_file_name",t)}getEffectLayerFileAppID(){return this.item.getAttribute("effect_layer_upload_fileapp_id")}setEffectLayerFileAppID(t){this.item.setAttribute("effect_layer_upload_fileapp_id",t)}getLivePreviewOpacityMask(){return this.item.getAttribute("live_preview_opacity_mask")}setLivePreviewOpacityMask(t){this.item.setAttribute("live_preview_opacity_mask",t)}getLivePreviewWhiteLayerMask(){return this.item.getAttribute("live_preview_white_layer_mask")}setLivePreviewWhiteLayerMask(t){this.item.setAttribute("live_preview_white_layer_mask",t)}isCustomizableSheet(){return["sheet","sheet_kiss_cut"].includes(this.item.getProductName())}isLabelSheet(){return"sheet_legacy"===this.item.getProductName()}isProductLabelsOnRoll(){return"labels_on_roll"===this.item.getProductName()}isCustomStickerFamily(){return"custom_sticker"===this.item.getProductFamilyName()}}},84384:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(98726),exports)},84559:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.JavaScriptTypeBuilder=void 0;const i=e(87814),r=e(47159),n=e(75933),s=e(63317),o=e(5358),a=e(96937),l=e(23714),h=e(62154),d=e(84384),c=e(55344),u=e(69038),p=e(9215),g=e(40915),m=e(83143),f=e(48902),v=e(14295),b=e(36210),y=e(65924);class _ extends i.JsonTypeBuilder{AsyncIterator(t,e){return(0,r.AsyncIterator)(t,e)}Awaited(t,e){return(0,n.Awaited)(t,e)}BigInt(t){return(0,s.BigInt)(t)}ConstructorParameters(t,e){return(0,a.ConstructorParameters)(t,e)}Constructor(t,e,i){return(0,o.Constructor)(t,e,i)}Date(t={}){return(0,l.Date)(t)}Function(t,e,i){return(0,h.Function)(t,e,i)}InstanceType(t,e){return(0,d.InstanceType)(t,e)}Iterator(t,e){return(0,c.Iterator)(t,e)}Parameters(t,e){return(0,u.Parameters)(t,e)}Promise(t,e){return(0,p.Promise)(t,e)}RegExp(t,e){return(0,g.RegExp)(t,e)}ReturnType(t,e){return(0,m.ReturnType)(t,e)}Symbol(t){return(0,f.Symbol)(t)}Undefined(t){return(0,b.Undefined)(t)}Uint8Array(t){return(0,v.Uint8Array)(t)}Void(t){return(0,y.Void)(t)}}exports.JavaScriptTypeBuilder=_},84985:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.convertMMToInches=function(t){const r=i(t)/e.inches_to_mm;return Math.round(10*r)/10},exports.convertInchesToMM=function(t){return i(t*e.inches_to_mm)},exports.convertMMToCM=function(t){return r(t/10,1)},exports.convertCMToMM=function(t){return r(10*t,0)},exports.convertMMToPX=function(t){return t*e.mm_to_px},exports.convertPXToMM=function(t){return i(t/e.mm_to_px)},exports.formatMM=i;const e={mm_to_px:2.83465,inches_to_mm:25.4};function i(t){return r(t=Math.round(10*t)/10,0)}function r(t,e){return Number(t.toFixed(e))}},85221:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(19263),exports)},85713:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(86842),exports),r(e(47035),exports),r(e(77346),exports)},85725:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MultiValueHelper=void 0,exports.MultiValueHelper=class{constructor(t,e){this.item=t,this.attrAlias=e}insertOne(t){const e=this.get();return e.includes(t)||e.push(t),e.length?this.set(e):this.delete()}deleteOne(t){const e=this.get().filter((e=>e!=t));return e.length?this.set(e):this.delete()}has(t){return this.get().includes(t)}get(){var t;const e=null!==(t=this.item.getAttribute(this.attrAlias))&&void 0!==t?t:[];return Array.isArray(e)?e:[e]}set(t){return this.item.setAttribute(this.attrAlias,t)}delete(){return this.item.removeAttribute(this.attrAlias)}}},85994:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SizeHelper=void 0;const i=e(72577),r=e(71283),n=e(84985),s=e(69864);class o{constructor(t,e){this.attrComputer=t,this.productItem=e,this.fixedSize=!1,this.transform=new r.TransformHelper(this),this.deliverySheet=new i.DeliverySheetSizeHelper(e),this.minSize=new s.SizeConverter(e),this.maxSize=new s.SizeConverter(e),this.maxSizeOtherSide=new s.SizeConverter(e)}toString(){return`|${this.width.mm}|${this.height.mm}|${this.minSize.mm}|${this.maxSize.mm}|${this.fixedSize}|${this.isImperialUnits()}|`}evaluate(){this.evaluateMaxSize(),this.evaluateMinSize(),this.evaluateMaxSizeOtherSide(),this.evaluateFixedSize()}getSizeOptions(){return this.attrComputer.getSuggestedValues("size")}canBeProductionLine(t){return!this.attrComputer.isConstrained("production_line",t)}formatDisplayableMeassure(t){return`${t} ${this.meassureDisplayAbbr}`}extractMeassuresFromString(t){var e,i;const[r,n]=(null!==(i=null===(e=t.match(/([\d]{1,3}\.?[\d]{1,3})|([\d]{1,3})/g))||void 0===e?void 0:e.map(Number))&&void 0!==i?i:[]).slice(-2);return{width:r,height:n}}setMeasureAttrLocalized(t,e){return this.setMeasureAttrInMM(t,this.localizedToMM(e))}localizedToMM(t){return this.isImperialUnits()?(0,n.convertInchesToMM)(t):(0,n.convertCMToMM)(t)}setMeasureAttrInMM(t,e){return t=this.sanitizeMeasureAttrName(t),this.maxSize.mm&&e>this.maxSize.mm?e=this.maxSize.mm:this.minSize.mm&&e<this.minSize.mm&&(e=this.minSize.mm),e=(0,n.formatMM)(e),this.productItem.setAttribute(t,e),e}getSizeByMM(t){return new s.SizeConverter(this.productItem,t)}getSizeByAttribute(t){t=this.sanitizeMeasureAttrName(t);const e=Number(this.productItem.getAttribute(t)||"0");return this.getSizeByMM(e)}isImperialUnits(){var t;return"true"===(null===(t=this.productItem.getAttribute("imperial_units"))||void 0===t?void 0:t.toString())}isSizeFixed(){return this.fixedSize}hasMaxSizeOtherSide(){return this.maxSizeOtherSide.mm!=this.maxSize.mm}get sqm(){const t=Number(this.productItem.getAttribute("quantity"));return this.width.mm*this.height.mm*t/1e6}get meassureDisplayAbbr(){return this.isImperialUnits()?'"':"cm"}get width(){return this.getSizeByAttribute("width_mm")}get height(){return this.getSizeByAttribute("height_mm")}evaluateFixedSize(){let t=this.productItem.getAttribute("fixed_size");void 0===t&&(t=this.attrComputer.isInFilteredValues("fixed_size",!0)),this.fixedSize=t}evaluateMaxSize(){var t;let e=this.canBeProductionLine("digital")?o.MAX_SIZE_MM_DIGITAL:o.MAX_SIZE_MM_LASER,i=this.productItem.getAttribute("max_size_mm");if(i||(i=null!==(t=this.attrComputer.getHighestAvailableValue("max_size_mm"))&&void 0!==t?t:void 0),"labels_on_roll"==this.productItem.getProductName()||"gitd_industrial"==this.productItem.getAttribute("material")){const t=this.attrComputer.getFilteredValues("max_size_mm");t.length&&t[0]<o.MAX_SIZE_MM_DIGITAL&&(i=t[0],e=o.MAX_SIZE_MM_DIGITAL)}else this.attrComputer.useFilters||this.canBeProductionLine("digital")||(e=800);this.maxSize.mm=Math.min(Number(i)||1/0,e)}evaluateMinSize(){var t;let e=this.productItem.getAttribute("min_size_mm");e||(e=null!==(t=this.attrComputer.getLowestAvailableValue("min_size_mm"))&&void 0!==t?t:o.MIN_SIZE_MM_DEFAULT),this.minSize.mm=e}evaluateMaxSizeOtherSide(){let t=this.productItem.getAttribute("max_size_other_side_mm");if(!t){const e=this.attrComputer.getFilteredValues("max_size_other_side_mm");e.length?t=e[0]:this.attrComputer.useFilters||this.canBeProductionLine("digital")||(t=o.MAX_SIZE_MM_LASER)}this.maxSize.mm||this.evaluateMaxSize(),this.minSize.mm||this.evaluateMinSize(),!t||t>this.maxSize.mm?t=this.maxSize.mm:t<this.minSize.mm&&(t=this.minSize.mm),this.maxSizeOtherSide.mm=t}sanitizeMeasureAttrName(t){return t.indexOf("_mm")<0&&(t+="_mm"),t}}exports.SizeHelper=o,o.MAX_SIZE_MM_DIGITAL=1200,o.MAX_SIZE_MM_LASER=275,o.MIN_SIZE_MM_DEFAULT=25},86706:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Omit=function(t,e,r){if((0,c.IsMappedKey)(e))return(0,l.OmitFromMappedKey)(t,e,r);if((0,c.IsMappedResult)(t))return(0,h.OmitFromMappedResult)(t,e,r);const n=(0,c.IsSchema)(e)?(0,a.IndexPropertyKeys)(e):e;return(0,i.CreateType)({...u(t,n),...r})};const i=e(30768),r=e(76166),n=e(65495),s=e(85713),o=e(6905),a=e(57083),l=e(30561),h=e(27025),d=e(93714),c=e(51049);function u(t,e){return(0,c.IsIntersect)(t)?(0,n.Intersect)(function(t,e){return t.map((t=>u(t,e)))}(t.allOf,e)):(0,c.IsUnion)(t)?(0,s.Union)(function(t,e){return t.map((t=>u(t,e)))}(t.anyOf,e)):(0,c.IsObject)(t)?function(t,e){const i=(0,r.Discard)(t,[d.TransformKind,"$id","required","properties"]),n=function(t,e){return e.reduce(((t,e)=>function(t,e){const{[e]:i,...r}=t;return r}(t,e)),t)}(t.properties,e);return(0,o.Object)(n,i)}(t,e):(0,o.Object)({})}},86842:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UnionEvaluated=function(t,e){return 0===t.length?(0,s.Never)(e):1===t.length?(0,i.CreateType)(t[0],e):function(t,e){return function(t){return t.some((t=>(0,l.IsOptional)(t)))}(t)?(0,o.Optional)((0,a.UnionCreate)(h(t),e)):(0,a.UnionCreate)(h(t),e)}(t,e)};const i=e(30768),r=e(73967),n=e(940),s=e(72492),o=e(27822),a=e(39039),l=e(51049);function h(t){return t.map((t=>(0,l.IsOptional)(t)?function(t){return(0,n.Discard)(t,[r.OptionalKind])}(t):t))}},87352:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExtractFromTemplateLiteral=function(t,e){return(0,i.Extract)((0,r.TemplateLiteralToUnion)(t),e)};const i=e(73842),r=e(61198)},87382:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MappedResult=function(t){return(0,i.CreateType)({[r.Kind]:"MappedResult",properties:t})};const i=e(30768),r=e(73967)},87580:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(51014),exports)},87814:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.JsonTypeBuilder=void 0;const i=e(18100),r=e(71927),n=e(99974),s=e(78993),o=e(90897),a=e(74118),l=e(33663),h=e(90079),d=e(35595),c=e(23419),u=e(57083),p=e(48652),g=e(65495),m=e(40633),f=e(39260),v=e(12881),b=e(34013),y=e(72492),_=e(12931),T=e(14479),x=e(3251),w=e(6905),E=e(41735),A=e(27822),P=e(93479),S=e(61359),O=e(13204),M=e(97439),C=e(15891),I=e(98146),k=e(14847),N=e(50919),L=e(29944),D=e(54031),B=e(11231),R=e(61198),j=e(46054),q=e(62700),V=e(85713),F=e(78272),H=e(8852);exports.JsonTypeBuilder=class{Strict(t){return(0,D.Strict)(t)}ReadonlyOptional(t){return(0,M.ReadonlyOptional)(t)}Readonly(t,e){return(0,O.Readonly)(t,e??!0)}Optional(t,e){return(0,A.Optional)(t,e??!0)}Any(t){return(0,i.Any)(t)}Array(t,e){return(0,r.Array)(t,e)}Boolean(t){return(0,n.Boolean)(t)}Capitalize(t,e){return(0,m.Capitalize)(t,e)}Composite(t,e){return(0,s.Composite)(t,e)}Const(t,e){return(0,o.Const)(t,e)}Deref(t,e){return(0,a.Deref)(t,e)}Enum(t,e){return(0,l.Enum)(t,e)}Exclude(t,e,i){return(0,h.Exclude)(t,e,i)}Extends(t,e,i,r,n){return(0,d.Extends)(t,e,i,r,n)}Extract(t,e,i){return(0,c.Extract)(t,e,i)}Index(t,e,i){return(0,u.Index)(t,e,i)}Integer(t){return(0,p.Integer)(t)}Intersect(t,e){return(0,g.Intersect)(t,e)}KeyOf(t,e){return(0,f.KeyOf)(t,e)}Literal(t,e){return(0,v.Literal)(t,e)}Lowercase(t,e){return(0,m.Lowercase)(t,e)}Mapped(t,e,i){return(0,b.Mapped)(t,e,i)}Never(t){return(0,y.Never)(t)}Not(t,e){return(0,_.Not)(t,e)}Null(t){return(0,T.Null)(t)}Number(t){return(0,x.Number)(t)}Object(t,e){return(0,w.Object)(t,e)}Omit(t,e,i){return(0,E.Omit)(t,e,i)}Partial(t,e){return(0,P.Partial)(t,e)}Pick(t,e,i){return(0,S.Pick)(t,e,i)}Record(t,e,i){return(0,C.Record)(t,e,i)}Recursive(t,e){return(0,I.Recursive)(t,e)}Ref(t,e){return(0,k.Ref)(t,e)}Required(t,e){return(0,N.Required)(t,e)}Rest(t){return(0,L.Rest)(t)}String(t){return(0,B.String)(t)}TemplateLiteral(t,e){return(0,R.TemplateLiteral)(t,e)}Transform(t){return(0,j.Transform)(t)}Tuple(t,e){return(0,q.Tuple)(t,e)}Uncapitalize(t,e){return(0,m.Uncapitalize)(t,e)}Union(t,e){return(0,V.Union)(t,e)}Unknown(t){return(0,F.Unknown)(t)}Unsafe(t){return(0,H.Unsafe)(t)}Uppercase(t,e){return(0,m.Uppercase)(t,e)}}},89027:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Condition=void 0;const i=e(32807),r=e(67574),n=e(64985),s=e(71032);exports.Condition=class{constructor(t,e=t=>t){this.key=t.key,this.operator=t.operator,this.value=e(t.value)}test(t){var e;let o=!1;if(null==t[this.key]&&this.operator!=r.ConditionOperators.IS_EMPTY&&this.operator!=r.ConditionOperators.IS_NOT_EMPTY&&this.operator!=r.ConditionOperators.NOT_IN&&this.operator!=r.ConditionOperators.NOT_EQUAL)throw new n.ConditionTestDataKeyNotFoundException("Couldn't perform test because test data doesn't contain conditioned key: "+this.key);const a=null!==(e=t[this.key])&&void 0!==e?e:void 0;if(this.operator==r.ConditionOperators.IS_EMPTY)return(0,i.isEmpty)(a);if(this.operator==r.ConditionOperators.IS_NOT_EMPTY)return!(0,i.isEmpty)(a);if(this.operator==r.ConditionOperators.IN||this.operator==r.ConditionOperators.NOT_IN)if(Array.isArray(a)&&!Array.isArray(this.value))o=this.operator==r.ConditionOperators.NOT_IN?!a.includes(this.value):a.includes(this.value);else if(Array.isArray(this.value)&&!Array.isArray(a)&&void 0!==a)o=this.operator==r.ConditionOperators.NOT_IN?!this.value.includes(a.toString()):this.value.includes(a.toString());else if(Array.isArray(a)&&Array.isArray(this.value)){const t=this.value.length,e=this.value.filter((t=>!a.includes(t))).length;if(this.operator==r.ConditionOperators.NOT_IN)return t==e;if(this.operator==r.ConditionOperators.IN)return e<t}else{if("string"!=typeof a||"string"!=typeof this.value){if(this.operator==r.ConditionOperators.NOT_IN&&(0,i.isEmpty)(a))return!0;if(this.operator==r.ConditionOperators.IN&&(0,i.isEmpty)(a))return!1;throw new s.ConditionTestFailedException("Trying to do CONTAINS in a special case that is not yet supported. "+this.key+" is "+a+")")}o=this.operator==r.ConditionOperators.NOT_IN?!a.includes(this.value):a.includes(this.value)}else{const t=`return ${JSON.stringify(a)} ${this.operator} ${JSON.stringify(this.value)};`;try{o=Function(t)()}catch(t){return!1}}return o}toString(){const t=JSON.stringify(this.value);switch(this.operator){case r.ConditionOperators.IS_EMPTY:return"!${"+this.key+"}";case r.ConditionOperators.IS_NOT_EMPTY:return"!!${"+this.key+"}";case r.ConditionOperators.NOT_IN:return"this.isNotIn(${"+this.key+"}, "+t+")";case r.ConditionOperators.IN:return"this.isIn(${"+this.key+"}, "+t+")";default:return"${"+this.key+"} "+this.operator+" "+t}}}},90079:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(5965),exports),r(e(76948),exports),r(e(83598),exports)},90728:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DeliveryRollHelper=void 0;class e{constructor(t,e=!1){this.productItem=t,this.calcCols=e}setCalcRols(t){this.calcCols=t}static getProdDirection(t){return{bottom_first:"top_first",top_first:"bottom_first",left_first:"right_first",right_first:"left_first"}[t]||null}static findRollSizeByType(t){const e=Object.entries(this.SIZE_TYPES).find((([e])=>e.toLowerCase()==t.toLowerCase()));return e?e[1]:null}static findRollTypeBySize(t){const e=Object.entries(this.SIZE_TYPES).find((([e,i])=>i==t));return e?e[0]:"custom"}static findSuitableSize(t){var e;return null!==(e=Object.values(this.SIZE_TYPES).sort(((t,e)=>t-e)).find((e=>e>=t)))&&void 0!==e?e:t}static isCustomSize(t){return"custom"===e.findRollTypeBySize(t)}getCalcHeight(){return["top_first","bottom_first"].includes(this.cutDirection)?this.widthMM:this.heightMM}getCalcWidth(){return["top_first","bottom_first"].includes(this.cutDirection)?this.heightMM:this.widthMM}getCols(){return this.calcCols?Math.floor(this.sizeType/(this.getCalcHeight()+2*e.MIN_TOP_MARGIN)):1}getTopMarginMax(){const t=this.sizeType/this.getCols()-this.getCalcHeight()-e.MIN_TOP_MARGIN;return Number(t.toFixed(1))}getTopMarginMid(){const t=(this.sizeType-this.getCols()*this.getCalcHeight())/(2*this.getCols());return Number(t.toFixed(1))}getCalcMinRollWidth(){return this.getCols()*(this.getCalcHeight()+2*e.MIN_TOP_MARGIN)}getSuitableSize(){return e.findSuitableSize(this.getCalcMinRollWidth())}isSizeTypeValid(){return!isNaN(this.sizeType)&&this.sizeType>=this.getCalcMinRollWidth()&&this.sizeType>=e.MIN_ROLL_SIZE&&this.sizeType<=e.MAX_ROLL_SIZE}get topEdgeMargin(){const t=Number(this.productItem.getAttribute("delivery_roll_top_edge_margin"));return Number(t.toFixed(1))}get sizeType(){return Number(this.productItem.getAttribute("delivery_roll_size_type"))}get widthMM(){return Number(this.productItem.getAttribute("width_mm"))}get heightMM(){return Number(this.productItem.getAttribute("height_mm"))}get cutDirection(){var t;return null!==(t=this.productItem.getAttribute("cut_direction"))&&void 0!==t?t:""}}exports.DeliveryRollHelper=e,e.DEFAULT_INNER_ROLL_SIZE=76,e.MAX_ROLL_SIZE=280,e.MIN_ROLL_SIZE=32,e.MIN_ITEM_MARGIN=4,e.MIN_TOP_MARGIN=2,e.SIZE_TYPES={small:35,medium:56,large:70,xlarge:93,xxlarge:140,full_width:280}},90816:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(26076),exports),r(e(42555),exports)},90897:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(44802),exports)},91156:(t,e,i)=>{"use strict";var r,n=Object.create,s=Object.defineProperty,o=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,l=Object.getPrototypeOf,h=Object.prototype.hasOwnProperty,d=(t,e,i,r)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let n of a(e))!h.call(t,n)&&n!==i&&s(t,n,{get:()=>e[n],enumerable:!(r=o(e,n))||r.enumerable});return t},c=(t,e,i)=>(i=null!=t?n(l(t)):{},d(!e&&t&&t.__esModule?i:s(i,"default",{value:t,enumerable:!0}),t)),u={};((t,e)=>{for(var i in e)s(t,i,{get:e[i],enumerable:!0})})(u,{CSSMatrix:()=>de.default,absolutizeSegment:()=>gt,arcToCubic:()=>_t,arcTools:()=>S,bezierTools:()=>R,cubicTools:()=>H,default:()=>ce,distanceEpsilon:()=>Ct,distanceSquareRoot:()=>m,finalizeSegment:()=>tt,getClosestPoint:()=>Dt,getDrawDirection:()=>Rt,getPathArea:()=>Bt,getPathBBox:()=>Ot,getPointAtLength:()=>kt,getPropertiesAtLength:()=>Nt,getPropertiesAtPoint:()=>Lt,getSVGMatrix:()=>re,getSegmentAtLength:()=>$t,getSegmentOfPoint:()=>jt,getTotalLength:()=>Mt,invalidPathValue:()=>$,isAbsoluteArray:()=>Vt,isArcCommand:()=>ht,isCurveArray:()=>Ht,isDigit:()=>rt,isDigitStart:()=>lt,isMoveCommand:()=>dt,isNormalizedArray:()=>Ft,isPathArray:()=>qt,isPathCommand:()=>at,isPointInStroke:()=>zt,isRelativeArray:()=>Ut,isSpace:()=>st,isValidPath:()=>Gt,iterate:()=>mt,lineToCubic:()=>xt,lineTools:()=>y,midPoint:()=>g,normalizePath:()=>It,normalizeSegment:()=>Et,optimizePath:()=>Jt,options:()=>Q,paramsCount:()=>J,paramsParser:()=>At,parsePathString:()=>pt,pathParser:()=>ut,pathToAbsolute:()=>ft,pathToCurve:()=>Pt,pathToRelative:()=>bt,pathToString:()=>St,polygonTools:()=>K,projection2d:()=>se,quadToCubic:()=>Tt,quadTools:()=>W,relativizeSegment:()=>vt,reverseCurve:()=>ae,reversePath:()=>te,rotateVector:()=>Y,roundPath:()=>le,roundSegment:()=>Qt,roundTo:()=>X,scanFlag:()=>it,scanParam:()=>nt,scanSegment:()=>ct,segmentToCubic:()=>wt,shapeParams:()=>Zt,shapeToPath:()=>Yt,shapeToPathArray:()=>Kt,shortenSegment:()=>Xt,skipSpaces:()=>ot,splitCubic:()=>he,splitPath:()=>ee,transformPath:()=>oe}),t.exports=(r=u,d(s({},"__esModule",{value:!0}),r));var p=c(i(45522),1),g=(t,e,i)=>{let[r,n]=t,[s,o]=e;return[r+(s-r)*i,n+(o-n)*i]},m=(t,e)=>Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])),f=(t,e,i,r)=>m([t,e],[i,r]),v=(t,e,i,r,n)=>{let s={x:t,y:e};if("number"==typeof n){let o=m([t,e],[i,r]);if(n<=0)s={x:t,y:e};else if(n>=o)s={x:i,y:r};else{let[a,l]=g([t,e],[i,r],n/o);s={x:a,y:l}}}return s},b=(t,e,i,r)=>{let{min:n,max:s}=Math;return[n(t,i),n(e,r),s(t,i),s(e,r)]},y={getLineBBox:b,getLineLength:f,getPointAtLineLength:v},_=(t,e,i)=>{let r=i/2,n=t**2*Math.sin(r)**2,s=e**2*Math.cos(r)**2,o=Math.sqrt(n+s)*i;return Math.abs(o)},T=(t,e,i,r,n,s)=>{let{sin:o,cos:a}=Math,l=a(n),h=o(n),d=i*a(s),c=r*o(s);return[t+l*d-h*c,e+h*d+l*c]},x=(t,e)=>{let{x:i,y:r}=t,{x:n,y:s}=e,o=i*n+r*s,a=Math.sqrt((i**2+r**2)*(n**2+s**2));return(i*s-r*n<0?-1:1)*Math.acos(o/a)},w=(t,e,i,r,n,s,o,a,l)=>{let{abs:h,sin:d,cos:c,sqrt:u,PI:p}=Math,g=h(i),m=h(r),f=(n%360+360)%360*(p/180);if(t===a&&e===l)return{rx:g,ry:m,startAngle:0,endAngle:0,center:{x:a,y:l}};if(0===g||0===m)return{rx:g,ry:m,startAngle:0,endAngle:0,center:{x:(a+t)/2,y:(l+e)/2}};let v=(t-a)/2,b=(e-l)/2,y=c(f)*v+d(f)*b,_=-d(f)*v+c(f)*b,T=y**2/g**2+_**2/m**2;T>1&&(g*=u(T),m*=u(T));let w=(g**2*m**2-g**2*_**2-m**2*y**2)/(g**2*_**2+m**2*y**2);w=w<0?0:w;let E=(s!==o?1:-1)*u(w),A=E*(g*_/m),P=E*(-m*y/g),S={x:c(f)*A-d(f)*P+(t+a)/2,y:d(f)*A+c(f)*P+(e+l)/2},O={x:(y-A)/g,y:(_-P)/m},M=x({x:1,y:0},O),C=x(O,{x:(-y-A)/g,y:(-_-P)/m});return!o&&C>0?C-=2*p:o&&C<0&&(C+=2*p),C%=2*p,{center:S,startAngle:M,endAngle:M+C,rx:g,ry:m}},E=(t,e,i,r,n,s,o,a,l)=>{let{rx:h,ry:d,startAngle:c,endAngle:u}=w(t,e,i,r,n,s,o,a,l);return _(h,d,u-c)},A=(t,e,i,r,n,s,o,a,l,h)=>{let d={x:t,y:e},{center:c,rx:u,ry:p,startAngle:g,endAngle:m}=w(t,e,i,r,n,s,o,a,l);if("number"==typeof h){let i=_(u,p,m-g);if(h<=0)d={x:t,y:e};else if(h>=i)d={x:a,y:l};else{if(t===a&&e===l)return{x:a,y:l};if(0===u||0===p)return v(t,e,a,l,h);let{PI:r,cos:s,sin:o}=Math,f=(n%360+360)%360*(r/180),b=g+h/i*(m-g),y=u*s(b),_=p*o(b);d={x:s(f)*y-o(f)*_+c.x,y:o(f)*y+s(f)*_+c.y}}}return d},P=(t,e,i,r,n,s,o,a,l)=>{let{center:h,rx:d,ry:c,startAngle:u,endAngle:p}=w(t,e,i,r,n,s,o,a,l),g=p-u,{min:m,max:f,tan:v,atan2:b,PI:y}=Math,{x:_,y:x}=h,E=n*y/180,A=v(E),P=b(-c*A,d),S=P,O=P+y,M=b(c,d*A),C=M+y,I=[a],k=[l],N=m(t,a),L=f(t,a),D=m(e,l),B=f(e,l),R=T(_,x,d,c,E,p-1e-5*g),j=T(_,x,d,c,E,p-.99999*g);if(R[0]>L||j[0]>L){let t=T(_,x,d,c,E,S);I.push(t[0]),k.push(t[1])}if(R[0]<N||j[0]<N){let t=T(_,x,d,c,E,O);I.push(t[0]),k.push(t[1])}if(R[1]<D||j[1]<D){let t=T(_,x,d,c,E,C);I.push(t[0]),k.push(t[1])}if(R[1]>B||j[1]>B){let t=T(_,x,d,c,E,M);I.push(t[0]),k.push(t[1])}return N=m.apply([],I),D=m.apply([],k),L=f.apply([],I),B=f.apply([],k),[N,D,L,B]},S={angleBetween:x,arcLength:_,arcPoint:T,getArcBBox:P,getArcLength:E,getArcProps:w,getPointAtArcLength:A},O=[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],M=[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],C=t=>{let e=[];for(let i=t,r=i.length,n=r-1;r>1;r-=1,n-=1){let t=[];for(let e=0;e<n;e+=1)t.push({x:n*(i[e+1].x-i[e].x),y:n*(i[e+1].y-i[e].y),t:0});e.push(t),i=t}return e},I=(t,e)=>{if(0===e)return t[0].t=0,t[0];let i=t.length-1;if(1===e)return t[i].t=1,t[i];let r=1-e,n=t;if(0===i)return t[0].t=e,t[0];if(1===i)return{x:r*n[0].x+e*n[1].x,y:r*n[0].y+e*n[1].y,t:e};let s=r*r,o=e*e,a=0,l=0,h=0,d=0;return 2===i?(n=[n[0],n[1],n[2],{x:0,y:0}],a=s,l=r*e*2,h=o):3===i&&(a=s*r,l=s*e*3,h=r*o*3,d=e*o),{x:a*n[0].x+l*n[1].x+h*n[2].x+d*n[3].x,y:a*n[0].y+l*n[1].y+h*n[2].y+d*n[3].y,t:e}},k=(t,e)=>{let i=t(e),r=i.x*i.x+i.y*i.y;return Math.sqrt(r)},N=t=>{let e=O.length,i=0;for(let r,n=0;n<e;n++)r=.5*O[n]+.5,i+=M[n]*k(t,r);return.5*i},L=t=>{let e=[];for(let i=0,r=t.length,n=2;i<r;i+=n)e.push({x:t[i],y:t[i+1]});let i=C(e);return N((t=>I(i[0],t)))},D=([t,e,i])=>{let r=Math.min(t,i),n=Math.max(t,i);if(e>=t?i>=e:i<=e)return[r,n];let s=(t*i-e*e)/(t-2*e+i);return s<r?[s,n]:[r,s]},B=([t,e,i,r])=>{let n=t-3*e+3*i-r;if(Math.abs(n)<1e-8)return t===r&&t===e?[t,r]:D([t,-.5*t+1.5*e,t-3*e+3*i]);let s=-t*i+t*r-e*i-e*r+e*e+i*i;if(s<=0)return[Math.min(t,r),Math.max(t,r)];let o=Math.sqrt(s),a=Math.min(t,r),l=Math.max(t,r),h=t-2*e+i;for(let s=(h+o)/n,d=1;d<=2;s=(h-o)/n,d++)if(s>0&&s<1){let n=t*(1-s)*(1-s)*(1-s)+3*e*(1-s)*(1-s)*s+3*i*(1-s)*s*s+r*s*s*s;n<a&&(a=n),n>l&&(l=n)}return[a,l]},R={bezierLength:N,calculateBezier:k,CBEZIER_MINMAX_EPSILON:1e-8,computeBezier:I,Cvalues:M,deriveBezier:C,getBezierLength:L,minmaxC:B,minmaxQ:D,Tvalues:O},j=([t,e,i,r,n,s,o,a],l)=>{let h=1-l;return{x:h**3*t+3*h**2*l*i+3*h*l**2*n+l**3*o,y:h**3*e+3*h**2*l*r+3*h*l**2*s+l**3*a}},q=(t,e,i,r,n,s,o,a)=>L([t,e,i,r,n,s,o,a]),V=(t,e,i,r,n,s,o,a,l)=>{let h={x:t,y:e};if("number"==typeof l){let d=L([t,e,i,r,n,s,o,a]);l<=0||(h=l>=d?{x:o,y:a}:j([t,e,i,r,n,s,o,a],l/d))}return h},F=(t,e,i,r,n,s,o,a)=>{let l=B([t,i,n,o]),h=B([e,r,s,a]);return[l[0],h[0],l[1],h[1]]},H={getCubicBBox:F,getCubicLength:q,getPointAtCubicLength:V,getPointAtCubicSegmentLength:j},z=([t,e,i,r,n,s],o)=>{let a=1-o;return{x:a**2*t+2*a*o*i+o**2*n,y:a**2*e+2*a*o*r+o**2*s}},U=(t,e,i,r,n,s)=>L([t,e,i,r,n,s]),G=(t,e,i,r,n,s,o)=>{let a={x:t,y:e};if("number"==typeof o){let l=L([t,e,i,r,n,s]);o<=0||(a=o>=l?{x:n,y:s}:z([t,e,i,r,n,s],o/l))}return a},Z=(t,e,i,r,n,s)=>{let o=D([t,i,n]),a=D([e,r,s]);return[o[0],a[0],o[1],a[1]]},W={getPointAtQuadLength:G,getPointAtQuadSegmentLength:z,getQuadBBox:Z,getQuadLength:U},K={polygonArea:t=>{let e,i=t.length,r=-1,n=t[i-1],s=0;for(;++r<i;)e=n,n=t[r],s+=e[1]*n[0]-e[0]*n[1];return s/2},polygonLength:t=>t.reduce(((e,i,r)=>r?e+m(t[r-1],i):0),0)},Y=(t,e,i)=>{let{sin:r,cos:n}=Math;return{x:t*n(i)-e*r(i),y:t*r(i)+e*n(i)}},X=(t,e)=>{let i=e>=1?10**e:1;return e>0?Math.round(t*i)/i:Math.round(t)},Q={origin:[0,0,0],round:4},J={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},tt=t=>{let e=t.pathValue[t.segmentStart],i=e.toLowerCase(),{data:r}=t;for(;r.length>=J[i]&&("m"===i&&r.length>2?(t.segments.push([e].concat(r.splice(0,2))),i="l",e="m"===e?"l":"L"):t.segments.push([e].concat(r.splice(0,J[i]))),J[i]););},et="SVGPathCommander Error",it=t=>{let{index:e,pathValue:i}=t,r=i.charCodeAt(e);return 48===r?(t.param=0,void(t.index+=1)):49===r?(t.param=1,void(t.index+=1)):void(t.err=`${et}: invalid Arc flag "${i[e]}", expecting 0 or 1 at index ${e}`)},rt=t=>t>=48&&t<=57,$="Invalid path value",nt=t=>{let e,{max:i,pathValue:r,index:n}=t,s=n,o=!1,a=!1,l=!1,h=!1;if(s>=i)t.err=`${et}: ${$} at index ${s}, "pathValue" is missing param`;else if(e=r.charCodeAt(s),(43===e||45===e)&&(s+=1,e=r.charCodeAt(s)),rt(e)||46===e){if(46!==e){if(o=48===e,s+=1,e=r.charCodeAt(s),o&&s<i&&e&&rt(e))return void(t.err=`${et}: ${$} at index ${n}, "${r[n]}" illegal number`);for(;s<i&&rt(r.charCodeAt(s));)s+=1,a=!0;e=r.charCodeAt(s)}if(46===e){for(h=!0,s+=1;rt(r.charCodeAt(s));)s+=1,l=!0;e=r.charCodeAt(s)}if(101===e||69===e){if(h&&!a&&!l)return void(t.err=`${et}: ${$} at index ${s}, "${r[s]}" invalid float exponent`);if(s+=1,e=r.charCodeAt(s),(43===e||45===e)&&(s+=1),!(s<i&&rt(r.charCodeAt(s))))return void(t.err=`${et}: ${$} at index ${s}, "${r[s]}" invalid integer exponent`);for(;s<i&&rt(r.charCodeAt(s));)s+=1}t.index=s,t.param=+t.pathValue.slice(n,s)}else t.err=`${et}: ${$} at index ${s}, "${r[s]}" is not a number`},st=t=>[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279,10,13,8232,8233,32,9,11,12,160].includes(t),ot=t=>{let{pathValue:e,max:i}=t;for(;t.index<i&&st(e.charCodeAt(t.index));)t.index+=1},at=t=>{switch(32|t){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}},lt=t=>rt(t)||43===t||45===t||46===t,ht=t=>97==(32|t),dt=t=>{switch(32|t){case 109:case 77:return!0;default:return!1}},ct=t=>{let{max:e,pathValue:i,index:r,segments:n}=t,s=i.charCodeAt(r),o=J[i[r].toLowerCase()];if(t.segmentStart=r,!at(s))return void(t.err=`${et}: ${$} "${i[r]}" is not a path command at index ${r}`);let a=n[n.length-1];if(dt(s)||"z"!==a?.[0]?.toLocaleLowerCase())if(t.index+=1,ot(t),t.data=[],o){for(;;){for(let r=o;r>0;r-=1){if(!ht(s)||3!==r&&4!==r?nt(t):it(t),t.err.length)return;t.data.push(t.param),ot(t),t.index<e&&44===i.charCodeAt(t.index)&&(t.index+=1,ot(t))}if(t.index>=t.max||!lt(i.charCodeAt(t.index)))break}tt(t)}else tt(t);else t.err=`${et}: ${$} "${i[r]}" is not a MoveTo path command at index ${r}`},ut=class{constructor(t){this.segments=[],this.pathValue=t,this.max=t.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}},pt=t=>{if("string"!=typeof t)return t.slice(0);let e=new ut(t);for(ot(e);e.index<e.max&&!e.err.length;)ct(e);if(e.err.length)throw TypeError(e.err);return e.segments.length&&(e.segments[0][0]="M"),e.segments},gt=(t,e,i,r)=>{let[n]=t,s=n.toUpperCase();if(0===e||s===n)return t;if("A"===s)return[s,t[1],t[2],t[3],t[4],t[5],t[6]+i,t[7]+r];if("V"===s)return[s,t[1]+r];if("H"===s)return[s,t[1]+i];if("L"===s)return[s,t[1]+i,t[2]+r];{let e=[],n=t.length;for(let s=1;s<n;s+=1)e.push(t[s]+(s%2?i:r));return[s].concat(e)}},mt=(t,e)=>{let i,r=t.length,n="M",s="M",o=!1,a=0,l=0,h=0,d=0,c=0;for(let u=0;u<r;u+=1){i=t[u],[n]=i,c=i.length,s=n.toUpperCase(),o=s!==n;let p=e(i,u,a,l);if(!1===p)break;"Z"===s?(a=h,l=d):"H"===s?a=i[1]+(o?a:0):"V"===s?l=i[1]+(o?l:0):(a=i[c-2]+(o?a:0),l=i[c-1]+(o?l:0),"M"===s&&(h=a,d=l)),p&&(t[u]=p,"C"===p[0]&&(r=t.length))}return t},ft=t=>{let e=pt(t);return mt(e,gt)},vt=(t,e,i,r)=>{let[n]=t,s=n.toLowerCase();if(0===e||n===s)return t;if("a"===s)return[s,t[1],t[2],t[3],t[4],t[5],t[6]-i,t[7]-r];if("v"===s)return[s,t[1]-r];if("h"===s)return[s,t[1]-i];if("l"===s)return[s,t[1]-i,t[2]-r];{let e=[],n=t.length;for(let s=1;s<n;s+=1)e.push(t[s]-(s%2?i:r));return[s].concat(e)}},bt=t=>{let e=pt(t);return mt(e,vt)},yt=(t,e,i,r,n,s,o,a,l,h)=>{let d,c,u,p,g,m=t,f=e,v=i,b=r,y=a,_=l,T=120*Math.PI/180,x=Math.PI/180*(+n||0),w=[];if(h)[c,u,p,g]=h;else{d=Y(m,f,-x),m=d.x,f=d.y,d=Y(y,_,-x),y=d.x,_=d.y;let t=(m-y)/2,e=(f-_)/2,i=t*t/(v*v)+e*e/(b*b);i>1&&(i=Math.sqrt(i),v*=i,b*=i);let r=v*v,n=b*b,a=(s===o?-1:1)*Math.sqrt(Math.abs((r*n-r*e*e-n*t*t)/(r*e*e+n*t*t)));p=a*v*e/b+(m+y)/2,g=a*-b*t/v+(f+_)/2,c=Math.asin(((f-g)/b*10**9|0)/10**9),u=Math.asin(((_-g)/b*10**9|0)/10**9),c=m<p?Math.PI-c:c,u=y<p?Math.PI-u:u,c<0&&(c=2*Math.PI+c),u<0&&(u=2*Math.PI+u),o&&c>u&&(c-=2*Math.PI),!o&&u>c&&(u-=2*Math.PI)}let E=u-c;if(Math.abs(E)>T){let t=u,e=y,i=_;u=c+T*(o&&u>c?1:-1),y=p+v*Math.cos(u),_=g+b*Math.sin(u),w=yt(y,_,v,b,n,0,o,e,i,[u,t,p,g])}E=u-c;let A=Math.cos(c),P=Math.sin(c),S=Math.cos(u),O=Math.sin(u),M=Math.tan(E/4),C=4/3*v*M,I=4/3*b*M,k=[m,f],N=[m+C*P,f-I*A],L=[y+C*O,_-I*S],D=[y,_];if(N[0]=2*k[0]-N[0],N[1]=2*k[1]-N[1],h)return[N[0],N[1],L[0],L[1],D[0],D[1]].concat(w);w=[N[0],N[1],L[0],L[1],D[0],D[1]].concat(w);let B=[];for(let t=0,e=w.length;t<e;t+=1)B[t]=t%2?Y(w[t-1],w[t],x).y:Y(w[t],w[t+1],x).x;return B},_t=yt,Tt=(t,e,i,r,n,s)=>{let o=.3333333333333333,a=2/3;return[o*t+a*i,o*e+a*r,o*n+a*i,o*s+a*r,n,s]},xt=(t,e,i,r)=>{let n=g([t,e],[i,r],.3333333333333333),s=g([t,e],[i,r],2/3);return[n[0],n[1],s[0],s[1],i,r]},wt=(t,e)=>{let[i]=t,r=t.slice(1).map(Number),[n,s]=r,{x1:o,y1:a,x:l,y:h}=e;return"TQ".includes(i)||(e.qx=null,e.qy=null),"M"===i?(e.x=n,e.y=s,t):"A"===i?["C"].concat(_t(o,a,r[0],r[1],r[2],r[3],r[4],r[5],r[6])):"Q"===i?(e.qx=n,e.qy=s,["C"].concat(Tt(o,a,r[0],r[1],r[2],r[3]))):"L"===i?["C"].concat(xt(o,a,n,s)):"Z"===i?["C"].concat(xt(o,a,l,h)):t},Et=(t,e)=>{let[i]=t,r=i.toUpperCase(),n=i!==r,{x1:s,y1:o,x2:a,y2:l,x:h,y:d}=e,c=t.slice(1),u=c.map(((t,e)=>t+(n?e%2?d:h:0)));if("TQ".includes(r)||(e.qx=null,e.qy=null),"A"===r)return u=c.slice(0,-2).concat(c[5]+(n?h:0),c[6]+(n?d:0)),["A"].concat(u);if("H"===r)return["L",t[1]+(n?h:0),o];if("V"===r)return["L",s,t[1]+(n?d:0)];if("L"===r)return["L",t[1]+(n?h:0),t[2]+(n?d:0)];if("M"===r)return["M",t[1]+(n?h:0),t[2]+(n?d:0)];if("C"===r)return["C"].concat(u);if("S"===r){let t=2*s-a,i=2*o-l;return e.x1=t,e.y1=i,["C",t,i].concat(u)}if("T"===r){let t=2*s-(e.qx?e.qx:0),i=2*o-(e.qy?e.qy:0);return e.qx=t,e.qy=i,["Q",t,i].concat(u)}if("Q"===r){let[t,i]=u;return e.qx=t,e.qy=i,["Q"].concat(u)}return"Z"===r?["Z"]:t},At={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null},Pt=t=>{let e={...At},i=pt(t);return mt(i,((t,r,n,s)=>{e.x=n,e.y=s;let o=Et(t,e),a=wt(o,e);"C"===a[0]&&a.length>7&&(i.splice(r+1,0,["C"].concat(a.slice(7))),a=a.slice(0,7));let l=a.length;return e.x1=+a[l-2],e.y1=+a[l-1],e.x2=+a[l-4]||e.x1,e.y2=+a[l-3]||e.y1,a}))},St=(t,e)=>{let i=t.length,{round:r}=Q,n=t[0],s="";r="off"===e||"number"==typeof e&&e>=0?e:"number"==typeof r&&r>=0?r:"off";for(let e=0;e<i;e+=1){n=t[e];let[i]=n,o=n.slice(1);if(s+=i,"off"===r)s+=o.join(" ");else{let t=0,e=o.length;for(;t<e;)s+=X(o[t],r),t!==e-1&&(s+=" "),t+=1}}return s},Ot=t=>{if(!t)return{x:0,y:0,width:0,height:0,x2:0,y2:0,cx:0,cy:0,cz:0};let e=pt(t),i="M",r=0,n=0,{max:s,min:o}=Math,a=1/0,l=1/0,h=-1/0,d=-1/0,c=0,u=0,p=0,g=0,m=0,f=0,v=0,y=0,_=0,T=0;mt(e,((t,e,x,w)=>{[i]=t;let E=i.toUpperCase(),A=E!==i?gt(t,e,x,w):t.slice(0),S="V"===E?["L",x,A[1]]:"H"===E?["L",A[1],w]:A;if([i]=S,"TQ".includes(E)||(_=0,T=0),"M"===i)[,r,n]=S,c=r,u=n,p=r,g=n;else if("L"===i)[c,u,p,g]=b(x,w,S[1],S[2]);else if("A"===i)[c,u,p,g]=P(x,w,S[1],S[2],S[3],S[4],S[5],S[6],S[7]);else if("S"===i){let t=2*m-v,e=2*f-y;[c,u,p,g]=F(x,w,t,e,S[1],S[2],S[3],S[4])}else"C"===i?[c,u,p,g]=F(x,w,S[1],S[2],S[3],S[4],S[5],S[6]):"T"===i?(_=2*m-_,T=2*f-T,[c,u,p,g]=Z(x,w,_,T,S[1],S[2])):"Q"===i?(_=S[1],T=S[2],[c,u,p,g]=Z(x,w,S[1],S[2],S[3],S[4])):"Z"===i&&([c,u,p,g]=b(x,w,r,n));a=o(c,a),l=o(u,l),h=s(p,h),d=s(g,d),[m,f]="Z"===i?[r,n]:S.slice(-2),[v,y]="C"===i?[S[3],S[4]]:"S"===i?[S[1],S[2]]:[m,f]}));let x=h-a,w=d-l;return{width:x,height:w,x:a,y:l,x2:h,y2:d,cx:a+x/2,cy:l+w/2,cz:Math.max(x,w)+Math.min(x,w)/2}},Mt=t=>{let e=pt(t),i=0,r=0,n=0,s=0,o=0,a=0,l="M",h=0,d=0,c=0;return mt(e,((t,e,u,p)=>{[l]=t;let g=l.toUpperCase(),m=g!==l?gt(t,e,u,p):t.slice(0),v="V"===g?["L",u,m[1]]:"H"===g?["L",m[1],p]:m;[l]=v,"TQ".includes(g)||(o=0,a=0),"M"===l?[,h,d]=v:"L"===l?c+=f(u,p,v[1],v[2]):"A"===l?c+=E(u,p,v[1],v[2],v[3],v[4],v[5],v[6],v[7]):"S"===l?c+=q(u,p,2*i-n,2*r-s,v[1],v[2],v[3],v[4]):"C"===l?c+=q(u,p,v[1],v[2],v[3],v[4],v[5],v[6]):"T"===l?(o=2*i-o,a=2*r-a,c+=U(u,p,o,a,v[1],v[2])):"Q"===l?(o=v[1],a=v[2],c+=U(u,p,v[1],v[2],v[3],v[4])):"Z"===l&&(c+=f(u,p,h,d)),[i,r]="Z"===l?[h,d]:v.slice(-2),[n,s]="C"===l?[v[3],v[4]]:"S"===l?[v[1],v[2]]:[i,r]})),c},Ct=1e-5,It=t=>{let e=pt(t),i={...At};return mt(e,((t,e,r,n)=>{i.x=r,i.y=n;let s=Et(t,i),o=s.length;return i.x1=+s[o-2],i.y1=+s[o-1],i.x2=+s[o-4]||i.x1,i.y2=+s[o-3]||i.y1,s}))},kt=(t,e)=>{let i=It(t),r=!1,n=[],s="M",o=0,a=0,[l,h]=i[0].slice(1),d={x:l,y:h},c=0,u=d,p=0;return"number"!=typeof e||e<Ct?d:(mt(i,((t,i,g,m)=>{if([s]=t,r="M"===s,n=r?n:[g,m].concat(t.slice(1)),r?([,l,h]=t,d={x:l,y:h},c=0):"L"===s?(d=v(n[0],n[1],n[2],n[3],e-p),c=f(n[0],n[1],n[2],n[3])):"A"===s?(d=A(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],e-p),c=E(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8])):"C"===s?(d=V(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],e-p),c=q(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7])):"Q"===s?(d=G(n[0],n[1],n[2],n[3],n[4],n[5],e-p),c=U(n[0],n[1],n[2],n[3],n[4],n[5])):"Z"===s&&(n=[g,m,l,h],d={x:l,y:h},c=f(n[0],n[1],n[2],n[3])),[o,a]=n.slice(-2),!(p<e))return!1;u=d,p+=c})),e>p-Ct?{x:o,y:a}:u)},Nt=(t,e)=>{let i=pt(t),r=i.slice(0),n=Mt(r),s=r.length-1,o=0,a=0,l=i[0];if(s<=0||!e||!Number.isFinite(e))return{segment:l,index:0,length:a,lengthAtSegment:o};if(e>=n)return r=i.slice(0,-1),o=Mt(r),a=n-o,l=i[s],{segment:l,index:s,length:a,lengthAtSegment:o};let h=[];for(;s>0;)l=r[s],r=r.slice(0,-1),o=Mt(r),a=n-o,n=o,h.push({segment:l,index:s,length:a,lengthAtSegment:o}),s-=1;return h.find((({lengthAtSegment:t})=>t<=e))},Lt=(t,e)=>{let i,r=pt(t),n=It(r),s=Mt(n),o=t=>{let i=t.x-e.x,r=t.y-e.y;return i*i+r*r},a=8,l={x:0,y:0},h=0,d=0,c=1/0;for(let t=0;t<=s;t+=a)i=kt(n,t),h=o(i),h<c&&(l=i,d=t,c=h);a/=2;let u,p,g=0,m=0,f=0,v=0;for(;a>1e-6&&(g=d-a,u=kt(n,g),f=o(u),m=d+a,p=kt(n,m),v=o(p),g>=0&&f<c?(l=u,d=g,c=f):m<=s&&v<c?(l=p,d=m,c=v):a/=2,!(a<1e-5)););let b=Nt(r,d);return{closest:l,distance:Math.sqrt(c),segment:b}},Dt=(t,e)=>Lt(t,e).closest,Bt=t=>{let e=0,i=0,r=0;return Pt(t).map((t=>"M"===t[0]?([,e,i]=t,0):(r=((t,e,i,r,n,s,o,a)=>3*((a-e)*(i+n)-(o-t)*(r+s)+r*(t-n)-i*(e-s)+a*(n+t/3)-o*(s+e/3))/20)(e,i,t[1],t[2],t[3],t[4],t[5],t[6]),[e,i]=t.slice(-2),r))).reduce(((t,e)=>t+e),0)},Rt=t=>Bt(Pt(t))>=0,$t=(t,e)=>Nt(t,e).segment,jt=(t,e)=>Lt(t,e).segment,qt=t=>Array.isArray(t)&&t.every((t=>{let e=t[0].toLowerCase();return J[e]===t.length-1&&"achlmqstvz".includes(e)&&t.slice(1).every(Number.isFinite)}))&&t.length>0,Vt=t=>qt(t)&&t.every((([t])=>t===t.toUpperCase())),Ft=t=>Vt(t)&&t.every((([t])=>"ACLMQZ".includes(t))),Ht=t=>Ft(t)&&t.every((([t])=>"MC".includes(t))),zt=(t,e)=>{let{distance:i}=Lt(t,e);return Math.abs(i)<Ct},Ut=t=>qt(t)&&t.slice(1).every((([t])=>t===t.toLowerCase())),Gt=t=>{if("string"!=typeof t||!t.length)return!1;let e=new ut(t);for(ot(e);e.index<e.max&&!e.err.length;)ct(e);return!e.err.length&&"mM".includes(e.segments[0][0])},Zt={line:["x1","y1","x2","y2"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],rect:["width","height","x","y","rx","ry"],polygon:["points"],polyline:["points"],glyph:["d"]},Wt=t=>null!=t&&"object"==typeof t&&1===t.nodeType,Kt=t=>{let e=Object.keys(Zt),i=Wt(t),r=i?t.tagName:null;if(r&&[...e,"path"].every((t=>r!==t)))throw TypeError(`${et}: "${r}" is not SVGElement`);let n=i?r:t.type,s=Zt[n],o={type:n};i?s.forEach((e=>{o[e]=t.getAttribute(e)})):Object.assign(o,t);let a=[];return"circle"===n?a=(t=>{let{cx:e,cy:i,r}=t;return[e,i,r]=[e,i,r].map((t=>+t)),[["M",e-r,i],["a",r,r,0,1,0,2*r,0],["a",r,r,0,1,0,-2*r,0]]})(o):"ellipse"===n?a=(t=>{let{cx:e,cy:i}=t,r=t.rx||0,n=t.ry||r;return[e,i,r,n]=[e,i,r,n].map((t=>+t)),[["M",e-r,i],["a",r,n,0,1,0,2*r,0],["a",r,n,0,1,0,-2*r,0]]})(o):["polyline","polygon"].includes(n)?a=(t=>{let e=[],i=(t.points||"").trim().split(/[\s|,]/).map((t=>+t)),r=0;for(;r<i.length;)e.push([r?"L":"M",i[r],i[r+1]]),r+=2;return"polygon"===t.type?[...e,["z"]]:e})(o):"rect"===n?a=(t=>{let e=+t.x||0,i=+t.y||0,r=+t.width,n=+t.height,s=+(t.rx||0),o=+(t.ry||s);return s||o?(2*s>r&&(s-=(2*s-r)/2),2*o>n&&(o-=(2*o-n)/2),[["M",e+s,i],["h",r-2*s],["s",s,0,s,o],["v",n-2*o],["s",0,o,-s,o],["h",2*s-r],["s",-s,0,-s,-o],["v",2*o-n],["s",0,-o,s,-o]]):[["M",e,i],["h",r],["v",n],["H",e],["Z"]]})(o):"line"===n?a=(t=>{let{x1:e,y1:i,x2:r,y2:n}=t;return[e,i,r,n]=[e,i,r,n].map((t=>+t)),[["M",e,i],["L",r,n]]})(o):["glyph","path"].includes(n)&&(a=pt(i?t.getAttribute("d")||"":t.d||"")),!(!qt(a)||!a.length)&&a},Yt=(t,e,i)=>{let r=i||document,n=Object.keys(Zt),s=Wt(t),o=s?t.tagName:null;if("path"===o)throw TypeError(`${et}: "${o}" is already SVGPathElement`);if(o&&n.every((t=>o!==t)))throw TypeError(`${et}: "${o}" is not SVGElement`);let a=r.createElementNS("http://www.w3.org/2000/svg","path"),l=s?o:t.type,h=Zt[l],d={type:l},c=Q.round,u=Kt(t),p=u&&u.length?St(u,c):"";return s?(h.forEach((e=>{d[e]=t.getAttribute(e)})),Object.values(t.attributes).forEach((({name:t,value:e})=>{h.includes(t)||a.setAttribute(t,e)}))):(Object.assign(d,t),Object.keys(d).forEach((t=>{!h.includes(t)&&"type"!==t&&a.setAttribute(t.replace(/[A-Z]/g,(t=>`-${t.toLowerCase()}`)),d[t])}))),!!Gt(p)&&(a.setAttribute("d",p),e&&s&&(t.before(a,t),t.remove()),a)},Xt=(t,e,i,r)=>{let[n]=t,{round:s}=Q,o="number"==typeof s?s:4,a=e.slice(1),{x1:l,y1:h,x2:d,y2:c,x:u,y:p}=i,[g,m]=a.slice(-2),f=t;if("TQ".includes(n)||(i.qx=null,i.qy=null),"L"===n){if(X(u,o)===X(g,o))return["V",m];if(X(p,o)===X(m,o))return["H",g]}else if("C"===n){let[t,e]=a;if(i.x1=t,i.y1=e,"CS".includes(r)&&(X(t,o)===X(2*l-d,o)&&X(e,o)===X(2*h-c,o)||X(l,o)===X(2*d-u,o)&&X(h,o)===X(2*c-p,o)))return["S",a[2],a[3],a[4],a[5]]}else if("Q"===n){let[t,e]=a;if(i.qx=t,i.qy=e,"QT".includes(r)&&X(t,o)===X(2*l-d,o)&&X(e,o)===X(2*h-c,o))return["T",a[2],a[3]]}return f},Qt=(t,e)=>{let i=t.slice(1).map((t=>X(t,e)));return[t[0]].concat(i)},Jt=(t,e)=>{let i=ft(t),r="number"==typeof e&&e>=0?e:2,n={...At},s=[],o="M",a="Z";return mt(i,((t,e,i,l)=>{n.x=i,n.y=l;let h=Et(t,n),d=t;if([o]=t,s[e]=o,e){a=s[e-1];let o=Xt(t,h,n,a),c=Qt(o,r),u=c.join(""),p=vt(o,e,i,l),g=Qt(p,r),m=g.join("");d=u.length<m.length?c:g}let c=h.length;return n.x1=+h[c-2],n.y1=+h[c-1],n.x2=+h[c-4]||n.x1,n.y2=+h[c-3]||n.y1,d}))},te=t=>{let e=ft(t),i=It(e),r=e.length,n="Z"===e[r-1][0],s=mt(e,((t,s)=>{let o=i[s],a=s&&e[s-1],l=a&&a[0],h=e[s+1],d=h&&h[0],[c]=t,[u,p]=i[s?s-1:r-1].slice(-2),g=t;switch(c){case"M":g=n?["Z"]:[c,u,p];break;case"A":g=[c,t[1],t[2],t[3],t[4],1===t[5]?0:1,u,p];break;case"C":g=h&&"S"===d?["S",t[1],t[2],u,p]:[c,t[3],t[4],t[1],t[2],u,p];break;case"S":g=!l||!"CS".includes(l)||h&&"S"===d?[c,o[1],o[2],u,p]:["C",o[3],o[4],o[1],o[2],u,p];break;case"Q":g=h&&"T"===d?["T",u,p]:[c,t[1],t[2],u,p];break;case"T":g=!l||!"QT".includes(l)||h&&"T"===d?[c,u,p]:["Q",o[1],o[2],u,p];break;case"Z":g=["M",u,p];break;case"H":g=[c,u];break;case"V":g=[c,p];break;default:g=[c].concat(t.slice(1,-2),u,p)}return g}));return n?s.reverse():[s[0]].concat(s.slice(1).reverse())},ee=t=>{let e,i=[],r=-1,n=0,s=0,o=0,a=0,l={...At};return t.forEach((t=>{let[h]=t,d=h.toUpperCase(),c=h.toLowerCase(),u=h===c,p=t.slice(1);"M"===d?(r+=1,[n,s]=p,n+=u?l.x:0,s+=u?l.y:0,o=n,a=s,e=[u?[d,o,a]:t]):("Z"===d?(n=o,s=a):"H"===d?([,n]=t,n+=u?l.x:0):"V"===d?([,s]=t,s+=u?l.y:0):([n,s]=t.slice(-2),n+=u?l.x:0,s+=u?l.y:0),e.push(t)),l.x=n,l.y=s,i[r]=e})),i},ie=c(i(45522),1),re=t=>{let e=new ie.default,{origin:i}=t,[r,n]=i,{translate:s}=t,{rotate:o}=t,{skew:a}=t,{scale:l}=t;return Array.isArray(s)&&s.length>=2&&s.every((t=>!Number.isNaN(+t)))&&s.some((t=>0!==t))?e=e.translate(...s):"number"==typeof s&&!Number.isNaN(s)&&(e=e.translate(s)),(o||a||l)&&(e=e.translate(r,n),Array.isArray(o)&&o.length>=2&&o.every((t=>!Number.isNaN(+t)))&&o.some((t=>0!==t))?e=e.rotate(...o):"number"==typeof o&&!Number.isNaN(o)&&(e=e.rotate(o)),Array.isArray(a)&&2===a.length&&a.every((t=>!Number.isNaN(+t)))&&a.some((t=>0!==t))?(e=a[0]?e.skewX(a[0]):e,e=a[1]?e.skewY(a[1]):e):"number"==typeof a&&!Number.isNaN(a)&&(e=e.skewX(a)),Array.isArray(l)&&l.length>=2&&l.every((t=>!Number.isNaN(+t)))&&l.some((t=>1!==t))?e=e.scale(...l):"number"==typeof l&&!Number.isNaN(l)&&(e=e.scale(l)),e=e.translate(-r,-n)),e},ne=c(i(45522),1),se=(t,e,i)=>{let[r,n,s]=i,[o,a,l]=((t,e)=>{let i=ne.default.Translate(e[0],e[1],e[2]);return[,,,i.m44]=e,i=t.multiply(i),[i.m41,i.m42,i.m43,i.m44]})(t,[e[0],e[1],0,1]),h=a-n,d=l-s;return[(o-r)*(Math.abs(s)/Math.abs(d)||1)+r,h*(Math.abs(s)/Math.abs(d)||1)+n]},oe=(t,e)=>{let i=0,r=0,n=0,s=0,o=0,a=0,l="M",h=pt(t),d=e&&Object.keys(e);if(!e||d&&!d.length)return h.slice(0);e.origin||Object.assign(e,{origin:Q.origin});let c=e.origin,u=re(e);return u.isIdentity?h.slice(0):mt(h,((t,e,d,p)=>{[l]=t;let g=l.toUpperCase(),m=g!==l?gt(t,e,d,p):t.slice(0),f="A"===g?["C"].concat(_t(d,p,m[1],m[2],m[3],m[4],m[5],m[6],m[7])):"V"===g?["L",d,m[1]]:"H"===g?["L",m[1],p]:m;l=f[0];let v="C"===l&&f.length>7,b=v?f.slice(0,7):f.slice(0);if(v&&(h.splice(e+1,0,["C"].concat(f.slice(7))),f=b),"L"===l)[n,s]=se(u,[f[1],f[2]],c),i!==n&&r!==s?f=["L",n,s]:r===s?f=["H",n]:i===n&&(f=["V",s]);else for(o=1,a=f.length;o<a;o+=2)[n,s]=se(u,[+f[o],+f[o+1]],c),f[o]=n,f[o+1]=s;return i=n,r=s,f}))},ae=t=>{let e=t.slice(1).map(((e,i,r)=>i?r[i-1].slice(-2).concat(e.slice(1)):t[0].slice(1).concat(e.slice(1)))).map((t=>t.map(((e,i)=>t[t.length-i-2*(1-i%2)])))).reverse();return[["M"].concat(e[0].slice(0,2))].concat(e.map((t=>["C"].concat(t.slice(2)))))},le=(t,e)=>{let{round:i}=Q;return i="off"===e||"number"==typeof e&&e>=0?e:"number"==typeof i&&i>=0?i:"off","off"===i?t.slice(0):mt(t,(t=>Qt(t,i)))},he=(t,e=.5)=>{let i=e,r=t.slice(0,2),n=t.slice(2,4),s=t.slice(4,6),o=t.slice(6,8),a=g(r,n,i),l=g(n,s,i),h=g(s,o,i),d=g(a,l,i),c=g(l,h,i),u=g(d,c,i);return[["C",a[0],a[1],d[0],d[1],u[0],u[1]],["C",c[0],c[1],h[0],h[1],o[0],o[1]]]},de=c(i(45522),1),ce=class{constructor(t,e){let i=e||{},r=typeof t>"u";if(r||!t.length)throw TypeError(`${et}: "pathValue" is ${r?"undefined":"empty"}`);this.segments=pt(t);let n,{round:s,origin:o}=i;n=Number.isInteger(s)||"off"===s?s:Q.round;let a=Q.origin;if(Array.isArray(o)&&o.length>=2){let[t,e,i]=o.map(Number);a=[Number.isNaN(t)?0:t,Number.isNaN(e)?0:e,Number.isNaN(i)?0:i]}return this.round=n,this.origin=a,this}get bbox(){return Ot(this.segments)}get length(){return Mt(this.segments)}getBBox(){return this.bbox}getTotalLength(){return this.length}getPointAtLength(t){return kt(this.segments,t)}toAbsolute(){let{segments:t}=this;return this.segments=ft(t),this}toRelative(){let{segments:t}=this;return this.segments=bt(t),this}toCurve(){let{segments:t}=this;return this.segments=Pt(t),this}reverse(t){let{segments:e}=this,i=ee(e),r=i.length>1&&i,n=r?r.map(((e,i)=>t?i?te(e):e.slice(0):te(e))):e.slice(0),s=[];return s=r?n.flat(1):t?e:te(e),this.segments=s.slice(0),this}normalize(){let{segments:t}=this;return this.segments=It(t),this}optimize(){let{segments:t}=this,e="off"===this.round?2:this.round;return this.segments=Jt(t,e),this}transform(t){if(!t||"object"!=typeof t||"object"==typeof t&&!["translate","rotate","skew","scale"].some((e=>e in t)))return this;let{segments:e,origin:[i,r,n]}=this,s={};for(let[e,i]of Object.entries(t))"skew"===e&&Array.isArray(i)||("rotate"===e||"translate"===e||"origin"===e||"scale"===e)&&Array.isArray(i)?s[e]=i.map(Number):"origin"!==e&&"number"==typeof Number(i)&&(s[e]=Number(i));let{origin:o}=s;if(Array.isArray(o)&&o.length>=2){let[t,e,a]=o.map(Number);s.origin=[Number.isNaN(t)?i:t,Number.isNaN(e)?r:e,a||n]}else s.origin=[i,r,n];return this.segments=oe(e,s),this}flipX(){let{cx:t,cy:e}=this.bbox;return this.transform({rotate:[0,180,0],origin:[t,e,0]}),this}flipY(){let{cx:t,cy:e}=this.bbox;return this.transform({rotate:[180,0,0],origin:[t,e,0]}),this}toString(){return St(this.segments,this.round)}dispose(){Object.keys(this).forEach((t=>delete this[t]))}static get options(){return Q}static get CSSMatrix(){return p.default}static get arcTools(){return S}static get bezierTools(){return R}static get cubicTools(){return H}static get lineTools(){return y}static get polygonTools(){return K}static get quadTools(){return W}static get pathToAbsolute(){return ft}static get pathToRelative(){return bt}static get pathToCurve(){return Pt}static get pathToString(){return St}static get distanceSquareRoot(){return m}static get midPoint(){return g}static get rotateVector(){return Y}static get roundTo(){return X}static get parsePathString(){return pt}static get finalizeSegment(){return tt}static get invalidPathValue(){return $}static get isArcCommand(){return ht}static get isDigit(){return rt}static get isDigitStart(){return lt}static get isMoveCommand(){return dt}static get isPathCommand(){return at}static get isSpace(){return st}static get paramsCount(){return J}static get paramsParser(){return At}static get pathParser(){return ut}static get scanFlag(){return it}static get scanParam(){return nt}static get scanSegment(){return ct}static get skipSpaces(){return ot}static get distanceEpsilon(){return Ct}static get getClosestPoint(){return Dt}static get getDrawDirection(){return Rt}static get getPathArea(){return Bt}static get getPathBBox(){return Ot}static get getPointAtLength(){return kt}static get getPropertiesAtLength(){return Nt}static get getPropertiesAtPoint(){return Lt}static get getSegmentAtLength(){return $t}static get getSegmentOfPoint(){return jt}static get getTotalLength(){return Mt}static get isAbsoluteArray(){return Vt}static get isCurveArray(){return Ht}static get isNormalizedArray(){return Ft}static get isPathArray(){return qt}static get isPointInStroke(){return zt}static get isRelativeArray(){return Ut}static get isValidPath(){return Gt}static get shapeParams(){return Zt}static get shapeToPath(){return Yt}static get shapeToPathArray(){return Kt}static get absolutizeSegment(){return gt}static get arcToCubic(){return _t}static get getSVGMatrix(){return re}static get iterate(){return mt}static get lineToCubic(){return xt}static get normalizePath(){return It}static get normalizeSegment(){return Et}static get optimizePath(){return Jt}static get projection2d(){return se}static get quadToCubic(){return Tt}static get relativizeSegment(){return vt}static get reverseCurve(){return ae}static get reversePath(){return te}static get roundPath(){return le}static get roundSegment(){return Qt}static get segmentToCubic(){return wt}static get shortenSegment(){return Xt}static get splitCubic(){return he}static get splitPath(){return ee}static get transformPath(){return oe}}},91554:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Literal=function(t,e){return(0,i.CreateType)({[r.Kind]:"Literal",const:t,type:typeof t},e)};const i=e(30768),r=e(73967)},91927:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.KeyOfPropertyEntries=function(t){const e=(0,r.KeyOfPropertyKeys)(t),n=(0,i.IndexFromPropertyKeys)(t,e);return e.map(((t,i)=>[e[i],n[i]]))};const i=e(53094),r=e(2531)},92153:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProductAttrConditionEvaluator=void 0;const ProductAttrFilterMode_1=__webpack_require__(27006);class ProductAttrConditionEvaluator{constructor(){this.debugEnabled=!1,this.debugList=[],this.attributes={},this.ignoredConstraints={},this.debugConstraints={},this.regex=/[$][{].*?[}]/g,this.logEnabled=!1}reset(t){this.attributes=t}clearDebug(){this.debugList=[],this.debugConstraints={}}debug(t){this.debugList.push(t)}debugConstraint(t,e,i){this.debugEnabled&&(this.debugConstraints.hasOwnProperty(t)||(this.debugConstraints[t]={}),this.debugConstraints[t].hasOwnProperty(e)||(this.debugConstraints[t][e]=[]),this.debugConstraints[t][e].push(i))}getDebugConstraints(t,e){return this.debugConstraints.hasOwnProperty(t)&&this.debugConstraints[t].hasOwnProperty(e)?this.debugConstraints[t][e]:null}log(...t){this.logEnabled}ignoreConstraintsFromTo(t,e){this.ignoredConstraints.hasOwnProperty(t)||(this.ignoredConstraints[t]=[]),this.ignoredConstraints[t].push(e)}shouldIgnoreConstraints(t,e){return!(!this.ignoredConstraints.hasOwnProperty(t)&&!this.ignoredConstraints.hasOwnProperty("*"))&&(this.ignoredConstraints[t].indexOf(e)>=0||this.ignoredConstraints[t].indexOf("*")>=0)}filter(t,e){const i=this.getAttribute(e);let r=[],n=[];return(null==i?void 0:i.filters)&&(n=i.filters.filter((e=>this.evalCondition(e.conditions,t))),n.sort(((t,e)=>e.conditionsComplexityScore-t.conditionsComplexityScore)),n.length)&&(i.filterMode===ProductAttrFilterMode_1.ProductAttrFilterMode.MODE_MERGE_ALL_WINNERS?(n.forEach((t=>r=r.concat(t.values))),r=[...new Set(r)]):r=n[0].values,i.isDynamicValue||(r=r.filter((t=>i.valuesAndConstraints.hasOwnProperty(t.toString()))))),[r,n]}canIChangeAttribute(t,e,i){return!!this.doesCurrentItemAllowToChange(t,e,i)&&this.doesAttrValueAllowToBeCombinedWith(t,e,i)}doesAttrValueAllowToBeCombinedWith(t,e,i){const r=this.getConstraintsFor(e,i);if(r){let n=!0;const s=r.match(this.regex);if(s&&(s.forEach((e=>{const i=this.extractConditionedColumnName(e);i&&n&&(n=this.evalConditionAgainstChangeRequest(r,t,i,t[i]))})),!n&&this.debugEnabled)){let r="Blocked by ",n=[];s.forEach((e=>{const i=this.extractConditionedColumnName(e);if(i){const e=i.replace("item.attributes.","");n.push(`'${e}' (${t[i]})`)}})),n=[...new Set(n)],n.length>1&&(r+="any of these: "),r+=n.join(", "),this.debugConstraint(e,i,r),this.debug(r)}return n}return!0}doesCurrentItemAllowToChange(t,e,i){for(const r in t){const n=r.indexOf("item.attributes.")>=0&&r.replace("item.attributes.","");if(n&&n!=e&&!this.shouldIgnoreConstraints(n,e)){const s=this.getAttribute(n);if(s){let o=t[r];Array.isArray(o)||(o=[o]);for(const r in o){const a=o[r],l=this.getConstraintsFor(n,`${a}`);if(l){const r=this.evalConditionAgainstChangeRequest(l,t,"item.attributes."+e,i);if(!r){const t=`'${a} ${n}' doesn't allow '${e}' to be changed to '${i}'.`;return this.debugConstraint(e,i,`Blocked by '${n}' (${a})`),this.log(t,s,l),this.debug(t),r}this.log(`'${s}:${a}'`,!0)}}}}}return!0}evalConditionAgainstChangeRequest(condition,productItemAsOneDimensionalObject,columnNameToBeChanged,columnValueToBeChanged){let result=!0;if(condition.indexOf("${"+columnNameToBeChanged+"}")>=0){const replacedValues={},conditionedColumnNames=condition.match(this.regex);conditionedColumnNames&&conditionedColumnNames.forEach((t=>{const e=this.extractConditionedColumnName(t);e==columnNameToBeChanged?(condition=condition.replace(t,"columnValueToBeChanged"),replacedValues.columnValueToBeChanged=columnValueToBeChanged):(condition=condition.replace(t,"productItemAsOneDimensionalObject['"+e+"']"),replacedValues["productItemAsOneDimensionalObject["+e+"]"]=productItemAsOneDimensionalObject[e])}));try{this.log("testConditionAgainstChangeRequest:",condition,replacedValues),result=eval(condition)}catch(t){}}return result}evalCondition(condition,productItemAsOneDimensionalObject){let result=!0;if(condition&&condition.length){const replacedValues={},conditionedColumnNames=condition.match(this.regex);conditionedColumnNames&&conditionedColumnNames.forEach((t=>{const e=this.extractConditionedColumnName(t);condition=condition.replace(t,"productItemAsOneDimensionalObject['"+e+"']"),replacedValues["productItemAsOneDimensionalObject["+e+"]"]=productItemAsOneDimensionalObject[e]}));try{this.log("simpleConditionTest:",condition,replacedValues),result=eval(condition)}catch(t){}}return result}isNotIn(t,e){return!t||(Array.isArray(t)&&!Array.isArray(e)?t.indexOf(e)<0:!Array.isArray(t)&&Array.isArray(e)?e.indexOf(t)<0:Array.isArray(t)&&Array.isArray(e)?0==e.filter((e=>t.indexOf(e)>=0)).length:!Array.isArray(t)&&!Array.isArray(e)&&t!=e)}isIn(t,e){return!!t&&(Array.isArray(t)&&!Array.isArray(e)?t.indexOf(e)>=0:!Array.isArray(t)&&Array.isArray(e)?e.indexOf(t)>=0:Array.isArray(t)&&Array.isArray(e)?e.filter((e=>t.indexOf(e)>=0)).length>0:!Array.isArray(t)&&!Array.isArray(e)&&t==e)}extractConditionedColumnName(t){var e;const i=null===(e=t.match(this.regex))||void 0===e?void 0:e.pop();return i?i.replace("$","").replace("{","").replace("}",""):null}getConstraintsFor(t,e){const i=this.getAttribute(t);return i&&i.valuesAndConstraints.hasOwnProperty(e)?i.valuesAndConstraints[e]:null}getAttribute(t){return this.attributes.hasOwnProperty(t)?this.attributes[t]:null}}exports.ProductAttrConditionEvaluator=ProductAttrConditionEvaluator},92217:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(80371),exports)},92471:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ReadonlyFromMappedResult=function(t,e){const n=function(t,e){return function(t,e){const i={};for(const n of globalThis.Object.getOwnPropertyNames(t))i[n]=(0,r.Readonly)(t[n],e);return i}(t.properties,e)}(t,e);return(0,i.MappedResult)(n)};const i=e(34013),r=e(15688)},92590:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},93479:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(30341),exports),r(e(3110),exports)},93700:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Uncapitalize=function(t,e={}){return(0,i.Intrinsic)(t,"Uncapitalize",e)};const i=e(786)},93714:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Kind=exports.Hint=exports.OptionalKind=exports.ReadonlyKind=exports.TransformKind=void 0,exports.TransformKind=Symbol.for("TypeBox.Transform"),exports.ReadonlyKind=Symbol.for("TypeBox.Readonly"),exports.OptionalKind=Symbol.for("TypeBox.Optional"),exports.Hint=Symbol.for("TypeBox.Hint"),exports.Kind=Symbol.for("TypeBox.Kind")},94099:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(11890),exports)},94225:(t,exports)=>{"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),exports.UnitTypeNames=void 0,function(t){t.SquareMeter="square_meter",t.PerPiece="per_piece",t.SquareMeterWithBleed="square_meter_with_bleed"}(e||(exports.UnitTypeNames=e={}))},94401:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TypeDereferenceError=void 0,exports.Pushref=function(t,e){return!(0,n.IsString)(t.$id)||e.some((e=>e.$id===t.$id))||e.push(t),e},exports.Deref=function t(e,i){return"This"===e[r.Kind]||"Ref"===e[r.Kind]?function(e,i){const r=i.find((t=>t.$id===e.$ref));if(void 0===r)throw new s(e);return t(r,i)}(e,i):e};const i=e(87580),r=e(73967),n=e(60585);class s extends i.TypeBoxError{constructor(t){super(`Unable to dereference schema with $id '${t.$ref}'`),this.schema=t}}exports.TypeDereferenceError=s},94641:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TemplateLiteralToUnion=function(t){const e=(0,n.TemplateLiteralGenerate)(t).map((t=>(0,r.Literal)(t)));return(0,i.UnionEvaluated)(e)};const i=e(85713),r=e(12881),n=e(82415)},94642:t=>{t.exports=function(t){function e(t){"undefined"!=typeof console&&(console.error||console.log)("[Script Loader]",t)}try{"undefined"!=typeof execScript&&"undefined"!=typeof attachEvent&&"undefined"==typeof addEventListener?execScript(t):"undefined"!=typeof eval?eval.call(null,t):e("EvalError: No eval function available")}catch(t){e(t)}}},95421:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TemplateLiteralParserError=void 0,exports.TemplateLiteralParse=h,exports.TemplateLiteralParseExact=function(t){return h(t.slice(1,t.length-1))};const i=e(87580);class r extends i.TypeBoxError{}function n(t){return t.replace(/\\\$/g,"$").replace(/\\\*/g,"*").replace(/\\\^/g,"^").replace(/\\\|/g,"|").replace(/\\\(/g,"(").replace(/\\\)/g,")")}function s(t,e,i){return t[e]===i&&92!==t.charCodeAt(e-1)}function o(t,e){return s(t,e,"(")}function a(t,e){return s(t,e,")")}function l(t,e){return s(t,e,"|")}function h(t){return function(t){if(!o(t,0)||!a(t,t.length-1))return!1;let e=0;for(let i=0;i<t.length;i++)if(o(t,i)&&(e+=1),a(t,i)&&(e-=1),0===e&&i!==t.length-1)return!1;return!0}(t)?h(function(t){return t.slice(1,t.length-1)}(t)):function(t){let e=0;for(let i=0;i<t.length;i++)if(o(t,i)&&(e+=1),a(t,i)&&(e-=1),l(t,i)&&0===e)return!0;return!1}(t)?function(t){let[e,i]=[0,0];const r=[];for(let n=0;n<t.length;n++)if(o(t,n)&&(e+=1),a(t,n)&&(e-=1),l(t,n)&&0===e){const e=t.slice(i,n);e.length>0&&r.push(h(e)),i=n+1}const n=t.slice(i);return n.length>0&&r.push(h(n)),0===r.length?{type:"const",const:""}:1===r.length?r[0]:{type:"or",expr:r}}(t):function(t){for(let e=0;e<t.length;e++)if(o(t,e))return!0;return!1}(t)?function(t){function e(t,e){if(!o(t,e))throw new r("TemplateLiteralParser: Index must point to open parens");let i=0;for(let r=e;r<t.length;r++)if(o(t,r)&&(i+=1),a(t,r)&&(i-=1),0===i)return[e,r];throw new r("TemplateLiteralParser: Unclosed group parens in expression")}function i(t,e){for(let i=e;i<t.length;i++)if(o(t,i))return[e,i];return[e,t.length]}const n=[];for(let r=0;r<t.length;r++)if(o(t,r)){const[i,s]=e(t,r),o=t.slice(i,s+1);n.push(h(o)),r=s}else{const[e,s]=i(t,r),o=t.slice(e,s);o.length>0&&n.push(h(o)),r=s-1}return 0===n.length?{type:"const",const:""}:1===n.length?n[0]:{type:"and",expr:n}}(t):{type:"const",const:n(t)}}exports.TemplateLiteralParserError=r},96347:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isEmpty=function(t){return null==t||""===t||Array.isArray(t)&&0===t.length},exports.toArray=function(t){return Array.isArray(t)?t:[t]},exports.unique=function(...t){return[...new Set(t.flat())]}},96937:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(16866),exports)},97069:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(43665),exports)},97439:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(2562),exports)},97476:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(78349),exports)},97658:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Enum=function(t,e){if((0,s.IsUndefined)(t))throw new Error("Enum undefined or empty");const o=globalThis.Object.getOwnPropertyNames(t).filter((t=>isNaN(t))).map((e=>t[e])),a=[...new Set(o)].map((t=>(0,i.Literal)(t)));return(0,n.Union)(a,{...e,[r.Hint]:"Enum"})};const i=e(12881),r=e(73967),n=e(85713),s=e(72862)},98146:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(53214),exports)},98255:(t,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TransformHelper=void 0,exports.TransformHelper=class{constructor(t){this.size=t}evaluateScale(t,e){const i=Math.max(...e),r=Math.min(...e);return e=e.map((e=>e*t)),this.areDimensionsValid("min_size_mm",e)?this.size.hasMaxSizeOtherSide()&&!this.areDimensionsValid("max_size_other_side_mm",e)&&i/r<this.size.maxSize.mm/this.size.maxSizeOtherSide.mm?this.size.maxSizeOtherSide.mm/r:this.areDimensionsValid("max_size_mm",e)?t:this.size.maxSize.mm/i:this.size.minSize.mm/r}areDimensionsValid(t,e){switch(t){case"min_size_mm":return!e.some((t=>t<this.size.minSize.mm));case"max_size_other_side_mm":return!e.every((t=>t>this.size.maxSizeOtherSide.mm));case"max_size_mm":return!e.some((t=>t>this.size.maxSize.mm));default:return!1}}}},98493:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PickFromMappedKey=function(t,e,r){const n=function(t,e,i){return function(t,e,i){return e.reduce(((e,r)=>({...e,...s(t,r,i)})),{})}(t,e.keys,i)}(t,e,r);return(0,i.MappedResult)(n)};const i=e(34013),r=e(28222),n=e(19922);function s(t,e,i){return{[e]:(0,r.Pick)(t,[e],(0,n.Clone)(i))}}},98623:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Rest=function(t){return function(t){return(0,i.IsIntersect)(t)?t.allOf:(0,i.IsUnion)(t)?t.anyOf:(0,i.IsTuple)(t)?t.items??[]:[]}(t)};const i=e(51049)},98726:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InstanceType=function(t,e){return(0,i.CreateType)(t.returns,e)};const i=e(30768)},99469:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Clone=function t(e){if((0,i.IsArray)(e))return function(e){return e.map((e=>t(e)))}(e);if((0,i.IsDate)(e))return function(t){return new Date(t.toISOString())}(e);if((0,i.IsTypedArray)(e))return function(t){return t.slice()}(e);if((0,i.IsMap)(e))return function(e){return new Map(t([...e.entries()]))}(e);if((0,i.IsSet)(e))return function(e){return new Set(t([...e.entries()]))}(e);if((0,i.IsObject)(e))return function(e){const i={};for(const r of Object.getOwnPropertyNames(e))i[r]=t(e[r]);for(const r of Object.getOwnPropertySymbols(e))i[r]=t(e[r]);return i}(e);if((0,i.IsValueType)(e))return e;throw new Error("ValueClone: Unable to clone value")};const i=e(79968)},99899:(t,exports,e)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),e(73967)},99974:function(t,exports,e){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),r=this&&this.__exportStar||function(t,exports){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(exports,e)||i(exports,t,e)};Object.defineProperty(exports,"__esModule",{value:!0}),r(e(51966),exports)}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var i=__webpack_module_cache__[t]={id:t,exports:{}};return __webpack_modules__[t].call(i.exports,i,i.exports,__webpack_require__),i.exports}__webpack_require__.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(exports,t)=>{for(var e in t)__webpack_require__.o(t,e)&&!__webpack_require__.o(exports,e)&&Object.defineProperty(exports,e,{enumerable:!0,get:t[e]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var __webpack_exports__={};(()=>{"use strict";__webpack_require__(26299);var t,e=__webpack_require__(55687);let i;!function(t){t.LARGE="large",t.TABLET="tablet",t.PHONE="phone"}(t||(t={})),navigator.userAgent.match(/instagram/i)&&document.body.classList.add("instagram-in-app"),window.addEventListener("resize",(()=>{const e=function(){const e=window.innerWidth;return e>992?t.LARGE:e<768?t.PHONE:t.TABLET}();if(e!==i){i=e;const t=new Event("MediaChange");t.size=e,document.dispatchEvent(t)}})),document.addEventListener("MediaChange",(t=>{const e=document.querySelectorAll('[data-toggle="tooltip"]');e.length&&(e.forEach((t=>{t.style.animation="none"})),"desktop"===t.size?e.forEach((t=>{t.tooltipEnabled=!0})):e.forEach((t=>{t.tooltipEnabled=!1})));const i=document.querySelector(".stapp-nav"),r=null==i?void 0:i.querySelector(".nav-content");i&&("phone"===t.size&&r?r.style.display="none":r&&(r.style.display="block"))})),window.addEventListener("load",(()=>{document.querySelectorAll("a.scroll").forEach((t=>{t.addEventListener("click",(e=>{e.preventDefault();const i=document.querySelector(t.getAttribute("href")),r=parseInt(t.getAttribute("data-offset")||"0",10);i&&window.scrollTo({top:i.offsetTop-r,behavior:"smooth"})}))}));const e=window.innerWidth;i=e>992?t.LARGE:e<768?t.PHONE:t.TABLET;const r=new Event("MediaChange");r.size=i,document.dispatchEvent(r);const n=document.querySelector(".stapp-nav");if(n){const t=n.querySelector(".nav-toggle"),e=n.querySelectorAll(".dropdown-toggle"),r=n.querySelectorAll(".dropdown-toggle-with-link");t&&t.addEventListener("click",(t=>{const e=n.querySelector(".nav-content");e&&(e.style.display="none"===e.style.display?"block":"none")})),e.forEach((t=>{t.addEventListener("click",(e=>{var r;if("phone"===i){e.preventDefault();const i=null===(r=t.parentElement)||void 0===r?void 0:r.querySelector("ul");return i&&(i.style.display="none"===i.style.display?"block":"none"),!1}}))})),r.forEach((t=>{t.addEventListener("click",(e=>{var i,r;e.preventDefault();const n=null===(r=null===(i=t.parentElement)||void 0===i?void 0:i.parentElement)||void 0===r?void 0:r.querySelector("ul");return n&&(n.style.display="none"===n.style.display?"block":"none"),!1}))}))}document.querySelectorAll(".no-action").forEach((t=>{t.addEventListener("click",(t=>{t.stopPropagation()}))}))}));class r{constructor(t){this.$el=t}$(t){return this.$el.find(t)}destroy(){this.$el.remove(),this.$el.off()}on(t,e,i){return this.$el.on(t,e,i)}off(t,e,i){return this.$el.off(t,e,i)}trigger(t,e){return this.$el.trigger(t,e)}get $el(){return this._$el}get el(){return this._$el.get(0)}set $el(t){this._$el=t}addEventListeners(t,e,i){this.el.querySelectorAll(t).forEach((t=>{t.addEventListener(e,(t=>{i(t)}))}))}}class n{static isLandscape(t,e){let i=t>=480;return t<=e&&t<800&&(i=!1),i}static isLarge(t,e){return t>=480&&e>=480}static isTouchDevice(){return!!("ontouchstart"in window)}static getDeviceType(){const t=navigator.userAgent;return/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(t)?"tablet":/Mobile|iP(hone|od)|Android|BlackBerry|IEMobile|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(t)?"mobile":"desktop"}static isInstagramInAppBrowser(){return!!navigator.userAgent.match(/instagram/i)}}class s{constructor(t){if(this.elementOrJquery=t,!s._instance){if(t instanceof jQuery){const e=t;this.element=e.get(0)}else this.element=t;this._buttons=[],this._btnConfirm=document.createElement("button"),this._btnConfirm.classList.add("bs5-btn","bs5-btn-outline-secondary","bs5-rounded-pill","btn-confirm"),this._btnConfirm.textContent=this.element.dataset.langOk,this._btnCancel=document.createElement("button"),this._btnCancel.classList.add("bs5-btn","bs5-btn-warning","bs5-rounded-pill","btn-cancel"),this._btnCancel.textContent=this.element.dataset.langCancel,this._btnYes=document.createElement("button"),this._btnYes.classList.add("bs5-btn","bs5-btn-outline-secondary","bs5-rounded-pill","btn-yes"),this._btnYes.textContent=this.element.dataset.langYes,this._btnNo=document.createElement("button"),this._btnNo.classList.add("bs5-btn","bs5-btn-warning","bs5-rounded-pill","btn-no"),this._btnNo.textContent=this.element.dataset.langNo,this._title=document.createElement("div"),this._title.classList.add("f-col-12","f-justify-center","text-center","title","h3")}}confirm(t,e=null){this.clearTitle(),this.clearButtons(),this.text=t,this.addButton(this._btnConfirm),this._onConfirmClick=e,this.show()}yesOrNo(t,e,i=null){this.clearTitle(),this.clearButtons(),this.text=t,this.addButton(this._btnNo),this.addButton(this._btnYes),this._onConfirmClick=e,this._onCancelClick=i,this.show()}confirmOrCancel(t,e,i=null){this.clearTitle(),this.clearButtons(),this.text=t,this.addButton(this._btnCancel),this.addButton(this._btnConfirm),this._onConfirmClick=e,this._onCancelClick=i,this.show()}addButton(t){if(t instanceof jQuery){let e=$('<div class="f-col f-none p-l-0"></div>');e.append(t),this.$actionsRow.append(e)}else{let e=document.createElement("div");e.classList.add("f-col","f-none","p-l-0"),e.append(t),this.actionsRow.append(e),this._buttons.push(t)}this.element.querySelectorAll(".btn-confirm, .btn-yes").forEach((t=>{t.addEventListener("click",(t=>{t.stopImmediatePropagation(),this.onConfirm(t)}))})),this.element.querySelectorAll(".btn-cancel, .btn-no").forEach((t=>{t.addEventListener("click",(t=>{t.stopImmediatePropagation(),this.onCancel(t)}))}))}clearButtons(){for(const t of this._buttons)t.remove();this._buttons=[],this.actionsRow.innerHTML=""}show(){this.element.classList.add("in")}hide(){s._instance=void 0,this.element.classList.remove("in")}static get ELEMENT_ID(){return"confirm-modal"}static get instance(){return s._instance||(s._instance=new s(document.querySelector("#"+s.ELEMENT_ID))),s._instance}get contentRow(){return this.element.querySelector(".content")}get actionsRow(){return this.element.querySelector(".actions")}get $actionsRow(){return $(".actions")}get $el(){return $(this.element)}set text(t){this.contentRow.textContent=t}set html(t){this.contentRow.innerHTML=t}onConfirm(t){t.preventDefault(),this.clearTitle(),this.hide(),this._onConfirmClick&&this._onConfirmClick(t)}onCancel(t){t.preventDefault(),this.clearTitle(),this.hide(),this._onCancelClick&&this._onCancelClick(t)}onButtonClick(t){t.preventDefault()}clearTitle(){this.element.classList.remove("title-design"),this._title.remove()}set title(t){this._title.innerHTML=t,this.contentRow.parentElement.prepend(this._title)}confirmWithTitle(t,e,i=null){this.clearTitle(),this.clearButtons(),this.element.classList.add("title-design"),this.text=t,this.title=e,this.addButton(this._btnConfirm),this._onConfirmClick=i,this.show()}confirmOrCancelWithTitle(t,e,i=null,r=null){this.clearTitle(),this.clearButtons(),this.element.classList.add("title-design"),this.text=t,this.title=e,this.addButton(this._btnConfirm),this.addButton(this._btnCancel),this._onConfirmClick=i,this._onCancelClick=r,this.show()}}class o{static getDomain(){return window.hasOwnProperty("DOMAIN")?DOMAIN:""}static getProtocol(){return window.hasOwnProperty("PROTOCOL")?PROTOCOL:""}static isDevMode(){return window.hasOwnProperty("ENVIRONMENT")&&"development"==ENVIRONMENT}static isLocalDevMode(){return window.location.toString().indexOf("192.168")>=0}static isTestMode(){return window.hasOwnProperty("ENVIRONMENT")&&"testing"==ENVIRONMENT}static isAdmin(){return window.hasOwnProperty("SITE")&&"admin"==SITE.toLowerCase()}static isProd(){return window.hasOwnProperty("ENVIRONMENT")&&"production"==ENVIRONMENT}static langTRoTLD(t){if(o.isDevMode())return"ci";if(o.isTestMode())return"nu";switch(t){case"us":t="com";break;case"uk":t="co.uk"}return t}static isCheckout(){return $("body").hasClass("checkout")}static isPhone(){return"phone"==i}}var a,l,h,d,c,u,p,g;window.DevUtil=o,function(t){t.INITIATED="editorInitiated",t.DESTROY="editorDestroy",t.BACKSIDEPRINT_MODIFIED="editorUIBacksidePrintModified",t.PART_EDITED="partEdited",t.UPLOAD_START="editorUploadStart",t.UPLOAD_CANCEL="editorUploadCancel",t.UPLOAD_END="editorUploadEnd",t.TOOL_PANE_STATE_CHANGE="editorToolPaneStateChange",t.ORIENTATION_CHANGE="editorOrientationChange",t.ORIENTATION_UPDATE="editorOrientationUpdate",t.OPEN_TOOL="editorOpenTool",t.CLOSE_TOOL="editorCloseTool",t.PRE_SAVE="editorPreSave",t.SAVE="editorSave",t.REQUEST_UPDATE="editorRequestUpdate",t.UPDATED="editorUpdated",t.UPDATE_FAILED="editorUpdateFailed",t.REQUEST_PRODUCT_ATTR_EVALUATION="editorRequestProductAttrEvaluation",t.PRODUCT_ATTR_EVALUATED="editorProductAttrEvaluated",t.DATA_POSTED="editorDataPosted",t.OPEN_TEMPLATE_TYPE_SELECTOR="editorOpenTemplateTypeSelector",t.BACKSIDEPRINT_REMOVED="backsidePrintRemoved",t.UPDATE_BACKPRINT_PATH="updateBackPrintPath",t.PRE_CHECKOUT_ACTION="preCheckoutAction",t.SWITCH_SIDE="editorSwitchSide",t.LAMINATE_CHANGE="laminateChange",t.MATERIAL_CHANGE="materialChange",t.LIVE_PREVIEW_HIDE="editorLivePreviewHide",t.LIVE_PREVIEW_SHOW="editorLivePreviewShow",t.BACKGROUND_UPDATED="backgroundUpdated",t.LIVE_PREVIEW_BASE_PROPS_CHANGE="livePreviewBasePropChange",t.LIVE_PREVIEW_RELOAD_MASKS="livePreviewReloadMasks",t.GENERAL_ERROR="error"}(a||(a={}));class m extends r{static get STATE_RENDER_IDLE(){return"state_render_idle"}static get STATE_RENDER_LOAD_CSS(){return"state_render_load_css"}static get STATE_RENDER_LOAD_JS(){return"state_render_load_js"}static get STATE_RENDER_LOAD_HTML(){return"state_render_load_html"}static get ELEMENT_ID(){return"editor-modal"}constructor(t){if(super(t),m._instance)return;let e=this,i=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,r=window.devicePixelRatio||1,s=(window.screen.width,window.screen.height*r);this._$closeButton=this.$("button.close"),this.onOrientationUpdate(null,null),(!i||i&&2436!=s)&&this.$(".editor-modal-content").css("padding-bottom","0"),this.on("click",(t=>this.onClick(t))),this.on(a.INITIATED,".editor",(function(t){let i=t.originalEvent.detail;e._editor=i,$(this).find(".modal.modal-scrollable").each((function(){e.$el.append($(this)),$(this).on("show.bs.modal",(function(){e.$content.css("opacity","0")})),$(this).on("hide.bs.modal",(function(){e.$content.css("opacity","1")}))}))})),this.on("click",".editor .btn-home, .editor .btn-back, .editor-modal-content > button.close",(t=>this.onClickBack(t))),this.on(a.ORIENTATION_UPDATE,".editor",((t,e)=>this.onOrientationUpdate(t,e))),this.on("mousedown",(t=>this.onMouseDown(t))),this.on("mouseup",(t=>this.onMouseUp(t))),n.isInstagramInAppBrowser()&&$(window).on("scroll",(t=>this.onInstagramWindowScroll(t)))}renderWithData(t){this.onLoadEditor(t)}render(t,e){this.sheetPreviewComponent=e,this.$editor.length||($("#overlay").show(),this._editorAPIURL=t,this.destroyEditor(),this._xhr&&this._xhr.abort(),this._xhr=$.ajax(this._editorAPIURL,{success:t=>{this.onLoadEditor(t)},error:t=>{o.isAdmin()&&(s.instance.confirmWithTitle(t.responseText,"Error"),this.$el.trigger("hidden.stickerapp.editormodal"),$("#overlay").hide())}}))}show(){this._bodyScrollTopBeforeOpen=$(window).scrollTop();let t=document.getElementById("editor-modal");t&&t.classList.add("in"),$("body").addClass("editor-modal-open"),this.buildEditor()}maybeHide(t=!0){this.askBeforeHide?this.confirmHide(t):this.hide(t)}confirmHide(t=!0,e=null){return s.instance.confirmOrCancel(this._editor.model.language.unload_warning,(()=>this.hide(t)),e),!1}hide(t=!0){var e;$("body").removeClass("editor-modal-open"),$(window).scrollTop(this._bodyScrollTopBeforeOpen);const i=null!==(e=document.querySelectorAll("div#editor-modal")[0])&&void 0!==e?e:void 0;i&&($(i).removeClass("in"),this.destroyEditor(),t&&$(i).trigger("hidden.stickerapp.editormodal"))}destroyEditor(){var t;const e=null!==(t=document.querySelectorAll("div#editor-modal div.editor")[0])&&void 0!==t?t:void 0;$(e).trigger("selfdestroy.stickerapp.editor"),$(e).remove(),this.$(".modal").remove()}buildEditor(){var t;const e=null!==(t=document.querySelectorAll("div#editor-modal div.editor")[0])&&void 0!==t?t:void 0;$(e).trigger("build.stickerapp.editor")}static get instance(){return m._instance||(m._instance=new m($("#"+m.ELEMENT_ID))),m._instance}get askBeforeHide(){return this._editor.model.settings.askBeforeExit&&this._editor.helpers.change.isChanged2()}get editorAPIURL(){return this._editorAPIURL}get $editor(){return this.$(".editor")}get sheetPreviewComponent(){return this._sheetPreviewComponent}set sheetPreviewComponent(t){this._sheetPreviewComponent=t}get isShown(){return this.$el.hasClass("in")}get $content(){return this.$(".editor-modal-content")}onLoadEditor(t){var e;$("#overlay").hide(),this._$closeButton.remove();const i=null!==(e=document.querySelectorAll("div#editor-modal div.editor-modal-content")[0])&&void 0!==e?e:void 0;$(i).html(t),$(i).find(".modal").each((function(){$(this).attr("data-backdrop","false")})),this.$content.append(this._$closeButton),this.show()}onClick(t){}onMouseDown(t){this._$startClickTarget=$(t.target)}onMouseUp(t){this._$startClickTarget&&(this._$startClickTarget.hasClass("editor-modal")?this.$el.hasClass("animating")||this.maybeHide():this._$startClickTarget.hasClass("modal")&&this._$startClickTarget.modal("hide")),this._$startClickTarget=null}onClickBack(t){t.preventDefault(),t.stopPropagation(),this._editor.model.settings.backPrintToolEnabled?this._editor.ui.closeEditor():this.maybeHide()}onOrientationUpdate(t,e){let i=e?e.isLandscape:wd.isLandscape(this.$el.width(),this.$el.height()),r=e?e.isLarge:wd.isLarge(this.$el.width(),this.$el.height());this.$el.attr("data-is-orientation-landscape",i),this.$el.attr("data-is-large-mode",r)}onInstagramWindowScroll(t){this._editor&&!this._editor.focus&&this.$el.find(".editor-modal-content").css("margin-top",$(window).scrollTop())}}class f{execute(t,e){}}class v extends f{get context(){return this.editor.context}get helpers(){return this.editor.helpers}get model(){return this.editor.model}}class b extends v{execute(t){t.preventDefault()}}!function(t){t.OVER_ALWAYS="always",t.OVER_LAYER="layerOver",t.OVER_BBOX="bboxOver",t.OVER_NEVER="neverOver",t.OVER_IGNORE="ignoreOver",t.OVER_ZOOMED="zoomedOver"}(l||(l={})),function(t){t.TRANSFORM_MOVE="translate",t.TRANSFORM_SCALE="scale",t.TRANSFORM_ROTATE="rotate",t.TRANSFORM_SKEW="skew",t.TRANSFORM_MATRIX="matrix",t.TRANSFORM_CREATE="create_node"}(h||(h={})),function(t){t.PART="Part",t.PART_TYPE_PATH="path",t.PART_TYPE_RECT="rect",t.PART_TYPE_ROUND="round",t.PART_TYPE_TRIANGLE="triangle",t.PART_TYPE_IMAGE="image",t.LAYER_ROOT="LayerRoot",t.CLIP_PATH="ClipPath",t.SHAPE_PATH="ShapePath",t.DEFS="Defs",t.LAYER_STANDARD="LayerStandard",t.LAYER_SHADOW="LayerShadow",t.SHAPE_TEXT="ShapeText",t.GROUP_ICON="GroupIcon",t.SHAPE_CIRCLE="ShapeCircle",t.SHAPE_IMAGE="ShapeImage",t.SHAPE_MULTI="ShapeMulti",t.SHAPE_RECT="ShapeRect",t.LAYER_SHEET="LayerSheet",t.COLLAGE="Collage",t.GROUP_STANDARD="GroupStandard"}(d||(d={})),function(t){t.ZOOM_SHEET="sheet",t.ZOOM_PART="part"}(c||(c={})),function(t){t.NAMESPACE="http://www.w3.org/2000/svg",t.XLINK="http://www.w3.org/1999/xlink",t.STICKIT_NS="http://www.stickerapp.se"}(u||(u={})),function(t){t.NODE_CREATED="editorSVGNodeCreated",t.NODE_TRANSFORMED="editorSVGNodeTransformed",t.IMAGE_CHECK_QUALITY="editorSVGShapeImageCheckQuality",t.TEXT_SELECTED="editorSVGShapeTextSelected",t.TEXT_EDIT="editorSVGShapeTextEdit",t.CLICK="editorClick",t.DOUBLE_CLICK="editorDblClick",t.DRAG_START="editorStartDrag",t.DRAG_MOVE="editorMoveDrag",t.DRAG_END="editorEndDrag",t.MOUSE_MOVE="editorMoveNoDrag",t.MOUSE_LEAVE="editorLeaveSVG",t.TOUCH_START="editorStartTouch",t.TOUCH_END="editorEndTouch",t.GESTURE_ROTATE="editorRotate",t.GESTURE_ZOOM="editorZoom",t.GESTURE_SWAP_TRANSFORM="editorSwapTranform",t.SVG_CREATED="editorSVGCreated",t.SVG_PART_LOADED="editorSVGPartCreated",t.SVG_ALL_PARTS_LOADED="editorSVGPartsLoaded",t.SVG_PART_SCALING="editorSVGPartScaling",t.SVG_PART_SCALING_DONE="editorSVGPartScalingDone",t.SVG_DESTROYED="editorSVGDestroyed",t.IS_TOUCH="editorIsTouch",t.READY="editorReady",t.RESIZE="editorResize",t.ZOOM_CHANGE="editorZoomChange",t.SVG_CHANGE_MODE="editorSVGChangeMode",t.PREVIEW_MODE_ON="editorPreviewON",t.PREVIEW_MODE_OFF="editorPreviewOFF",t.SELECT_NODE="editorSelectNode",t.DESELECT_NODE="editorDeselectNode",t.ADD_NOTIFICATION="editorAddNotification",t.REMOVE_NOTIFICATION="editorRemoveNotification",t.DEACTIVATE_COLLAGE="editorDeactivateCollage",t.ACTIVATE_COLLAGE="editorActivateCollage",t.SVG_PART_ASPECT_CHANGED="editorPartAfterChangeAspect",t.NODE_MENU_CLICK_UPLOAD="editorNodeMenuClickUpload",t.ZOOM_ANIMATION_END="editorZoomAnimationEnd",t.NODE_REMOVED="editorNodeRemoved",t.SVG_PART_IMAGES_QUALITY_UPDATED="editorSVGPartImagesUpdated",t.NEW_TEXT_NODE_ADDED="editorNewSVGTextNodeAdded"}(p||(p={}));class y{constructor(t,e=null){this.type=t,this.svgTag=e,this.svg=null,this.options=null,this.parent=null,this.parentIndex=0,this.part=null,this.element=null,this.id="",this.intId="",this.boundingBox=null,this.hoverElement=null,this.selectElement=null,this.selectToolElement1=null,this.selectToolElement2=null,this.children=[],this.overHandling=l.OVER_BBOX,this.part_type=null,this.path_type=null,this.isClickThrough=null,this.isSelectable=null,this.isOverable=null,this.isTransformable=!1,this.isResizeable=!1,this.isRotateable=!1,this.isSkewable=!1,this.isMoveable=!1,this.isDeleteable=!0,this.isAspectChangable=!1,this.isCopyable=!1,this.isUpDownable=!0,this.isEditable=!0,this.isLockedContent=!1,this.isIndexLocked=!1,this.isSheetBackground=!1,this.ignore=!1,this.icon=!1,this.isStrangeCenter=!1,this.isResizable=null,this.center=null,this.calcBBox=!0,this.lastTransformType=null,this.selectRedirect=null,this.collageObject=null,this.path=null,this.orgPath=null,this.bleed=null,this.render=null,this.select=null,this.oldScaleX_=0,this.oldScaleY_=0,this.startMatrix_=null,this.startNWPoint_=null,this.startNEPoint_=null,this.startSEPoint_=null,this.startSWPoint_=null,this.startNPoint_=null,this.startEPoint_=null,this.startSPoint_=null,this.startWPoint_=null,this.tempTransform1_=null,this.tempTransform2_=null,this.startCenter_=null,this.intId="node"+Math.random().toString().replace(",","").replace(".","")}transforming(t,e,i){return e}onElementCreated(t=null){t&&t(this)}specialBeforeTransform(){}specialAfterTransform(t){}specialTransform(t,e,i){}remove(){}onInit(){}updateOptions(){}init(t,e,i,r=null){this.options=i,this.parent=t,this.svg=e,this.onInit(),this.create(r)}create(t=null){null!=this.svgTag&&(this.element=document.createElementNS(u.NAMESPACE,this.svgTag)),this.addSelfToParent(),null!=this.svgTag&&this.onElementCreated(t),this.updateNodeOptions()}addSelfToParent(){this.parent&&this.parent.addChild(this,this.parentIndex)}getElement(){if(null!=this.element)return this.element;if(this.parent)return this.parent.getElement();throw"No elements above root"}renderChildren(){let t=this.getElement();for(let e=this.children.length-1;e>=0;e--)this.children[e].renderChildren(),null!=this.children[e].element&&t.appendChild(this.children[e].element)}updateNodeOptions(){this.options.id&&(this.id=this.options.id),this.updateOptions()}isOverBBox(t){return!(null==t||null==this.boundingBox||t.x<this.boundingBox.x||t.x>this.boundingBox.x+this.boundingBox.width||t.y<this.boundingBox.y||t.y>this.boundingBox.y+this.boundingBox.height)}isOverBBoxInklChildren(t,e,i,r=0){var n;let s=[];if(r>0){r++;for(let t=0;t<e.length;t++)"   ".repeat(t)}if(this.svg.svgSettings.zoomMode==c.ZOOM_PART&&this.type==d.PART&&this.id!=(null===(n=this.svg.activePart)||void 0===n?void 0:n.id))return!1;switch(this.overHandling){case l.OVER_ALWAYS:if(e.push(this),i)return!0;break;case l.OVER_LAYER:break;case l.OVER_BBOX:if(this.isOverBBox(t)&&(e.push(this),i))return!0;break;case l.OVER_NEVER:return!1;case l.OVER_IGNORE:break;case l.OVER_ZOOMED:this.isOverBBox(t)&&s.push(this)}if(this.overHandling==l.OVER_ALWAYS||this.overHandling==l.OVER_ZOOMED||this.overHandling==l.OVER_LAYER||this.isOverBBox(t))for(let n=0;n<this.children.length;n++)if(this.children[n].isOverBBoxInklChildren(t,e,i,r))return e.push.apply(e,s),!0;return e.push.apply(e,s),!1}getPart(){return null==this.part?this.type==d.PART?this:this.parent.getPart():this.part}searchNodeById(t){if(this.id==t)return this;let e;for(let i=0;i<this.children.length;i++)if(e=this.children[i].searchNodeById(t),null!=e)return e;return null}searchNodeByIntId(t){if(this.intId==t)return this;let e;for(let i=0;i<this.children.length;i++)if(e=this.children[i].searchNodeByIntId(t),null!=e)return e;return null}beforeTransform(t=null,e=!1){return!(!this.isTransformable&&!e||(this.getTransformList(),this.tempTransform1_=this.svg.rootEl.createSVGTransform(),this.tempTransform2_=this.svg.rootEl.createSVGTransform(),this.startMatrix_=this.getBaseTransformationMatrix().multiply(this.svg.rootEl.createSVGMatrix()),this.startNWPoint_=this.svg.rootEl.createSVGPoint(),this.startNWPoint_.x=this.boundingBox.x,this.startNWPoint_.y=this.boundingBox.y,this.startNEPoint_=this.svg.rootEl.createSVGPoint(),this.startNEPoint_.x=this.boundingBox.x+this.boundingBox.width,this.startNEPoint_.y=this.boundingBox.y,this.startSEPoint_=this.svg.rootEl.createSVGPoint(),this.startSEPoint_.x=this.boundingBox.x+this.boundingBox.width,this.startSEPoint_.y=this.boundingBox.y+this.boundingBox.height,this.startSWPoint_=this.svg.rootEl.createSVGPoint(),this.startSWPoint_.x=this.boundingBox.x,this.startSWPoint_.y=this.boundingBox.y+this.boundingBox.height,this.startNPoint_=this.svg.rootEl.createSVGPoint(),this.startNPoint_.x=this.boundingBox.x+this.boundingBox.width/2,this.startNPoint_.y=this.boundingBox.y,this.startEPoint_=this.svg.rootEl.createSVGPoint(),this.startEPoint_.x=this.boundingBox.x+this.boundingBox.width,this.startEPoint_.y=this.boundingBox.y+this.boundingBox.height/2,this.startSPoint_=this.svg.rootEl.createSVGPoint(),this.startSPoint_.x=this.boundingBox.x+this.boundingBox.width/2,this.startSPoint_.y=this.boundingBox.y+this.boundingBox.height,this.startWPoint_=this.svg.rootEl.createSVGPoint(),this.startWPoint_.x=this.boundingBox.x,this.startWPoint_.y=this.boundingBox.y+this.boundingBox.height/2,this.specialBeforeTransform(),this.startCenter_=this.getCenterPoint(!1).matrixTransform(this.getTransformationMatrix().inverse()),null!=this.svg.selected&&this.svg.selected.intId==this.intId&&this.svg.select.hideSelect(this),null!=this.svg.hovered&&this.svg.select.hover(null),0))}afterTransform(t=!1,e=null,i=null){return!(!this.isTransformable&&!t||(this.element.transform.baseVal.consolidate(),this.specialAfterTransform(i),this.makeBBoxUpdateList(),null!=this.svg.selected&&this.svg.selected.intId==this.intId&&this.svg.select.showSelect(this),this.svg.select.removeRotateLine(this),e!=h.TRANSFORM_CREATE&&this.svg.events.trigger(p.NODE_TRANSFORMED,this),0))}swapTranform(){this.element.transform.baseVal.consolidate(),this.tempTransform1_=this.svg.rootEl.createSVGTransform(),this.tempTransform2_=this.svg.rootEl.createSVGTransform(),this.startMatrix_=this.getBaseTransformationMatrix().multiply(this.svg.rootEl.createSVGMatrix()),this.startNWPoint_=this.svg.rootEl.createSVGPoint(),this.startNWPoint_.x=this.boundingBox.x,this.startNWPoint_.y=this.boundingBox.y,this.startNEPoint_=this.svg.rootEl.createSVGPoint(),this.startNEPoint_.x=this.boundingBox.x+this.boundingBox.width,this.startNEPoint_.y=this.boundingBox.y,this.startSEPoint_=this.svg.rootEl.createSVGPoint(),this.startSEPoint_.x=this.boundingBox.x+this.boundingBox.width,this.startSEPoint_.y=this.boundingBox.y+this.boundingBox.height,this.startSWPoint_=this.svg.rootEl.createSVGPoint(),this.startSWPoint_.x=this.boundingBox.x,this.startSWPoint_.y=this.boundingBox.y+this.boundingBox.height,this.startNPoint_=this.svg.rootEl.createSVGPoint(),this.startNPoint_.x=this.boundingBox.x+this.boundingBox.width/2,this.startNPoint_.y=this.boundingBox.y,this.startEPoint_=this.svg.rootEl.createSVGPoint(),this.startEPoint_.x=this.boundingBox.x+this.boundingBox.width,this.startEPoint_.y=this.boundingBox.y+this.boundingBox.height/2,this.startSPoint_=this.svg.rootEl.createSVGPoint(),this.startSPoint_.x=this.boundingBox.x+this.boundingBox.width/2,this.startSPoint_.y=this.boundingBox.y+this.boundingBox.height,this.startWPoint_=this.svg.rootEl.createSVGPoint(),this.startWPoint_.x=this.boundingBox.x,this.startWPoint_.y=this.boundingBox.y+this.boundingBox.height/2,this.startCenter_=this.getCenterPoint(!1).matrixTransform(this.getTransformationMatrix().inverse())}transform(t,e,i,r,n,s,o,a=!1){this.lastTransformType=t;let l=0,c=0;if(!this.isTransformable&&!a)return!1;if(this.getTransformList().numberOfItems<3&&(this.element.transform.baseVal.appendItem(this.tempTransform1_),this.element.transform.baseVal.appendItem(this.tempTransform2_)),t==h.TRANSFORM_MOVE&&(this.isMoveable||a)){let t=e,r=i,n=this.getBaseTransformationMatrix();l=n.e,c=n.f;let s=this.svg.rootEl.createSVGPoint();if(s.x=t+l,s.y=r+c,s=s.matrixTransform(n.inverse()),this.type==d.PART){let t=this.boundingBox.x+s.x,e=this.boundingBox.x+this.boundingBox.width+s.x,i=this.boundingBox.y+s.y,r=this.boundingBox.y+this.boundingBox.height+s.y;a||(t<this.svg.sheet.boundingBox.x&&(s.x=this.svg.sheet.boundingBox.x-this.boundingBox.x),e>this.svg.sheet.boundingBox.x+this.svg.sheet.boundingBox.width&&(s.x=this.svg.sheet.boundingBox.x+this.svg.sheet.boundingBox.width-this.boundingBox.x-this.boundingBox.width),i<this.svg.sheet.boundingBox.y&&(s.y=this.svg.sheet.boundingBox.y-this.boundingBox.y),r>this.svg.sheet.boundingBox.y+this.svg.sheet.boundingBox.height&&(s.y=this.svg.sheet.boundingBox.y+this.svg.sheet.boundingBox.height-this.boundingBox.y-this.boundingBox.height))}this.tempTransform1_.setTranslate(s.x,s.y),this.element.transform.baseVal.replaceItem(this.tempTransform1_,1)}if(t==h.TRANSFORM_ROTATE&&(this.isRotateable||a)){let t=e,r=i;0!=r&&(r=!0),this.tempTransform1_.setRotate(t,this.startCenter_.x,this.startCenter_.y),this.element.transform.baseVal.replaceItem(this.tempTransform1_,1),r&&this.svg.select.drawRotateLine(this)}if(t==h.TRANSFORM_SCALE&&(this.isResizeable||a)){let t,n,s,o,a,d,u,p,g,m,f=e,v=i,b=r,y=this.svg.rootEl.createSVGPoint(),_=(this.svg.rootEl.createSVGPoint(),this.getBaseTransformationMatrix()),T=Math.min(this.startMatrix_.a,this.startMatrix_.d),x=Math.min(_.a,_.d);switch(f){case"uni":t=i,n=0,s=0;break;case"center":t=i,t=this.transforming(h.TRANSFORM_SCALE,t,"all"),o=1/t-1,y.x=this.boundingBox.x+this.boundingBox.width/2,y.y=this.boundingBox.y+this.boundingBox.height/2,y=y.matrixTransform(_.inverse()),n=y.x*o,s=y.y*o;break;case"se":u=this.startSEPoint_.x-this.startNWPoint_.x,p=this.startSEPoint_.y-this.startNWPoint_.y,g=v-this.startNWPoint_.x,m=b-this.startNWPoint_.y,a=g/u,d=m/p,t=Math.max(a,d),t=T*t/x,t=this.transforming(h.TRANSFORM_SCALE,t,"se"),o=1/t-1,y.x=this.boundingBox.x,y.y=this.boundingBox.y,y=y.matrixTransform(_.inverse()),n=y.x*o,s=y.y*o;break;case"sw":u=this.startNEPoint_.x-this.startSWPoint_.x,p=this.startSWPoint_.y-this.startNEPoint_.y,g=this.startNEPoint_.x-v,m=b-this.startNEPoint_.y,a=g/u,d=m/p,t=Math.max(a,d),t=T*t/x,t=this.transforming(h.TRANSFORM_SCALE,t,"sw"),o=1/t-1,y.x=this.boundingBox.x+this.boundingBox.width,y.y=this.boundingBox.y,y=y.matrixTransform(_.inverse()),n=y.x*o,s=y.y*o;break;case"nw":u=this.startSEPoint_.x-this.startNWPoint_.x,p=this.startSEPoint_.y-this.startNWPoint_.y,g=this.startSEPoint_.x-v,m=this.startSEPoint_.y-b,a=g/u,d=m/p,t=Math.max(a,d),t=T*t/x,t=this.transforming(h.TRANSFORM_SCALE,t,"nw"),o=1/t-1,y.x=this.boundingBox.x+this.boundingBox.width,y.y=this.boundingBox.y+this.boundingBox.height,y=y.matrixTransform(_.inverse()),n=y.x*o,s=y.y*o;break;case"ne":u=this.startNEPoint_.x-this.startSWPoint_.x,p=this.startSWPoint_.y-this.startNEPoint_.y,g=v-this.startSWPoint_.x,m=this.startSWPoint_.y-b,a=g/u,d=m/p,t=Math.max(a,d),t=T*t/x,t=this.transforming(h.TRANSFORM_SCALE,t,"ne"),o=1/t-1,y.x=this.boundingBox.x,y.y=this.boundingBox.y+this.boundingBox.height,y=y.matrixTransform(_.inverse()),n=y.x*o,s=y.y*o}if(t>0){try{let t=this.element.transform.baseVal;for(let e=t.numberOfItems-1;e>=1;e--)e>0&&t.removeItem(e)}catch(t){}this.tempTransform1_.setScale(t,t),this.tempTransform2_.setTranslate(n,s),this.element.transform.baseVal.appendItem(this.tempTransform1_),this.element.transform.baseVal.appendItem(this.tempTransform2_),l=n,c=s,this.element.transform.baseVal.consolidate()}this.calcDPI()}return this.specialTransform(this.getTransformationMatrix(!1),l,c),!0}getTransformList(){if(!this.element.transform)return this.svg.rootEl.createSVGTransform();if(0==this.element.transform.baseVal.numberOfItems){let t=this.svg.rootEl.createSVGTransform();this.element.transform.baseVal.initialize(t)}return this.element.transform.baseVal}getTransformationMatrix(t=!0){let e=this.svg.createSVGMatrix();if(t){if(!this.parent)return e;e=e.multiply(this.parent.getTransformationMatrix(!0))}let i=this.getTransformList();for(let t=0;t<i.numberOfItems;t++)e=e.multiply(i.getItem(t).matrix);return e}getBaseTransformationMatrix(t=!0){let e=this.svg.rootEl.createSVGMatrix();if(t){if(!this.parent)return e;e=e.multiply(this.parent.getTransformationMatrix(!0))}let i=this.getTransformList();return e=e.multiply(i.getItem(0).matrix),e}makeBBoxUpdateList(t=[],e=!0){if(!t.length){if(this.calcBBox)for(let e=0;e<this.children.length;e++)this.children[e].makeBBoxUpdateList(t,!1);e=!0}if(e){if(e)if(t.unshift(this),this.parent)this.parent.makeBBoxUpdateList(t,!0);else for(let e=0;e<t.length;e++)t[e].createBBoxAndCenter()}else if(t.push(this),this.calcBBox)for(let e=0;e<this.children.length;e++)this.children[e].makeBBoxUpdateList(t,!1)}moveToLayer(t,e=0){this.parent.removeChild(this.parentIndex),t.addChild(this,e),this.parent=t}getCenterPoint(t){return t?this.center.matrixTransform(this.getTransformationMatrix()):this.center}onSelect(){}onDeSelect(){}onEditMenu(){return null}onDeleteMenu(){return!0}copy(t){return null}getMenuOptions(){return null}preRemove(t=null){t&&t()}calcDPI(){}isParentSelected(){return null!=this.svg.selected&&this.svg.selected.id==this.id||!!this.parent&&this.parent.isParentSelected()}serializeFlags(){let t="";return t+=this.isClickThrough?1:0,t+=this.isSelectable?1:0,t+=this.isOverable?1:0,t+=this.isTransformable?1:0,t+=this.isResizeable?1:0,t+=this.isRotateable?1:0,t+=this.isSkewable?1:0,t+=this.isMoveable?1:0,t+=this.isDeleteable?1:0,t+=this.isAspectChangable?1:0,t+=this.isCopyable?1:0,t+=this.isEditable?1:0,t+=this.isLockedContent?1:0,t+=this.isIndexLocked?1:0,t}deSerializeFlags(t){let e=t.split("");"1"==e[0]?this.isClickThrough=!0:this.isClickThrough=!1,"1"==e[1]?this.isSelectable=!0:this.isSelectable=!1,"1"==e[2]?this.isOverable=!0:this.isOverable=!1,"1"==e[3]?this.isTransformable=!0:this.isTransformable=!1,"1"==e[4]?this.isResizeable=!0:this.isResizeable=!1,"1"==e[5]?this.isRotateable=!0:this.isRotateable=!1,"1"==e[6]?this.isSkewable=!0:this.isSkewable=!1,"1"==e[7]?this.isMoveable=!0:this.isMoveable=!1,"1"==e[8]?this.isDeleteable=!0:this.isDeleteable=!1,"1"==e[9]?this.isAspectChangable=!0:this.isAspectChangable=!1,"1"==e[10]?this.isCopyable=!0:this.isCopyable=!1,"1"==e[11]?this.isEditable=!0:this.isEditable=!1,"1"==e[12]?this.isLockedContent=!0:this.isLockedContent=!1,"1"==e[13]?this.isIndexLocked=!0:this.isIndexLocked=!1}findChildWithOption(t,e){let i;for(let r=0;r<this.children.length&&!i;r++){let n=this.children[r];if(n.options&&n.options[t]&&n.options[t]==e)return n;i=n.findChildWithOption(t,e)}return i}setBoundingBox(t,e,i,r){this.boundingBox.x=t,this.boundingBox.y=e,this.boundingBox.height=i,this.boundingBox.width=r}setPaths(t,e){this.path=t,this.orgPath=e}setPartTypeOnPart(t){this.part_type=t}setIsResizable(t){this.isResizable=t}isOptionSet(t){return void 0!==this.options[t]}getOption(t,e=null){return this.isOptionSet(t)?this.options[t]:e}createBBoxAndCenter(){}}!function(t){t.UP="up",t.DOWN="down",t.DELETE="delete",t.EDIT="edit",t.UPLOAD="upload",t.COPY="copy",t.CENTER_HOR="center_hor",t.CENTER_VER="center_ver",t.COLLAGE="collage",t.MOVE="move",t.NW_RESIZE="nw_resize",t.NE_RESIZE="ne_resize",t.SE_RESIZE="se_resize",t.SW_RESIZE="sq_resize",t.N_RESIZE="n_resize",t.E_RESIZE="e_resize",t.S_RESIZE="s_resize",t.W_RESIZE="w_resize",t.ROTATE="rotate",t.ROTATE_INVERSE="rotate_inverse",t.PART_DOWN="part_down",t.PART_UP="part_up"}(g||(g={}));class _ extends y{constructor(t,e){super(t,e),this.svgTag=e,this.isClickThrough=!1,this.isSelectable=!0,this.isOverable=!0,this.isTransformable=!0,this.isResizeable=!0,this.isRotateable=!0,this.isSkewable=!1,this.isMoveable=!0}remove(){var t;null===(t=this.parent)||void 0===t||t.removeChild(this.parentIndex)}getMenuOptions(){var t=[];return this.isUpDownable&&(t.push(g.UP),t.push(g.DOWN)),this.isDeleteable&&t.push(g.DELETE),t}}class T extends _{constructor(){super(d.SHAPE_IMAGE,"image"),this.imageWidth=0,this.imageHeight=0,this.dpi=0,this.widthPX=0,this.heightPX=0,this.link=null,this.clipartId=null,this.stickerId=null,this.attachmentId=null,this.uploadId=null,this.uploaded=!1,this.currentThumbVersion="sm",this.checkDpi=!1,this.vector=!1,this.outline=null,this.resolutionLastCheckedImageQuality=0}onElementCreated(t=null,e=null){let i=!e;if(this.options.fileapp_id&&(this.element.setAttribute("fileapp_id",this.options.fileapp_id),this.element.setAttribute("fileapp_region",this.options.fileapp_region)),null==e)if(this.options.href)e=this.options.href;else{if(!this.options["xlink:href"])return;e=this.options["xlink:href"]}if(void 0!==this.options.copyable&&(this.isCopyable=this.options.copyable),this.options.y&&(this.options.top=this.options.y),this.options.x&&(this.options.left=this.options.x),this.options.attachment_id&&(this.attachmentID=this.options.attachment_id),this.options.upload_id&&(this.uploadId=this.options.upload_id),this.options.uploaded&&(this.uploaded=this.options.uploaded),this.options.left||(this.options.left=0),this.options.top||(this.options.top=0),void 0!==this.options.flags&&this.deSerializeFlags(this.options.flags),this.options.transform){let t=this.svg.transform.transformStringToMatrix(this.options.transform),e=this.svg.createSVGTransform();e.setMatrix(t),this.getTransformList(),this.element.transform.baseVal.initialize(e)}this.link=e;let r=new Image;r.onload=()=>{this.options.width?this.imageWidth=this.options.width:this.imageWidth=r.width,this.options.height?this.imageHeight=this.options.height:this.imageHeight=r.height;let i=r.width,n=r.height;if(0!=i||0!=n)if("width"in this.options||"height"in this.options)if("width"in this.options)if("height"in this.options){let t=this.options.width/this.options.height,e=i/n;t!=e&&(e>t?this.options.height=this.options.width*(n/i):this.options.width=this.options.height*(i/n))}else this.options.height=this.options.width*(n/i);else this.options.width=this.options.height*(i/n);else this.options.width=i,this.options.height=n;this.element.setAttribute("x",this.options.left),this.element.setAttribute("y",this.options.top),this.element.setAttribute("width",this.options.width),this.element.setAttribute("height",this.options.height),this.options.vector&&this.element.setAttribute("vector",this.options.vector),this.options.attachment_id&&this.element.setAttribute("attachment_id",this.options.attachment_id),this.options.upload_id&&this.element.setAttribute("upload_id",this.options.upload_id),this.options.fileapp_id&&this.element.setAttribute("fileapp_id",this.options.fileapp_id),this.options.uploaded&&this.element.setAttribute("uploaded",this.options.uploaded),this.options.id&&this.element.setAttribute("id",this.options.id),this.element.setAttributeNS(u.XLINK,"xlink:href",e),this.createBBoxAndCenter(),t&&t(this)},r.onerror=()=>{if(i)r=null,void 0!==t&&t(null);else{let i=(new Date).getTime();e+="?random="+i,setTimeout((()=>{this.onElementCreated(t,e)}),0)}},r.setAttribute("src",e)}createBBoxAndCenter(){if(this.svg.runBBox){if(null==this.element.getAttribute("x")||null==this.element.getAttribute("y")||null==this.element.getAttribute("width")||null==this.element.getAttribute("height"))return this.boundingBox=this.svg.rootEl.createSVGRect(),this.boundingBox.width=0,this.boundingBox.height=0,this.boundingBox.x=0,this.boundingBox.y=0,this.center=this.svg.rootEl.createSVGPoint(),this.center.x=0,void(this.center.y=0);let t=this.getTransformationMatrix(),e=Math.sqrt(t.a*t.a+t.b*t.b),i=Math.sqrt(t.c*t.c+t.d*t.d);this.widthPX=this.imageWidth*e*this.svg.transMatrix.a,this.heightPX=this.imageHeight*i*this.svg.transMatrix.d;let r=parseFloat(this.element.getAttribute("x")),n=parseFloat(this.element.getAttribute("y")),s=parseFloat(this.element.getAttribute("width")),o=parseFloat(this.element.getAttribute("height")),a=this.svg.rootEl.createSVGPoint();a.x=r,a.y=n,a=a.matrixTransform(t);let l=this.svg.rootEl.createSVGPoint();l.x=r+s,l.y=n,l=l.matrixTransform(t);let h=this.svg.rootEl.createSVGPoint();h.x=r+s,h.y=n+o,h=h.matrixTransform(t);let d=this.svg.rootEl.createSVGPoint();d.x=r,d.y=n+o,d=d.matrixTransform(t);let c=Math.min(l.x,a.x,d.x,h.x),u=Math.min(l.y,a.y,d.y,h.y),p=Math.max(l.x,a.x,d.x,h.x)-c,g=Math.max(l.y,a.y,d.y,h.y)-u;this.boundingBox=this.svg.rootEl.createSVGRect(),this.boundingBox.width=p,this.boundingBox.height=g,this.boundingBox.x=c,this.boundingBox.y=u,this.center=this.svg.rootEl.createSVGPoint(),this.center.x=c+p/2,this.center.y=u+g/2,this.calcDPI(),this.checkUploadImageQuality()}}checkUploadImageQuality(){"1"!=this.uploaded&&!0!==this.uploaded||this.resolutionLastCheckedImageQuality<this.widthPX*this.heightPX&&(this.resolutionLastCheckedImageQuality=this.widthPX*this.heightPX,this.svg.trigger(p.IMAGE_CHECK_QUALITY,this))}calcDPI(){let t=this.getTransformationMatrix(!0),e=Math.sqrt(t.a*t.a+t.b*t.b),i=Math.sqrt(t.c*t.c+t.d*t.d);this.widthPX=this.imageWidth*e*this.svg.transMatrix.a,this.heightPX=this.imageHeight*i*this.svg.transMatrix.d;let r=this.imageWidth/(this.imageWidth*e/this.svg.px2mm)*25.4,n=this.imageHeight/(this.imageHeight*i/this.svg.px2mm)*25.4;this.dpi=Math.min(r,n),this.checkDpi&&this.svg.dpi.checkDpi()}preRemove(t=null){this.svg.dpi.removeImageNode(this),this.svg.dpi.checkDpi(),t&&t()}getMenuOptions(){let t=[];return t.push(g.UP),t.push(g.DOWN),this.svg.extraCopy&&t.push(g.COPY),t.push(g.DELETE),t}copy(t){let e=[];for(let t in this.options)"id"!=t&&(e[t]=this.options[t]);t.offX&&(e.x=parseFloat(e.left)+parseFloat(t.offX)),t.offY&&(e.y=parseFloat(e.top)+parseFloat(t.offY)),e.transform=this.element.getAttribute("transform"),e.flags=this.serializeFlags(),e.visibility="hidden",this.svg.node.addNode(new T,e,(t=>{t.options.visibility="visible",t.element.style.visibility="visible"}))}}class x extends v{execute(t){if(t.preventDefault(),""!=t.originalEvent.dataTransfer.getData("Image")){var e=t.originalEvent.dataTransfer.getData("Image"),i=e.substring(e.lastIndexOf("/")+1),r=e.substring(0,e.indexOf("."));if(null==this.svg.activePart);else var n=this.svg.node.addNode(new T,{id:r,href:"/edit2/upload/"+i,part:this.svg.activePart.id},(()=>{this.svg.transform.fitAndCenterOnPart(n)}))}}}class w extends v{execute(t,e){var i;null===(i=this.editor.ui.toolPane.backPrintEditorTool)||void 0===i||i.disableButtons(),this.editor.ui.toolPane.backPrintEditorTool&&this.helpers.product.isBackprintPossible()?(this.editor.ui.toolPane.backPrintEditorTool.setEnabled(!0),this.editor.ui.toolPane.backPrintEditorTool.enableButtons()):this.disableBackprintWithWarning()}disableBackprintWithWarning(){var t;let e=this.editor.model.language.backprint_material_warning_title,i=this.editor.model.language.backprint_material_warning_text;null===(t=this.editor.ui.toolPane.backPrintEditorTool)||void 0===t||t.setEnabled(!1,i,e)}}var E,A=__webpack_require__(51346);class P extends v{constructor(){super(...arguments),this.counter=0,this.debounceEvaluation=(0,A.debounce)((()=>{this.runEvaluation()}),500)}execute(t,e){this.editor.model.settings.isAdmin||this.debounceEvaluation()}runEvaluation(){this.counter++,this.toolPane=this.editor.ui.toolPane;let t=this.helpers.product.getAllOutOfStockAttributesInProductItem();if(Object.keys(t).length>0){this.editor.ui.toolPane.saveButtonTool.setEnabled(!1),document.querySelectorAll(".tool").forEach((t=>{t.classList.remove("blink")}));for(const e in t)switch(e){case"laminate":this.toolPane.laminateTool.$el.addClass("blink"),s.instance.confirm(this.editor.model.language.editor.laminate_out_of_stock);break;case"material":this.toolPane.materialPresetsTool.$el.addClass("blink"),s.instance.confirm(this.editor.model.language.editor.material_out_of_stock);break;case"feature":s.instance.confirm("Feature is out of stock")}}else this.reset()}reset(){this.editor.ui.toolPane.saveButtonTool.maybeEnable()}}class S extends v{execute(t,e){this.editor.focus=t.target}}class O extends v{execute(t,e){this.editor.edited=!0,0==(null==e?void 0:e.rebuildLivePreview)?this.editor.helpers.livePreview.shouldRebuildLivePreview=!1:this.editor.helpers.livePreview.shouldRebuildLivePreview=!0}}class M{static triggerEvent(t,e,i,r=0){let n={event:"com.stickerapp.events.GoogleAnalyticsEvent","event.category":t,"event.action":e,"event.label":i,"event.value":r};o.isDevMode(),dataLayer.push(n)}static addEventNew(t,e){const i={event:t,event_params:e};dataLayer.push({event_params:null}),dataLayer.push(i)}static triggerEcommerceEvent(t,e){let i={event:t,ecommerce:e};o.isDevMode(),dataLayer.push(i)}static triggerCheckoutEvent(t,e,i=0){M.triggerEvent("checkout",t,e,i)}static triggerAdminEvent(t,e,i=0){M.triggerEvent("admin",t,e,i)}static triggerStartPageEvent(t,e,i=0){M.triggerEvent("start",t,e,i)}static triggerSingleProductPageEvent(t,e,i=0){M.triggerEvent("single",t,e,i)}static triggerEditorEvent(t,e,i){const r={action:"editor"};e&&(r.label=e),i&&(r.value=i),M.addEventNew(t,r)}static triggerFigureTagFilterEvent(t,e,i=0){M.triggerEvent("figure_tag_filter",t,e,i)}static triggerFavoriteEvent(t,e,i=0){M.triggerEvent("favorite",t,e,i)}static frameByFrameActivity(t,e,i=0){M.triggerEvent("material",t,e,i)}static triggerPageEvent(t,e,i=0){M.triggerEvent("page",t,e,i)}static triggerContactEvent(t,e,i=0){M.triggerEvent("contact",t,e,i)}static addStickerToSheetFromCart(){M.triggerEditorEvent("ADD_STICKER_TO_A_SHEET_IN_THE_CART",window.location.toString())}static addStickerToNewSheet(){M.triggerEditorEvent("ADD_STICKER_TO_A_NEW_SHEET",window.location.toString())}static addGiftcardToCart(t){M.triggerEvent("ADD_GIFTCARD_TO_CART",window.location.toString(),t)}static triggerQuantityStepSelect(t,e,i="editor",r){M.addEventNew("change_quantity",{action:i,quantity_from:r,quantity_to:t})}static clickDuplicateCartSheet(t){M.triggerEvent("cart","CLICK_DUPLICATE_CART_SHEET",t)}static changeTemplate(t,e){M.triggerEditorEvent("CHANGE_TEMPLATE",t+" -> "+e)}static changeTemplateType(t,e){M.triggerEditorEvent("CHANGE_TEMPLATE_TYPE",t+" -> "+e)}static changeTemplateCategory(t,e){M.triggerEditorEvent("CHANGE_TEMPLATE_CATEGORY",t+" -> "+e)}static changeMaterial(t,e){M.triggerEditorEvent("CHANGE_MATERIAL",t+" -> "+e)}static openTemplateSelector(t){M.triggerEditorEvent("OPEN_TEMPLATE_SELECTOR",t)}static openTemplateTypeSelector(t){M.triggerEditorEvent("OPEN_TEMPLATE_TYPE_SELECTOR",t.eventString)}static easterEggFound(){M.triggerEditorEvent("easter_egg","shown")}static effectLayerAdd(t){M.triggerEditorEvent("effect_layer_add",t)}static effectLayerRemove(t){M.triggerEditorEvent("effect_layer_remove",t)}static effectLayerBrowse(t){M.triggerEditorEvent("effect_layer_browse",t)}static effectLayerUploaded(t){M.triggerEditorEvent("effect_layer_uploaded",t)}static effectLayerDone(t){M.triggerEditorEvent("effect_layer_done",t)}static preCheckoutModal(t){const e=t.replace(/[A-Z]/g,(t=>`_${t.toLowerCase()}`));M.triggerEditorEvent(e,"pre_checkout_modal")}static wizformButtonClick(){M.triggerPageEvent("WIZFORM_BUTTON_CLICK",window.location.toString())}static contactFormTopicChosen(t){M.triggerContactEvent("CONTACT_FORM_TOPIC_CHOSEN",t)}static contactFormSendButtonClick(t){M.triggerContactEvent("CONTACT_FORM_SEND_BUTTON_CLICK",t)}static contactFormTwitterButtonClick(){M.triggerContactEvent("CONTACT_FORM_TWITTER_BUTTON_CLICK","clicked")}static contactFormEmailButtonClick(){M.triggerContactEvent("CONTACT_FORM_EMAIL_BUTTON_CLICK","clicked")}static contactButtonInHeaderClick(){M.triggerContactEvent("CONTACT_BUTTON_IN_HEADER_CLICK","clicked")}static contactButtonInHeaderTwoClick(){M.triggerContactEvent("CONTACT_BUTTON_IN_HEADER_TWO_CLICK","clicked")}static contactButtonInFooterClick(){M.triggerContactEvent("CONTACT_BUTTON_IN_FOOTER_CLICK","clicked")}static triggerEcommercePurchaseEvent(t){this.triggerEcommerceEvent("purchase",t)}static triggerRecaptchaBlockEvent(t){this.triggerEcommerceEvent("recaptcha_block",t)}static sendMetric(t){dataLayer.push({event:"web_vital",metric:t})}static RenderGTMScript(){if("undefined"==typeof GTM_MODE||1===GTM_MODE){const t=document.querySelector("body"),e=document.createElement("noscript"),i=document.createElement("iframe");i.src="//www.googletagmanager.com/ns.html?id=GTM-WZXX56",i.height="0",i.width="0",i.style.display="none",i.style.visibility="hidden",e.appendChild(i);const r=document.createElement("script");r.innerHTML="(function ( w, d, s, l, i ) {\n                w[ l ] = w[ l ] || [];\n                w[ l ].push( {\n                    'gtm.start': new Date().getTime(), event: 'gtm.js'\n                } );\n                var f = d.getElementsByTagName( s )[ 0 ],\n                    j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';\n                j.async = true;\n                j.src =\n                    '//www.googletagmanager.com/gtm.js?id=' + i + dl;\n                f.parentNode.insertBefore( j, f );\n            })( window, document, 'script', 'dataLayer', 'GTM-WZXX56' );",t.appendChild(e),t.appendChild(r)}else if("undefined"!=typeof GTM_MODE&&2===GTM_MODE){const t=document.querySelector("body"),e=document.createElement("noscript"),i=document.createElement("iframe"),r=document.createElement("script");i.src="https://www.googletagmanager.com/ns.html?id=GTM-WZXX56&gtm_auth=IB3USY9oot_RnA3TMaVkOA&gtm_preview=env-104&gtm_cookies_win=x",i.height="0",i.width="0",i.style.display="none",i.style.visibility="hidden",e.appendChild(i),t.appendChild(e),r.innerHTML="(function (w, d, s, l, i) {\n                w[l] = w[l] || [];\n                w[l].push({\n                    'gtm.start':\n                        new Date().getTime(), event: 'gtm.js'\n                });\n                var f = d.getElementsByTagName(s)[0],\n                    j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';\n                j.async = true;\n                j.src =\n                    'https://www.googletagmanager.com/gtm.js?id=' + i + dl + '&gtm_auth=IB3USY9oot_RnA3TMaVkOA&gtm_preview=env-104&gtm_cookies_win=x';\n                f.parentNode.insertBefore(j, f);\n            })(window, document, 'script', 'dataLayer', 'GTM-WZXX56');",t.appendChild(r)}}}class C extends v{execute(t,e){$("#overlay").show(),M.openTemplateTypeSelector(e)}}class I extends v{execute(t,{modal:e,action:i}){switch(i){case"duplicateAndEdit":e.loading(i,!0),setTimeout((()=>{e.loading(i,!1),e.done(i,!0),setTimeout((()=>{e.hide()}),750)}),750);break;case"goToCheckout":e.loading(i,!0),setTimeout((()=>{this.editor.model.settings.askBeforeExit=!1,window.location.pathname=CHECKOUT_ROUTE}),500);break;case"makeNewSticker":e.loading(i,!0),setTimeout((()=>{this.editor.model.settings.askBeforeExit=!1,this.editor.isModal?(e.hide(),this.editor.ui.closeEditor()):window.location.pathname=CUSTOM_STICKERS_ROUTE}),500);break;default:e.hide()}}}class k extends v{execute(t,e){this.context.invokeProcessors(),this.svg.svgSettings.maxSizeMM=this.context.sizeHelper.maxSize.mm,this.svg.svgSettings.minSizeMM=this.context.sizeHelper.minSize.mm,this.editor.trigger(a.PRODUCT_ATTR_EVALUATED)}}class N extends v{execute(t,e){if($("#overlay").hide(),this.editor.svg.container.style.visibility="visible",this.editor.ui.setTitle(this.model.settings.title),this.editor.ui.showTemplateTip(),null!=this.svg.error){let t=this.model.language[this.svg.error];this.editor.ui.showError(t)}this.editor.changed||(this.editor.changed=this.editor.helpers.exportHelper.exportSheet())}}class L extends v{execute(t,e){const i=this.helpers.exportHelper.exportAndSanitizeData(e);$.ajax({type:"POST",url:"/editor/save",data:i,success:t=>this.onSuccess({request:i,response:t,intent:e}),error:t=>this.onError(t)}),this.editor.controller.pause()}onSuccess(t){this.helpers.change.isChanged(!0),t.response.redirectURL?window.location=t.response.redirectURL:this.editor.controller.resume(),this.editor.trigger(a.DATA_POSTED,{request:t.request,response:t.response,intent:t.intent})}onError(t){throw Error(t.responseText)}}class D extends v{execute(t,e){if(this._extra=e,this.helpers.product.isBackprintPossible()&&this.editor.ui.toolPane.backPrintEditorTool.enabled){let i=this.svg.part.getBackPart(),r=this.svg.part.getFrontPart(),n=this.svg.part.getBackDealPart();!(r&&i||r&&n)||"front"!==this.svg.part.getActivePartSide()&&this.svg.activePart||this.getPathCall(r).then((t=>{this.updatePaths(t,r,i,n)})).catch((()=>{setTimeout((()=>this.execute(t,e)),5e3)}))}}getPathCall(t){return new Promise(((e,i)=>{var r=t.pathNode.element.getAttribute("d");let n=this.svg.path.parse(r);n.flipX(),e(n.toString())}))}updatePaths(t,e,i,r){let n="";i&&(n=i.pathNode.element.getAttribute("d"),this.applyPathToPart(i,t,e,n)),r&&(n=r.pathNode.element.getAttribute("d"),this.applyPathToPart(r,t,e,n),r.backGroundNode.element.setAttribute("fill","url(#"+this.editor.id+"-BackPrintDealPattern)"))}applyPathToPart(t,e,i,r){t.pathNode.element.setAttribute("d",e),t.backGroundNode.element.setAttribute("d",e),t.setPaths(e,e),t.setPartTypeOnPart(i.part_type),t.setBoundingBox(i.boundingBox.x,i.boundingBox.y,i.boundingBox.height,i.boundingBox.width),this.svg.transform.rearrangeChildrenToNewPath(t.partGroupNode.children,this.svg.path.toBoundingBox(r),this.svg.path.toBoundingBox(e))}}class B{static getURL(t){let e=TOOLS_URL+"/";return t&&t.length?e+t:e}static getEditorAsJSONURI(t,e=!0){return"/editor/get_as_json/"+t+"/"+e}static getEditorURI(t,e,i,r,n,s,o,a,l,h,d,c,u=!1,p=!1){let g="/editor/"+t+"/"+e+"/"+i+"/"+r+"/"+n+"/"+s+"/"+o+"/"+a+"/"+l+"/"+h+"/"+d+"/"+c+"/"+u;return p&&(g+="?checkout"),g}static get METHOD_URI_THUMB(){return"thumb"}static get METHOD_URI_OUTLINE(){return"outline"}}class R extends v{execute(t,e){e&&e.rebuildSVG&&1==e.rebuildSVG&&(e.hasOwnProperty("showSpinner")&&1!=e.showSpinner||$("#overlay").show()),this._extra=e,this._exportedData=this.helpers.exportHelper.exportAndSanitizeData();let i={sheet_id:this.editor.model.id,lang:this.editor.model.settings.lang};const r=JSON.stringify(this.context.productItem);let n=new URLSearchParams({productItem:r}).toString(),s=B.getEditorAsJSONURI(i.lang,this.editor.model.settings.incVAT);s=s+"?"+n,r.includes("null")&&console.debug("EditorUpdateCommand: productItem contains attribute with 'null' as value",{url:s}),this._xhr&&this._xhr.abort(),this._xhr=$.ajax(s,{error:t=>{"abort"!=t.statusText&&($("#connection-error").modal("show"),this.editor.trigger(a.UPDATE_FAILED,t))},success:t=>this.onResult(t)})}onResult(t){var e,i;let r=JSON.parse(t);if(this.editor.context.productItem.reset(r.productItem),null!=this._extra&&this._extra.hasOwnProperty("rebuildSVG")&&1==this._extra.rebuildSVG){let t,s=this.editor.context.productItem.getAttribute("sheet_type"),o=this.editor.context.productItem.getProductName(),l=this.editor.context.productItem.getAttribute("template_id");if(r.settings.askBeforeExit=this.editor.model.settings.askBeforeExit,r.id=this.editor.model.id,this.editor.model.settings.status&&(r.settings.status=this.editor.model.settings.status),r.parts.length>1&&"single"!=s&&"sheet_customizable"!=o||"case"==s||"skin"==s){t=[];for(var n=0;n<r.parts.length;n++){let e=r.parts[n],i=this.findExportedPart(e.part_id);if(null!=this.svg.collage&&(i=null),i){let t=!1;if(l&&"0"!=l&&!this.svg.collage&&i.svg.indexOf("<text")<0){let r=this.svg.export.findAttachmentIDs(e.svg);$(i.attachmentIDs).each((function(e,i){r.indexOf(i)<0&&(t=!0)})),t||i.svg.indexOf("<image")!=i.svg.lastIndexOf("<image")&&(t=!0)}else t=!0;t&&(e._originallyDesignedSVG=e.svg,e.svg=i.svg,e._originalPathBoundingBox=i._originalPathBoundingBox,e.background=i.background)}t.push(e)}}else if(r.parts.length>1&&("single"==s||"sheet_customizable"!=o)){let e=r.parts.filter((function(t){return"front"===t.side}));t=$.extend(!0,e,this._exportedData.parts)}else t=$.extend(!0,r.parts,this._exportedData.parts);r.parts=t,this.editor.rebuildSVG(r,function(t){switch(t){case!0:case"true":case 1:case"1":return!0;default:return!1}}(this._extra.partChanged)),this.svg.trigger(a.PART_EDITED,{edited:"rebuild",rebuildLivePreview:null===(i=null===(e=this._extra)||void 0===e?void 0:e.rebuildLivePreview)||void 0===i||i})}this.editor.trigger(a.UPDATE_BACKPRINT_PATH,this._extra),this.editor.trigger(a.UPDATED,r),$("#overlay").hide()}findExportedPart(t){for(var e=0;e<this._exportedData.parts.length;e++){let i=this._exportedData.parts[e];if(i.part_id==t)return i}return null}}class j{static get FRONT(){return"front"}static get BACK(){return"back"}static get BACK_DEAL(){return"back_deal"}}class q extends v{execute(t,e){let i=this.svg.part.getActivePartSide(),r=this.editor.ui.toolPane;switch(i){case j.FRONT:this.frontToolState(r);break;case j.BACK:this.backToolState(r);break;case j.BACK_DEAL:this.backDealToolState(r);break;case!1:this.frontToolState(r)}this.editor.svg.trigger(p.RESIZE)}frontToolState(t){var e;t.backgroundTool.setEnabled(this.model.settings.backgroundSelectorEnabled),t.textTool.setEnabled(this.model.settings.textSelectorEnabled),t.materialPresetsTool.setEnabled(this.model.settings.materialPresetsSelectorEnabled),t.cutlineTool.setEnabled(this.model.settings.cuttinglineSelectorEnabled),t.uploadTool.setEnabled(this.model.settings.uploadEnabled),t.clipartsTool.setEnabled(this.model.settings.clipartSelectorEnabled),t.effectLayerTool.setEnabled(this.model.settings.effectLayerToolEnabled),t.laminateTool.setEnabled(this.model.settings.laminateToolEnabled),t.backPrintDealTextTool.setEnabled(!1),t.removeBackPrintTool.setEnabled(!1),t.backPrintDealTool.setEnabled(!1),null===(e=t.convertSheetToSingleTool)||void 0===e||e.setEnabled(!0),$(".tool.tool-size").removeClass("hidden"),this.editor.isLandscapeOrientation()?t.uploadTool.show():($(".tool-size").removeClass("hidden"),t.noteTool.setEnabled(this.model.settings.noteButtonEnabled))}backToolState(t){var e;this.svg.part.getParts().length>1&&this.editor.model.settings.backPrintDealToolEnabled?t.backPrintDealTool.setEnabled(!0):t.backPrintDealTool.setEnabled(!1),t.textTool.setEnabled(!0),t.uploadTool.setEnabled(!0),t.clipartsTool.setEnabled(!0),t.backgroundTool.setEnabled(!0),t.backPrintDealTextTool.setEnabled(!1),t.materialPresetsTool.setEnabled(!1),t.cutlineTool.setEnabled(!1),t.effectLayerTool.setEnabled(!1),t.laminateTool.setEnabled(!1),null===(e=t.convertSheetToSingleTool)||void 0===e||e.setEnabled(!1),$(".tool.tool-size").addClass("hidden"),t.removeBackPrintTool.setEnabled(!0),t.removeBackPrintTool.setDisabled(!this.helpers.product.hasBackprint()),this.editor.isLandscapeOrientation()?t.uploadTool.show():($(".tool-size").addClass("hidden"),t.noteTool.setEnabled(!1))}backDealToolState(t){this.svg.part.getParts().length>1&&this.editor.model.settings.backPrintDealToolEnabled?t.backPrintDealTool.setEnabled(!0):t.backPrintDealTool.setEnabled(!1),t.backPrintDealTextTool.setEnabled(!0),t.materialPresetsTool.setEnabled(!1),t.cutlineTool.setEnabled(!1),t.removeBackPrintTool.setEnabled(!1),$(".tool.tool-size").addClass("hidden"),t.clipartsTool.disable(),t.uploadTool.disable(),t.backgroundTool.disable(),this.editor.isLandscapeOrientation()?(t.textTool.disable(),t.backPrintDealTextTool.$el.css("display","none"),t.backPrintDealTextTool.show()):(t.textTool.setEnabled(!1),t.backPrintDealTextTool.$el.css("display","block"),t.noteTool.setEnabled(!1))}get model(){return this.editor.model}}class V extends v{execute(t){this._timeOutMilliSeconds=250,"resize"!=t.type&&"orientationchange"!=t.type&&(this._isHidingKeyboardEvent=!0,this.editor.focus=null),this._selectedNode=this.svg.selected,"orientationchange"==t.type&&(this._timeOutMilliSeconds=500),this.editor.ui.repositionTooltipsAndPopovers(),n.isTouchDevice()&&"resize"==t.type&&this.editor.ui.currentlyFocusing||this.nextStep()}nextStep(){this.editor.ui.setSizeAndOrientation(),this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout((()=>this.onTimeout()),this._timeOutMilliSeconds)}onTimeout(){this.editor.destroyed||this._isHidingKeyboardEvent&&!this.editor.isLandscapeOrientation()&&this.editor.ui.toolPane.isOpenToolState()||(this._isHidingKeyboardEvent&&this.editor.controller.offByEventName(p.DESELECT_NODE),this.svg.margin.refreshMargin(!1),this.editor.trigger(p.RESIZE),this._selectedNode&&this.svg.select.select(this._selectedNode),this._isHidingKeyboardEvent&&this.editor.controller.onByEventName(p.DESELECT_NODE))}}class F extends v{execute(t,e){this.svg.activePart&&!0===this.svg.activePart.stickySizeLabels&&this.svg.activePart.showSize()}}class H{}class z{constructor(t,e,i,r){this.object=t,this.eventName=e,this.selector=i,this.callback=r,this.listener=null,this.isActive=!1,this.oneTimeOnly=!1,this.object instanceof EventTarget||"function"==typeof this.object.get&&(this.object=this.object.get(0)),this.object}}class U{constructor(t){this._eventsCount=0,this._status="on",this.svg=t,this.eventMap=new Map}trigger(t,e,i,r){i||(i=this.svg.container),r||(r={bubbles:!0,cancelable:!0});let n=new CustomEvent(t,Object.assign(Object.assign({},r),{detail:e}));i.dispatchEvent(n)}nextKey(){return this._eventsCount++,this._eventsCount.toString()}registerHandler(t,e,i,r){return e.svg=this.svg,i?this.addListenerTo(i,t,r||"",e.execute.bind(e)):this.addListener(t,r||"",e.execute.bind(e))}addListenerOnce(t,e,i){let r=this.addListener(t,e,i);return this.eventMap.get(r).oneTimeOnly=!0,r}addListener(t,e,i){let r=this.factorEventReference(this.svg.container,t,e,i);return this.eventMap.set(r.key,r),"on"==this._status&&this.turnOn(r),r.key}addListenerTo(t,e,i,r){if(Array.isArray(t))return void t.forEach((t=>this.addListenerTo(t,e,i,r)));let n=this.factorEventReference(t,e,i,r);return this.eventMap.set(n.key,n),"on"==this._status&&this.turnOn(n),n.key}delete(t){let e=this.eventMap.get(t);e&&(this.turnOff(e),this.eventMap.delete(t))}deleteBy(t,e){let i;for(let r=1;r<this._eventsCount+1;r++)(i=this.eventMap.get(r.toString()))&&(i.object!=t||e&&i.eventName!=e||this.delete(r.toString()))}deleteAll(){let t;for(let e=1;e<this._eventsCount;e++)(t=this.eventMap.get(e.toString()))&&this.delete(e.toString())}factorEventReference(t,e,i,r){let n=new z(t||this.svg.container,e,r?i:null,r||i);return n.key=this.nextKey(),n.listener=t=>this.onEventHandling(n,t),n}getEventReference(t){return this.eventMap.get(t)}pause(){this._status="off"}resume(){this._status="on"}off(){if("off"==this._status)return;let t;for(let e=1;e<=this._eventsCount;e++)t=this.eventMap.get(e.toString()),t&&this.turnOff(t);this._status="off"}unregisterAllByEventName(t){let e;for(let i=1;i<=this._eventsCount;i++)e=this.eventMap.get(i.toString()),e&&e.eventName==t&&this.delete(i.toString())}offByEventName(t){let e;for(let i=1;i<=this._eventsCount;i++)e=this.eventMap.get(i.toString()),e&&e.eventName==t&&this.turnOff(e)}onByEventName(t){let e;for(let i=1;i<=this._eventsCount;i++)e=this.eventMap.get(i.toString()),e&&e.eventName==t&&this.turnOn(e)}turnOff(t){var e;if(t.isActive){let i=t.eventName.split(" ");for(let r=0;r<i.length;r++)null===(e=t.object)||void 0===e||e.removeEventListener(i[r],t.listener);t.isActive=!1}}turnOn(t){var e;if(!t.isActive){let i=t.eventName.split(" ");for(let r=0;r<i.length;r++)null===(e=t.object)||void 0===e||e.addEventListener(i[r],t.listener);t.isActive=!0}}on(){if("on"==this._status)return;let t;for(let e=1;e<=this._eventsCount;e++)t=this.eventMap.get(e.toString()),t&&this.turnOn(t);this._status="on"}getCurrentEventTarget(t){let e=null;if(t.object instanceof Element&&event.target instanceof Element){let i=t.object.querySelectorAll(t.selector);return e=Array.from(i).find((t=>t.contains(event.target))),e}return e}onEventHandling(t,e){if("on"!=this._status)return;t.oneTimeOnly&&this.delete(t.key);let i=e instanceof CustomEvent?e.detail:null,r=Object.assign({},i);if("string"==typeof t.selector&&t.selector.length){const e=this.getCurrentEventTarget(t);if(!e)return;r.currentTarget=e}let n=new Proxy(e,{get:this.getEventProxyHandler(r)});t.callback(n,i)}getEventProxyHandler(t){return(e,i,r)=>{let n=t.hasOwnProperty(i)?t[i]:e[i];if(n instanceof Function){let r=t[i]?t:e;return n.bind(r)}return n}}get status(){return this._status}}class G extends f{execute(t,e){if(this.svg.selected){var i=this.svg.transform.rotateSnap(e.angle,2);this.svg.transform.rotateNode(this.svg.selected,i,!1)}}}class Z extends f{execute(t,e){this.svg.selected&&this.svg.selected.swapTranform()}}class W extends f{execute(t,e){this.svg.selected&&this.svg.transform.scaleNodeAll(this.svg.selected,e.zoom)}}!function(t){t.MODE_SHEET="sheet",t.MODE_SINGLE="single"}(E||(E={}));class K extends f{execute(t,e){e.type==d.PART&&this.svg.svgSettings.mode==E.MODE_SHEET&&(e.stickySizeLabels=!1)}}class Y extends f{execute(t,e){var i;if(this.svg.buildParts&&this.svg.buildParts.length)for(let t=0;t<this.svg.buildParts.length;t++){let e=this.svg.buildParts[t];if(e.selectPartOnLoad){let t=!1;e._node.type==d.SHAPE_MULTI&&null!=this.svg.collage&&(t=!0),this.svg.transform.centerHorOrVer(e._node,!1,!0,t),this.svg.transform.centerHorOrVer(e._node,!0,!0,t),this.svg.select.select(e._node)}}if(this.svg.sheet.updatePartsOrder(),this.svg.sheet.sheet_type==E.MODE_SHEET&&(this.svg.sheet.showSize(),this.svg.events.addListener(p.RESIZE,(()=>this.svg.sheet.showSize()))),(null===(i=this.svg.svgSettings)||void 0===i?void 0:i.mode)==E.MODE_SINGLE&&this.svg.sheet.parts.length>0){let t=this.svg.part.getFrontPart()||this.svg.sheet.parts[0];this.svg.defaultParentNode=t,this.svg.zoomHelper.changeMode(c.ZOOM_PART,this.svg.defaultParentNode,!0)}else this.svg.zoomHelper.changeMode(c.ZOOM_SHEET,null,!0);this.svg.shadow.updateShadow(),this.svg.preview.turnOn(),this.svg.trigger(p.READY,this.svg)}}class X{constructor(t=0,e=0,i=0,r=0,n=0){this.offX=t,this.offY=e,this.widthMM=i,this.heightMM=r,this.rotation=n}}class Q extends y{addChild(t,e=0){this.children.splice(e,0,t),this.updateChildrensParentIndex(),t.parent=this,null!=t.element&&this.renderChildren()}changeBranch(t,e=0){t.parent.children.splice(t.parentIndex,1),t.parent.updateChildrensParentIndex(),this.addChild(t,e)}updateChildrensParentIndex(){for(let t=0;t<this.children.length;t++)null!=this.children[t]&&(this.children[t].parentIndex=t)}remove(){this.isDeleteable&&(this.updateChildrensParentIndex(),this.preRemove((()=>{this.parent.updateChildrensParentIndex(),this.parent.removeChild(this.parentIndex)})))}removeInklChildren(t=!0){for(let t=this.children.length-1;t>0;t--)this.children[t]instanceof Q?this.children[t].removeInklChildren(!1):this.children[t]=null;t&&this.parent.removeChild(this.parentIndex,t),this.updateChildrensParentIndex()}removeChild(t,e=!0){this.children[t]&&(this.children[t]&&(e&&this.children[t].element.remove(),this.children.splice(t,1)),this.updateChildrensParentIndex())}removeChildren(){for(let t=0;t<this.children.length;t++)null!=this.children[t].element&&(this.children[t].preRemove(),this.children[t].element.parentElement.removeChild(this.children[t].element)),this.children[t].remove();this.children=[]}moveChildFirst(t){this.children.splice(t.parentIndex,1),this.children.splice(1,0,t),this.updateChildrensParentIndex(),this.renderChildren()}getChildAt(t){return this.children.length?t<0?this.children[0]:t>=this.children.length?this.children[this.children.length-1]:this.children[t]:null}isChildIndexInterchangeable(t){let e=this.getChildAt(t);return!!e&&!e.isIndexLocked}moveChildToPos(t,e){let i=t.parentIndex>e?"up":"down",r=this.isChildIndexInterchangeable(e);for(;!r&&e>=0&&e<=this.children.length;)"up"==i?e++:e--,r=this.isChildIndexInterchangeable(e);e>=0&&e<=this.children.length&&(this.children.splice(t.parentIndex,1),this.children.splice(e,0,t),this.updateChildrensParentIndex(),this.renderChildren())}moveChildUp(t){t.parentIndex>0&&(this.moveChildToPos(t,0),this.updateChildrensParentIndex(),this.renderChildren())}moveChildDown(t){t.parentIndex<this.children.length-1&&(null!=this.svg.collage?this.moveChildToPos(t,this.children.length-1):this.moveChildToPos(t,this.children.length),this.updateChildrensParentIndex(),this.renderChildren())}isChildFirst(t,e=!0){if(e)return!(t.parentIndex>0);{let e=0,i=this.isChildIndexInterchangeable(e);for(;!i&&e>=0&&e<=this.children.length;)e++,i=this.isChildIndexInterchangeable(e);return t.parentIndex==e}}isChildLast(t,e=!0){if(null!=this.svg.collage&&t.parentIndex==this.children.length-2)return!0;if(e)return!(t.parentIndex<this.children.length-1);{let e=this.children.length-1,i=this.isChildIndexInterchangeable(e);for(;!i&&e>=0;)e--,i=this.isChildIndexInterchangeable(e);return t.parentIndex==e}}calcDPI(){for(let t=0;t<this.children.length;t++)this.children[t].calcDPI()}preRemove(t=null){for(let t=0;t<this.children.length;t++)this.children[t].preRemove(),this.updateChildrensParentIndex();t&&t()}}class J extends _{constructor(){super(d.SHAPE_PATH,"path"),this.overDrop=null,this.tempTransform=null,this.oldMatrix="",this.isStrangeCenter=!0,this.orgPath=null}onElementCreated(t=null){this.orgPath=this.options.d,this.element.setAttribute("d",this.options.d),this.options.fill&&this.element.setAttribute("fill",this.options.fill),this.options.stroke&&this.element.setAttribute("stroke",this.options.stroke),this.options.id&&this.element.setAttribute("id",this.options.id),this.options["fill-opacity"]&&this.element.setAttribute("fill-opacity",this.options["fill-opacity"]),this.options["fill-rule"]&&this.element.setAttribute("fill-rule",this.options["fill-rule"]),this.options["stroke-opacity"]&&this.element.setAttribute("stroke-opacity",this.options["stroke-opacity"]),this.options["stroke-dasharray"]&&this.element.setAttribute("stroke-dasharray",this.options["stroke-dasharray"]),this.options["stroke-width"]&&this.element.setAttribute("stroke-width",this.options["stroke-width"]),this.options.class&&this.element.setAttribute("class",this.options.class),this.options["clip-path"]&&this.element.setAttribute("clip-path",this.options["clip-path"]),this.options.transform&&this.element.setAttribute("transform",this.options.transform),this.tempTransform=this.svg.rootEl.createSVGTransform(),this.createBBoxAndCenter(),super.onElementCreated(t)}onEditMenu(){null!=this.collageObject&&null!=this.collageObject.imageNode&&this.svg.collage.showImage(this.collageObject.imageNode)}onDeleteMenu(){return null!=this.collageObject&&this.svg.collage.deleteImage(this.collageObject),!1}specialBeforeTransform(){null!=this.collageObject&&this.element.setAttribute("class","svgCollagePath drag")}specialAfterTransform(t){if(null!=this.collageObject&&this.element.setAttribute("class","svgCollagePath"),null!=this.overDrop&&(this.overDrop.element.setAttribute("class","svgCollagePath"),this.overDrop=null),null!=this.collageObject&&null!=t){this.createBBoxAndCenter(),this.svg.transform.moveNode(this,this.collageObject.x-this.boundingBox.x,this.collageObject.y-this.boundingBox.y),this.element.transform.baseVal.consolidate();let e=this.svg.node.getNodeListOnPoint(t);for(let t=0;t<e.length;t++)e[t].type==d.SHAPE_PATH&&e[t].id!=this.id&&null!=e[t].collageObject&&this.svg.collage.swapImages(this.collageObject,e[t].collageObject)}}specialDrag(t){if(null!=this.collageObject){let e=this.svg.node.getNodeListOnPoint(t),i=!0;for(let t=0;t<e.length;t++)e[t].type==d.SHAPE_PATH&&e[t].id!=this.id&&null!=e[t].collageObject&&(i=!1,null!=this.overDrop&&this.overDrop.intId!=e[t].intId&&(this.overDrop.element.setAttribute("class","svgCollagePath"),this.overDrop=null),null==this.overDrop&&(this.overDrop=e[t],this.overDrop.element.setAttribute("class","svgCollagePath drop")));i&&null!=this.overDrop&&(this.overDrop.element.setAttribute("class","svgCollagePath"),this.overDrop=null)}}createBBoxAndCenter(){if(this.svg.runBBox){let t=this.getTransformationMatrix();this.oldMatrix=t.a+" "+t.b+" "+t.c+" "+t.d+" "+t.e+" "+t.f;let e=this.svg.path.transformByMatrix(this.element.getAttribute("d"),t).bbox;this.boundingBox=this.svg.rootEl.createSVGRect(),this.boundingBox.width=e.width,this.boundingBox.height=e.height,this.boundingBox.x=e.x,this.boundingBox.y=e.y,this.center=this.svg.rootEl.createSVGPoint(),this.center.x=e.x+(e.x2-e.x)/2,this.center.y=e.y+(e.y2-e.y)/2}}getMenuOptions(){if(null!=this.collageObject){if(null!=this.collageObject.imageNode){let t=[];return t.push(g.EDIT),t.push(g.DELETE),t}{let t=[];return t.push(g.UPLOAD),t}}return null}}class tt extends Q{constructor(){super(d.CLIP_PATH,"clipPath"),this.clipPathPath=null,this.transformString=null,this.path=null}onElementCreated(t=null){this.element.setAttribute("id",this.options.id),this.id=this.options.id,this.path=this.options.path,this.options.transform&&(this.transformString=this.options.transform),this.clipPathPath=new J,this.clipPathPath=this.svg.node.addNode(this.clipPathPath,{parentId:this.id,transform:this.transformString,id:this.id+"_path",d:this.path}),this.clipPathPath.ignore=!0,this.clipPathPath.overHandling=l.OVER_IGNORE,super.onElementCreated(t)}}class et extends Q{constructor(){super(d.GROUP_STANDARD,"g"),this.isGrouped=!1,this.isClickThrough=!0,this.isSelectable=!1,this.isOverable=!1,this.isTransformable=!1,this.isResizeable=!1,this.isRotateable=!1,this.isSkewable=!1,this.isMoveable=!1,this.isDeleteable=!0,this.isStrangeCenter=!0}onElementCreated(t=null){if(this.options.id&&this.element.setAttribute("id",this.options.id),void 0!==this.options.flags&&this.deSerializeFlags(this.options.flags),this.options.transform){let t=this.svg.transform.transformStringToMatrix(this.options.transform),e=this.svg.createSVGTransform();e.setMatrix(t),this.getTransformList(),this.element.transform.baseVal.initialize(e)}this.createBBoxAndCenter(),super.onElementCreated(t)}createBBoxAndCenter(){if(this.svg.runBBox){let t=1e5,e=1e5,i=-1e5,r=-1e5;for(let n=0;n<this.children.length;n++)this.children[n].createBBoxAndCenter(),isNaN(this.children[n].boundingBox.x)||(t=Math.min(t,this.children[n].boundingBox.x)),isNaN(this.children[n].boundingBox.y)||(e=Math.min(e,this.children[n].boundingBox.y)),isNaN(this.children[n].boundingBox.x+this.children[n].boundingBox.width)||(i=Math.max(i,this.children[n].boundingBox.x+this.children[n].boundingBox.width)),isNaN(this.children[n].boundingBox.y+this.children[n].boundingBox.height)||(r=Math.max(r,this.children[n].boundingBox.y+this.children[n].boundingBox.height));1e5==t&&-1e5==i&&(t=0,i=0),1e5==e&&-1e5==r&&(e=0,r=0),this.boundingBox=this.svg.rootEl.createSVGRect(),this.boundingBox.width=i-t,this.boundingBox.height=r-e,this.boundingBox.x=t,this.boundingBox.y=e,this.center=this.svg.rootEl.createSVGPoint(),this.center.x=this.boundingBox.x+this.boundingBox.width/2,this.center.y=this.boundingBox.y+this.boundingBox.height/2}}group(){this.isClickThrough=!1,this.isSelectable=!0,this.isOverable=!0,this.isTransformable=!0,this.isResizeable=!0,this.isRotateable=!0,this.isSkewable=!1,this.isMoveable=!0,this.isGrouped=!0}ungroup(){this.isClickThrough=!0,this.isSelectable=!1,this.isOverable=!1,this.isTransformable=!1,this.isResizeable=!1,this.isRotateable=!1,this.isSkewable=!1,this.isMoveable=!1,this.isGrouped=!1}getMenuOptions(){let t=[];return t.push(g.UP),t.push(g.DOWN),this.svg.extraCopy&&t.push(g.COPY),t.push(g.CENTER_HOR),t.push(g.CENTER_VER),t.push(g.DELETE),t}copy(t){let e=[];for(let t in this.options)"id"!=t&&(e[t]=this.options[t]);let i=this.svg.rootEl.createSVGMatrix(),r=0,n=0;t.offX&&(r=t.offX),t.offY&&(n=t.offY),i=i.multiply(this.element.transform.baseVal.consolidate().matrix),i=i.translate(r,n),e.transform="matrix("+i.a+", "+i.b+", "+i.c+", "+i.d+", "+i.e+", "+i.f+")",e.flags=this.serializeFlags(),e.visibility="hidden",this.svg.node.addNode(new et,e,(t=>{let e=new XMLSerializer,i="";for(let t=this.children.length-1;t>=0;t--)this.svg.export.serializeNodeFlags(this.children[t]),i+=e.serializeToString(this.children[t].element);i=i.replace(/\sid="([^"]+)"/g," "),i=i.replace(/ href=/g," xlink:href=");let r=new RegExp(window.location.protocol+"//"+window.location.host,"g");i=i.replace(r,""),this.svg.import.importSVGData(i,t,((e,i)=>{this.svg.margin.refreshMargin(!1),this.svg.select.select(t)})),t.options.visibility="visible",t.element.setAttribute("visibility","visible")}))}}class it{static createElement(t){return document.createElementNS(u.NAMESPACE,t)}static getOffset(t){if(!t.getClientRects().length)return{top:0,left:0};let e=t.getBoundingClientRect(),i=t.ownerDocument.defaultView;return{top:e.top+i.pageYOffset,left:e.left+i.pageXOffset}}mm2px(t){return 2.83465*t}generateUniqueId(){return Math.random().toString(36).slice(2,11)}extractScale(t){let e=1;if(t&&""!==t.trim()){const i=(t=t.substring(t.indexOf("matrix"))).match(/\(([^()]+)\)/);if(i&&i[1]){let t;t=i[1].includes(",")?i[1].split(","):i[1].trim().split(/\s+/);const r=parseFloat(t[0]),n=parseFloat(t[1]);e=Math.sqrt(Math.pow(r,2)+Math.pow(n,2))}}return e}}class rt extends _{constructor(){super(d.SHAPE_TEXT,"text")}onSelect(){this.svg.noOnSelect||this.svg.trigger(p.TEXT_SELECTED,this)}onDeSelect(){}getMenuOptions(){let t=[];return t.push(g.UP),t.push(g.DOWN),this.svg.touch.isTouch&&t.push(g.EDIT),this.svg.extraCopy&&t.push(g.COPY),t.push(g.CENTER_HOR),t.push(g.CENTER_VER),t.push(g.DELETE),t}onEditMenu(){this.svg.trigger(p.TEXT_EDIT,this)}onElementCreated(t=null){if(this.options.left&&this.element.setAttribute("x",this.options.left),this.options.x&&this.element.setAttribute("x",this.options.x),this.options.top&&this.element.setAttribute("y",this.options.top),this.options.y&&this.element.setAttribute("y",this.options.y),this.options.fill&&this.element.setAttribute("fill",this.options.fill),this.options.class&&this.element.setAttribute("class",this.options.class),this.options.id&&this.element.setAttribute("id",this.options.id),this.options.transform&&this.element.setAttribute("transform",this.options.transform),this.element.setAttribute("space","preserve"),this.options.size&&this.element.setAttribute("font-size",this.options.size),this.options["font-size"]&&this.element.setAttribute("font-size",this.options["font-size"]),this.options.font&&(this.options.font=this.options.font.replace(/'/g,""),this.element.setAttribute("font-family",this.options.font)),this.options["font-family"]&&(this.options["font-family"]=this.options["font-family"].replace(/'/g,""),this.element.setAttribute("font-family",this.options["font-family"])),this.options.anchor&&this.element.setAttribute("text-anchor",this.options.anchor),this.options["text-anchor"]&&this.element.setAttribute("text-anchor",this.options["text-anchor"]),void 0!==this.options.flags&&this.deSerializeFlags(this.options.flags),void 0!==this.options.copyable&&(this.isCopyable=this.options.copyable),this.options.transform){let t=this.svg.transform.transformStringToMatrix(this.options.transform),e=this.svg.createSVGTransform();e.setMatrix(t),this.element.transform.baseVal.initialize(e)}this.text_=this.options.text,this.fixText(),this.createBBoxAndCenter(),super.onElementCreated(t),!0===this.options.locked&&(this.isResizeable=!1,this.svg.transform.centerHorOrVer(this,!0,!0,!1,!1))}copy(t){let e=[];for(let t in this.options)"id"!=t&&(e[t]=this.options[t]);let i=this.getTextAsJson();e.text=i.text,e.font=i.font.replace(/'/g,""),e.fill=i.color,e.color=i.color,e.align=i.align,e.anchor=i.align,e.transform=this.element.getAttribute("transform"),t.offX&&(e.left+=parseFloat(t.offX)),t.offY&&(e.top+=parseFloat(t.offY)),e.flags=this.serializeFlags(),e.visibility="hidden",this.svg.node.addNode(new rt,e,(t=>{t.options.visibility="visible",t.element.style.visibility="visible",this.svg.margin.refreshMargin(!1),this.svg.select.select(t)}))}changeText(t){if(t.text&&(this.text_=t.text),t.align){let e=this.element.getAttribute("text-anchor"),i=t.align,r=0;e!=i&&("start"==e&&("middle"==i&&(r=this.boundingBox.width/2),"end"==i&&(r=this.boundingBox.width)),"middle"==e&&("start"==i&&(r=this.boundingBox.width/2*-1),"end"==i&&(r=this.boundingBox.width/2)),"end"==e&&("start"==i&&(r=-1*this.boundingBox.width),"middle"==i&&(r=this.boundingBox.width/2*-1)),this.beforeTransform(null,!0),this.transform(h.TRANSFORM_MOVE,r,0,0,0,0,0,!0),this.element.setAttribute("text-anchor",t.align),this.afterTransform(!0))}t.size&&this.element.setAttribute("font-size",t.size),t.color&&this.element.setAttribute("fill",t.color),t.font&&(t.font=t.font.replace(/'/g,""),this.element.setAttribute("font-family",t.font)),this.fixText(),this.createBBoxAndCenter()}changeColor(t){this.element.setAttribute("fill",t)}createBBoxAndCenter(){if(this.svg.runBBox){let t=0,e=0,i=0,r=0;try{let n=this.element.getBBox();t=n.x,e=n.y,i=n.width,r=n.height}catch(n){let s=it.getOffset(el);t=s.left,e=s.top,i=this.element.clientWidth,r=this.element.clientHeight}let n=this.getTransformationMatrix(),s=this.svg.rootEl.createSVGPoint();s.x=t,s.y=e,s=s.matrixTransform(n);let o=this.svg.rootEl.createSVGPoint();o.x=t+i,o.y=e,o=o.matrixTransform(n);let a=this.svg.rootEl.createSVGPoint();a.x=t+i,a.y=e+r,a=a.matrixTransform(n);let l=this.svg.rootEl.createSVGPoint();l.x=t,l.y=e+r,l=l.matrixTransform(n);let h=Math.min(o.x,s.x,l.x,a.x),d=Math.min(o.y,s.y,l.y,a.y),c=Math.max(o.x,s.x,l.x,a.x)-h,u=Math.max(o.y,s.y,l.y,a.y)-d;this.boundingBox=this.svg.rootEl.createSVGRect(),this.boundingBox.width=c,this.boundingBox.height=u,this.boundingBox.x=h,this.boundingBox.y=d,this.center=this.svg.rootEl.createSVGPoint(),this.center.x=h+c/2,this.center.y=d+u/2}}getTextAsJson(){let t={text:"",font:"",color:"",align:""};this.elementAsText.querySelectorAll("tspan").forEach((e=>{t.text+=e.textContent+"\r\n"})),""!=t.text&&(t.text=t.text.substr(0,t.text.length-2));let e=window.getComputedStyle(this.elementAsText);return t.font=e.fontFamily.replace(/'/g,"").replace(/"/g,""),t.color=this.elementAsText.getAttribute("fill"),t.align=this.elementAsText.getAttribute("text-anchor"),t}get elementAsText(){return this.element}fixText(){this.element.innerHTML="";let t=this.element,e=parseFloat(t.getAttribute("font-size"));isNaN(e)&&(e=10);let i=this.element.hasAttribute("x")?parseFloat(this.element.getAttribute("x")):0,r=this.element.hasAttribute("y")?parseFloat(this.element.getAttribute("y")):0,n=this.text_.split("\n");for(let t=0;t<n.length;t++){let s=it.createElement("tspan");null!=this.element.getAttribute("font-family")&&s.setAttribute("font-family",this.element.getAttribute("font-family").replace(/'/g,"")),s.setAttribute("x",i.toString()),s.setAttribute("y",(r+e*t).toString());let o=document.createTextNode(n[t].trim());s.appendChild(o),this.element.appendChild(s)}}}class nt extends Q{constructor(){super(d.PART,"g"),this.sheet=null,this.bleed=null,this.pathVariants=null,this.isTransformableTemp=!0,this.isResizeableTemp=!0,this.isRotateableTemp=!0,this.isSkewableTemp=!1,this.isMoveableTemp=!0,this.isDeleteableTemp=!0,this.isAspectChangableTemp=!0,this.isSheetBackground=!1,this.cornersRadius=0,this.height=0,this.width=0,this.originalPathBoundingBox=null,this.orgCornersRadius=0,this.orgHeight=0,this.orgWidth=0,this.partGroupNode=null,this.backGroundNode=null,this.pathNode=null,this.previewClipPath=null,this.previewBack=null,this.previewFont=null,this.imageNode=null,this.bleedPathNode=null,this.clipPathNode=null,this.isReady=!1,this.scaleToFit=1,this.rBBox=null,this.bottomText=null,this.leftText=null,this.tempFilters="",this.preview=null,this.stickSize=!1,this.oldMatrix="",this.pathMarked=!1,this.oldMarkDash=null,this.oldMarkLine=null,this.background_cmyk=null,this.side=null,this.stickySizeLabels=!0,this.haveRoundedCorners=!1,this.isGrouped=!1,this.predefinedCutline=!1,this.lineWidthScale_=1,this.pathPointArray_=[],this.pathPointLength_=-1,this.pathPointMX_=-1,this.pathPointMY_=-1,this.isSubPart=!1,this.isClickThrough=!1,this.isSelectable=!0,this.isOverable=!0,this.isTransformable=!0,this.isResizeable=!0,this.isRotateable=!0,this.isSkewable=!1,this.isMoveable=!0,this.isDeleteable=!0,this.isAspectChangable=!0,this.isEditable=!0,this.isCopyable=!0,this.isLockedContent=!1,this.isStrangeCenter=!0,this.orgPath=null,this.path=null,this.part_type=null,this.path_type=null}onElementCreated(t){let e=!1,i=!1;if(this.options.json){let t=this.options.json;t.id&&(this.options.id=t.id),t.part_id&&(this.options.id=t.part_id),t.cuttingline&&(this.options.path=t.cuttingline),t.bleed&&(this.options.bleed=t.bleed),t.background&&(this.options.background=t.background),t.background_cmyk&&(this.options.background_cmyk=t.background_cmyk),t.backgroundPattern&&(this.options.backgroundPattern=t.backgroundPattern),t.part_type&&(this.options.part_type=t.part_type),t.width&&(this.options.width=t.width),t.height&&(this.options.height=t.height),t.cornersRadius&&(this.options.cornersRadius=parseInt(t.cornersRadius)),t.bleed_margin&&(this.options.bleed_margin=t.bleed_margin),t.svg&&(this.options.svg=t.svg),t.matrix&&(this.options.matrix=t.matrix),t.visibility&&(this.options.visibility=t.visibility),t.flags&&(this.options.flags=t.flags),void 0!==t.rotateable&&(this.options.rotateable=t.rotateable),void 0!==t.resizeable&&(this.options.resizeable=t.resizeable),void 0!==t.aspectchangable&&(this.options.aspectchangable=t.aspectchangable),void 0!==t.moveable&&(this.options.moveable=t.moveable),void 0!==t.skewable&&(this.options.skewable=t.skewable),void 0!==t.editable&&(this.options.editable=t.editable),void 0!==t.deleteable&&(this.options.deleteable=t.deleteable),void 0!==t.aspectChangable&&(this.options.aspectChangable=t.aspectChangable),void 0!==t.copyable&&(this.options.copyable=t.copyable),void 0!==t.lockedContent&&(this.options.lockedContent=t.lockedContent),void 0!==t._originalPathBoundingBox&&(this.originalPathBoundingBox=t._originalPathBoundingBox),t.meta&&(t.meta.CMYK_BACKGROUND&&(this.options.background_cmyk=t.meta.CMYK_BACKGROUND),t.meta.PREDEFINED_CUTLINE&&(this.options.predefinedCutline="true"===t.meta.PREDEFINED_CUTLINE||!0===t.meta.PREDEFINED_CUTLINE)),t.preview&&(this.options.preview=[],this.options.preview.back=t.preview.back,this.options.preview.front=t.preview.front,this.options.preview.clippath=t.preview.clippath),t.side&&(this.side=t.side)}let r=0,n=0,s=0,o=0,a=0;if(this.options.svg){let t=this.options.svg.search("dataHeight");if(-1!=t){let e=this.options.svg.substring(t+12),i=e.search('"');e=e.substring(0,i),n=parseFloat(e)}let e=this.options.svg.search("dataWidth");if(-1!=e){let t=this.options.svg.substring(e+11),i=t.search('"');t=t.substring(0,i),r=parseFloat(t)}let i=this.options.svg.search("dataCornersRadius");if(-1!=i){let t=this.options.svg.substring(i+19),e=t.search('"');t=t.substring(0,e),this.options.cornersRadius=parseFloat(t)}let l=this.options.svg.search("dataOffsetX");if(-1!=l){let t=this.options.svg.substring(l+13),e=t.search('"');t=t.substring(0,e),s=parseFloat(t)}let h=this.options.svg.search("dataOffsetY");if(-1!=h){let t=this.options.svg.substring(h+13),e=t.search('"');t=t.substring(0,e),o=parseFloat(t)}let d=this.options.svg.search("dataRotation");if(-1!=d){let t=this.options.svg.substring(d+14),e=t.search('"');t=t.substring(0,e),a=parseFloat(t)}}if(this.element.setAttribute("id",this.options.id),this.id=this.options.id,this.options.visibility&&(this.element.style.visibility=this.options.visibility),this.options.background_cmyk&&(this.background_cmyk=this.options.background_cmyk),this.options.preview&&(this.preview=[],this.preview.back=this.options.preview.back,this.preview.front=this.options.preview.front,this.preview.clippath=this.options.preview.clippath,this.previewBack=this.svg.node.addNode(new T,{parentIntId:this.svg.node.getNodeById("preBottomLayer").intId,href:this.preview.back},(t=>{this.svg.preview.scaleImageToSheet(t),t.element.style.display="none",this.svg.preview.updatePreview()})),this.previewFont=this.svg.node.addNode(new T,{parentIntId:this.svg.node.getNodeById("preTopLayer").intId,href:this.preview.front},(t=>{this.svg.preview.scaleImageToSheet(t),t.element.style.display="none",this.svg.preview.updatePreview()})),this.previewClipPath=this.svg.node.addNode(new tt,{path:this.preview.clippath})),this.options.meta&&this.options.meta.background_cmyk&&(this.background_cmyk=this.options.meta.background_cmyk),this.options.height&&(this.height=this.options.height),this.options.width&&(this.width=this.options.width),this.options.cornersRadius&&(this.cornersRadius=parseInt(this.options.cornersRadius)),void 0!==this.options.flags&&this.deSerializeFlags(this.options.flags),void 0!==this.options.rotateable&&(this.isRotateable=this.options.rotateable),void 0!==this.options.resizeable&&(this.isResizeable=this.options.resizeable),void 0!==this.options.aspectchangable&&(this.isAspectChangable=this.options.aspectchangable),void 0!==this.options.moveable&&(this.isMoveable=this.options.moveable),void 0!==this.options.skewable&&(this.isSkewable=this.options.skewable),void 0!==this.options.editable&&(this.isEditable=this.options.editable),void 0!==this.options.deleteable&&(this.isDeleteable=this.options.deleteable),void 0!==this.options.copyable&&(this.isCopyable=this.options.copyable),void 0!==this.options.lockedContent&&(this.isLockedContent=this.options.lockedContent),this.options.part_type?this.part_type=this.options.part_type:this.part_type=d.PART_TYPE_PATH,this.options.predefinedCutline&&(this.predefinedCutline=this.options.predefinedCutline),this.options.svg&&""!=this.options.svg&&(e=!0),this.options.bleed&&(this.bleed=this.options.bleed),isNaN(this.options.height)&&(this.height=this.options.height=this.svg.sheet.height),isNaN(this.options.width)&&(this.width=this.options.width=this.svg.sheet.width),this.part_type==d.PART_TYPE_PATH?(this.options.path?this.path=this.options.path:i=!0,this.isAspectChangable=!1):(this.part_type===d.PART_TYPE_IMAGE?(this.isAspectChangable=this.getOption("aspectchangable",!1),this.isEditable=!1):this.isAspectChangable=this.getOption("aspectchangable",!0),this.path=this.makePartPath(s,o,a,r,n)),this.svg.svgSettings.mode==E.MODE_SINGLE&&null!=this.path){let t=[];t.path=this.path,this.previewClipPath=this.svg.node.addNode(new tt,t)}this.partGroupNode=this.svg.node.addNode(new et,{parentIntId:this.intId,id:this.id+"_partGroup"}),this.partGroupNode.ignore=!0,this.partGroupNode.overHandling=l.OVER_IGNORE,this.partGroupNode.getTransformList(),"background"==this.id&&(this.isSheetBackground=!0,this.isCopyable=!1,this.isMoveable=!1,this.isMoveableTemp=!1,this.isRotateable=!1,this.isRotateableTemp=!1,this.isAspectChangable=!1,this.isAspectChangableTemp=!1,this.isDeleteable=!1,this.isDeleteableTemp=!1,this.isResizable=!1,this.isResizeable=!1,this.isResizeableTemp=!1),e?this.svg.import.importSVGData(this.options.svg,this.partGroupNode,(e=>{if(null==e){this.part_type=d.PART_TYPE_RECT,this.isAspectChangable=!0;let e=2*this.svg.px2mm;return this.path=this.makePartPath(e,e,0,this.width,this.height),this.previewClipPath=this.svg.node.addNode(new tt,{path:this.path}),this.scaleToFit=1,this.svg.error="editor_image_error",void this.createElementContinue(t)}if(i&&1==this.partGroupNode.children.length&&this.partGroupNode.children[0].type==d.SHAPE_MULTI){let e=this.partGroupNode.children[0].children[0];e.type==d.SHAPE_IMAGE&&(this.imageNode=e,this.runOutlineOnImage().then((()=>this.createElementContinue(t))))}else i?this.runOutlineOnImage().then((()=>this.createElementContinue(t))):this.createElementContinue(t)})):i||this.createElementContinue(t)}runOutlineOnImage(){return t=this,e=arguments,r=function*(t=null){let e=yield this.svg.outline.createImageOutline(this.imageNode,this);return new Promise((t=>{if(this.path=e.path,this.options.background=e.backgroundColor,this.predefinedCutline=e.type!=d.PART_TYPE_RECT,e.type==d.PART_TYPE_RECT){this.part_type=d.PART_TYPE_RECT,this.isAspectChangable=!0;let t=0;t=this.height/this.imageNode.imageHeight>this.width/this.imageNode.imageWidth?this.imageNode.imageHeight/this.height:this.imageNode.imageWidth/this.width,this.scaleToFit=1/(t/this.svg.px2mm);let e=2*this.svg.px2mm,i=1;i=parseFloat(this.imageNode.imageWidth)>parseFloat(this.imageNode.imageHeight)?(parseFloat(this.imageNode.imageWidth)+2*e)/parseFloat(this.imageNode.imageWidth):(parseFloat(this.imageNode.imageHeight)+2*e)/parseFloat(this.imageNode.imageHeight),this.imageNode.beforeTransform(null,!0),this.imageNode.transform(h.TRANSFORM_SCALE,"center",i,0,0,0,0,!0),this.imageNode.afterTransform(!0)}else this.scaleToFit=this.scalePathToFitWidthAndHeight();this.previewClipPath=this.svg.node.addNode(new tt,{path:this.path},(()=>{t(!0)}))}))},new((i=void 0)||(i=Promise))((function(n,s){function o(t){try{l(r.next(t))}catch(t){s(t)}}function a(t){try{l(r.throw(t))}catch(t){s(t)}}function l(t){t.done?n(t.value):function(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(o,a)}l((r=r.apply(t,e||[])).next())}));var t,e,i,r}createElementContinue(t=null){if(this.options.matrix){let t=this.svg.transform.transformStringToMatrix(this.options.matrix),e=this.svg.createSVGTransform();if(e.setMatrix(t),this.partGroupNode.element.transform.baseVal.initialize(e),void 0!==this.options.json&&void 0!==this.options.json.translate&&""!=this.options.json.translate){let t=this.options.json.translate.split(",");if(2==t.length){let e=this.svg.rootEl.createSVGTransform();e.setTranslate(parseFloat(t[0]),parseFloat(t[1])),this.partGroupNode.element.transform.baseVal.appendItem(e),this.partGroupNode.element.transform.baseVal.consolidate()}}this.part_type==d.PART_TYPE_PATH&&(this.path=this.svg.path.transformByMatrix(this.path,t).toString()),null!=this.bleed&&(this.bleed=this.svg.path.transformByMatrix(this.bleed,t).toString())}this.orgPath=this.path,this.orgCornersRadius=this.cornersRadius,this.orgHeight=this.height,this.orgWidth=this.width,this.element.setAttribute("clip-path","url(#editorClip_"+this.options.id+")"),void 0!==this.options.json&&void 0!==this.options.json.sort_order?this.svg.sheet.addPart(this,this.options.json.sort_order):this.svg.sheet.addPart(this),this.svg.sheet.updatePartsOrder(),this.clipPathNode=this.svg.node.addNode(new tt,{id:"editorClip_"+this.id,path:this.getOuterPath()}),this.tempTransform=this.svg.createSVGTransform();let e=this.svg.node.getNodeById("partPathLayer"),i="svgPartPath";this.part_type==d.PART_TYPE_IMAGE&&(i+=" partImage"),this.pathNode=this.svg.node.addNode(new J,{parentIntId:e.intId,d:this.path,class:i}),this.pathNode.ignore=!0,this.pathNode.overHandling=l.OVER_IGNORE,this.options.visibility&&(this.pathNode.element.style.visibility=this.options.visibility),this.pathNode.getTransformList(),this.pathNode.element.transform.baseVal.appendItem(this.tempTransform),null==this.bleed||this.isSheetBackground||(this.bleedPathNode=this.svg.node.addNode(new J,{parentIntId:e.intId,d:this.bleed,class:"svgPartBleedPath"}),this.bleedPathNode.ignore=!0,this.bleedPathNode.overHandling=l.OVER_IGNORE,this.bleedPathNode.getTransformList(),this.bleedPathNode.element.transform.baseVal.appendItem(this.tempTransform)),this.svg.sheet.backgroundPattern&&"front"===this.side&&(this.options.background="url(#"+this.svg.id+"-BackgroundPattern)"),null==this.options.background&&(this.options.background=!this.svg.sheet.isCustomizableSheet||this.side?this.getInitBackground():"none"),this.setBackground(this.options.background),this.addDropShadow(),this.isReady=!0,1!=this.scaleToFit&&(this.createBBoxAndCenter(),this.beforeTransform(null,!0),this.transform(h.TRANSFORM_SCALE,"uni",this.scaleToFit,0,0,0,0,!0),this.afterTransform(!0),this.scaleToFit=1),this.createBBoxAndCenter(),this.partGroupNode.element.transform.baseVal.consolidate(),t&&t(this)}getInitBackground(){return this.svg.livePreviewEnabled?"#FFFFFF00":"#FFFFFF"}addSelfToParent(){this.parent&&this.parent.addChild(this,this.parentIndex)}triggerScalingEvent(t=!1){this.svg.trigger(t?p.SVG_PART_SCALING_DONE:p.SVG_PART_SCALING,{widthMM:this.width,heightMM:this.height}),this.stickySizeLabels&&this.showSize()}createBBoxAndCenter(){if(this.svg.runBBox&&this.isReady){let t=this.getTransformationMatrix(),e=this.svg.path.transformByMatrix(this.orgPath,t);this.path=e.toString();let i=e.bbox;if(null!=this.bleed){let e=this.svg.path.transformByMatrix(this.bleed,t);this.bleed=e.toString(),i=e.bbox}this.boundingBox=this.svg.rootEl.createSVGRect(),this.boundingBox.width=i.width,this.boundingBox.height=i.height,this.boundingBox.x=i.x,this.boundingBox.y=i.y,this.center=this.svg.rootEl.createSVGPoint(),this.center.x=i.x+(i.x2-i.x)/2,this.center.y=i.y+(i.y2-i.y)/2,this.updatePath(),this.rBBox=i,this.height=this.boundingBox.height/this.svg.px2mm,this.width=this.boundingBox.width/this.svg.px2mm,this.orgHeight=this.height,this.orgWidth=this.width,(this.svg.svgSettings.mode==E.MODE_SINGLE||this.isSheetBackground)&&(this.svg.sheet.height=this.height,this.svg.sheet.width=this.width,this.svg.sheet.createBBoxAndCenter())}}addDropShadow(){this.svg.svgSettings.mode==E.MODE_SINGLE&&(this.backGroundNode.element.setAttribute("filter","url(#drop_shadow)"),this.pathNode.element.classList.add("dropShadow"))}removeDropShadow(){this.svg.svgSettings.mode==E.MODE_SINGLE&&(this.backGroundNode.element.removeAttribute("filter"),this.pathNode.element.classList.remove("dropShadow"))}updatePath(){this.calcLinePathWidthScale();let t=parseFloat(this.svg.style.getStyle(".svgPartPath","stroke-width"));this.pathNode.element.style.strokeWidth=(t*this.lineWidthScale_).toString(10),this.svg.sheet.isCustomizableSheet&&(this.isSheetBackground||"back"==this.side)&&(this.pathNode.element.style.visibility="hidden"),null!=this.bleedPathNode&&(this.bleedPathNode.element.style.strokeWidth=parseFloat((t*this.lineWidthScale_).toString())),this.createPathPointArray(100)}deactivate(){this.isClickThrough=!1,this.isSelectable=!0,this.isOverable=!0,this.isTransformable=this.isTransformableTemp,this.isResizeable=this.isResizeableTemp,this.isRotateable=this.isRotateableTemp,this.isSkewable=this.isSkewableTemp,this.isMoveable=this.isMoveableTemp,this.isDeleteable=this.isDeleteableTemp,this.isAspectChangable=this.isAspectChangableTemp,this.isGrouped=!0,this.element.setAttribute("clip-path","url(#editorClip_"+this.options.id+")")}activate(){this.isTransformableTemp=this.isTransformable,this.isResizeableTemp=this.isResizeable,this.isRotateableTemp=this.isRotateable,this.isSkewableTemp=this.isSkewable,this.isMoveableTemp=this.isMoveable,this.isDeleteableTemp=this.isDeleteable,this.isAspectChangableTemp=this.isAspectChangable,this.svg.svgSettings.mode==E.MODE_SINGLE?(this.isSelectable=!0,this.isOverable=!0,this.isTransformable=!0):this.svg.svgSettings.mode==E.MODE_SHEET?(this.isSelectable=!0,this.isOverable=!0,this.isTransformable=!0,this.isResizeable=!1):(this.isSelectable=!1,this.isOverable=!1,this.isTransformable=!1,this.isResizeable=!1),"back"!==this.side&&"back_deal"!==this.side||(this.isTransformable=!1,this.isAspectChangable=!1),this.isClickThrough=!0,this.isRotateable=!1,this.isSkewable=!1,this.isMoveable=!1,this.isGrouped=!1,this.element.setAttribute("clip-path","none")}setBackground(t){if(this.options.background=t,null!=this.backGroundNode)this.backGroundNode.element.setAttribute("fill",t);else{let e=this.path;null!=this.bleed&&(e=this.bleed),this.backGroundNode=this.svg.node.addNode(new J,{id:this.id+"PartBackground",parentIntId:this.intId,d:e,fill:t,stroke:"none"}),this.backGroundNode.ignore=!0,this.backGroundNode.overHandling=l.OVER_IGNORE,this.moveChildFirst(this.backGroundNode)}}getBackground(){return this.backGroundNode?"none"==this.backGroundNode.element.getAttribute("fill")?null:this.backGroundNode.element.getAttribute("fill"):this.getOption("background")}setCMYKBackground(t){this.background_cmyk=t}getCMYKBackground(){return this.background_cmyk}calcLinePathWidthScale(){let t=this.svg.rootEl.viewBox.baseVal.height,e=this.svg.rootEl.viewBox.baseVal.width,i=this.svg.container.clientHeight/t,r=this.svg.container.clientWidth/e,n=this.pathNode.getTransformationMatrix(),s=Math.sqrt(Math.pow(n.a,2)+Math.pow(n.b,2)),o=Math.sqrt(Math.pow(n.c,2)+Math.pow(n.d,2));this.lineWidthScale_=1/Math.min(i*s,r*o)}makePartPath(t=0,e=0,i=0,r=0,n=0){return t="string"==typeof t?parseFloat(t):t,e="string"==typeof e?parseFloat(e):e,i="string"==typeof i?parseFloat(i):i,r="string"==typeof r?parseFloat(r):r,n="string"==typeof n?parseFloat(n):n,0==r&&(r=this.width),0==n&&(n=this.height),this.svg.outline.createPath(this,new X(t,e,r,n,i)).path}changeAspect(t,e,i,r=!0,n=!1){r=void 0===r||r,n=void 0!==n&&n;let s,o=this.svg.px2mm,a=0,l=0,c=this.width,u=this.height;if(this.width=Math.round(this.width),this.height=Math.round(this.height),this.part_type==d.PART_TYPE_PATH||n){let r=1;switch(t){case"height":r=i/this.height;break;case"width":r=e/this.width}r=this.svg.size.evaluatePartScale(this,r),this.beforeTransform(null,!0),this.transform(h.TRANSFORM_SCALE,"center",r,0,0,0,0,!0),this.afterTransform(!0,null)}else{switch(t){case"height":this.height=i,i=(u-i)*o,this.part_type==d.PART_TYPE_TRIANGLE&&(this.width=this.height/(Math.sqrt(3)/2),a=i/2),l=i/2;break;case"width":this.width=e,e=(c-e)*o,this.part_type==d.PART_TYPE_TRIANGLE&&(this.height=Math.sqrt(3)/2*this.width,l=Math.sqrt(3)/2*e/2),a=e/2;break;case"n":this.height=(this.orgHeight*o-i)/o,this.part_type==d.PART_TYPE_TRIANGLE&&(this.width=this.height/(Math.sqrt(3)/2),a=i/Math.sqrt(3)),l=i;break;case"ne":s=(i-e)/2,this.height=(this.orgHeight*o-s)/o,this.width=(this.orgWidth*o-s)/o,l=s;break;case"e":this.width=(this.orgWidth*o-e)/o,this.part_type==d.PART_TYPE_TRIANGLE&&(this.height=Math.sqrt(3)/2*this.width,l=-Math.sqrt(3)/2*e/2),a=e;break;case"se":s=(-e-i)/2,this.height=(this.orgHeight*o-s)/o,this.width=(this.orgWidth*o-s)/o;break;case"s":this.height=(this.orgHeight*o+i)/o,this.part_type==d.PART_TYPE_TRIANGLE&&(this.width=this.height/(Math.sqrt(3)/2),a=-i/Math.sqrt(3));break;case"sw":s=(i-e)/2,this.height=(this.orgHeight*o+s)/o,this.width=(this.orgWidth*o+s)/o,a=-s;break;case"w":this.width=(this.orgWidth*o+e)/o,this.part_type==d.PART_TYPE_TRIANGLE&&(this.height=Math.sqrt(3)/2*this.width,l=Math.sqrt(3)/2*e/2);break;case"nw":s=(i+e)/2,this.height=(this.orgHeight*o-s)/o,this.width=(this.orgWidth*o-s)/o,l=s,a=s}let n=this.svg.size.evaluatePartSize(this,this.width,this.height),h=n.heightMM,p=n.widthMM;this.height!=h&&((this.height>h&&l<0||this.height<h&&l>0)&&(l=(this.orgHeight-h)*o),this.height=h),this.width!=p&&((this.width>p&&a<0||this.width<p&&a>0)&&(a=(this.orgWidth-p)*o),this.width=p),this.svg.sheet.sheet_type==E.MODE_SHEET&&(a+=this.rBBox.x,l+=this.rBBox.y,l<0&&(this.height+=l/o,l=0),a<0&&(this.width+=a/o,a=0),l+this.height*o>this.svg.sheet.boundingBox.height&&(this.height=(this.svg.sheet.boundingBox.height-l)/o),a+this.width*o>this.svg.sheet.boundingBox.width&&(this.width=(this.svg.sheet.boundingBox.width-a)/o));let g=this.makePartPath(a,l);if(this.bleed&&this.svg.sheet.isCustomizableSheet?this.bleed=g:this.path=g,this.clipPathNode.clipPathPath.element.setAttribute("d",this.getOuterPath()),this.pathNode.element.setAttribute("d",this.path),this.svg.shadow.updateShadow(this.path),r&&this.svg.sheet.sheet_type==E.MODE_SINGLE&&this.triggerScalingEvent(!1),this.svg.sheet.isCustomizableSheet&&null!=this.bleed){let t=this.svg.outline.getBleedPX(),e=.705*t;this.path=this.makePartPath(a+t,l+t,0,this.width-e,this.height-e),this.bleedPathNode.element.setAttribute("d",this.bleed)}null!=this.backGroundNode&&this.backGroundNode.element.setAttribute("d",this.getOuterPath())}}afterChangeAspect(t=!0,e=!1){if(this.resetPartMatrix(),this.orgPath=this.path,this.orgCornersRadius=this.cornersRadius,this.orgHeight=this.height,this.orgWidth=this.width,this.createBBoxAndCenter(),t&&this.svg.sheet.sheet_type==E.MODE_SINGLE&&0!=Math.round(this.width)&&0!=Math.round(this.height)&&this.triggerScalingEvent(!0),this.svg.sheet.sheet_type!=E.MODE_SINGLE||e||this.resetOrigin(),this.lastTransformType==h.TRANSFORM_ROTATE){if(this.boundingBox.height>this.svg.sheet.boundingBox.height){let t=this.svg.sheet.boundingBox.height/this.boundingBox.height;t-=.01,this.beforeTransform(null,!0),this.transform(h.TRANSFORM_SCALE,"uni",t,0,0,0,0,!0),this.lastTransformType=h.TRANSFORM_ROTATE,this.afterTransform(!0)}if(this.boundingBox.width>this.svg.sheet.boundingBox.width){let t=this.svg.sheet.boundingBox.width/this.boundingBox.width;t-=.01,this.beforeTransform(null,!0),this.transform(h.TRANSFORM_SCALE,"uni",t,0,0,0,0,!0),this.lastTransformType=h.TRANSFORM_ROTATE,this.afterTransform(!0)}if(this.boundingBox.x<this.svg.sheet.boundingBox.x){let t=this.svg.sheet.boundingBox.x-this.boundingBox.x+1;this.beforeTransform(null,!0),this.transform(h.TRANSFORM_MOVE,t,0,0,0,0,0,!0),this.lastTransformType=h.TRANSFORM_ROTATE,this.afterTransform(!0)}if(this.boundingBox.y<this.svg.sheet.boundingBox.y){let t=this.svg.sheet.boundingBox.y-this.boundingBox.y+1;this.beforeTransform(null,!0),this.transform(h.TRANSFORM_MOVE,0,t,0,0,0,0,!0),this.lastTransformType=h.TRANSFORM_ROTATE,this.afterTransform(!0)}if(this.boundingBox.x+this.boundingBox.width>this.svg.sheet.boundingBox.x+this.svg.sheet.boundingBox.width){let t=this.svg.sheet.boundingBox.x+this.svg.sheet.boundingBox.width-(this.boundingBox.x+this.boundingBox.width)-1;this.beforeTransform(null,!0),this.transform(h.TRANSFORM_MOVE,t,0,0,0,0,0,!0),this.lastTransformType=h.TRANSFORM_ROTATE,this.afterTransform(!0)}if(this.boundingBox.y+this.boundingBox.height>this.svg.sheet.boundingBox.y+this.svg.sheet.boundingBox.height){let t=this.svg.sheet.boundingBox.y+this.svg.sheet.boundingBox.height-(this.boundingBox.y+this.boundingBox.height)-1;this.beforeTransform(null,!0),this.transform(h.TRANSFORM_MOVE,0,t,0,0,0,0,!0),this.lastTransformType=h.TRANSFORM_ROTATE,this.afterTransform(!0)}}let i=this.lastTransformType;this.lastTransformType=null,this.svg.trigger(p.SVG_PART_ASPECT_CHANGED,{part:this,lastTransformType:i})}resetPartMatrix(){var t;let e=this.tempTransform.matrix;this.path=this.svg.path.transformByMatrix(this.path,e).toString(),this.partGroupNode.element.transform.baseVal.insertItemBefore(this.tempTransform,0),this.partGroupNode.element.transform.baseVal.consolidate(),this.element.transform.baseVal.clear(),this.tempTransform=this.svg.rootEl.createSVGTransform(),(null===(t=this.backGroundNode)||void 0===t?void 0:t.element)&&this.backGroundNode.element.setAttribute("d",this.path),this.pathNode.element.transform.baseVal.clear(),this.pathNode.getTransformList(),this.pathNode.element.transform.baseVal.appendItem(this.tempTransform),this.pathNode.element.setAttribute("d",this.path),this.updatePath(),this.clipPathNode.clipPathPath.element.setAttribute("d",this.path),null!=this.bleed&&(this.bleed=this.svg.path.transformByMatrix(this.bleed,e).toString(),null==this.bleedPathNode?this.bleedPathNode=this.svg.node.addNode(new J,{parentIntId:this.svg.node.getNodeById("partPathLayer").intId,d:this.bleed,class:"svgPartBleedPath"}):(this.bleedPathNode.element.transform.baseVal.clear(),this.bleedPathNode.getTransformList(),this.bleedPathNode.element.transform.baseVal.appendItem(this.tempTransform),this.bleedPathNode.element.setAttribute("d",this.bleed)),this.backGroundNode.element.setAttribute("d",this.bleed),this.clipPathNode.clipPathPath.element.setAttribute("d",this.bleed)),this.svg.shadow.updateShadow()}resetOrigin(){let t=this.svg.root.getX()-this.boundingBox.x,e=this.svg.root.getY()-this.boundingBox.y;this.tempTransform.setTranslate(-1*this.boundingBox.x,-1*this.boundingBox.y),this.resetPartMatrix(),this.orgPath=this.path,this.createBBoxAndCenter(),this.svg.shadow.updateShadow(),this.svg.root.updateViewBox(t+" "+e+" "+this.svg.root.getWidth()+" "+this.svg.root.getHeight()),this.svg.svgSettings.zoomMode==c.ZOOM_PART&&this.svg.zoomHelper.changeMode(c.ZOOM_PART,this)}transforming(t,e,i){if(t==h.TRANSFORM_SCALE){let t=this.height*e,r=this.width*e,n=e;return this.svg.sheet.sheet_type!=E.MODE_SINGLE&&(("sw"==i||"se"==i)&&t*this.svg.px2mm+this.boundingBox.y>this.svg.sheet.boundingBox.height&&(n=(this.svg.sheet.boundingBox.height-this.boundingBox.y)/this.svg.px2mm/this.height,t=(this.svg.sheet.boundingBox.height-this.boundingBox.y)/this.svg.px2mm,r=this.width*n),("ne"==i||"se"==i)&&r*this.svg.px2mm+this.boundingBox.x>this.svg.sheet.boundingBox.width&&(n=(this.svg.sheet.boundingBox.width-this.boundingBox.x)/this.svg.px2mm/this.width,r=(this.svg.sheet.boundingBox.width-this.boundingBox.x)/this.svg.px2mm,t=this.height*n),("nw"==i||"ne"==i)&&this.boundingBox.height+this.boundingBox.y-t*this.svg.px2mm<this.svg.sheet.boundingBox.y&&(n=(this.boundingBox.height+this.boundingBox.y-this.svg.sheet.boundingBox.y)/this.svg.px2mm/this.height,t=(this.boundingBox.height+this.boundingBox.y-this.svg.sheet.boundingBox.y)/this.svg.px2mm,r=this.width*n),("nw"==i||"sw"==i)&&this.boundingBox.width+this.boundingBox.x-r*this.svg.px2mm<this.svg.sheet.boundingBox.x&&(n=(this.boundingBox.width+this.boundingBox.x-this.svg.sheet.boundingBox.x)/this.svg.px2mm/this.width,r=(this.boundingBox.width+this.boundingBox.x-this.svg.sheet.boundingBox.x)/this.svg.px2mm,t=this.height*n),"all"==i&&(t/2*this.svg.px2mm+(this.boundingBox.y+this.boundingBox.height/2)>this.svg.sheet.boundingBox.height&&(n=(this.svg.sheet.boundingBox.height-(this.boundingBox.y+this.boundingBox.height/2))/this.svg.px2mm/(this.height/2),t=(this.svg.sheet.boundingBox.height-(this.boundingBox.y+this.boundingBox.height/2))/this.svg.px2mm*2,r=this.width*n),r/2*this.svg.px2mm+(this.boundingBox.x+this.boundingBox.width/2)>this.svg.sheet.boundingBox.width&&(n=(this.svg.sheet.boundingBox.width-(this.boundingBox.x+this.boundingBox.width/2))/this.svg.px2mm/(this.width/2),r=(this.svg.sheet.boundingBox.width-(this.boundingBox.x+this.boundingBox.width/2))/this.svg.px2mm*2,t=this.height*n),this.boundingBox.height/2+this.boundingBox.y-t/2*this.svg.px2mm<this.svg.sheet.boundingBox.y&&(n=(this.boundingBox.height/2+this.boundingBox.y-this.svg.sheet.boundingBox.y)/this.svg.px2mm/(this.height/2),t=(this.boundingBox.height/2+this.boundingBox.y-this.svg.sheet.boundingBox.y)/this.svg.px2mm*2,r=this.width*n),this.boundingBox.width/2+this.boundingBox.x-r/2*this.svg.px2mm<this.svg.sheet.boundingBox.x&&(n=(this.boundingBox.width/2+this.boundingBox.x-this.svg.sheet.boundingBox.x)/this.svg.px2mm/(this.width/2),r=(this.boundingBox.width/2+this.boundingBox.x-this.svg.sheet.boundingBox.x)/this.svg.px2mm*2,t=this.height*n)),e=n),e=this.svg.size.evaluatePartScale(this,e),this.height*=e,this.width*=e,this.svg.sheet.sheet_type==E.MODE_SINGLE&&this.triggerScalingEvent(!1),e}}specialBeforeTransform(){this.tempFilters=this.backGroundNode.element.getAttribute("filter"),this.backGroundNode.element.setAttribute("filter","")}specialTransform(t){this.tempTransform.setMatrix(t),this.pathNode.element.transform.baseVal.initialize(this.tempTransform),this.svg.sheet.isCustomizableSheet&&null!=this.bleedPathNode&&this.bleedPathNode.element.transform.baseVal.initialize(this.tempTransform),this.updatePath(),this.svg.shadow.updateShadow(),this.svg.sheet.sheet_type!=E.MODE_SHEET&&1!=this.stickySizeLabels||this.showSize(t)}specialAfterTransform(t){null!=this.bottomText&&(this.bottomText.remove(),this.bottomText=null),null!=this.leftText&&(this.leftText.remove(),this.leftText=null),this.afterChangeAspect(),this.backGroundNode.element.setAttribute("filter",this.tempFilters),this.tempFilters="",this.svg.svgSettings.zoomMode==c.ZOOM_PART&&this.addBleed(!1)}setCornersRadius(t){this.cornersRadius=parseInt(t);let e=0,i=0;if(this.svg.sheet.sheet_type!=E.MODE_SINGLE){let t=this.partGroupNode.element.getAttribute("transform").match(/\d+\.?\d*/g);e=t[4],i=t[5]}this.path=this.makePartPath(e,i)}setPartType(t,e=null,i=null){let r=this.part_type;if(this.part_type=t,this.path_type=t,"path-org"!=t&&"path-s"!=t&&"path-m"!=t&&"path-l"!=t&&"path-x"!=t&&"path-new-x"!=t||(this.part_type=d.PART_TYPE_PATH),"path-included"==t)return this.path=i,this.part_type=d.PART_TYPE_PATH,this.isAspectChangable=!1,this.isAspectChangableTemp=!1,this.afterChangeAspect(),this.svg.svgSettings.zoomMode==c.ZOOM_PART&&this.svg.sheet.sheet_type==E.MODE_SHEET&&this.svg.zoomHelper.changeMode(c.ZOOM_PART,this),void(e&&e());if(this.part_type==d.PART_TYPE_PATH){if(0==this.partGroupNode.children.length)return this.part_type=r,!1;this.isAspectChangable=!1,this.isAspectChangableTemp=!1;let i=!0;for(let t=0;t<this.partGroupNode.children.length;t++)if(this.partGroupNode.children[t].type!=d.SHAPE_TEXT){i=!1;break}this.svg.outline.createPartOutline(this,t).then((t=>{let i=t.type==d.PART_TYPE_RECT;this.svg.isSheetMode||!t.backgroundColor||this.getBackground()||this.setBackground(t.backgroundColor),this.path=t.path,this.svg.isSheetMode&&this.lastTransformType||this.afterChangeAspect(!0,!0);let r=1;this.height<this.svg.svgSettings.subPartMinSizeMM&&(r=this.svg.svgSettings.subPartMinSizeMM/this.height),this.width*r<this.svg.svgSettings.subPartMinSizeMM&&(r=this.svg.svgSettings.subPartMinSizeMM/this.width),r>1&&!this.svg.isSheetMode?(this.beforeTransform(null,!0),this.transform(h.TRANSFORM_SCALE,"center",r,0,0,0,0,!0),this.afterTransform(!0)):this.svg.sheet.sheet_type==E.MODE_SINGLE&&this.afterChangeAspect(),this.svg.svgSettings.zoomMode==c.ZOOM_PART&&this.svg.isSheetMode&&this.svg.zoomHelper.changeMode(c.ZOOM_PART,this),i?this.setPartType(d.PART_TYPE_RECT,e):(this.addBleed(),e&&e())}))}else{switch(this.part_type){case d.PART_TYPE_RECT:case d.PART_TYPE_ROUND:case d.PART_TYPE_TRIANGLE:this.isAspectChangable=!0,this.isAspectChangableTemp=!0}let t=0,i=0;this.svg.isSheetMode&&(t=this.boundingBox.x,i=this.boundingBox.y);let r=this.svg.outline.getBleedPX(),n=.705*r;this.path=this.makePartPath(t+r,i+r,0,this.width-n,this.height-n),this.addBleed(),this.afterChangeAspect(),this.svg.shadow.updateShadow(),e&&e()}}adaptToContent(){if(this.part_type==d.PART_TYPE_RECT){let t=10;this.width=this.partGroupNode.boundingBox.width/this.svg.px2mm+2*t,this.height=this.partGroupNode.boundingBox.height/this.svg.px2mm+2*t;let e=this.partGroupNode.boundingBox.x-t,i=this.partGroupNode.boundingBox.y-t;this.path=this.makePartPath(e,i),this.addBleed(!1),this.afterChangeAspect()}}onDeSelect(){this.svg.sheet.sheet_type==E.MODE_SHEET&&this.svg.svgSettings.zoomMode==c.ZOOM_SHEET&&(this.svg.activePart=null)}scalePathToFitWidthAndHeight(){let t=this.svg.path.toBoundingBox(this.path),e=this.width/(t.width/this.svg.px2mm),i=this.height/(t.height/this.svg.px2mm),r=Math.min(e,i);return r*(t.width/this.svg.px2mm)<this.svg.svgSettings.minSizeMM&&(r=this.svg.svgSettings.minSizeMM/(t.width/this.svg.px2mm)),r*(t.height/this.svg.px2mm)<this.svg.svgSettings.minSizeMM&&(r=this.svg.svgSettings.minSizeMM/(t.height/this.svg.px2mm)),r}checkRotationBorder(t){let e=this.svg.path.transform(this.path,{translate:0,scale:1,origin:[0,0],skew:0,rotate:t}).bbox;return!(e.x<this.svg.sheet.boundingBox.x||e.x2>this.svg.sheet.boundingBox.x+this.svg.sheet.boundingBox.width||e.y<this.svg.sheet.boundingBox.y||e.y2>this.svg.sheet.boundingBox.y+this.svg.sheet.boundingBox.height)}getMenuOptions(){if(this.svg.svgSettings.zoomMode==c.ZOOM_SHEET){let t=[],e=window.location.href.indexOf("admin.")>-1;return this.svg.sheet.isCustomizableSheet&&(this.isSheetBackground||"back"==this.side)&&(e=!1),e&&(t.push(g.UP),t.push(g.DOWN)),this.isEditable&&t.push(g.EDIT),this.isCopyable&&t.push(g.COPY),this.isMoveable&&(t.push(g.CENTER_HOR),t.push(g.CENTER_VER)),this.isDeleteable&&t.push(g.DELETE),t}return null}preRemove(t){for(let t=0;t<this.children.length;t++)this.children[t].preRemove();null!=this.backGroundNode&&this.backGroundNode.remove(),null!=this.pathNode&&this.pathNode.remove(),null!=this.bleedPathNode&&this.bleedPathNode.remove(),null!=this.clipPathNode&&this.clipPathNode.remove(),this.svg.sheet.parts.splice(this.svg.sheet.parts.indexOf(this),1),setTimeout((()=>{void 0!==t&&t()}),0)}onEditMenu(){this.svg.svgSettings.sheetZoomable&&this.isEditable&&this.svg.svgSettings.mode==E.MODE_SHEET&&(this.svg.svgSettings.zoomMode==c.ZOOM_SHEET?this.svg.zoomHelper.changeMode(c.ZOOM_PART,this):this.svg.svgSettings.zoomMode==c.ZOOM_PART&&this.svg.zoomHelper.changeMode(c.ZOOM_SHEET))}hideSize(){if(this.stickySizeLabels)return!1;null!=this.bottomText&&(this.bottomText.remove(),this.bottomText=null),null!=this.leftText&&(this.leftText.remove(),this.leftText=null)}showSize(t=null){var e;if(t=t||this.getBaseTransformationMatrix(),0!=Math.atan2(t.b,t.a))return null!=this.bottomText&&(this.bottomText.remove(),this.bottomText=null),void(null!=this.leftText&&(this.leftText.remove(),this.leftText=null));let i=this.isAspectChangable?this.svg.path.toBoundingBox(this.getOuterPath()):this.boundingBox,r=this.svg.rootEl.createSVGPoint();r.x=i.x,r.x||(r.x=1),r.y=i.y,r.y||(r.y=1),r=r.matrixTransform(t);let n=this.svg.rootEl.createSVGPoint();n.x=i.x+i.width,n.x||(n.x=1),n.y=i.y+i.height,n.y||(n.y=1),n=n.matrixTransform(t);let s=(this.svg.isSheetMode?this.svg.svgSettings.subPartFontSize:this.svg.svgSettings.fontSize)*this.svg.strokeScale,o=s;isFinite(o)||(o=1),isFinite(s)||(s=1);let a=[];a.top=n.y+o,this.svg.select.invertedRotation&&(a.top=r.y-o),a.parentId="infoLayer",a.left=(r.x+n.x)/2,a.size=s,a.anchor="middle",a.text=this.svg.size.mmToDisplayable(this.width),a.class="svgPartSizeText","front"!=this.side&&null!=this.side||(null===(e=this.bottomText)||void 0===e||e.remove(),this.bottomText=this.svg.node.addNode(new rt,a),this.bottomText.overHandling=l.OVER_NEVER,a.left=r.x-o,a.top=(r.y+n.y)/2,a.text=this.svg.size.mmToDisplayable(this.height),a.transform="rotate(-90 "+a.left+", "+a.top+")",null==this.leftText||this.leftText.remove(),this.leftText=this.svg.node.addNode(new rt,a),this.leftText.overHandling=l.OVER_NEVER)}copy(t){let e=0,i=0;this.pathNode.createBBoxAndCenter(),this.partGroupNode.createBBoxAndCenter(),this.pathNode.element.transform.baseVal.consolidate(),this.partGroupNode.element.transform.baseVal.consolidate(),null!=this.backGroundNode&&(t.background=this.backGroundNode.element.getAttribute("fill")),void 0===t.offX&&(t.offX=0),void 0===t.offY&&(t.offY=0),void 0!==t.x&&(t.offX=parseFloat(t.x)-this.pathNode.boundingBox.x),void 0!==t.y&&(t.offY=parseFloat(t.y)-this.pathNode.boundingBox.y),t.part_type=d.PART_TYPE_PATH;let r=this.partGroupNode.element.transform.baseVal.consolidate().matrix,n=this.svg.createSVGMatrix(),s=this.svg.path.transformByMatrix(this.path,r.inverse());t.path=s.toString(),e=this.boundingBox.x+parseFloat(t.offX)-this.pathNode.boundingBox.x,i=this.boundingBox.y+parseFloat(t.offY)-this.pathNode.boundingBox.y,n=n.translate(e,i),n=n.multiply(r),t.matrix="matrix("+n.a+", "+n.b+", "+n.c+", "+n.d+", "+n.e+", "+n.f+")",t.svg=this.svg.export.serializedPart(this,!0),t.flags=this.serializeFlags(),t.visibility="hidden",t.predefinedCutline=this.predefinedCutline,this.svg.node.addNode(new nt,t,(t=>{if(this.bleed&&this.svg.sheet.isCustomizableSheet)switch(t.addBleed(),t.part_type=this.part_type,t.part_type){case d.PART_TYPE_RECT:case d.PART_TYPE_ROUND:case d.PART_TYPE_TRIANGLE:t.isAspectChangable=!0,t.isAspectChangableTemp=!0}t.element.style.visibility="visible",t.pathNode.element.style.visibility="visible",this.svg.select.select(t)}))}copyTo(t,e,i,r){e=void 0!==e&&e,i=void 0!==i&&i,null!=this.backGroundNode&&(null==t.backGroundNode?(t.backGroundNode=this.svg.node.addNode(new J,{id:t.id+"PartBackground",parentIntId:t.intId,d:t.path,fill:this.backGroundNode.element.getAttribute("fill"),stroke:"none"}),t.backGroundNode.ignore=!0,t.backGroundNode.overHandling=l.OVER_IGNORE,t.moveChildFirst(t.backGroundNode)):t.backGroundNode.element.setAttribute("fill",this.backGroundNode.element.getAttribute("fill"))),this.svg.import.importSVGData(this.svg.export.serializedPart(this),t,((t,n)=>{let s=this.svg.rootEl.createSVGTransform(),o=this.svg.rootEl.createSVGMatrix(),a=this.partGroupNode.getTransformationMatrix(),l=t.boundingBox.x-this.boundingBox.x,h=t.boundingBox.y-this.boundingBox.y;if(o.a=a.a,o.b=a.b,o.c=a.c,o.d=a.d,o.e=l+a.e,o.f=h+a.f,s.setMatrix(o),t.partGroupNode.element.transform.baseVal.initialize(s),e){let e=this.boundingBox.width/t.boundingBox.width,i=this.boundingBox.height/t.boundingBox.height,r=1/Math.min(e,i),n=this.svg.rootEl.createSVGTransform();n.setScale(r,r),t.partGroupNode.element.transform.baseVal.appendItem(n),t.partGroupNode.element.transform.baseVal.consolidate(),t.partGroupNode.createBBoxAndCenter();let s=t.boundingBox.x+t.boundingBox.width/2-(t.partGroupNode.boundingBox.x+t.partGroupNode.boundingBox.width/2),o=t.boundingBox.y+t.boundingBox.height/2-(t.partGroupNode.boundingBox.y+t.partGroupNode.boundingBox.height/2),a=this.svg.rootEl.createSVGTransform();a.setTranslate(s,o),t.partGroupNode.element.transform.baseVal.insertItemBefore(a,0),t.partGroupNode.element.transform.baseVal.consolidate()}if(i){t.partGroupNode.createBBoxAndCenter();let e=this.svg.rootEl.createSVGTransform(),i=(t.boundingBox.width-this.boundingBox.width)/2,r=(t.boundingBox.height-this.boundingBox.height)/2;e.setTranslate(i,r),t.partGroupNode.element.transform.baseVal.insertItemBefore(e,0),t.partGroupNode.element.transform.baseVal.consolidate()}void 0!==r&&r()}))}hidePart(t=l.OVER_IGNORE){this.ignore=!0,this.overHandling=t,this.element.style.display="none",this.pathNode.element.style.display="none",this.bleedPathNode&&(this.bleedPathNode.element.style.display="none")}showPart(t=l.OVER_ZOOMED){this.ignore=!1,this.overHandling=t,this.element.style.display="block",this.pathNode.element.style.display="block",this.pathNode.element.classList.add("svgPartPath"),this.bleedPathNode&&(this.bleedPathNode.element.style.display="block",this.bleedPathNode.element.classList.add("svgPartBleedPath"))}isEmpty(){return 0==this.partGroupNode.children.length}createPathPointArray(t){if(isNaN(t)||t<=0)return;let e=this.svg.path.parse(this.path),i=e.segments[0],r=e.length;if(r==this.pathPointLength_&&i[1]==this.pathPointMX_&&i[2]==this.pathPointMY_)return;this.pathPointLength_=r,this.pathPointMX_=i[1],this.pathPointMY_=i[2],this.pathPointArray_.length=0;let n=r/t;for(let t=0;t<r;t+=n){let i=e.getPointAtLength(t);this.pathPointArray_.push(new st(i.x,i.y))}}searchPathPointArray(t,e){let i=this.pathPointArray_.length,r=new st(t,e),n=-1;for(let t=0;t<i-1;t++){let e=this.pathPointArray_[t],i=this.pathPointArray_[t+1],s=this.distToSegment(r,e,i);(-1==n||s<n)&&(n=s)}return n/this.lineWidthScale_}markPath(){if((null!=this.svg.selected&&this.svg.selected.intId!=this.intId||null==this.svg.selected)&&!this.pathMarked){this.svg.preview.isPreviewModeOn&&(this.pathNode.element.style.visibility="visible"),this.oldMarkDash=this.pathNode.element.style.strokeDasharray,this.oldMarkLine=this.pathNode.element.style.strokeWidth;let t=this.pathNode.element.getAttribute("class");this.pathNode.element.setAttribute("class",t+" svgPartPathHover");let e=parseFloat(this.svg.style.getStyle(".svgPartPathHover","stroke-width")),i=this.svg.style.getStyle(".svgPartPathHover","stroke-dasharray");if(null==e||isNaN(e)||(this.pathNode.element.style.strokeWidth=(e*this.lineWidthScale_).toString(10)),null!=i){let t=i.split(","),e=parseFloat(t[0]),r=parseFloat(t[1]);isNaN(e)||isNaN(r)||(this.pathNode.element.style.strokeDasharray=e*this.lineWidthScale_+","+r*this.lineWidthScale_)}this.pathMarked=!0}}unMarkPath(){if(this.pathMarked){this.svg.preview.isPreviewModeOn&&this.svg.svgSettings.mode==E.MODE_SINGLE&&(this.pathNode.element.style.visibility="hidden");let t=this.pathNode.element.getAttribute("class");this.pathNode.element.setAttribute("class",t.replace(" svgPartPathHover","")),null!=this.oldMarkDash&&(this.pathNode.element.style.strokeDasharray=this.oldMarkDash);let e=parseFloat(this.svg.style.getStyle(".svgPartPath","stroke-width"));this.pathNode.element.style.strokeWidth=(e*this.lineWidthScale_).toString(10),this.pathMarked=!1,this.updatePath()}}movePartDown(){let t=this.svg.sheet.parts,e=t.indexOf(this);e!=t.length-1&&(t[e]=t[e+1],t[e+1]=this,this.svg.sheet.updatePartsOrder())}movePartUp(){let t=this.svg.sheet.parts,e=t.indexOf(this);0!=e&&(t[e]=t[e-1],t[e-1]=this,this.svg.sheet.updatePartsOrder())}getOuterPath(){return null!=this.bleed?this.bleed:this.path}isJustText(){for(let t=0;t<this.partGroupNode.children.length;t++)if(this.partGroupNode.children[t].type!=d.SHAPE_TEXT)return!1;return!0}addBleed(t=!0){let e=this.lastTransformType;this.svg.outline.offsetPath(this.path,this.svg.outline.getBleedMM()).then((i=>{var r;if(this.bleed=i.outer,e==h.TRANSFORM_MOVE&&!this.lastTransformType)return this.addBleed(t);this.lastTransformType||(this.afterChangeAspect(!0,!0),t&&(null===(r=this.svg.selected)||void 0===r?void 0:r.intId)==this.intId&&this.svg.select.selectOn(this,!0))}))}sqr(t){return t*t}dist2(t,e){return this.sqr(t.x-e.x)+this.sqr(t.y-e.y)}distToSegmentSquared(t,e,i){let r=this.dist2(e,i);if(0==r)return this.dist2(t,e);let n=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/r;return n<0?this.dist2(t,e):n>1?this.dist2(t,i):this.dist2(t,{x:e.x+n*(i.x-e.x),y:e.y+n*(i.y-e.y)})}distToSegment(t,e,i){return Math.sqrt(this.distToSegmentSquared(t,e,i))}get gEl(){return this.partGroupNode.element}}class st{constructor(t,e){this.x=t,this.y=e}}class ot extends f{execute(t,e){if(Array.isArray(this.svg.buildParts)&&this.svg.buildParts.length>0){let t=this.svg.buildParts.length;if(0==t)this.svg.trigger(p.SVG_ALL_PARTS_LOADED);else for(let e=0;e<this.svg.buildParts.length;e++){let i=this.svg.buildParts[e];i.visibility="hidden",this.svg.svgSettings.mode!=E.MODE_SHEET&&(i.deleteable=!1),this.svg.svgSettings.mode!==E.MODE_SHEET&&(i.deleteable=!1),i.visibility="hidden",this.svg.node.addNode(new nt,{json:i},(e=>{i._node=e,this.svg.trigger(p.SVG_PART_LOADED,i),--t,t<=0&&this.svg.trigger(p.SVG_ALL_PARTS_LOADED)}))}}else this.svg.trigger(p.SVG_ALL_PARTS_LOADED)}}class at extends f{execute(t,e){var i;let r=e.part;e.lastTransformType==h.TRANSFORM_SCALE&&this.svg.isSheetMode&&r.setPartType(null!==(i=r.path_type)&&void 0!==i?i:r.part_type)}}class lt extends f{execute(t,e){switch(this.svg.svgSettings.mode){case E.MODE_SKIN:case E.MODE_CASE:this.onTemplatePartCreated(e),this.onCaseOrSkinPartCreated(e)}this.showPart(e)}showPart(t){"back"==t.side&&(t._node.element.style.display="none"),t._node.element.style.visibility="visible",this.svg.isSheetMode&&(t._node.pathNode.element.style.visibility="visible")}onTemplatePartCreated(t){t._node.originalPathBoundingBox&&!this.svg.collage&&(this.svg.transform.rearrangeChildrenToNewPath(t._node.partGroupNode.children,t._node.originalPathBoundingBox,this.svg.path.toBoundingBox(t._node.path)),this.svg.trigger(p.RESIZE))}onCaseOrSkinPartCreated(t){t._originallyDesignedSVG&&(this.svg.export.findAttachmentIDs(t._originallyDesignedSVG).forEach(((e,i)=>{let r=t._node.findChildWithOption("attachment_id",e);r&&r.parent.onDeleteMenu()&&(r.parent.isDeleteable=!0,r.parent.remove())})),this.svg.import.importSVGData(t._originallyDesignedSVG,t._node,(function(t,e){e.forEach(((t,e)=>{let i=t;for(;i.parent&&i.parent.type!=d.GROUP_STANDARD;)i=i.parent;i.parent&&i.parent.type==d.GROUP_STANDARD&&i.parent.moveChildToPos(i,i.parent.children.length-1)}))})))}}class ht extends f{execute(t,e){var i=this.svg.icon.overIcon(e.point);e.icon=i,null!=i?this.svg.events.trigger("click",null,i.element):this.shouldSelectActivePart(e)?this.svg.select.select(this.svg.activePart):this.selectNodeOnPoint(e)}selectNodeOnPoint(t){var e=this.svg.node.getNodeOnPoint(t.point);null!=e?this.svg.select.select(e):this.svg.preview.turnOn()}shouldSelectActivePart(t){return!!this.svg.input.isPointerOverActivePartPath(t.point.x,t.point.y)&&(null==this.svg.selected||this.svg.selected.intId!=this.svg.activePart.intId)}}class dt extends f{execute(t,e){var i=this.svg.icon.overIcon(e.point);if(null!=i){if("selectRotateIcon"==(i=i.id)){var r=this.svg.selected.getBaseTransformationMatrix(),n=Math.round(Math.atan2(r.b,r.a)*(180/Math.PI));n=0==n||90==n||180==n||270==n||-90==n||-180==n||-270==n?this.svg.transform.rotateSnap(90,45):this.svg.transform.rotateSnap(0,45),this.svg.transform.updateNodeBeforeTransformation(this.svg.selected,t),this.svg.transform.rotateNode(this.svg.selected,n),this.svg.transform.updateNodeAfterTransformation(this.svg.selected,g.ROTATE,e.point)}this.svg.svgSettings.controlScaleToFitMediaOnDblClick&&this.svg.selected.type!=d.PART&&("selectNWIcon"!=i&&"selectNEIcon"!=i&&"selectSEIcon"!=i&&"selectSWIcon"!=i||(this.svg.transform.fit(this.svg.selected,1,!0,!0,!0,!0),this.svg.transform.center(this.svg.selected)))}else if(this.svg.svgSettings.sheetZoomable)if(this.svg.svgSettings.zoomMode==c.ZOOM_SHEET){var s=this.svg.node.getNodeOnPoint(e.point);null!=s&&this.svg.zoomHelper.changeMode(c.ZOOM_PART,s)}else this.svg.svgSettings.zoomMode==c.ZOOM_PART&&this.svg.zoomHelper.changeMode(c.ZOOM_SHEET);else{var o=this.svg.node.getNodeOnPoint(e.point);null!=o&&o.onEditMenu()}}}class ct extends f{execute(t,e){var i=!1;if(null!=this.svg.selected){if(this.svg.selected.isTransformable)switch(this.svg.select.selectedTool){case g.MOVE:this.svg.selected.isMoveable&&(i=!0);break;case g.ROTATE:case g.ROTATE_INVERSE:this.svg.selected.isRotateable&&(i=!0);break;case g.NW_RESIZE:case g.NE_RESIZE:case g.SE_RESIZE:case g.SW_RESIZE:this.svg.selected.isResizeable&&(i=!0);break;case g.N_RESIZE:case g.E_RESIZE:case g.S_RESIZE:case g.W_RESIZE:this.svg.selected.isAspectChangable&&(i=!0)}if(i){var r=this.svg.select.selectedTool;this.svg.select.lockTool=!1,this.svg.select.selectedTool=null,this.svg.transform.updateNodeAfterTransformation(this.svg.selected,r,e.point)}}}}class ut extends f{execute(t,e){var i=this.svg.select.selectedTool;if(null!=this.svg.selected){if(i==g.MOVE&&this.svg.selected.isMoveable&&(this.svg.transform.moveNode(this.svg.selected,e.point.x-this.svg.input.startDragX,e.point.y-this.svg.input.startDragY),this.svg.selected.type==d.SHAPE_PATH&&this.svg.selected.specialDrag(e.point)),i==g.ROTATE&&this.svg.selected.isRotateable&&null!=this.svg.selected){var r=this.svg.selected.getCenterPoint(!1),n=e.point,s=r.y-n.y,o=r.x-n.x,a=180*Math.atan2(o,s)/Math.PI*-1;a=this.svg.transform.rotateSnap(a,2),this.svg.transform.rotateNode(this.svg.selected,a)}if(i==g.ROTATE_INVERSE&&this.svg.selected.isRotateable&&null!=this.svg.selected&&(r=this.svg.selected.getCenterPoint(!1),s=(n=e.point).y-r.y,o=n.x-r.x,a=180*Math.atan2(o,s)/Math.PI*-1,a=this.svg.transform.rotateSnap(a,2),this.svg.transform.rotateNode(this.svg.selected,a)),(i==g.NW_RESIZE||i==g.NE_RESIZE||i==g.SE_RESIZE||i==g.SW_RESIZE)&&this.svg.selected.isResizeable&&null!=this.svg.selected){switch(i){case g.NW_RESIZE:l="nw";break;case g.NE_RESIZE:l="ne";break;case g.SE_RESIZE:l="se";break;case g.SW_RESIZE:l="sw"}this.svg.sheet.sheet_type==E.MODE_SINGLE&&this.svg.selected.type==d.PART&&this.svg.selected.part_type!=d.PART_TYPE_PATH?this.svg.selected.changeAspect(l,e.point.x-this.svg.input.startDragX,e.point.y-this.svg.input.startDragY):this.svg.transform.scaleNode(this.svg.selected,l,e.point.x,e.point.y)}if((i==g.N_RESIZE||i==g.E_RESIZE||i==g.S_RESIZE||i==g.W_RESIZE)&&this.svg.selected.isAspectChangable&&null!=this.svg.selected){var l;switch(i){case g.N_RESIZE:l="n";break;case g.E_RESIZE:l="e";break;case g.S_RESIZE:l="s";break;case g.W_RESIZE:l="w"}this.svg.selected.type==d.PART&&this.svg.selected.changeAspect(l,e.point.x-this.svg.input.startDragX,e.point.y-this.svg.input.startDragY)}}}}class pt extends f{execute(t,e){var i=null;if(null==this.svg.icon.overIcon(e.point)&&(i=this.svg.node.getNodeOnPoint(e.point)),null!=e.tool&&(this.svg.select.selectedTool=e.tool),null==this.svg.select.selectedTool&&(this.svg.select.selectedTool=g.MOVE),null!=i&&i!=this.svg.selected&&this.svg.select.select(i),null!=this.svg.selected){this.svg.select.lockTool=!0;var r=!1;if(this.svg.selected.isTransformable)switch(this.svg.select.selectedTool){case g.MOVE:this.svg.selected.isMoveable&&(r=!0);break;case g.ROTATE:case g.ROTATE_INVERSE:this.svg.selected.isRotateable&&(r=!0);break;case g.NW_RESIZE:case g.NE_RESIZE:case g.SE_RESIZE:case g.SW_RESIZE:this.svg.selected.isResizeable&&(r=!0);break;case g.N_RESIZE:case g.E_RESIZE:case g.S_RESIZE:case g.W_RESIZE:this.svg.selected.isAspectChangable&&(r=!0)}r?this.svg.transform.updateNodeBeforeTransformation(this.svg.selected,t):this.svg.select.lockTool=!1}}}class gt extends f{execute(t,e){this.svg.select.hover(null)}}class mt extends f{execute(t,e){let i=this.svg.node.getNodeOnPoint(e.point);this.svg.select.lockTool?this.svg.select.hover(null):this.svg.input.isPointerOverActivePartPath(e.point.x,e.point.y)&&(null!=this.svg.selected&&this.svg.selected.intId!=this.svg.activePart.intId||null==this.svg.selected)?this.svg.select.hover(this.svg.activePart):this.svg.selected!=i?this.svg.select.hover(i):this.svg.select.hover(null)}}class ft extends f{execute(t,e){this.svg.selected&&this.svg.transform.updateNodeAfterTransformation(this.svg.selected)}}class vt extends f{execute(t,e){if(!this.svg.selected){var i=this.svg.node.getNodeOnPoint(e.point);this.svg.select.select(i)}this.svg.selected&&this.svg.transform.updateNodeBeforeTransformation(this.svg.selected,null)}}class bt{constructor(t,e,i,r,n){this.id=t,this.node=e,this.code=i,this.type=r,this.data=n,this.visible=!1}}class yt{constructor(t){this.svg=t}}class _t extends yt{constructor(t){super(t),this.images=[],this.notifications=[],this.oldNotifications=[],this.id=0}addImageNode(t){this.images.push(t)}removeImageNode(t){for(let e=0;e<this.images.length;e++)if(t.id==this.images[e].id){this.images.splice(e,1);break}this.removeMessage(t)}calcAndCheckDpi(){for(let t=0;t<this.images.length;t++){let e=this.images[t].checkDpi;this.images[t].checkDpi=!1,this.images[t].calcDPI(),this.images[t].checkDpi=e}this.checkDpi()}checkDpi(){for(let t=0;t<this.images.length;t++){let e=this.images[t];e.dpi<100?(this.removeMessage(e,1,2),this.addMessage(e,1,1,e.dpi)):e.dpi<200?(this.removeMessage(e,1,1),this.addMessage(e,1,2,e.dpi)):this.removeMessage(e,1)}this.displayMessages()}highlight(t){for(let e=0;e<this.notifications.length;e++)if(this.notifications[e].id==t){if(this.svg.svgSettings.zoomMode!=c.ZOOM_SHEET){null!=this.notifications[e].node&&this.svg.select.select(this.notifications[e].node);break}this.svg.select.select(this.notifications[e].node.getPart())}}addMessage(t,e,i,r){let n=!0;for(let r=0;r<this.notifications.length;r++)if(this.notifications[r].node.id==t.id&&this.notifications[r].code==e&&this.notifications[r].type==i){n=!1;break}if(n){this.id++;let n=new bt(Math.floor(1e6*Math.random()),t,e,i,r,!1);this.notifications.push(n)}}removeMessage(t,e,i){i=void 0===i?0:i,e=void 0===e?0:e;for(let r=0;r<this.notifications.length;r++)null!=t?this.notifications[r].node.id!=t.id||this.notifications[r].code!=e&&0!=e||this.notifications[r].type!=i&&0!=i||(this.notifications.splice(r,1),r--):this.notifications[r].code!=e&&0!=e||(this.notifications.splice(r,1),r--)}displayMessages(){for(let t=0;t<this.notifications.length;t++)this.notifications[t].node.isParentSelected()&&!this.notifications[t].visible&&(this.svg.trigger(p.ADD_NOTIFICATION,{category:this.notifications[t].code,type:this.notifications[t].type,id:this.notifications[t].id,data:this.notifications[t].data}),this.notifications[t].visible=!0),!this.notifications[t].node.isParentSelected()&&this.notifications[t].visible&&(this.svg.trigger(p.REMOVE_NOTIFICATION,this.notifications[t].id),this.notifications[t].visible=!1),6==this.notifications[t].code&&(this.svg.trigger(p.ADD_NOTIFICATION,{category:this.notifications[t].code,type:this.notifications[t].type,id:this.notifications[t].id,data:this.notifications[t].data}),this.notifications[t].visible=!0);for(let t=0;t<this.oldNotifications.length;t++){let e=!0;for(let i=0;i<this.notifications.length;i++)this.notifications[i].id==this.oldNotifications[t].id&&(e=!1);e&&this.oldNotifications[t].visible&&(this.svg.trigger(p.REMOVE_NOTIFICATION,this.oldNotifications[t].id),this.oldNotifications[t].visible=!1)}if(this.svg.svgSettings.zoomMode==c.ZOOM_SHEET)for(let t=0;t<this.notifications.length;t++)if(this.notifications[t].visible)for(let e=0;e<this.notifications.length;e++)this.notifications[t].node.getPart().id,this.notifications[e].visible&&t!=e&&this.notifications[e].type>=this.notifications[t].type&&(this.svg.trigger(p.REMOVE_NOTIFICATION,this.notifications[e].id),this.notifications[e].visible=!1);this.oldNotifications=this.notifications.slice(0)}}class Tt extends yt{constructor(){super(...arguments),this.pathSeparators=["M","Z","L","H","V","C","S","A","Q","T"]}exportParts(){return this.svg.sheet.parts.map(((t,e)=>this.exportPart(t,e)))}exportPart(t,e){let i={meta:{},cuttingline:"",bleed:null,part_id:null,sort_order:e,part_type:null,width:null,height:null,cornersRadius:null,flags:null,svg:null,matrix:null,background:null,attachmentIDs:null},r=t.gEl.transform.baseVal.consolidate().matrix,n=r.inverse(),s=Math.atan2(r.b,r.a)*(180/Math.PI);t.part_type!=d.PART_TYPE_IMAGE&&(i.cuttingline=this.svg.path.transformByMatrix(t.path,n).toString(),i.cuttingline=this.exportPath(i.cuttingline)),null!=t.bleed&&(i.bleed=this.svg.path.transformByMatrix(t.bleed,n).toString(),i.bleed=this.exportPath(i.bleed)),i.part_id=t.id,i.part_type=t.part_type,i.width=Math.round(t.width),i.height=Math.round(t.height),i.cornersRadius=t.cornersRadius,i.side=t.side,i.flags=t.serializeFlags(),i.svg=this.serializedPart(t),i.svg=i.svg.replace(/xmlns:xlink="http:\/\/www.w3.org\/1999\/xlink"/g,""),i.svg=i.svg.replace(/xmlns="http:\/\/www.w3.org\/2000\/svg"/g,""),i.svg=i.svg.replace(/\?random\=\d*/g,"");let o=t.path;0!=s&&(i.svg='<defs dataRotation="'+s+'"/>'+i.svg,o=this.svg.path.transform(o,{translate:0,scale:1,origin:[0,0],skew:0,rotate:-1*s}).toString());let a=this.svg.path.toBoundingBox(o);if(i._originalPathBoundingBox=a,t.height&&0!=t.height&&(i.svg='<defs dataHeight="'+a.height/this.svg.px2mm+'"/>'+i.svg),t.width&&0!=t.width&&(i.svg='<defs dataWidth="'+a.width/this.svg.px2mm+'"/>'+i.svg),t.cornersRadius&&0!=t.cornersRadius&&(i.svg='<defs dataCornersRadius="'+t.cornersRadius+'"/>'+i.svg),0!=a.x&&(i.svg='<defs dataOffsetX="'+a.x+'"/>'+i.svg),0!=a.y&&(i.svg='<defs dataOffsetY="'+a.y+'"/>'+i.svg),null!=this.svg.collage){let t=this.svg.collage.getColParts(),e="<defs>";for(let i=0;i<t.length;i++)t[i].clipPath.path,e+='<clipPath id="'+t[i].clipPath.id+'"><path d="'+t[i].clipPath.path+'" id="'+t[i].clipPath.id+'_path"></path></clipPath>';e+="</defs>",i.svg=e+i.svg,i.svg=i.svg.replace(/class="svgCollagePath"/g,'fill="none" stroke="none"')}i.matrix="matrix("+r.a+","+r.b+","+r.c+","+r.d+","+r.e+","+r.f+")",null!=t.backGroundNode?(this.svg.sheet.backgroundPattern&&"front"==i.side?i.background="none":i.background=t.backGroundNode.element.getAttribute("fill"),"url"==i.background.substring(0,3)&&(i.background="none")):i.background="none",i.meta.CMYK_BACKGROUND=t.background_cmyk,i.meta.SIDE=t.side,i.meta.PREDEFINED_CUTLINE=t.predefinedCutline;let l=this.getIndicesOf("<text",i.svg,!1);for(let t=0;t<l.length;t++){let e=i.svg.substring(l[t],i.svg.indexOf(">",l[t])+1);if(-1==e.indexOf("font-size",e)){let e=l[t]+6+14*t;i.svg=[i.svg.slice(0,e),'font-size="14"',i.svg.slice(e)].join("")}}i.attachmentIDs=this.findAttachmentIDs(i.svg);let h="(&quot;";h=h.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1");let c=new RegExp(h,"g");i.svg=i.svg.replace(c,"(");let u="&quot;)";u=u.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1");let p=new RegExp(u,"g");return i.svg=i.svg.replace(p,")"),i}exportPath(t){t=t.replace(/\,/g," "),this.pathSeparators.forEach((e=>{let i=new RegExp(e,"g");t=t.replace(i," "+e+" ")}));let e=(t=t.trim()).split(" ");return t="",e.forEach((e=>{""!==e&&(isNaN(e)?t+=e+" ":t+=Math.round(100*parseFloat(e))/100+" ")})),t=t.trim()}serializedPart(t,e){e=void 0!==e&&e;let i=new XMLSerializer,r="",n=t.partGroupNode.children;for(let t=n.length-1;t>=0;t--)this.serializeNodeFlags(n[t]),r+=i.serializeToString(n[t].element);return e&&(r=r.replace(/\sid="([^"]+)"/g," ")),r=r.replace(/ href=/g," xlink:href="),r=r.replace(/_thumb_lg\./g,"_thumb."),r=r.replace(/_thumb_md\./g,"_thumb."),r}serializeNodeFlags(t){t.element.setAttribute("flags",t.serializeFlags());for(let e=0;e<t.children.length;e++)this.serializeNodeFlags(t.children[e])}printPartTrees(){for(let t=0;t<this.svg.sheet.parts.length;t++)this.printChildrenTrees(this.svg.sheet.parts[t].children,"  ")}printChildrenTrees(t,e){for(let i=0;i<t.length;i++)this.printOptions(t[i].options,e),this.printChildrenTrees(t[i].children,e+"    ")}printOptions(t,e){for(let i in t)"object"==typeof t[i]&&this.printOptions(t[i],e+"  ")}getIndicesOf(t,e,i){let r,n=0,s=t.length,o=[];if(s<1)return o;for(i||(e=e.toLowerCase(),t=t.toLowerCase());(r=e.indexOf(t,n))>-1&&(o.push(r),n=r+s,!(n>=e.length)););return o}findAttachmentIDs(t){let e=[],i=this.getIndicesOf('attachment_id="',t,!1);for(let r=0;r<i.length;r++){let n=i[r]+15,s=t.substring(n,t.indexOf('"',n));e.push(s)}return e}generateSvgStringFromPart(t){const e=new it,i=e.mm2px(t.width),r=e.mm2px(t.height);let n="";const s=t.translate?`transform="translate(${t.translate})"`:"";if(t.translate){const[e,i]=t.translate.split(",").map(Number);n=` translate(${-1*e},${-1*i}) `}const o=e.extractScale(t.matrix),a=Math.round(e.mm2px(4)/o),l=`mask_${e.generateUniqueId()}`,h=t.background;let d="";d+=`<g transform="${t.matrix}${n}">`,d+=`<g mask="url(#${l})">`,d+=`<path d="${t.cuttingline}" fill="${h}" stroke="${h}" stroke-width="${a}" stroke-linecap="square"/>`,d+=`<g ${s}>`,d+=t.svg,d+="</g>",d+="</g>",d+="</g>";const c=e.mm2px(4);return`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="${-c/2} ${-c/2} ${i+c} ${r+c}">${d}</svg>`}}class xt{constructor(t,e,i,r){this.imageName=t,this.size=e,this.x=i,this.y=r}}class wt extends _{constructor(){super(d.SHAPE_CIRCLE,"circle")}onElementCreated(t=null){this.element.setAttribute("cx",this.options.cx),this.element.setAttribute("cy",this.options.cy),this.element.setAttribute("r",this.options.r),this.options.fill&&this.element.setAttribute("fill",this.options.fill),this.options.id&&this.element.setAttribute("id",this.options.id),this.createBBoxAndCenter(),super.onElementCreated(t),this.options.class&&this.element.setAttribute("class",this.options.class)}createBBoxAndCenter(){if(this.svg.runBBox){var t=this.getTransformationMatrix();this.center=this.svg.rootEl.createSVGPoint(),this.center.x=parseFloat(this.element.getAttribute("cx")),this.center.y=parseFloat(this.element.getAttribute("cy"));var e=this.center.matrixTransform(t),i=Math.sqrt(t.a*t.a+t.b*t.b)*parseFloat(this.element.getAttribute("r"));this.boundingBox=this.svg.rootEl.createSVGRect(),this.boundingBox.width=2*i,this.boundingBox.height=2*i,this.boundingBox.x=e.x-i,this.boundingBox.y=e.y-i}}}class Et extends _{constructor(){super(d.SHAPE_RECT,"rect")}onElementCreated(t=null){this.options.x&&this.element.setAttribute("x",this.options.x),this.options.left&&this.element.setAttribute("x",this.options.left),this.options.y&&this.element.setAttribute("y",this.options.y),this.options.top&&this.element.setAttribute("y",this.options.top),this.element.setAttribute("width",this.options.width),this.element.setAttribute("height",this.options.height),this.options.mask&&this.element.setAttribute("clip-path","url(#"+this.options.mask+")"),this.options.fill&&this.element.setAttribute("fill",this.options.fill),this.options.stroke&&this.element.setAttribute("stroke",this.options.stroke),this.options["stroke-width"]&&this.element.setAttribute("stroke-width",this.options["stroke-width"]),this.options["fill-opacity"]&&this.element.setAttribute("fill-opacity",this.options["fill-opacity"]),this.options.rx&&this.element.setAttribute("rx",this.options.rx),this.options.ry&&this.element.setAttribute("ry",this.options.ry),this.options.class&&this.element.setAttribute("class",this.options.class),this.options.id&&this.element.setAttribute("id",this.options.id),this.createBBoxAndCenter(),super.onElementCreated(t)}createBBoxAndCenter(){if(this.svg.runBBox){let t=this.getTransformationMatrix(),e=parseFloat(this.element.getAttribute("x")),i=parseFloat(this.element.getAttribute("y")),r=parseFloat(this.element.getAttribute("width")),n=parseFloat(this.element.getAttribute("height")),s=this.svg.rootEl.createSVGPoint();s.x=e,s.y=i,s=s.matrixTransform(t);let o=this.svg.rootEl.createSVGPoint();o.x=e+r,o.y=i,o=o.matrixTransform(t);let a=this.svg.rootEl.createSVGPoint();a.x=e+r,a.y=i+n,a=a.matrixTransform(t);let l=this.svg.rootEl.createSVGPoint();l.x=e,l.y=i+n,l=l.matrixTransform(t);let h=Math.min(o.x,s.x,l.x,a.x),d=Math.min(o.y,s.y,l.y,a.y),c=Math.max(o.x,s.x,l.x,a.x)-h,u=Math.max(o.y,s.y,l.y,a.y)-d;this.boundingBox=this.svg.rootEl.createSVGRect(),this.boundingBox.width=c,this.boundingBox.height=u,this.boundingBox.x=h,this.boundingBox.y=d,this.center=this.svg.rootEl.createSVGPoint(),this.center.x=h+c/2,this.center.y=d+u/2}}}class At extends yt{static get TOUCH_SENSITIVITY(){return 10}constructor(t){super(t),this.iconNodes=[]}static get iconMap(){return this._iconMap||(this._iconMap=new Map,this._iconMap.set("icon_editor_Down",new xt("EditorIconsVector",100,0,0)),this._iconMap.set("icon_editor_Up",new xt("EditorIconsVector",100,150,0)),this._iconMap.set("icon_editor_SWResize",new xt("EditorIconsVector",100,300,0)),this._iconMap.set("icon_editor_NEResize",new xt("EditorIconsVector",100,300,0)),this._iconMap.set("icon_editor_NWResize",new xt("EditorIconsVector",100,450,0)),this._iconMap.set("icon_editor_SEResize",new xt("EditorIconsVector",100,450,0)),this._iconMap.set("icon_editor_NResize",new xt("EditorIconsVector",100,0,150)),this._iconMap.set("icon_editor_SResize",new xt("EditorIconsVector",100,0,150)),this._iconMap.set("icon_editor_EResize",new xt("EditorIconsVector",100,150,150)),this._iconMap.set("icon_editor_WResize",new xt("EditorIconsVector",100,150,150)),this._iconMap.set("icon_editor_Center_ver",new xt("EditorIconsVector",100,300,150)),this._iconMap.set("icon_editor_Center_hor",new xt("EditorIconsVector",100,450,150)),this._iconMap.set("icon_editor_Ok",new xt("EditorIconsVector",100,0,300)),this._iconMap.set("icon_editor_Delete",new xt("EditorIconsVector",100,150,300)),this._iconMap.set("icon_editor_Rotate",new xt("EditorIconsVector",100,300,300)),this._iconMap.set("icon_editor_Edit",new xt("EditorIconsVector",100,450,300)),this._iconMap.set("icon_editor_Copy",new xt("EditorIconsVector",100,0,450)),this._iconMap.set("icon_editor_Upload",new xt("EditorIconsVector",100,150,450))),this._iconMap}static getIcon(t){return At.iconMap.has(t)?At.iconMap.get(t):null}overIcon(t){for(let e=0;e<this.iconNodes.length;e++){if(null==this.iconNodes[e].children[1])continue;let i=At.TOUCH_SENSITIVITY*this.svg.strokeScale;this.iconNodes[e].children[1].createBBoxAndCenter();let r=this.iconNodes[e].children[1].boundingBox;if(!(t.x<r.x-i||t.x>r.x+r.width+i||t.y<r.y-i||t.y>r.y+r.height+i))return this.iconNodes[e]}return null}createIcon(t,e,i=null,r=0,n,s=!1){n||(n=this.svg.svgSettings.iconsDefaultShape);let o=At.getIcon(e),a=o.imageName,c=o.size,u=o.x,p=o.y,g=new Array;g.id=t,null!=i&&(g.parentId=i);let m=this.svg.node.addNode(new et,g);m.ignore=!0,m.overHandling=l.OVER_IGNORE;let f=this.svg.style.getStyle(".svgIconRound","padding");f=null==f?r:parseInt(f);let v=this.svg.style.getStyle(".svgIconRect","padding");v=null==v?r:parseInt(v);let b,y=this.svg.style.getStyle(".svgIconRect","border-radius");if(y=null==y?0:parseInt(y),s&&(null!=this.svg.style.getStyle(".svgIconMenu","padding")&&(v=parseInt(this.svg.style.getStyle(".svgIconMenu","padding"))),null!=this.svg.style.getStyle(".svgIconMenu","border-radius")&&(y=parseInt(this.svg.style.getStyle(".svgIconMenu","border-radius")))),n==d.SHAPE_CIRCLE){let e=Math.sqrt(Math.pow(c,2)/2)+f,i=[];i.id=t+"IconBackground",i.cx=u+c/2,i.cy=p+c/2,i.r=e,i.parentId=t,i.class="svgIcon",b=this.svg.node.addNode(new wt,i),b.ignore=!0,b.overHandling=l.OVER_IGNORE}if(n==d.SHAPE_RECT){let e=[];e.id=t+"IconBackground",e.left=u-v,e.top=p-v,e.width=c+2*v,e.height=c+2*v,e.parentId=t,s?this.svg.touch.isTouch?e.class="svgIconMenuTouch":e.class="svgIconMenu":e.class="svgIcon",e.rx=y,e.ry=y,b=this.svg.node.addNode(new Et,e),b.ignore=!0,b.overHandling=l.OVER_IGNORE}b&&b.element.setAttribute("pointer-events","all");let _=[];_.id=t+"IconSecondGroup",_.parentId=t;let x=this.svg.node.addNode(new et,_);x.ignore=!0,x.overHandling=l.OVER_IGNORE,x.element.setAttribute("pointer-events","none");let w=it.createElement("clipPath");m.element.prepend(w),w.setAttribute("id",t+"IconClipPath");let E,A=it.createElement("rect");switch(w.append(A),A.setAttribute("x",u.toString()),A.setAttribute("y",p.toString()),A.setAttribute("width",c.toString()),A.setAttribute("height",c.toString()),x.element.setAttribute("clip-path","url(#"+t+"IconClipPath)"),a){case"EditorIcons":E=this.svg.svgSettings.iconsSpriteURL;break;case"EditorIconsVector":E=this.svg.svgSettings.iconsVectorSpriteURL}m.isTransformable=!0,m.isMoveable=!0,m.isResizeable=!0;let P=[];P.href=E,P.id=t+"IconImage",P.top=0,P.left=0,P.parentIntId=x.intId,P.width=550,P.height=550,this.svg.node.addNode(new T,P,(function(t){t.ignore=!0}));let S=Math.min(this.svg.transMatrixInv.a,this.svg.transMatrixInv.d);return S*=.15,m.beforeTransform(),m.transform(h.TRANSFORM_MOVE,-1*u*S-c*S/2,-1*p*S-c*S/2),m.afterTransform(!1,h.TRANSFORM_CREATE),m.beforeTransform(null,!0),m.transform(h.TRANSFORM_SCALE,"uni",S,0,0,0,0,!0),m.afterTransform(!0,h.TRANSFORM_CREATE),this.iconNodes.push(m),m}clearIconsList(){this.iconNodes.forEach((t=>{this.svg.events.deleteBy(t.element)})),this.iconNodes=[]}}class Pt{static jsonToObject(t){let e;if("string"==typeof t)try{e=JSON.parse(t)}catch(t){return null}else{if("object"!=typeof t)return null;e=t}return e}static deepEqualIterative(t,e){const i=[{obj1:t,obj2:e}];for(;i.length>0;){const{obj1:t,obj2:e}=i.pop();if(t===e)continue;if("object"!=typeof t||"object"!=typeof e||null==t||null==e)return!1;const r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(const s of r){if(!n.includes(s))return!1;i.push({obj1:t[s],obj2:e[s]})}}return!0}static removeKeys(t,e){const i=e.map((t=>t.split(".")));return function t(e,r=[]){if("object"!=typeof e||null===e)return e;if(Array.isArray(e))return e.map((e=>t(e,r)));const n={};for(const s in e)if(e.hasOwnProperty(s)){const o=[...r,s];i.some((t=>t.length===o.length&&t.every(((t,e)=>t===o[e]))))||(n[s]=t(e[s],o))}return n}(t)}}class St extends Q{constructor(){super(d.SHAPE_MULTI,"g"),this.orgBBox=null,this.isClickThrough=!1,this.isSelectable=!0,this.isOverable=!0,this.isTransformable=!0,this.isResizeable=!0,this.isRotateable=!0,this.isSkewable=!1,this.isMoveable=!0}onElementCreated(t=null){if(this.options.json){let t=this.options.json;t.id&&(this.options.id=t.id),t.visibility&&(this.options.visibility=t.visibility)}if(this.options.transform){let t=this.svg.transform.transformStringToMatrix(this.options.transform),e=this.svg.createSVGTransform();e.setMatrix(t),this.getTransformList(),this.element.transform.baseVal.initialize(e)}void 0!==this.options.copyable&&(this.isCopyable=this.options.copyable),this.element.setAttribute("id",this.options.id),void 0===this.options.flags||this.svg.svgSettings.useFlags||this.deSerializeFlags(this.options.flags),this.options.visibility&&(this.element.style.visibility=this.options.visibility),this.createBBoxAndCenter(),super.onElementCreated(t)}createBBoxAndCenter(){if(this.svg.runBBox)if(this.calcBBox){let t=1e5,e=1e5,i=-1e5,r=-1e5;for(let n=0;n<this.children.length;n++)this.children[n].createBBoxAndCenter(),isNaN(this.children[n].boundingBox.x)||(t=Math.min(t,this.children[n].boundingBox.x)),isNaN(this.children[n].boundingBox.y)||(e=Math.min(e,this.children[n].boundingBox.y)),isNaN(this.children[n].boundingBox.x+this.children[n].boundingBox.width)||(i=Math.max(i,this.children[n].boundingBox.x+this.children[n].boundingBox.width)),isNaN(this.children[n].boundingBox.y+this.children[n].boundingBox.height)||(r=Math.max(r,this.children[n].boundingBox.y+this.children[n].boundingBox.height));1e5==t&&-1e5==i&&(t=0,i=0),1e5==e&&-1e5==r&&(e=0,r=0),this.boundingBox=this.svg.rootEl.createSVGRect(),this.boundingBox.width=i-t,this.boundingBox.height=r-e,this.boundingBox.x=t,this.boundingBox.y=e,this.orgBBox=this.svg.rootEl.createSVGRect(),this.orgBBox.width=this.boundingBox.width,this.orgBBox.height=this.boundingBox.height,this.orgBBox.x=this.boundingBox.x,this.orgBBox.y=this.boundingBox.y,this.center=this.svg.rootEl.createSVGPoint(),this.center.x=this.boundingBox.x+this.boundingBox.width/2,this.center.y=this.boundingBox.y+this.boundingBox.height/2}else{let t=this.getTransformationMatrix(),e=this.orgBBox.x,i=this.orgBBox.y,r=this.orgBBox.width,n=this.orgBBox.height,s=this.svg.rootEl.createSVGPoint();s.x=e,s.y=i,s=s.matrixTransform(t);let o=this.svg.rootEl.createSVGPoint();o.x=e+r,o.y=i,o=o.matrixTransform(t);let a=this.svg.rootEl.createSVGPoint();a.x=e+r,a.y=i+n,a=a.matrixTransform(t);let l=this.svg.rootEl.createSVGPoint();l.x=e,l.y=i+n,l=l.matrixTransform(t);let h=Math.min(o.x,s.x,l.x,a.x),d=Math.min(o.y,s.y,l.y,a.y),c=Math.max(o.x,s.x,l.x,a.x)-h,u=Math.max(o.y,s.y,l.y,a.y)-d;this.boundingBox=this.svg.rootEl.createSVGRect(),this.boundingBox.width=c,this.boundingBox.height=u,this.boundingBox.x=h,this.boundingBox.y=d,this.center=this.svg.rootEl.createSVGPoint(),this.center.x=h+c/2,this.center.y=d+u/2}}getMenuOptions(){let t=[];return this.isMoveable&&t.push(g.UP),this.isMoveable&&t.push(g.DOWN),this.svg.extraCopy&&t.push(g.COPY),this.isMoveable&&t.push(g.CENTER_HOR),this.isMoveable&&t.push(g.CENTER_VER),this.isDeleteable&&t.push(g.DELETE),t.push(g.COLLAGE),t}onDeleteMenu(){return null==this.collageObject||(this.svg.collage.deleteImage(this.collageObject),!1)}onDeSelect(){null!=this.collageObject&&this.svg.collage.hideImage(this)}copy(t){let e=[];for(let t in this.options)"id"!=t&&(e[t]=this.options[t]);let i=this.svg.rootEl.createSVGMatrix(),r=0,n=0;t.offX&&(r=t.offX),t.offY&&(n=t.offY),i=i.multiply(this.element.transform.baseVal.consolidate().matrix),i=i.translate(r,n),e.transform="matrix("+i.a+", "+i.b+", "+i.c+", "+i.d+", "+i.e+", "+i.f+")",e.flags=this.serializeFlags(),e.visibility="hidden",this.svg.node.addNode(new St,e,(t=>{t.options.visibility="visible",t.element.style.visibility="visible",this.svg.import.importSVGData(t.options&&t.options.json&&t.options.json.svg?t.options.json.svg:this.element.innerHTML,t,((e,i)=>{this.svg.margin.refreshMargin(!1),this.svg.select.select(t)}))}))}preRemove(t){this.removeChildren();for(let t=0;t<this.svg.multiArr.length;t++)this.svg.multiArr[t].intId==this.intId&&this.svg.multiArr.splice(t,1);void 0!==t&&t()}}class Ot extends Q{constructor(){throw super(d.COLLAGE,"g"),this.activePart=null,this.colParts=[],new Error("Not supported. Refactor.")}onElementCreated(t=null){if(this.options.id="collage",this.element.setAttribute("id",this.options.id),this.options.collage_id,this.options.import){let t=new Mt;for(let e=0;e<this.options.xml.childNodes.length;e++){let i=this.options.xml.childNodes[e],r=[];for(let t=0;t<i.attributes.length;t++){let e=i.attributes[t];r[e.name]=e.value}if(r.parentIntId=this.intId,"g"==i.nodeName&&(t.group=this.svg.node.addNode(new et,r),i.childNodes.length>0)){let e=i.childNodes[0],r=[];for(let t=0;t<e.attributes.length;t++){let i=e.attributes[t];r[i.name]=i.value}r.parentIntId=t.group.intId;let n=new XMLSerializer;r.svg=n.serializeToString(e.childNodes[0]);let s=e.childNodes[0];"g"==s.nodeName&&(s=s.childNodes[0]);let o=this.svg.node.addNode(new St,r,(t=>{this.svg.multiArr.push(t);let e=[];for(let t=0;t<s.attributes.length;t++){let i=s.attributes[t];e[i.name]=i.value}e.parentIntId=t.intId,this.svg.node.addNode(new T,e,(t=>{this.editor.helpers.dpi.addImageNode(t),t.checkDpi=!0}))}));t.imageNode=o,o.collageObject=t}"path"==i.nodeName&&(r.fill=null,r.stroke=null,r.class="svgCollagePath",t.path=this.svg.node.addNode(new J,r),t.path.collageObject=t,t.path.isTransformable=!1,t.path.isResizeable=!1,t.path.isRotateable=!1,t.path.isSkewable=!1,t.path.isMoveable=!1,t.path.isDeleteable=!1,t.path.isUpDownable=!1,t.clipPath=this.svg.node.addNode(new tt,{id:"collageClip_"+t.path.id,path:r.d}),t.x=t.path.boundingBox.x,t.y=t.path.boundingBox.y),null!=t.group&&null!=t.path&&(this.colParts.push(t),t=new Mt)}for(let t=0;t<this.colParts.length;t++)null!=this.colParts[t].imageNode&&(this.colParts[t].path.isTransformable=!0,this.colParts[t].path.isMoveable=!0,this.hideImage(this.colParts[t].imageNode))}this.parent.moveChildDown(this),super.onElementCreated(t)}createBBoxAndCenter(){this.boundingBox=this.svg.rootEl.createSVGRect(),this.boundingBox.width=0,this.boundingBox.height=0,this.boundingBox.x=1e6,this.boundingBox.y=1e6;for(let t=0;t<this.colParts.length;t++)this.colParts[t].path.boundingBox.x<this.boundingBox.x&&(this.boundingBox.x=this.colParts[t].path.boundingBox.x),this.colParts[t].path.boundingBox.y<this.boundingBox.y&&(this.boundingBox.y=this.colParts[t].path.boundingBox.y);for(let t=0;t<this.colParts.length;t++)this.colParts[t].path.boundingBox.width+this.colParts[t].path.boundingBox.x>this.boundingBox.width+this.boundingBox.x&&(this.boundingBox.width=this.colParts[t].path.boundingBox.width+this.colParts[t].path.boundingBox.x-this.boundingBox.x),this.colParts[t].path.boundingBox.height+this.colParts[t].path.boundingBox.y>this.boundingBox.height+this.boundingBox.y&&(this.boundingBox.height=this.colParts[t].path.boundingBox.height+this.colParts[t].path.boundingBox.y-this.boundingBox.y);this.center=this.svg.rootEl.createSVGPoint(),this.center.x=this.boundingBox.x+this.boundingBox.width/2,this.center.y=this.boundingBox.y+this.boundingBox.height/2}addImage(t){let e=-1;if(null!=this.svg.selected)for(let t=0;t<this.colParts.length;t++)if(this.colParts[t].path.intId==this.svg.selected.intId&&null==this.colParts[t].imageNode){e=t;break}if(-1==e)for(let t=0;t<this.colParts.length;t++)if(null==this.colParts[t].imageNode){e=t;break}if(-1!=e){this.colParts[e].imageNode=t,this.colParts[e].group.changeBranch(t),t.collageObject=this.colParts[e],t.collageObject.path.isTransformable=!0,t.collageObject.path.isMoveable=!0,t.createBBoxAndCenter();let i=(t.collageObject.path.boundingBox.width+2*this.svg.px2mm)/t.boundingBox.width,r=(t.collageObject.path.boundingBox.height+2*this.svg.px2mm)/t.boundingBox.height,n=Math.max(i,r);t.beforeTransform(null,!0),t.transform(h.TRANSFORM_SCALE,"uni",n,0,0,0,0,!0),t.afterTransform(!0);let s=t.collageObject.path.center.x-t.center.x,o=t.collageObject.path.center.y-t.center.y;t.beforeTransform(null,!0),t.transform(h.TRANSFORM_MOVE,s,o,0,0,0,0,!0),t.afterTransform(!0),null!=this.svg.selected&&null!=this.svg.selected.collageObject&&this.editor.helpers.select.reDrawHoverAndSelect()}this.hideImage(t)}deleteImage(t){t.path.isTransformable=!1,t.path.isMoveable=!1,t.imageNode.preRemove(),t.group.removeChild(0,!0),t.imageNode=null}showImage(t){t.collageObject.group.element.removeAttribute("clip-path"),t.ignore=!1,t.overHandling=l.OVER_BBOX,this.svg.shadow.addCollage(t.collageObject),t.createBBoxAndCenter(),t.collageObject.path.createBBoxAndCenter(),t.collageObject.group.createBBoxAndCenter(),this.editor.helpers.select.select(t);for(let t=0;t<this.colParts.length;t++)this.colParts[t].path.overHandling=l.OVER_IGNORE,this.colParts[t].path.ignore=!0,this.colParts[t].group.overHandling=l.OVER_IGNORE,this.colParts[t].group.ignore=!0;null!=this.svg.activePart&&(this.svg.activePart.overHandling=l.OVER_IGNORE,this.svg.activePart.ignore=!0),this.activePart=t.collageObject}hideImage(t){if(null!=t.collageObject){t.collageObject.group.element.setAttribute("clip-path","url(#"+t.collageObject.clipPath.id+")"),t.ignore=!0,t.overHandling=l.OVER_NEVER,t.createBBoxAndCenter(),t.collageObject.group.createBBoxAndCenter(),this.svg.shadow.removeCollage();for(let t=0;t<this.colParts.length;t++)this.colParts[t].path.overHandling=l.OVER_BBOX,this.colParts[t].path.ignore=!1,this.colParts[t].group.overHandling=l.OVER_IGNORE,this.colParts[t].group.ignore=!0}null!=this.svg.activePart&&(this.svg.activePart.overHandling=l.OVER_ZOOMED,this.svg.activePart.ignore=!1),this.activePart=null}swapImages(t,e){if(null!=t.imageNode)if(null==e.imageNode)this.showImage(t.imageNode),e.imageNode=t.imageNode,e.imageNode.collageObject=e,t.imageNode=null,e.path.isTransformable=!0,e.path.isMoveable=!0,t.path.isTransformable=!1,t.path.isMoveable=!1,t.group.removeChild(0,!1),e.group.addChild(e.imageNode),e.imageNode.beforeTransform(),this.editor.helpers.transform.moveNode(e.imageNode,e.x-t.x,e.y-t.y),this.hideImage(e.imageNode),t.path.createBBoxAndCenter(),t.group.createBBoxAndCenter(),this.editor.helpers.select.select(null),e.imageNode.element.transform.baseVal.consolidate();else{this.showImage(t.imageNode),this.showImage(e.imageNode);let i=e.imageNode;e.imageNode=t.imageNode,t.imageNode=i,e.imageNode.collageObject=e,t.imageNode.collageObject=t,e.group.removeChild(0,!1),t.group.removeChild(0,!1),e.group.addChild(e.imageNode),t.group.addChild(t.imageNode),e.imageNode.beforeTransform(),t.imageNode.beforeTransform(),this.editor.helpers.transform.moveNode(e.imageNode,e.x-t.x,e.y-t.y),this.editor.helpers.transform.moveNode(t.imageNode,t.x-e.x,t.y-e.y),this.hideImage(e.imageNode),this.hideImage(t.imageNode),t.path.createBBoxAndCenter(),e.path.createBBoxAndCenter(),t.group.createBBoxAndCenter(),e.group.createBBoxAndCenter(),this.editor.helpers.select.select(null),e.imageNode.element.transform.baseVal.consolidate(),t.imageNode.element.transform.baseVal.consolidate()}}getColParts(){return this.colParts}}class Mt{constructor(){this.x=null,this.y=null,this.width=null,this.height=null,this.imageNode=null,this.path=null,this.group=null,this.clipPath=null,this.isVisible=!1}}class Ct extends yt{importJSON(t,e=null,i=!0){let r=Pt.jsonToObject(t);if(this.svg.node.isTooManyImages()&&-1==r.svg.search("attachment_id"))return this.svg.trigger(p.ADD_NOTIFICATION,{category:6,type:1,data:"Too many images"}),void this.onJSONImported(null,e,i);if(null==this.svg.activePart){if(!r.cuttingline){let t={};return t.editable=r.editable,t.visibility="hidden",t.part_type=d.PART_TYPE_PATH,t.width=this.svg.sheet.height/2,t.height=this.svg.sheet.width/2,void 0!==r.editable&&(t.editable=r.editable),t.svg=r.svg,void(this.svg.activePart=this.svg.node.addNode(new nt,{json:t},(t=>{this.svg.transform.center(t),t.element.style.visibility="visible",t.pathNode.element.style.visibility="visible",this.onJSONImported(t,e,i)})))}{let t={visibility:"hidden"};t.cuttingline=r.cuttingline,void 0!==r.editable&&(t.editable=r.editable),r.id&&(t.id="part_"+r.id),r.part_id&&(t.id="part_"+r.part_id),r.background&&(t.background=r.background),t.part_type=d.PART_TYPE_PATH,this.svg.activePart=this.svg.node.addNode(new nt,{json:t}),i=!1}}this.svg.runBBox=!1,r.visibility="hidden",this.svg.node.addNode(new St,{json:r,part:this.svg.activePart.id},(t=>{this.importSVGData(r.svg,t,(r=>{this.svg.runBBox=!0,setTimeout((()=>{if(null==r||0==r.children.length)return t.remove(),void this.onJSONImported(null,e,i);t.makeBBoxUpdateList(),i?this.svg.transform.fitAndCenterOnPart(t):this.svg.activePart.isMoveable&&this.svg.transform.fitAndCenter(this.svg.activePart,.5),t.element.style.visibility="visible",this.svg.activePart.element.style.visibility="visible",this.svg.activePart.pathNode.element.style.visibility="visible",this.onJSONImported(t,e,i)}),0)}))}))}importData(t){let e=t.documentElement;"svg"==e.firstChild.nodeName&&(e=e.firstChild);let i=this.traverseChildren(e);return this.svg.transform.fitAndCenter(i,.5),i.group(),i}importSVGData(t,e,i=null){"<image"!=t.trim().substring(0,6)||t.split(">").length-1!=1&&t.split("</").length-1!=1||(t="<g>"+t+"</g>");let r=(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+t+"</svg>","image/svg+xml"),n=r.documentElement,s=[];this.cleanupSVGImages(n);let o=r.querySelector("parsererror");o&&o.textContent;let a=n.childNodes.length;if(0==a)i&&i(e,s);else for(let t=0;t<n.childNodes.length;t++){let r=n.childNodes[t];this.traverseChildren(r,e.intId,(t=>{void 0===t||null!=t?(s.push(t),--a,a<=0&&i&&i(e,s)):i(null,s)}))}}traverseChildren(t,e,i){let r=this;e=void 0===e?null:e;let n,s=null;switch(t.nodeName){case"g":s=d.GROUP_STANDARD,n=new et;break;case"rect":s=d.SHAPE_RECT,n=new Et;break;case"circle":s=d.SHAPE_CIRCLE,n=new wt;break;case"path":s=d.SHAPE_PATH,n=new J;break;case"image":s=d.SHAPE_IMAGE,n=new T;break;case"text":s=d.SHAPE_TEXT,n=new rt;break;default:return void i()}if(null!=s){let o=[];for(let e=0;e<t.attributes.length;e++){let i=t.attributes[e];o[i.name]=i.value}if(null!=e&&(o.parentIntId=e),s==d.GROUP_STANDARD&&void 0!==t.childNodes[0]&&"image"==t.childNodes[0].nodeName&&(n=new St,s=d.SHAPE_MULTI),s==d.GROUP_STANDARD&&"collage"==t.getAttribute("id"))s=d.COLLAGE,n=new Ot,o.import=!0,o.xml=t,this.svg.node.addNode(n,o,(function(t){t.ignore=!0,t.overHandling=l.OVER_LAYER,r.svg.collage=t,i(t)}));else if(s==d.SHAPE_TEXT){let e="";for(let i=0;i<t.childNodes.length;i++)if(void 0!==t.childNodes[i].innerHTML&&t.childNodes[i].innerHTML.indexOf("emoji_")>-1){let r=t.childNodes[i].innerHTML,n=/(<([^>]+)>)/gi;r=r.replace(n,""),e+=r+"\n"}else void 0!==t.childNodes[i].childNodes[0]?e+=t.childNodes[i].childNodes[0].data+"\n":e+="\n";if(void 0!==t.childNodes[0].getAttribute("x")&&void 0!==o.x){let e=parseFloat(o.x)-parseFloat(t.childNodes[0].getAttribute("x"));isNaN(e)||(o.x=parseFloat(o.x)-e)}if(void 0!==t.childNodes[0].getAttribute("y")&&void 0!==o.y){let e=parseFloat(o.y)-parseFloat(t.childNodes[0].getAttribute("y"));isNaN(e)||(o.y=parseFloat(o.y)-e)}e=e.substr(0,e.length-1),o.text=e,this.svg.node.addNode(n,o,(function(t){i(t)}))}else s==d.SHAPE_IMAGE?this.svg.node.addNode(n,o,(t=>{null!=t?(void 0!==o.vector&&o.vector?t.vector=!0:(this.svg.dpi.addImageNode(t),t.checkDpi=!0,this.svg.multiArr.push(t.parent)),i(t)):i(null)})):this.svg.node.addNode(n,o,(function(e){let n=t.childNodes.length;if(0!=n)for(let s=0;s<t.childNodes.length;s++){let o=t.childNodes[s];r.traverseChildren(o,e.intId,(function(t){null!=t?(--n,n<=0&&i(t)):i(null)}))}else i(e)}))}}onJSONImported(t=null,e=null,i=!0){if(null==t)return void(e&&e(null));let r=!0;t.type==d.SHAPE_MULTI&&(t.children[0].vector||null!=this.svg.collage&&this.svg.collage.getPart().intId==this.svg.activePart.intId&&(this.svg.collage.addImage(t),r=!1));let n=!1;this.svg.sheet.sheet_type==E.MODE_CASE&&(n=!0);let s=!1;t.type==d.SHAPE_MULTI&&null!=this.svg.collage&&(s=!0),i&&(this.svg.transform.centerHorOrVer(t,!1,!1,s,n),this.svg.transform.centerHorOrVer(t,!0,!1,s,n)),r&&(this.svg.activePart.isSheetBackground?(this.svg.zoomHelper.changeMode(c.ZOOM_PART,this.svg.activePart),this.svg.select.select(t)):this.svg.svgSettings.zoomMode==c.ZOOM_SHEET?this.svg.select.select(t.getPart()):this.svg.select.select(t)),e&&e(t)}cleanupSVGImages(t){const e=t.getElementsByTagName("image");for(let t=e.length-1;t>=0;t--){const i=e[t],r=i.hasAttribute("xlink:href"),n=i.hasAttribute("href");if(!r&&!n){let t=i.parentNode;for(t.removeChild(i);t&&0===t.childNodes.length;){const e=t.parentNode;e?(e.removeChild(t),t=e):t=null}}}}}class It extends yt{constructor(){super(...arguments),this.currentPoint=null,this._isSuspectingStartDrag=!1,this.startDragPoint=null}static get DRAG_SENSITIVITY_PIXELS(){return 10}isPointerOverActivePartPath(t,e){if(null!=this.svg.activePart&&(this.svg.sheet.sheet_type==E.MODE_SINGLE||this.svg.sheet.sheet_type==E.MODE_SHEET)){if(this.svg.sheet.sheet_type==E.MODE_SHEET&&this.svg.activePart.part_type==d.PART_TYPE_PATH)return!1;if(this.svg.activePart.searchPathPointArray(t,e)<5)return!0}return!1}toSVGPoint(t){let e=this.svg.root.element.createSVGPoint();return e.x=t.clientX,e.y=t.clientY,e.matrixTransform(this.svg.transMatrixInv)}setCurrentPointFrom(t){this.currentPoint=this.toSVGPoint(t)}suspectingStartDrag(){this._isSuspectingStartDrag=!0,this.startDragPoint=this.currentPoint}resetStartDrag(){this._isSuspectingStartDrag=!1,this.startDragPoint=null}shouldConsiderCurrentPointAsDragging(){let t=10*Math.abs(this.currentPoint.x-this.startDragPoint.x),e=10*Math.abs(this.currentPoint.y-this.startDragPoint.y);return t>It.DRAG_SENSITIVITY_PIXELS||e>It.DRAG_SENSITIVITY_PIXELS}get startDragX(){var t;return null!==(t=this.startDragPoint.x)&&void 0!==t?t:0}get startDragY(){var t;return null!==(t=this.startDragPoint.y)&&void 0!==t?t:0}get isSuspectingStartDrag(){return this._isSuspectingStartDrag}}class kt extends yt{static get KEY_LEFT(){return 37}static get KEY_UP(){return 38}static get KEY_RIGHT(){return 39}static get KEY_DOWN(){return 40}static get KEY_DEL(){return 46}static get MOVE_FACTOR(){return 2}constructor(t){super(t),this.svg.events.addListenerTo(document,"keydown",(t=>this.onDocumentKeyDown(t)))}onDocumentKeyDown(t){if(this.svg.isInFocus){var e=this.svg.strokeScale,i=0,r=0;switch(t.which){case kt.KEY_UP:r=-kt.MOVE_FACTOR*e;break;case kt.KEY_DOWN:r=kt.MOVE_FACTOR*e;break;case kt.KEY_LEFT:i=-kt.MOVE_FACTOR*e;break;case kt.KEY_RIGHT:i=kt.MOVE_FACTOR*e}null!=this.svg.selected&&(0==i&&0==r||(this.svg.noOnSelect=!0,this.svg.transform.updateNodeBeforeTransformation(this.svg.selected),this.svg.transform.moveNode(this.svg.selected,i,r),this.svg.transform.updateNodeAfterTransformation(this.svg.selected),this.svg.noOnSelect=!1))}}}class Nt extends yt{constructor(){super(...arguments),this.svgMargins={top:0,right:0,bottom:0,left:0,topProc:0,rightProc:0,bottomProc:0,leftProc:0}}formatSVGMargins(){return"8 8 8 8 8 8 8 8"}setMargin(t){let e=t.split(" ");this.svgMargins.top=parseInt(e[0]),this.svgMargins.right=parseInt(e[1]),this.svgMargins.bottom=parseInt(e[2]),this.svgMargins.left=parseInt(e[3]),e.length>4&&(this.svgMargins.topProc=parseInt(e[4]),this.svgMargins.rightProc=parseInt(e[5]),this.svgMargins.bottomProc=parseInt(e[6]),this.svgMargins.leftProc=parseInt(e[7]))}refreshMargin(t=!1){if(this.svg.zoomHelper.isBusy())return!1;if(this.svg.root.viewBoxNoMargin=this.svg.root.orgViewBox,this.svg.root.sheetViewBox=this.addMarginToViewBox(this.svg.root.orgViewBox),this.svg.root.updateViewBox(this.svg.root.sheetViewBox),this.svg.refreshMatrixes(),null!=this.svg.sheet)for(let t=0;t<this.svg.sheet.parts.length;t++)this.svg.sheet.parts[t].updatePath();return 0==t&&this.svg.svgSettings.zoomMode==c.ZOOM_PART&&this.svg.activePart&&this.svg.zoomHelper.changeMode(c.ZOOM_PART,this.svg.activePart,!0),!0}addMarginToViewBox(t){let e=(t=t.replace(/NaN/gi,"0")).split(" "),i=parseFloat(e[0]),r=parseFloat(e[1]),n=parseFloat(e[2]),s=parseFloat(e[3]),o=this.svgMargins,a=this.svg.rootEl.createSVGPoint();a.x=this.svg.fixedLeft,a.y=this.svg.fixedTop;let l=this.svg.rootEl.createSVGPoint();l.x=this.svg.fixedLeft+this.svg.container.offsetWidth,l.y=this.svg.fixedTop+this.svg.container.offsetHeight;let h=this.svg.rootEl.createSVGPoint();h.x=a.x+o.left,h.y=a.y+o.top;let d=this.svg.rootEl.createSVGPoint();d.x=l.x-o.right,d.y=l.y-o.bottom;let c=this.svg.rootEl.createSVGPoint(),u=this.svg.rootEl.createSVGPoint(),p=1;p=n/s<=(d.x-h.x)/(d.y-h.y)?s/(d.y-h.y):n/(d.x-h.x),c.x=i-o.left*p,c.y=r-o.top*p,u.x=n+i+o.right*p,u.y=s+r+o.bottom*p;let g=u.x-c.x,m=u.y-c.y;c.x-=g*o.rightProc*.01,c.y-=m*o.topProc*.01,u.x+=g*o.leftProc*.01,u.y+=m*o.bottomProc*.01;let f=u.x-c.x,v=u.y-c.y;return c.x+" "+c.y+" "+(f>=0?f:0)+" "+(v>=0?v:0)}}class Lt extends yt{constructor(t){super(t),this.isMouseDown_=!1,this.isDrag_=!1,this.allowClick_=!0,this.allowDblClick_=!0,this.startTool_=null,this.clickStop_=!1,this.svg.events.addListener("click",(t=>this.onClick(t))),this.svg.events.addListener("dblclick",(t=>this.onDoubleClick(t))),this.svg.events.addListener("mousedown",(t=>this.onMouseDown(t))),this.svg.events.addListener("mouseenter",(t=>this.onMouseEnter(t))),this.svg.events.addListener("mouseleave",(t=>this.onMouseLeave(t))),this.svg.events.addListener("mousemove",(t=>this.onMouseMove(t))),this.svg.events.addListenerTo(document,"mouseup",(t=>this.mouseUpCheck(t))),this.svg.events.addListenerTo(document,"mouseleave",(t=>this.mouseUpCheck(t))),this.svg.events.addListenerTo(document,"mousemove",(t=>this.onDocumentMouseMove(t))),this.svg.events.addListenerTo(document,"mousedown",(t=>this.onDocumentMouseDown(t)))}triggerEditorEvent(t,e,i=!1){var r={point:this.svg.input.toSVGPoint(e),tool:null,pageX:null,pageY:null};i?(r.tool=this.startTool_,r.pageX=this.svg.input.startDragX,r.pageY=this.svg.input.startDragY):(r.tool=null,r.pageX=e.clientX,r.pageY=e.clientY),this.svg.trigger(t,r)}mouseUpCheck(t){this.isMouseDown_=!1,this.svg.input.resetStartDrag(),this.isDrag_?(this.allowClick_=!1,this.allowDblClick_=!1,this.isDrag_=!1,this.triggerEditorEvent(p.DRAG_END,t)):(this.allowClick_=!0,this.allowDblClick_=!0)}onClick(t){t.stopPropagation(),this.clickStop_||(this.allowClick_?(this.clickStop_=!0,this.triggerEditorEvent(p.CLICK,t),this.clickStop_=!1):this.allowClick_=!0)}onDoubleClick(t){var e;t.stopPropagation(),null===(e=window.getSelection())||void 0===e||e.removeAllRanges(),this.allowDblClick_?this.triggerEditorEvent(p.DOUBLE_CLICK,t):this.allowDblClick_=!0}onMouseDown(t){t.stopPropagation(),this.svg.isInFocus=!0,this.isMouseDown_=!0,t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}onMouseEnter(t){}onMouseLeave(t){this.triggerEditorEvent(p.MOUSE_LEAVE,t)}onMouseMove(t){this.isMouseDown_||this.triggerEditorEvent(p.MOUSE_MOVE,t)}onDocumentMouseDown(t){t.target instanceof Node?this.svg.isInFocus=this.svg.container.contains(t.target):this.svg.isInFocus=!1}onDocumentMouseMove(t){this.svg.input.setCurrentPointFrom(t),this.isMouseDown_?this.svg.input.isSuspectingStartDrag?this.isDrag_?(t.stopPropagation(),this.triggerEditorEvent(p.DRAG_MOVE,t)):this.svg.input.shouldConsiderCurrentPointAsDragging()&&(this.isDrag_=!0,this.triggerEditorEvent(p.DRAG_START,t,!0)):(this.svg.input.suspectingStartDrag(),this.startTool_=this.svg.select.selectedTool):(this.allowClick_=!0,this.allowDblClick_=!0)}}class Dt extends Q{constructor(t,e=null){super(t,e),this.isClickThrough=!0,this.isSelectable=!1,this.isOverable=!1}isOverBBox(){return!0}}class Bt extends Dt{constructor(){super(d.LAYER_ROOT,"svg"),this.orgViewBox=null,this.sheetViewBox=null,this.viewBoxNoMargin=null,this.preserveAspectRatio=null,this.ignore=!0,this.overHandling=l.OVER_IGNORE}onElementCreated(t=null){this.element.setAttribute("id",this.svg.id),this.updateViewBox(this.options.viewBox),this.orgViewBox=this.options.viewBox,this.viewBoxNoMargin=this.orgViewBox,this.options.preserveAspectRatio&&(this.element.setAttribute("preserveAspectRatio",this.options.preserveAspectRatio),this.preserveAspectRatio=this.options.preserveAspectRatio),this.options.width&&this.element.setAttribute("width",this.options.width),this.options.height&&this.element.setAttribute("height",this.options.height),this.element.setAttribute("xmlns",u.NAMESPACE),this.element.setAttribute("xmlns:xlink",u.XLINK),this.element.setAttribute("stickit",u.STICKIT_NS),this.element.setAttribute("class","no-text-select"),this.element.setAttribute("height","100%"),this.element.setAttribute("width","100%"),super.onElementCreated(t)}getCenterPoint(t){var e=this.element.getAttribute("viewBox").split(" "),i=this.svg.rootEl.createSVGPoint();return i.x=(parseFloat(e[2])-parseFloat(e[0]))/2,i.y=(parseFloat(e[3])-parseFloat(e[1]))/2,i}getWidth(){var t=this.element.getAttribute("viewBox").split(" ");return parseFloat(t[2])}getHeight(){var t=this.element.getAttribute("viewBox").split(" ");return parseFloat(t[3])}getX(){var t=this.element.getAttribute("viewBox").split(" ");return parseFloat(t[0])}getY(){var t=this.element.getAttribute("viewBox").split(" ");return parseFloat(t[1])}getSheetViewBox(){return this.sheetViewBox}getViewBox(){return this.element.getAttribute("viewBox")}updateViewBox(t){this.element.setAttribute("viewBox",t)}isParentSelected(){return!1}}class Rt extends yt{addNode(t,e,i=null){if(e||(e={}),e.json){let t=e.json;t.id&&(e.id=t.id,t.id),t.parentId&&(e.parentId=t.parentId),t.parentIntId&&(e.parentIntId=t.parentIntId),t.part&&(e.part=t.part)}e.id&&void 0!==e.id||(e.id=Math.random().toString().replace(",","").replace(".",""));let r=null;return r=e.parentId?this.getNodeById(e.parentId):e.parentIntId?this.getNodeByIntId(e.parentIntId):e.part?this.getNodeById(e.part):null!=this.svg.selected?this.svg.selected:this.svg.defaultParentNode,t instanceof nt&&(r=this.svg.root,t.parentIndex=this.svg.sheet.parentIndex),t instanceof tt&&(r=this.svg.defs),r&&r.type==d.PART&&e.id!=r.id+"PartBackground"&&e.id!=r.id+"_partGroup"&&(r=this.getNodeById(r.id+"_partGroup")),t instanceof Bt&&(r=null),t.init(r,this.svg,e,(()=>this.onNodeCreated(t,i))),t.makeBBoxUpdateList(),t}onNodeCreated(t,e=null){e&&e(t),this.svg.trigger(p.NODE_CREATED,t)}copy(t,e=[]){return e.id&&void 0!==e.id||(e.id=Math.random().toString().replace(",","").replace(".","")),t.copy(e)}hide(t){null!=t.element&&t.element.setAttribute("display","none")}show(t){null!=t.element&&t.element.setAttribute("display","inline")}setId(t,e){t.id=e}getNodeByIntId(t){return this.svg.root.searchNodeByIntId(t)}getNodeById(t){return this.svg.root.searchNodeById(t)}getNodeOnPoint(t){let e=[];return this.svg.root.isOverBBoxInklChildren(t,e,!1),0!=e.length?e[0]:null}isTooManyImages(){if(null!=this.svg.collage)throw new Error("Collages are not supported.");return!1}getNodeListOnPoint(t,e=0){let i=[];return this.svg.root.isOverBBoxInklChildren(t,i,!1,e),i}getActiveNodeSheet(){return this.svg.sheet.isCustomizableSheet?this.svg.part.isBackSideActive()?this.svg.part.getBackPart():this.getNodeById("background"):null}}var $t=function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function o(t){try{l(r.next(t))}catch(t){s(t)}}function a(t){try{l(r.throw(t))}catch(t){s(t)}}function l(t){t.done?n(t.value):function(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(o,a)}l((r=r.apply(t,e||[])).next())}))};class jt extends yt{static bleedMMToPX(t){return 3.7*t}getBleedMM(){return this.svg.svgSettings.bleedSizeMM}getBleedPX(){return jt.bleedMMToPX(this.getBleedMM())}offsetPath(t,e){return $t(this,void 0,void 0,(function*(){let i=this.svg.overridables.offsetPathFn?yield this.svg.overridables.offsetPathFn(t,e):{inner:null,outer:null};return new Promise((t=>t(i)))}))}createImageOutline(t,e){return $t(this,void 0,void 0,(function*(){let i=this.svg.overridables.outlineImageFn?yield this.svg.overridables.outlineImageFn(t,e):null;if(!i||!i.path){let r=new X(0,0,t.imageWidth/this.svg.px2mm,t.imageHeight/this.svg.px2mm);i=this.createPath(e,r)}return i}))}createPartOutline(t,e){return $t(this,void 0,void 0,(function*(){let i=this.svg.overridables.outlinePartFn?yield this.svg.overridables.outlinePartFn(t,e):null;return i&&i.path||(i=this.createPath(t,new X(0,0,t.width,t.height))),i}))}createPath(t,e){let i={path:"",type:t.part_type,backgroundColor:null},r=e.widthMM*this.svg.svgSettings.px2mm,n=e.heightMM*this.svg.svgSettings.px2mm;switch(t.part_type){case d.PART_TYPE_ROUND:i.path="M "+e.offX+","+(n/2+e.offY)+" ",i.path+="A "+r/2+","+n/2+" 0 0,1 "+(r+e.offX)+","+(n/2+e.offY)+" ",i.path+="A "+r/2+","+n/2+" 0 0,1 "+e.offX+","+(n/2+e.offY)+" ",i.path+="Z";break;case d.PART_TYPE_TRIANGLE:let s=e.widthMM*this.svg.px2mm,o=Math.sqrt(3)/2*s;if(t.cornersRadius>0){let r,n,o,a,l=s,h=l;for(let e=0;e<5;e++)s+=l-h,r=Math.sqrt(3)/2*s,o=s/2*(t.cornersRadius/100),n=2*o/(2*Math.sqrt(3)),a=Math.sqrt(3)/2*o,h=s-o-o+n+n;i.path="M "+(s/2-o/2+e.offX)+","+(a+e.offY)+" ",i.path+="A "+n+","+n+" 0 0,1 "+(s/2+o/2+e.offX)+","+(a+e.offY)+" ",i.path+="L "+(s-o/2+e.offX)+","+(r-a+e.offY)+" ",i.path+="A "+n+","+n+" 0 0,1 "+(s-o+e.offX)+","+(r+e.offY)+" ",i.path+="L "+(o+e.offX)+","+(r+e.offY)+" ",i.path+="A "+n+","+n+" 0 0,1 "+(o/2+e.offX)+","+(r-a+e.offY)+" ",i.path+="Z"}else i.path="M "+(s/2+e.offX)+","+e.offY+" ",i.path+="L "+(s+e.offX)+","+(o+e.offY)+" ",i.path+="L "+e.offX+","+(o+e.offY)+" ",i.path+="Z";break;default:if(i.type=d.PART_TYPE_RECT,t.cornersRadius>0){let s=Math.min(r,n)/2/100*t.cornersRadius;i.path="M "+e.offX+", "+(s+e.offY)+" ",i.path+="A "+s+","+s+" 0 0,1 "+(s+e.offX)+","+e.offY+" ",i.path+="L "+(r-s+e.offX)+","+e.offY+" ",i.path+="A "+s+","+s+" 0 0,1 "+(r+e.offX)+","+(s+e.offY)+" ",i.path+="L "+(r+e.offX)+","+(n-s+e.offY)+" ",i.path+="A "+s+","+s+" 0 0,1 "+(r-s+e.offX)+","+(n+e.offY)+" ",i.path+="L "+(s+e.offX)+","+(n+e.offY)+" ",i.path+="A "+s+","+s+" 0 0,1 "+e.offX+","+(n-s+e.offY)+" ",i.path+="Z"}else i.path="M "+e.offX+","+e.offY+" ",i.path+="L "+(r+e.offX)+","+e.offY+" ",i.path+="L "+(r+e.offX)+","+(n+e.offY)+" ",i.path+="L "+e.offX+","+(n+e.offY)+" ",i.path+="Z"}return 0!=e.rotation&&(i.path=this.svg.path.transform(i.path,{translate:0,scale:1,origin:[0,0],skew:0,rotate:e.rotation}).toString()),i}}class qt{static rgb2hex(t){function e(t){return("0"+parseInt(t).toString(16)).slice(-2)}return"#"+e((t=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))[1])+e(t[2])+e(t[3])}static hexToRgb(t){let e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}static hexToCmyk(t){let e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t),i=parseInt(e[1],16)/255,r=parseInt(e[2],16)/255,n=parseInt(e[3],16)/255;if(0===i&&0===r&&0===n)return{c:0,m:0,y:0,k:100};let s=1-Math.max(i,r,n);return e?{c:(1-i-s)/(1-s),m:(1-r-s)/(1-s),y:(1-n-s)/(1-s),k:s}:null}static cmykToRgb(t){let e=t.match(/^cmyk\((\d+),\s*(\d+),\s*(\d+),\s*(\d+)\)$/),i=255*(1-e[1]/100)*(1-e[4]/100),r=255*(1-e[2]/100)*(1-e[4]/100),n=255*(1-e[3]/100)*(1-e[4]/100);return e?{r:i,g:r,b:n}:null}static paddy(t,e,i){let r=void 0!==i?i:"0",n=new Array(1+e).join(r);return(n+t).slice(-n.length)}static checkHex(t){return!(t.length>2)&&/[A-Fa-f0-9]/.test(t)}static isHexColor(t){return/^#[0-9a-f]{3}(?:[0-9a-f]{3})?$/i.test(t)}}class Vt extends yt{constructor(){super(...arguments),this.triggerGtmWidthChange=!0,this.triggerGtmHeightChange=!0}change(t,e){let i=Pt.jsonToObject(t),r=Object.keys(i).length;void 0!==i.path&&r--,null!=this.svg.activePart?(i.corner_radius&&(i.part_type&&i.part_type==d.PART_TYPE_PATH||this.svg.activePart.setCornersRadius(parseInt(i.corner_radius)),--r,void 0!==e&&r<=0&&e()),i.part_type&&(this.svg.activePart.predefinedCutline=!1,this.svg.activePart.setPartType(i.part_type,(function(){--r,void 0!==e&&r<=0&&e()}),i.path)),i.width&&(this.svg.activePart.changeAspect("width",i.width,0,!1),this.svg.activePart.part_type!=d.PART_TYPE_PATH&&this.svg.activePart.afterChangeAspect(!1),--r,void 0!==e&&r<=0&&e()),i.height&&(this.svg.activePart.changeAspect("height",0,i.height,!1),this.svg.activePart.part_type!=d.PART_TYPE_PATH&&this.svg.activePart.afterChangeAspect(!1),--r,void 0!==e&&r<=0&&e())):void 0!==e&&e()}changeBackground(t){var e,i,r=Pt.jsonToObject(t);if(r.sync)for(var n=this.svg.sheet.parts,s=0;s<n.length;s++)n[s].setBackground(r.color);else{if(!this.svg.activePart&&(null===(e=this.svg.sheet)||void 0===e?void 0:e.isCustomizableSheet))return null===(i=this.svg.node.getActiveNodeSheet())||void 0===i?void 0:i.setBackground(r.color);null!=this.svg.activePart&&this.svg.activePart.setBackground(r.color)}}copyPartContent(t,e,i){if(t=void 0!==t&&t,e=void 0!==e&&e,null!=this.svg.selected)for(var r=this.svg.sheet.parts,n=0;n<r.length;n++)r[n].intId!=this.svg.selected.intId&&(e||r[n].isEmpty())&&(r[n].isSheetBackground||(e&&r[n].partGroupNode.removeChildren(),this.svg.selected.copyTo(r[n],t,i)));else this.svg.trigger(p.ADD_NOTIFICATION,{category:5,type:2,data:"Nothing selected"})}getTopLeftPart(){if(0==this.svg.sheet.parts.length)return null;for(var t=0,e=this.svg.sheet.parts[0].boundingBox.x+this.svg.sheet.parts[0].boundingBox.y,i=1;i<this.svg.sheet.parts.length;i++){var r=this.svg.sheet.parts[i].boundingBox.x+this.svg.sheet.parts[i].boundingBox.y;r<e&&(t=i,e=r)}var n={};n.part_id=this.svg.sheet.parts[t].id;var s=this.svg.transform.getScreenCTM(),o=this.svg.rootEl.createSVGPoint();o.x=this.svg.sheet.parts[t].boundingBox.x,o.y=this.svg.sheet.parts[t].boundingBox.y,o=o.matrixTransform(s),n.point1=o;var a=this.svg.rootEl.createSVGPoint();return a.x=this.svg.sheet.parts[t].boundingBox.x+this.svg.sheet.parts[t].boundingBox.width,a.y=this.svg.sheet.parts[t].boundingBox.x+this.svg.sheet.parts[t].boundingBox.height,a=a.matrixTransform(s),n.point2=a,n}getBackDealPart(){return this.svg.sheet.parts.filter((function(t){return"back_deal"==t.side}))[0]||!1}getBackPart(){return this.svg.sheet.parts.filter((function(t){return"back"==t.side}))[0]||!1}setCMYKBackgound(t){null!=this.svg.activePart&&this.svg.activePart.setCMYKBackground(t)}getFrontPart(){return this.svg.sheet.parts.filter((function(t){return"front"==t.side}))[0]||!1}getActivePartSide(){return null!=this.svg.activePart&&this.svg.activePart.side}isBackSideActive(){return"back"==this.getActivePartSide()}isFrontSideActive(){return"front"==this.getActivePartSide()}isStickerActive(){var t;return null===(null===(t=this.svg.activePart)||void 0===t?void 0:t.side)}getCmykBackground(){return null!=this.svg.activePart?this.svg.activePart.getCMYKBackground():null}getActivePartId(){return null!=this.svg.activePart&&this.svg.activePart.id}clearActivePart(){let t=this.svg.node.getNodeById(this.getActivePartId());t.setBackground("#FFF"),t.partGroupNode.removeChildren(),t.partGroupNode.element.innerHTML=""}getParts(){for(var t=this.svg.sheet.parts,e=[],i=0;i<t.length;i++)e.push(t[i].id);return e}getBackground(){var t,e;return null!=this.svg.activePart?null!=this.svg.activePart.backGroundNode?this.svg.activePart.backGroundNode.element.getAttribute("fill"):"none":(null===(t=this.svg.sheet)||void 0===t?void 0:t.isCustomizableSheet)?null===(e=this.svg.node.getActiveNodeSheet())||void 0===e?void 0:e.backGroundNode.element.getAttribute("fill"):void 0}changeCMYKvalues(t,e,i){let r,n=qt.hexToCmyk(i);switch(t){case"cyan":r=qt.cmykToRgb(`cmyk(${e},${Math.round(100*n.m)},${Math.round(100*n.y)},${Math.round(100*n.k)})`);break;case"magenta":r=qt.cmykToRgb(`cmyk(${Math.round(100*n.c)},${e},${Math.round(100*n.y)},${Math.round(100*n.k)})`);break;case"yellow":r=qt.cmykToRgb(`cmyk(${Math.round(100*n.c)},${Math.round(100*n.m)},${e},${Math.round(100*n.k)})`);break;case"black":r={r:255*(1-n.c)*(1-e/100),g:255*(1-n.m)*(1-e/100),b:255*(1-n.y)*(1-e/100)}}return qt.rgb2hex(`rgb(${Math.round(r.r)},${Math.round(r.g)},${Math.round(r.b)})`)}setInputsValues(t,e){const i="[name$=_input_red]",r="[name$=_input_green]",n="[name$=_input_blue]";switch(e.find("[name$=_input_type]").val()){case"dec":e.find(i).val(parseInt(t.replace("#","").substring(0,2),16)),e.find(r).val(parseInt(t.replace("#","").substring(2,4),16)),e.find(n).val(parseInt(t.replace("#","").substring(4,6),16));break;case"hex":e.find(i).val(t.replace("#","").substring(0,2).toUpperCase()),e.find(r).val(t.replace("#","").substring(2,4).toUpperCase()),e.find(n).val(t.replace("#","").substring(4,6).toUpperCase());break;case"cmyk":let s=qt.hexToCmyk(t);e.find("[name$=_input_cyan]").val(Math.round(100*s.c)),e.find("[name$=_input_magenta]").val(Math.round(100*s.m)),e.find("[name$=_input_yellow]").val(Math.round(100*s.y)),e.find("[name$=_input_black]").val(Math.round(100*s.k))}}}var Ft=__webpack_require__(91156),Ht=__webpack_require__.n(Ft);class zt extends yt{parse(t){return new(Ht())(t)}toBoundingBox(t){return new(Ht())(t).bbox}transformByMatrix(t,e){return this.transform(t,this.matrixToTransformObject(e))}matrixToTransformObject(t){let e=t.e,i=t.f,r=Math.sqrt(t.a*t.a+t.b*t.b),n=Math.sqrt(t.c*t.c+t.d*t.d);return{translate:[e,i],scale:[r,n],rotate:Math.atan2(t.b,t.a)*(180/Math.PI),skew:[Math.atan2(t.a*t.c+t.b*t.d,r*r)*(180/Math.PI),Math.atan2(t.a*t.c+t.b*t.d,n*n)*(180/Math.PI)],origin:[0,0]}}transform(t,e){let i=new(Ht())(t);return i.transform(e),i}}class Ut extends yt{get isPreviewModeOn(){return this._isPreviewModeOn}constructor(t){super(t),this._isPreviewModeOn=!1,this.lineWidthScale_=1,this.svg.events.addListener(p.SELECT_NODE,(t=>this.turnOff()))}turnOn(){this.isPreviewModeOn||(this._isPreviewModeOn=!0,this.updatePreview(),this.svg.trigger(p.PREVIEW_MODE_ON))}turnOff(){this.isPreviewModeOn&&(this._isPreviewModeOn=!1,this.updatePreview(),this.svg.trigger(p.PREVIEW_MODE_OFF))}getStrokeColor(){return this.svg.svgSettings.zoomMode==c.ZOOM_PART?"#000000":"#A0A0A0"}handleSingleMode(){if(this.svg.activePart){if(this.isPreviewModeOn){let t=this.svg.activePart.path,e=this.svg.activePart.previewClipPath.clipPathPath;e.element.setAttribute("d",t);let i=this.svg.rootEl.createSVGTransform();i.setMatrix(this.svg.activePart.partGroupNode.getTransformationMatrix().inverse()),e.getTransformList(),e.element.transform.baseVal.initialize(i),this.svg.activePart.partGroupNode.element.setAttribute("clip-path","url(#"+this.svg.activePart.previewClipPath.id+")"),this.svg.activePart.pathNode.element.style.visibility="hidden",this.svg.activePart.backGroundNode.element.setAttribute("stroke","#A0A0A0");let r=this.svg.style.getStyle(".svgPartPath","stroke-width");return this.svg.activePart.backGroundNode.element.setAttribute("stroke-width",parseFloat(r)*this.svg.strokeScale),void(this.svg.svgSettings.fxDropShadow?this.svg.activePart.addDropShadow():this.svg.activePart.removeDropShadow())}this.svg.activePart.partGroupNode.element.setAttribute("clip-path","none"),this.svg.activePart.pathNode.element.style.visibility="visible",this.svg.activePart.backGroundNode.element.setAttribute("stroke","none"),this.svg.activePart.backGroundNode.element.setAttribute("stroke-width","0"),this.svg.activePart.removeDropShadow()}}applyStyleSheetMode(){var t,e;const i=this.svg.node.getActiveNodeSheet();if(i&&((null===(t=this.svg.activePart)||void 0===t?void 0:t.id)&&"background"==(null===(e=this.svg.activePart)||void 0===e?void 0:e.id)&&i.backGroundNode.element.setAttribute("stroke",this.getStrokeColor()),"back"==i.side)){let t=this.isPreviewModeOn?"url(#editorClip_"+this.svg.part.getFrontPart().id+")":"none";this.svg.activePart.partGroupNode.element.setAttribute("clip-path",t)}}handleSheetMode(){var t;let e=this.isPreviewModeOn&&this.svg.svgSettings.zoomMode==c.ZOOM_SHEET;null===(t=this.svg.node.getActiveNodeSheet())||void 0===t||t.backGroundNode.element.setAttribute("stroke","none"),e&&this.svg.svgSettings.fxDropShadow?this.svg.sheet.addDropShadow():this.svg.sheet.removeDropShadow(),this.applyStyleSheetMode()}updatePreview(){if(this.isPreviewModeOn&&null!=this.svg.selected&&this.svg.select.select(null),this.svg.svgSettings.mode==E.MODE_SINGLE)this.handleSingleMode();else if(this.svg.svgSettings.mode==E.MODE_SHEET){this.handleSheetMode();let t=this.svg.style.getStyle(".svgSheet.sheet","stroke-width");this.svg.sheet.element.setAttribute("stroke",this.getStrokeColor()),this.svg.sheet.element.setAttribute("stroke-width",parseFloat(t)*this.svg.strokeScale)}this.svg.shadow.updateShadow(),this.svg.activePart&&this.svg.activePart.stickySizeLabels&&this.svg.activePart.showSize()}scaleImageToSheet(t){var e=this.svg.sheet.width*this.svg.px2mm/t.imageWidth,i=this.svg.sheet.height*this.svg.px2mm/t.imageHeight,r=this.svg.rootEl.createSVGMatrix();r.a=parseFloat(e.toString()),r.b=0,r.c=0,r.d=parseFloat(i.toString()),r.e=0,r.f=0;var n=this.svg.rootEl.createSVGTransform();n.setMatrix(r),t.getTransformList(),t.element.transform.baseVal.initialize(n)}hidePreview(t,e){null!=t.previewBack&&(t.previewBack.element.style.display="none"),null!=t.previewFont&&(t.previewFont.element.style.display="none"),null!=t.previewClipPath&&t.element.setAttribute("clip-path","none"),t.pathNode.element.style.display=e?"block":"none",null!=t.bleedPathNode&&(t.bleedPathNode.element.style.display=e?"block":"none"),null!=t.backGroundNode&&t.backGroundNode.element.setAttribute("d",t.backGroundNode.orgPath),null!=this.svg.collage&&(this.svg.collage.getPart().intId,t.intId)}showPreview(t,e){null!=t.previewBack&&(t.previewBack.element.style.display="block"),null!=t.previewFont&&(t.previewFont.element.style.display="block"),null!=t.previewClipPath&&t.element.setAttribute("clip-path","url(#"+t.previewClipPath.id+")"),t.pathNode.element.style.display=e?"none":"block",null!=t.bleedPathNode&&(t.bleedPathNode.element.style.display=e?"none":"block"),null!=t.backGroundNode&&t.backGroundNode.element.setAttribute("d",e?t.previewClipPath.path:t.backGroundNode.orgPath),null!=this.svg.collage&&(this.svg.collage.getPart().intId,t.intId)}}class Gt extends Dt{constructor(){super(d.LAYER_STANDARD,"g"),this.elements=[]}onElementCreated(t){this.options.id&&this.element.setAttribute("id",this.options.id),super.onElementCreated(t)}updateOptions(){this.options.part&&(this.part=this.svg.node.getNodeById(this.options.part),this.moveToLayer(this.part))}addElement(t,e){e?this.element.appendChild(t):this.element.prepend(t)}removeElement(t){this.svg.events.deleteBy(t),this.element.removeChild(t)}}class Zt extends yt{constructor(t){super(t),this.position=null,this.lockTool=!1,this.invertedRotation=!1,this.selectedTool=null,this.selectedBottomTextNode=null,this.selectedTopTextNode=null,this.SELECTCORNERSIZE=12,this.MENUOFFSETX=30,this.MENUOFFSETY=10,this.MENUOFFSETITEM=22,this.MENUPADDING=3,this.MENUTOUCHOFFSETX=40,this.MENUTOUCHOFFSETY=12,this.MENUTOUCHOFFSETITEM=40,this.MENUTOUCHPADDING=8,this.oldHover_=null,this.oldSelect_=null,this.selectGroup_=null,this.svg.events.addListener(p.RESIZE,(()=>this.reDrawHoverAndSelect())),this.svg.events.addListener(p.IS_TOUCH,(t=>this.onEditorIsTouch(t))),this.svg.events.addListener(p.SVG_DESTROYED,(t=>this.reset()))}reDrawHoverAndSelect(){null!=this.oldHover_&&this.hoverOn(this.oldHover_,null,!0),null!=this.oldSelect_&&(this.hideSelect(this.oldSelect_),this.selectOn(this.oldSelect_,!0))}reset(){this.oldHover_=null,this.oldSelect_=null,this.selectGroup_=null}hover(t,e=null){if(e=void 0===e?null:e,null!=t&&t.type!=d.PART&&t.getPart().isLockedContent&&(t=t.getPart()),!(null!=t&&t.type==d.PART&&this.svg.sheet.sheet_type!=E.MODE_SHEET&&this.svg.sheet.sheet_type!=E.MODE_SINGLE||null!=t&&t.type==d.PART&&this.svg.sheet.sheet_type==E.MODE_SHEET&&t.part_type==d.PART_TYPE_PATH&&this.svg.svgSettings.zoomMode==c.ZOOM_PART)){if(null==t&&null!=this.oldHover_)return this.hoverOff(this.oldHover_),void(this.oldHover_=null);if(null!=t||null!=this.oldHover_)return null==this.oldHover_?(this.hoverOn(t,e),void(this.oldHover_=t)):void((null==t?void 0:t.intId)!=this.oldHover_.intId&&(this.hoverOff(this.oldHover_),this.hoverOn(t,e),this.oldHover_=t))}}hideSelect(t){t.selectElement=null,null!=this.selectGroup_&&(this.selectGroup_.element.style.display="none",this.svg.icon.clearIconsList(),t.type==d.PART&&this.svg.sheet.sheet_type==E.MODE_SHEET&&(null!=t.bottomText&&(t.bottomText.remove(),t.bottomText=null),null!=t.leftText&&(t.leftText.remove(),t.leftText=null)))}showSelect(t){this.selectOn(t,!1)}deselect(){this.select(null)}select(t){if(null!=t&&t.type!=d.PART&&t.getPart().isLockedContent&&(t=t.getPart()),null!=t&&null!=t.selectRedirect&&(t=t.selectRedirect),null==t||t.type!=d.PART||this.svg.sheet.sheet_type==E.MODE_SHEET||this.svg.sheet.sheet_type==E.MODE_SINGLE)if(null==t||t.type!=d.PART||this.svg.sheet.sheet_type!=E.MODE_SHEET||t.part_type!=d.PART_TYPE_PATH||this.svg.svgSettings.zoomMode!=c.ZOOM_PART){if(null!=this.svg.text.specialTextSelection&&(this.svg.trigger(p.DESELECT_NODE,this.svg.text.specialTextSelection.type),this.svg.text.specialTextSelection=null),null==t&&null!=this.oldSelect_)return this.selectOff(this.oldSelect_),void(this.oldSelect_=null);if(null!=t||null!=this.oldSelect_)return null==this.oldSelect_?(this.oldSelect_=t,void this.selectOn(t,!1)):void(t.intId!=this.oldSelect_.intId&&(t.intId!=this.svg.selected.intId&&this.selectOff(this.oldSelect_),this.oldSelect_=t,this.selectOn(t,!1)))}else null!=this.oldSelect_&&(this.selectOff(this.oldSelect_),this.oldSelect_=null);else null!=this.oldSelect_&&(this.selectOff(this.oldSelect_),this.oldSelect_=null)}createMenu(t,e){this.svg.touch.isTouch?(null!=this.svg.style.getStyle(".svgIconMenuTouch","margin-left")&&(this.MENUOFFSETX=parseInt(this.svg.style.getStyle(".svgIconMenuTouch","margin-left"))),null!=this.svg.style.getStyle(".svgIconMenuTouch","margin-top")&&(this.MENUOFFSETITEM=parseInt(this.svg.style.getStyle(".svgIconMenuTouch","margin-top")))):(null!=this.svg.style.getStyle(".svgIconMenu","margin-left")&&(this.MENUOFFSETX=parseInt(this.svg.style.getStyle(".svgIconMenu","margin-left"))),null!=this.svg.style.getStyle(".svgIconMenu","margin-top")&&(this.MENUOFFSETITEM=parseInt(this.svg.style.getStyle(".svgIconMenu","margin-top"))));let i=t.boundingBox,r=0,n=i.y+this.MENUOFFSETY*this.svg.strokeScale,s=this.MENUOFFSETITEM*this.svg.strokeScale,o=0,a=0,l=0,h=0,c=0,u=0,m=this.svg.rootEl.createSVGPoint();if(m.x=this.svg.fixedLeft+this.svg.container.offsetWidth,m.y=this.svg.fixedTop+this.svg.container.offsetHeight,m=m.matrixTransform(this.svg.transform.getScreenCTM().inverse()),c=m.x-this.MENUOFFSETX*this.svg.strokeScale*1.7,u=m.y,a=c,m.x=this.svg.fixedLeft,m.y=this.svg.fixedTop,m.y+=50,m=m.matrixTransform(this.svg.transform.getScreenCTM().inverse()),l=m.x+this.MENUOFFSETY*this.svg.strokeScale*2,h=m.y+this.MENUOFFSETY*this.svg.strokeScale*2,r=i.x+i.width<a?i.x+i.width+this.MENUOFFSETX*this.svg.strokeScale:i.x-this.MENUOFFSETX*this.svg.strokeScale,r<l&&(r=c+this.MENUOFFSETX*this.svg.strokeScale,n+=this.MENUOFFSETX*this.svg.strokeScale/2),n<h&&(n=h+this.MENUOFFSETY*this.svg.strokeScale),e.includes(g.EDIT)){let e=r,a=n;this.svg.selected.isSheetBackground&&(e=i.width-100*this.svg.strokeScale,a=i.y-2*this.MENUOFFSETY*this.svg.strokeScale);let l=this.svg.icon.createIcon("selectEditIcon","icon_editor_Edit","selectGroup",this.MENUPADDING,this.svg.selected.isSheetBackground?d.SHAPE_RECT:null,!0);if(this.svg.transform.moveNode(l,e+0*o,a+s*o),o++,l.element.setAttribute("class","svgSelectIcon"),l.element.setAttribute("pointer-events","all"),this.svg.selected.isSheetBackground){o--,document.querySelector("#"+l.id+"IconBackground").setAttribute("width","740");let t=At.getIcon("icon_editor_Edit"),e={};e.parentIntId=l.intId,e.left=t.x+140,e.top=t.y+74,e.size=70,e.text="Edit background",e.fill="#FFFFFF";let i=this.svg.node.addNode(new rt,e);i.element.style.pointerEvents="none",i.element.style.fontFamily='"FuturaPT", sans-serif'}this.svg.events.addListenerTo(l.element,"click",(e=>{e.stopPropagation(),t.onEditMenu()}))}if(e.includes(g.UP)&&!t.parent.isChildFirst(t,!1)){let e=this.svg.icon.createIcon("selectUpIcon","icon_editor_Up","selectGroup",this.MENUPADDING,null,!0);this.svg.transform.moveNode(e,r+0*o,n+s*o),o++,e.element.setAttribute("class","svgSelectIcon"),e.element.setAttribute("pointer-events","all"),this.svg.events.addListenerTo(e.element,"click",(e=>{e.stopPropagation(),t.parent.moveChildUp(t),this.reDrawHoverAndSelect()}))}if(e.includes(g.DOWN)&&!t.parent.isChildLast(t,!1)){let e=this.svg.icon.createIcon("selectDownIcon","icon_editor_Down","selectGroup",this.MENUPADDING,null,!0);this.svg.transform.moveNode(e,r+0*o,n+s*o),o++,e.element.setAttribute("class","svgSelectIcon"),e.element.setAttribute("pointer-events","all"),this.svg.events.addListenerTo(e.element,"click",(e=>{e.stopPropagation(),t.parent.moveChildDown(t),this.reDrawHoverAndSelect()}))}if(e.includes(g.PART_UP)){let e=this.svg.icon.createIcon("selectPartUpIcon","icon_editor_Up","selectGroup",this.MENUPADDING,null,!0);this.svg.transform.moveNode(e,r+0*o,n+s*o),o++,e.element.setAttribute("class","svgSelectIcon"),e.element.setAttribute("pointer-events","all"),this.svg.events.addListenerTo(e.element,"click",(e=>{e.stopPropagation(),t.movePartUp(),this.reDrawHoverAndSelect()}))}if(e.includes(g.PART_DOWN)){let e=this.svg.icon.createIcon("selectPartDownIcon","icon_editor_Down","selectGroup",this.MENUPADDING,null,!0);this.svg.transform.moveNode(e,r+0*o,n+s*o),o++,e.element.setAttribute("class","svgSelectIcon"),e.element.setAttribute("pointer-events","all"),this.svg.events.addListenerTo(e.element,"click",(e=>{e.stopPropagation(),t.movePartDown(),this.reDrawHoverAndSelect()}))}if(e.includes(g.COPY)){let e=this.svg.icon.createIcon("selectCopyIcon","icon_editor_Copy","selectGroup",this.MENUPADDING,null,!0);this.svg.transform.moveNode(e,r+0*o,n+s*o),o++,e.element.setAttribute("class","svgSelectIcon"),e.element.setAttribute("pointer-events","all"),this.svg.events.addListenerTo(e.element,"click",(e=>{e.stopPropagation();let i=new Array;i.offX=10,i.offY=10,t.type==d.PART&&this.svg.sheet.sheet_type==E.MODE_SHEET&&(t.boundingBox.y+t.boundingBox.height+i.offY>this.svg.sheet.boundingBox.height&&(i.offY=-i.offY),t.boundingBox.x+t.boundingBox.width+i.offX>this.svg.sheet.boundingBox.width&&(i.offX=-i.offX)),this.svg.node.copy(t,i),this.reDrawHoverAndSelect()}))}if(e.includes(g.CENTER_HOR)){let e=this.svg.icon.createIcon("selectCenterHorIcon","icon_editor_Center_hor","selectGroup",this.MENUPADDING,null,!0);this.svg.transform.moveNode(e,r+0*o,n+s*o),o++,e.element.setAttribute("class","svgSelectIcon"),e.element.setAttribute("pointer-events","all"),this.svg.events.addListenerTo(e.element,"click",(e=>{e.stopPropagation();let i=!1,r=!1,n=!1;t.type==d.PART&&this.svg.sheet.sheet_type==E.MODE_SHEET&&(i=!0),t.type==d.SHAPE_MULTI&&null!=this.svg.collage&&(r=!0),this.svg.sheet.sheet_type==E.MODE_CASE&&(n=!0),this.svg.transform.centerHorOrVer(t,!0,i,r,n),this.reDrawHoverAndSelect()}))}if(e.includes(g.CENTER_VER)){let e=this.svg.icon.createIcon("selectCenterVerIcon","icon_editor_Center_ver","selectGroup",this.MENUPADDING,null,!0);this.svg.transform.moveNode(e,r+0*o,n+s*o),o++,e.element.setAttribute("class","svgSelectIcon"),e.element.setAttribute("pointer-events","all"),this.svg.events.addListenerTo(e.element,"click",(e=>{e.stopPropagation();let i=!1,r=!1,n=!1;t.type==d.PART&&this.svg.sheet.sheet_type==E.MODE_SHEET&&(i=!0),t.type==d.SHAPE_MULTI&&null!=this.svg.collage&&(r=!0),this.svg.sheet.sheet_type==E.MODE_CASE&&(n=!0),this.svg.transform.centerHorOrVer(t,!1,i,r,n),this.reDrawHoverAndSelect()}))}if(e.includes(g.DELETE)){let e=this.svg.icon.createIcon("selectDeleteIcon","icon_editor_Delete","selectGroup",this.MENUPADDING,null,!0);this.svg.transform.moveNode(e,r+0*o,n+s*o),o++,e.element.setAttribute("class","svgSelectIcon"),e.element.setAttribute("pointer-events","all"),this.svg.events.addListenerTo(e.element,"click",(e=>{e.stopPropagation(),t.onDeleteMenu()&&t.remove(),this.svg.select.select(null),this.svg.events.trigger(p.NODE_REMOVED)}))}if(e.includes(g.COLLAGE)&&null!=this.svg.collage&&null!=t.collageObject){let t=this.svg.icon.createIcon("selectCollageIcon","icon_editor_Ok","selectGroup",this.MENUPADDING,null,!0);this.svg.transform.moveNode(t,r+0*o,n+s*o),o++,t.element.setAttribute("class","svgSelectIcon"),t.element.setAttribute("pointer-events","all"),this.svg.events.addListenerTo(t.element,"click",(t=>{t.stopPropagation(),this.svg.select.select(null)}))}if(e.includes(g.UPLOAD)){let e=this.svg.icon.createIcon("selectUploadIcon","icon_editor_Upload","selectGroup",this.MENUPADDING,null,!0);this.svg.transform.moveNode(e,r+0*o,n+s*o),o++,e.element.setAttribute("class","svgSelectIcon"),e.element.setAttribute("pointer-events","all"),this.svg.events.addListenerTo(e.element,"click",(e=>{e.stopPropagation(),this.svg.events.trigger(p.NODE_MENU_CLICK_UPLOAD,{node:t})}))}if(n+s*o>u){let t=u-(n+s*o),e=["#selectEditIcon","#selectUpIcon","#selectDownIcon","#selectCopyIcon","#selectCenterHorIcon","#selectCenterVerIcon","#selectUploadIcon","#selectCollageIcon","#selectDeleteIcon"];for(let i=0;i<e.length;++i){let r=document.querySelector(e[i]),n=null==r?void 0:r.getAttribute("transform");n&&r.setAttribute("transform","translate(0,"+t+") "+n)}}}showDpi(t){}drawRotateLine(t){if(null!=t){null!=t.selectToolElement1&&(this.selectLayer.removeElement(t.selectToolElement1),t.selectToolElement1=null);let e=this.svg.input.currentPoint.x,i=this.svg.input.currentPoint.y,r=t.getCenterPoint(!1),n=it.createElement("line");n.setAttribute("x1",e),n.setAttribute("y1",i),n.setAttribute("x2",r.x),n.setAttribute("y2",r.y),n.setAttribute("class","svgSelectRotateLine"),t.selectToolElement1=n,this.selectLayer.addElement(t.selectToolElement1,!0);let s=parseFloat(this.svg.style.getStyle(".svgSelectRotateLine","stroke-width"));t.selectToolElement1.style.strokeWidth=parseFloat((s*this.svg.strokeScale).toString())+"px"}}removeRotateLine(t){null!=t.selectToolElement1&&(this.selectLayer.removeElement(t.selectToolElement1),t.selectToolElement1=null)}addInnerMeasures(t){const e=parseInt(t.getAttribute("width")),i=parseInt(t.getAttribute("height")),r=parseInt(t.getAttribute("x")),n=parseInt(t.getAttribute("y")),s=this.svg.svgSettings.fontSize*this.svg.strokeScale,o=s;let a={parentId:"selectGroup",left:e/2+r,top:i+n+o+1,size:s,anchor:"middle",text:this.svg.size.mmToDisplayable(e/this.svg.px2mm),transform:null,class:"svgPartInnerSizeText"};this.selectedBottomTextNode=this.svg.node.addNode(new rt,a),a.left=r,a.top=n+i/2,a.transform="rotate(-90 "+(r-o/2)+","+a.top+")",a.text=this.svg.size.mmToDisplayable(i/this.svg.px2mm),this.selectedTopTextNode=this.svg.node.addNode(new rt,a)}createSelectElement(t){let e=t.boundingBox,i=[];i.id="selectGroup",i.parentId="selectLayer",null!=this.selectGroup_&&this.selectGroup_.removeInklChildren(),null!==this.selectedBottomTextNode&&this.selectedBottomTextNode.remove(),null!==this.selectedTopTextNode&&this.selectedTopTextNode.remove(),this.selectGroup_=this.svg.node.addNode(new et,i),this.selectGroup_.overHandling=l.OVER_IGNORE;let r=this.selectGroup_.element,n=it.createElement("rect");n.setAttribute("x",e.x),n.setAttribute("y",e.y),n.setAttribute("width",e.width),n.setAttribute("height",e.height),n.setAttribute("class","svgSelect"),n.setAttribute("pointer-events","all"),r.appendChild(n);let s=parseFloat(this.svg.style.getStyle(".svgSelect","stroke-width"));if(n.style.strokeWidth=parseFloat((s*this.svg.strokeScale).toString())+"px",t.isMoveable?(this.svg.events.addListenerTo(n,"mousedown",(()=>{this.lockTool||(this.selectedTool=g.MOVE)})),this.svg.events.addListenerTo(n,"mouseleave",(()=>{this.lockTool||(this.selectedTool=null)})),this.svg.svgSettings.displayNodeMeasures&&this.addInnerMeasures(n)):(n.style.strokeWidth=parseFloat((s*this.svg.strokeScale).toString())+"px",n.style.cursor="default"),t.isResizeable){let t=[[e.x,e.y,"nw"],[e.x+e.width,e.y,"ne"],[e.x+e.width,e.y+e.height,"se"],[e.x,e.y+e.height,"sw"]];for(let e=0;e<t.length;e++)switch(t[e][2]){case"nw":let i=this.svg.icon.createIcon("selectNWIcon","icon_editor_NWResize","selectGroup",2);this.svg.transform.moveNode(i,t[e][0],t[e][1]),i.element.setAttribute("class","svgSelectNW"),i.element.setAttribute("pointer-events","all"),this.svg.events.addListenerTo(i.element,"mouseenter",(()=>{this.lockTool||(this.selectedTool=g.NW_RESIZE)})),this.svg.events.addListenerTo(i.element,"mouseleave",(()=>{this.lockTool||(this.selectedTool=null)}));break;case"ne":let r=this.svg.icon.createIcon("selectNEIcon","icon_editor_NEResize","selectGroup",2);this.svg.transform.moveNode(r,t[e][0],t[e][1]),r.element.setAttribute("class","svgSelectNE"),r.element.setAttribute("pointer-events","all"),this.svg.events.addListenerTo(r.element,"mouseenter",(()=>{this.lockTool||(this.selectedTool=g.NE_RESIZE)})),this.svg.events.addListenerTo(r.element,"mouseleave",(()=>{this.lockTool||(this.selectedTool=null)}));break;case"se":let n=this.svg.icon.createIcon("selectSEIcon","icon_editor_SEResize","selectGroup",2);this.svg.transform.moveNode(n,t[e][0],t[e][1]),n.element.setAttribute("class","svgSelectSE"),n.element.setAttribute("pointer-events","all"),this.svg.events.addListenerTo(n.element,"mouseenter",(()=>{this.lockTool||(this.selectedTool=g.SE_RESIZE)})),this.svg.events.addListenerTo(n.element,"mouseleave",(()=>{this.lockTool||(this.selectedTool=null)}));break;case"sw":let s=this.svg.icon.createIcon("selectSWIcon","icon_editor_SWResize","selectGroup",2);this.svg.transform.moveNode(s,t[e][0],t[e][1]),s.element.setAttribute("class","svgSelectSW"),s.element.setAttribute("pointer-events","all"),this.svg.events.addListenerTo(s.element,"mouseenter",(()=>{this.lockTool||(this.selectedTool=g.SW_RESIZE)})),this.svg.events.addListenerTo(s.element,"mouseleave",(()=>{this.lockTool||(this.selectedTool=null)}))}}if(t.isAspectChangable&&this.svg.svgSettings.zoomMode==c.ZOOM_PART){let t=[[e.x+e.width/2,e.y,"n"],[e.x+e.width,e.y+e.height/2,"w"],[e.x+e.width/2,e.y+e.height,"s"],[e.x,e.y+e.height/2,"e"]];for(let e=0;e<t.length;e++)switch(t[e][2]){case"n":let i=this.svg.icon.createIcon("selectNIcon","icon_editor_NResize","selectGroup",2);this.svg.transform.moveNode(i,t[e][0],t[e][1]),i.element.setAttribute("class","svgSelectN"),i.element.setAttribute("pointer-events","all"),this.svg.events.addListenerTo(i.element,"mouseenter",(()=>{this.lockTool||(this.selectedTool=g.N_RESIZE)})),this.svg.events.addListenerTo(i.element,"mouseleave",(()=>{this.lockTool||(this.selectedTool=null)}));break;case"e":let r=this.svg.icon.createIcon("selectEIcon","icon_editor_EResize","selectGroup",2);this.svg.transform.moveNode(r,t[e][0],t[e][1]),r.element.setAttribute("class","svgSelectE"),r.element.setAttribute("pointer-events","all"),this.svg.events.addListenerTo(r.element,"mouseenter",(()=>{this.lockTool||(this.selectedTool=g.E_RESIZE)})),this.svg.events.addListenerTo(r.element,"mouseleave",(()=>{this.lockTool||(this.selectedTool=null)}));break;case"s":let n=this.svg.icon.createIcon("selectSIcon","icon_editor_SResize","selectGroup",2);this.svg.transform.moveNode(n,t[e][0],t[e][1]),n.element.setAttribute("class","svgSelectS"),n.element.setAttribute("pointer-events","all"),this.svg.events.addListenerTo(n.element,"mouseenter",(()=>{this.lockTool||(this.selectedTool=g.S_RESIZE)})),this.svg.events.addListenerTo(n.element,"mouseleave",(()=>{this.lockTool||(this.selectedTool=null)}));break;case"w":let s=this.svg.icon.createIcon("selectWIcon","icon_editor_WResize","selectGroup",2);this.svg.transform.moveNode(s,t[e][0],t[e][1]),s.element.setAttribute("class","svgSelectW"),s.element.setAttribute("pointer-events","all"),this.svg.events.addListenerTo(s.element,"mouseenter",(()=>{this.lockTool||(this.selectedTool=g.W_RESIZE)})),this.svg.events.addListenerTo(s.element,"mouseleave",(()=>{this.lockTool||(this.selectedTool=null)}))}}if(t.isRotateable){let i=t.getCenterPoint(!1),n=e.x+e.width/2,o=0,a=0,l=0,h=null,d=this.svg.rootEl.createSVGPoint();d.x=this.svg.fixedLeft+this.svg.margin.svgMargins.left,d.y=this.svg.fixedTop+this.svg.margin.svgMargins.top,d=d.matrixTransform(this.svg.transform.getScreenCTM().inverse()),a=d.y+50+10,e.y>a?(o=e.y-this.SELECTCORNERSIZE*this.svg.strokeScale*2,l=e.y,h=g.ROTATE,this.invertedRotation=!1):(o=e.y+e.height+this.SELECTCORNERSIZE*this.svg.strokeScale*2,l=e.y+e.height,h=g.ROTATE_INVERSE,this.invertedRotation=!0);let c=it.createElement("line");c.setAttribute("x1",n),c.setAttribute("y1",o.toString()),c.setAttribute("x2",i.x),c.setAttribute("y2",l),c.setAttribute("class","svgSelect"),r.appendChild(c),c.style.strokeWidth=parseFloat((s*this.svg.strokeScale).toString())+"px";let u=this.svg.icon.createIcon("selectRotateIcon","icon_editor_Rotate","selectGroup",1);this.svg.transform.moveNode(u,n,o),u.element.setAttribute("class","svgSelectRotate"),u.element.setAttribute("pointer-events","all"),this.svg.events.addListenerTo(u.element,"mouseenter",(()=>{this.lockTool||(this.selectedTool=h)})),this.svg.events.addListenerTo(u.element,"mouseleave",(()=>{this.lockTool||(this.selectedTool=null)}))}let o=t.getMenuOptions();return null!=o&&this.createMenu(t,o),t.isSheetBackground||t.type!=d.PART||this.svg.sheet.sheet_type!=E.MODE_SHEET||t.showSize(),r}selectOff(t){t.selectElement=null,this.svg.selected=null,this.selectGroup_.element.style.display="none",this.svg.icon.clearIconsList(),t.onDeSelect(),this.svg.dpi.calcAndCheckDpi(),this.svg.text.specialTextSelection=null,this.svg.trigger(p.DESELECT_NODE,t.type),t.type==d.PART&&this.svg.sheet.sheet_type==E.MODE_SHEET&&t.hideSize()}selectOn(t,e){this.svg.selected=t,(null==t.selectElement||e)&&(e||t.onSelect(),t.selectElement=this.createSelectElement(t),this.selectLayer.addElement(t.selectElement,!0),this.svg.trigger(p.SELECT_NODE,t)),this.svg.dpi.calcAndCheckDpi()}hoverOff(t){null!=t.hoverElement&&(this.selectLayer.removeElement(t.hoverElement),t.hoverElement=null),this.svg.hovered=null,t.type==d.PART&&t.unMarkPath()}hoverOn(t,e=null,i=!1){if(null==t.hoverElement||i)if(i&&this.selectLayer.removeElement(t.hoverElement),t.type==d.PART){t.hoverElement=it.createElement("path"),t.hoverElement.setAttribute("d",t.path),this.selectLayer.addElement(t.hoverElement,!1);let e=10;t.hoverElement.style.cursor="pointer",t.hoverElement.style.pointerEvents="all",t.hoverElement.style.visibility="hidden",t.hoverElement.style.strokeWidth=parseFloat((e*this.svg.strokeScale).toString())+"px",t.markPath(),this.svg.events.addListenerTo(t.hoverElement,"mouseover",(()=>{t.markPath()})),this.svg.events.addListenerTo(t.hoverElement,"mouseout",(()=>{t.unMarkPath()}))}else{t.hoverElement=it.createElement("rect"),t.hoverElement.setAttribute("x",t.boundingBox.x),t.hoverElement.setAttribute("y",t.boundingBox.y),t.hoverElement.setAttribute("width",t.boundingBox.width),t.hoverElement.setAttribute("height",t.boundingBox.height),null!=e?t.hoverElement.setAttribute("class",e):t.hoverElement.setAttribute("class","svgHover"),t.hoverElement.setAttribute("pointer-events","all"),this.selectLayer.addElement(t.hoverElement,!1);let i=1;i=null!=e?parseFloat(this.svg.style.getStyle("."+e,"stroke-width")):parseFloat(this.svg.style.getStyle(".svgHover","stroke-width")),t.hoverElement.style.strokeWidth=parseFloat((i*this.svg.strokeScale).toString())+"px"}t.type==d.SHAPE_PATH&&null!=t.collageObject&&null!=t.collageObject.imageNode&&t.hoverElement.setAttribute("class","svgHover move"),this.svg.hovered=t}onEditorIsTouch(t){this.MENUOFFSETX=this.MENUTOUCHOFFSETX,this.MENUOFFSETY=this.MENUTOUCHOFFSETY,this.MENUOFFSETITEM=this.MENUTOUCHOFFSETITEM,this.MENUPADDING=this.MENUTOUCHPADDING}onEditorSVGCreated(){this.selectLayer=this.svg.node.addNode(new Gt,{id:"selectLayer"}),this.selectLayer.ignore=!0,this.selectLayer.overHandling=l.OVER_NEVER}}class Wt extends yt{clearSheet(){for(var t=this.svg.sheet.parts.length-1;t>=0;t--)this.svg.sheet.parts[t].isDeleteable?this.svg.sheet.parts[t].remove():(this.svg.select.select(null),this.svg.sheet.parts[t].partGroupNode.removeChildren(),null!=this.svg.sheet.parts[t].backGroundNode&&this.svg.sheet.parts[t].setBackground("#FFF"))}getStickerSizes(){var t={};return null!=this.svg.sheet&&(t.heightMM=this.svg.sheet.height,t.widthMM=this.svg.sheet.width,t.widthPX=this.svg.sheet.pathNode.boundingBox.width/this.svg.strokeScale,t.heightPX=this.svg.sheet.pathNode.boundingBox.height/this.svg.strokeScale),t}}class Kt extends yt{mmToDisplayable(t){return this.svg.overridables.mmToDisplayableFn?this.svg.overridables.mmToDisplayableFn(t):(t/10).toFixed(1)+" cm"}evaluatePartSize(t,e,i){let r;if(this.svg.overridables.evaluatePartSizeFn&&(r=this.svg.overridables.evaluatePartSizeFn(t,e,i)),!r){r={widthMM:e,heightMM:i};for(let t in r)r[t]<this.svg.svgSettings.minSizeMM?r[t]=this.svg.svgSettings.minSizeMM:r[t]>this.svg.svgSettings.maxSizeMM&&(r[t]=this.svg.svgSettings.maxSizeMM)}return r}evaluatePartScale(t,e){let i=this.svg.overridables.evaluatePartScaleFn?this.svg.overridables.evaluatePartScaleFn(t,e):null;if(!i){i=e;let r=t.width*i,n=t.height*i;this.isMinSizeReached(t,r,n)&&(i=1),Math.max(r,n)>this.svg.svgSettings.maxSizeMM&&(i=1)}return i}isMinSizeReached(t,e,i){let r=Math.min(e,i);return!t.isSubPart&&r<this.svg.svgSettings.minSizeMM||t.isSubPart&&r<this.svg.svgSettings.subPartMinSizeMM}}class Yt extends yt{changeText(t){let e=Pt.jsonToObject(t);const i=null!=this.svg.selected&&this.svg.selected.type==d.SHAPE_TEXT,r=null!=this.specialTextSelection;i||r?this.updateExistingTextNode(e):this.createNewTextNode(e)}createNewTextNode(t){let e=null,i=!1;if(void 0===t.text||""==t.text)return;if(null==this.svg.activePart){let t=this.svg.sheet.height,e=this.svg.sheet.width;this.svg.activePart=this.svg.node.addNode(new nt,{part_type:d.PART_TYPE_RECT,width:e,height:t}),i=!0}let r={},n=this.svg.rootEl.createSVGPoint();n.x=this.svg.activePart.center.x,n.y=this.svg.activePart.center.y,n=n.matrixTransform(this.svg.activePart.partGroupNode.element.transform.baseVal.getItem(0).matrix.inverse());let s=1*this.svg.activePart.boundingBox.height/this.svg.activePart.partGroupNode.element.transform.baseVal.getItem(0).matrix.d/5;r.left=n.x,r.top=n.y,r.font=void 0===t.font?"ariel":t.font,r.fill=void 0===t.color?"#000000":t.color,r.size=void 0===t.size?s:t.size,r.anchor=void 0===t.align?"middle":t.align,r.text=void 0===t.text?"":t.text,r.id=Math.random().toString().replace(",","").replace(".",""),r.part=this.svg.activePart.id,r.locked=void 0!==t.locked&&t.locked,this.svg.select.select(null),e=this.svg.node.addNode(new rt,r),i&&this.svg.activePart.adaptToContent(),this.svg.svgSettings.zoomMode==c.ZOOM_SHEET?this.specialTextSelection=e:this.svg.select.select(e),this.svg.trigger(p.NEW_TEXT_NODE_ADDED)}updateExistingTextNode(t){var e;let i=null,r=!1;if(i=null!=this.specialTextSelection?this.specialTextSelection:this.svg.selected,i.changeText(t),this.svg.svgSettings.zoomMode==c.ZOOM_PART){if(this.svg.sheet.sheet_type!=E.MODE_SHEET&&(i.boundingBox.width>.8*this.svg.activePart.boundingBox.width||i.boundingBox.height>.8*this.svg.activePart.boundingBox.height)&&void 0!==t.text){let t={},e=.8*this.svg.activePart.boundingBox.width/i.boundingBox.width,r=.8*this.svg.activePart.boundingBox.height/i.boundingBox.height,n=Math.min(e,r);t.size=i.element.getAttribute("font-size")*n,i.changeText(t)}}else{if(i.boundingBox.width>.8*this.svg.sheet.boundingBox.width||i.boundingBox.height>.8*this.svg.sheet.boundingBox.height){let t={},e=.8*this.svg.sheet.boundingBox.width/i.boundingBox.width,r=.8*this.svg.sheet.boundingBox.height/i.boundingBox.height,n=Math.min(e,r);t.size=i.element.getAttribute("font-size")*n,i.changeText(t)}r=!0}i.makeBBoxUpdateList(),r&&(null===(e=this.svg.activePart)||void 0===e||e.adaptToContent()),this.svg.select.reDrawHoverAndSelect()}changeTextColor(t){(null!=this.svg.selected&&this.svg.selected.type==d.SHAPE_TEXT||null!=this.specialTextSelection)&&(null!=this.specialTextSelection?this.specialTextSelection.changeColor(t):this.svg.selected.changeColor(t))}}class Xt extends yt{static get DRAGSENSITIVITYPIXELS(){return 10}constructor(t){super(t),this.isTouch=!1,this.isTouchDown_=!1,this.isDrag_=!1,this.isMaybeDrag_=!1,this.isClick=!1,this.isMaybeMulti_=!1,this.isGesture_=!1,this.isRotate_=!1,this.isZoom_=!1,this.blockClick=!1,this.X_=0,this.Y_=0,this.X1_=0,this.Y1_=0,this.X2_=0,this.Y2_=0,this.XZ1_=0,this.YZ1_=0,this.XZ2_=0,this.YZ2_=0,this.preYDiff_=0,this.preXDiff_=0,this.fingers_=0,this.lPxDiff_=0,this.aPxDiff_=0,this.swapCounter=0,this.eventCheckX=0,this.eventCheckY=0,this.svg.events.addListener("touchstart",(t=>this.onTouchStart(t))),this.svg.events.addListener("touchmove",(t=>this.onTouchMove(t))),this.svg.events.addListener("touchend",(t=>this.onTouchEnd(t))),this.svg.events.addListener("touchcancel",(t=>this.onTouchCancel(t)))}triggerEditorEvent(t,e,i){var r=this.svg.rootEl.createSVGPoint();r.x=e,r.y=i;var n={point:r=r.matrixTransform(this.svg.transMatrixInv),clientX:r.x,clientY:r.y,touch:!0};this.svg.trigger(t,n)}touchUpCheck(t){var e;this.svg.input.resetStartDrag(),this.isMaybeMulti_||this.isGesture_?(this.isGesture_&&this.triggerEditorEvent(p.TOUCH_END,0,0),this.isMaybeMulti_=!1,this.isGesture_=!1,this.isRotate_=!1,this.isZoom_=!1,this.blockClick=!0,setTimeout((()=>this.blockClick=!1),300)):this.isDrag_?(this.isDrag_=!1,this.isClick=!1,this.triggerEditorEvent(p.DRAG_END,this.X_,this.Y_)):this.blockClick||(null===(e=window.getSelection())||void 0===e||e.removeAllRanges(),this.isClick?(this.isClick=!1,this.triggerEditorEvent(p.DOUBLE_CLICK,this.X_,this.Y_)):(this.isClick=!0,this.triggerEditorEvent(p.CLICK,this.X_,this.Y_),setTimeout((()=>this.isClick=!1),300)))}checkIcon(){var t=this.svg.rootEl.createSVGPoint();t.x=this.X_,t.y=this.Y_,t=t.matrixTransform(this.svg.transMatrixInv);var e=this.svg.icon.overIcon(t);if(null!=e)switch(e.id){case"selectRotateIcon":this.svg.select.selectedTool=g.ROTATE;break;case"selectNWIcon":this.svg.select.selectedTool=g.NW_RESIZE;break;case"selectNEIcon":this.svg.select.selectedTool=g.NE_RESIZE;break;case"selectSEIcon":this.svg.select.selectedTool=g.SE_RESIZE;break;case"selectSWIcon":this.svg.select.selectedTool=g.SW_RESIZE;break;case"selectNIcon":this.svg.select.selectedTool=g.N_RESIZE;break;case"selectEIcon":this.svg.select.selectedTool=g.E_RESIZE;break;case"selectSIcon":this.svg.select.selectedTool=g.S_RESIZE;break;case"selectWIcon":this.svg.select.selectedTool=g.W_RESIZE}}calcLengthDiff(t,e){var i=parseInt(t.clientX),r=parseInt(t.clientY),n=parseInt(e.clientX),s=parseInt(e.clientY),o=Math.sqrt(Math.pow(this.XZ2_-this.XZ1_,2)+Math.pow(this.YZ2_-this.YZ1_,2)),a=Math.sqrt(Math.pow(n-i,2)+Math.pow(s-r,2));return this.lPxDiff_=Math.abs(a-o),Math.round(a/o*100)/100}calcAngleDiff(t,e){var i=parseInt(t.clientX),r=parseInt(t.clientY),n=parseInt(e.clientX),s=parseInt(e.clientY),o=n-i,a=s-r,l=Math.atan2(a,o)*(180/Math.PI),h=this.X2_-this.X1_,d=this.Y2_-this.Y1_,c=Math.atan2(d,h)*(180/Math.PI),u=Math.atan2(this.preYDiff_,this.preXDiff_)*(180/Math.PI),p=Math.sqrt(Math.pow(n-i,2)+Math.pow(s-r,2))*Math.PI;return this.aPxDiff_=p*(Math.abs(l-u)/360),this.preXDiff_=n-i,this.preYDiff_=s-r,l-c}getGesture(t,e){var i=this.calcLengthDiff(t,e),r=this.calcAngleDiff(t,e);if(r>5||r<-5?(this.isGesture_=!0,this.isRotate_=!0,this.isZoom_=!1):(i>1.1||i<.9)&&(this.isGesture_=!0,this.isZoom_=!0,this.isRotate_=!1),this.isGesture_){var n=this.svg.rootEl.createSVGPoint();n.x=(this.X1_+this.X2_)/2,n.y=(this.Y1_+this.Y2_)/2,n=n.matrixTransform(this.svg.transMatrixInv),this.svg.trigger(p.TOUCH_START,{point:n,touch:!0})}}onTouchStart(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.isTouch||(this.isTouch=!0,this.svg.trigger(p.IS_TOUCH)),this.fingers_=t.touches.length;var e=t.touches[0];this.X_=e.clientX,this.Y_=e.clientY,this.checkIcon()}onTouchMove(t){if(t.stopPropagation(),t.preventDefault(),(t.touches[0].clientX!=this.eventCheckX||t.touches[0].clientY!=this.eventCheckY)&&!(t.touches[0].clientX<0||t.touches[0].clientY<0))if(this.eventCheckX=t.touches[0].clientX,this.eventCheckY=t.touches[0].clientY,1==this.fingers_){var e=t.touches[0];this.svg.input.setCurrentPointFrom(e),this.X_=e.clientX,this.Y_=e.clientY,this.svg.input.isSuspectingStartDrag?this.isDrag_?this.triggerEditorEvent(p.DRAG_MOVE,this.X_,this.Y_):this.svg.input.shouldConsiderCurrentPointAsDragging()&&(this.isDrag_=!0,this.triggerEditorEvent(p.DRAG_START,this.svg.startDragX,this.svg.startDragY)):this.svg.input.suspectingStartDrag()}else if(2==this.fingers_){var i=t.touches[0],r=t.touches[1];if(i&&r)if(this.isGesture_){var n=this.calcLengthDiff(i,r),s=this.calcAngleDiff(i,r);if(this.XZ1_=parseInt(i.clientX),this.YZ1_=parseInt(i.clientY),this.XZ2_=parseInt(r.clientX),this.YZ2_=parseInt(r.clientY),this.isRotate_&&(this.svg.trigger(p.GESTURE_ROTATE,{angle:s,touch:!0}),this.lPxDiff_>this.aPxDiff_?this.swapCounter++:this.swapCounter=0),this.isZoom_){var o=parseFloat(n.toString());this.svg.trigger(p.GESTURE_ZOOM,{zoom:o,touch:!0}),this.aPxDiff_>this.lPxDiff_?this.swapCounter++:this.swapCounter=0}this.swapCounter>3&&(this.triggerEditorEvent(p.GESTURE_SWAP_TRANSFORM,0,0),this.isRotate_?(this.isRotate_=!1,this.isZoom_=!0):(this.isZoom_=!1,this.isRotate_=!0,this.X1_=parseInt(i.clientX),this.Y1_=parseInt(i.clientY),this.X2_=parseInt(r.clientX),this.Y2_=parseInt(r.clientY)))}else this.isMaybeMulti_?(Math.abs(this.X1_-i.clientX)>Xt.DRAGSENSITIVITYPIXELS||Math.abs(this.Y1_-i.clientY)>Xt.DRAGSENSITIVITYPIXELS||Math.abs(this.X2_-r.clientX)>Xt.DRAGSENSITIVITYPIXELS||Math.abs(this.Y2_-r.clientY)>Xt.DRAGSENSITIVITYPIXELS)&&this.getGesture(i,r):(this.isMaybeMulti_=!0,this.X1_=parseInt(i.clientX),this.Y1_=parseInt(i.clientY),this.X2_=parseInt(r.clientX),this.Y2_=parseInt(r.clientY),this.XZ1_=parseInt(i.clientX),this.YZ1_=parseInt(i.clientY),this.XZ2_=parseInt(r.clientX),this.YZ2_=parseInt(r.clientY),this.preXDiff_=this.X2_-this.X1_,this.preYDiff_=this.Y2_-this.Y1_)}}onTouchEnd(t){this.fingers_=t.touches.length,t.stopPropagation(),t.preventDefault(),this.touchUpCheck(t)}onTouchCancel(t){this.fingers_=0,t.stopPropagation(),t.preventDefault(),this.touchUpCheck(t)}}class Qt extends yt{getInversedMatrixString(t,e){return"matrix("+-Math.abs(t.a)+", "+t.b+","+t.c+","+t.d+","+e+","+t.f+")"}rearrangeChildrenToNewPath(t,e,i){for(let r=0;r<t.length;r++){let n=t[r],s=n.element.getAttribute("id");n.children.length<=1&&s.indexOf("_partGroup")<0&&s.indexOf("PartBackground")<0?this.rearrangeNodeToNewPath(n,e,i):this.rearrangeChildrenToNewPath(n.children,e,i)}}rearrangeNodeToNewPath(t,e,i){if(t.createBBoxAndCenter(),t.getTransformList(),t.type==d.SHAPE_TEXT)return this.rearrangeTextToNewPath(t,e,i);t.children&&1==t.children.length&&"g"==t.svgTag&&this.multiplyMatrixWithParent(t);let r=this.transformStringToMatrix(t.element.getAttribute("transform")),n=this.svg.createSVGMatrix(),s=this.svg.createSVGTransform(),o=Math.atan2(r.b,r.a)*(180/Math.PI),a=t.boundingBox.width,l=t.boundingBox.height,c=t.element.getAttribute("transform");isNaN(o)||0==o||(t.beforeTransform(null),t.transform(h.TRANSFORM_ROTATE,o>0?-o:Math.abs(o),!1),t.createBBoxAndCenter(),c=t.element.getAttribute("transform"),r=this.transformStringToMatrix(t.element.getAttribute("transform")),a=t.boundingBox.width,l=t.boundingBox.height),t.getCenterPoint(!1);let u=r.e+a/2,p=r.f+l/2,g=a/r.a,m=l/r.d,f=a/e.width,v=(e.height,f*i.width/g),b=(i.height,v*g),y=v*m,_=(u-e.x)/e.width,T=(p-e.y)/e.height,x=_*i.width+i.x-b/2,w=T*i.height+i.y-y/2;n.a=v,n.b=r.b*(n.a/r.a),n.c=r.c*(n.a/r.a),n.d=v,n.e=x,n.f=w,s.setMatrix(n),t.element.transform.baseVal.initialize(s),isNaN(o)||0==o||(t.transform(h.TRANSFORM_ROTATE,o,!1),t.afterTransform(!0,h.TRANSFORM_ROTATE))}multiplyMatrixWithParent(t,e,i){if(e||(e=t.children),i||(i=t.element.transform.baseVal.consolidate().matrix),!e||!e.length||e.length>1)return i;for(let r=0;r<e.length;r++){let n=e[r];n.getTransformList();let s=n.element.transform.baseVal.consolidate().matrix;i=i.multiply(s);let o=this.svg.createSVGTransform();o.setMatrix(this.svg.createSVGMatrix()),n.element.transform.baseVal.initialize(o),n.children.length&&(i=this.multiplyMatrixWithParent(t,n.children,i))}let r=this.svg.createSVGTransform();return r.setMatrix(i),t.getTransformList(),t.element.transform.baseVal.initialize(r),i}transformStringToMatrix(t){let e=t.replace(/,/g," ").replace(/\(/g," ").replace(/\)/g,"|").replace(/  /g," ").split("|"),i=this.svg.createSVGMatrix(),r=["matrix","translate","rotate","scale"],n=this.svg.createSVGTransform();for(let t=0;t<e.length;t++){let s=e[t].split(" ");for(let t=0;t<s.length;t++){let e=s[t];if(r.indexOf(e)>=0){let o=[];for(let e=1;t+e<s.length;e++){let i=s[t+e];if(!(r.indexOf(i)<0))break;o.push(i)}switch(e){case"matrix":let t=this.svg.createSVGMatrix();t.a=o[0],t.b=o[1],t.c=o[2],t.d=o[3],t.e=o[4],t.f=o[5],i=i.multiply(t);break;case"rotate":Array.isArray(o)&&1===o.length&&(o=Array(3).fill(o[0])),n.setRotate.apply(n,o),i=i.multiply(n.matrix);break;case"translate":n.setTranslate.apply(n,o),i=i.multiply(n.matrix);break;case"scale":n.setScale.apply(n,o),i=i.multiply(n.matrix)}break}}}return i}rearrangeTextToNewPath(t,e,i){let r=t.center,n=this.transformStringToMatrix(t.element.getAttribute("transform")),s=i.width/e.width,o=(r.x-e.x)/(e.cx-e.x),a=(r.y-e.y)/(e.cy-e.y),l=s*t.element.getAttribute("font-size");t.element.setAttribute("x",i.cx),t.element.setAttribute("y",i.cy),t.changeText({size:l}),t.createBBoxAndCenter();let h=o*(i.cx-i.x)-(t.center.x-i.x)+n.e,d=a*(i.cy-i.y)-(t.center.y-i.y)+n.f,c=this.svg.createSVGMatrix(),u=this.svg.createSVGTransform();c.a=n.a,c.b=n.b,c.c=n.c,c.d=n.d,c.e=n.e,c.f=n.f,c.e=h,c.f=d,u.setMatrix(c),t.element.transform.baseVal.initialize(u)}getScreenCTM(){let t=this.svg.rootEl.getScreenCTM();return t||(t=this.svg.createSVGMatrix()),t}createSVGTransform(){return this.svg.createSVGTransform()}createSVGMatrix(){return this.svg.createSVGMatrix()}rotateSnap(t,e){let i=this.svg.selected.getBaseTransformationMatrix(),r=Math.atan2(i.b,i.a)*(180/Math.PI),n=r+t;return n>180&&(n=n-180-180),n<-180&&(n=180+(n+180)),n>0-e&&n<0+e&&(t=0-r),n>90-e&&n<90+e&&(t=90-r),n>-90-e&&n<-90+e&&(t=-90-r),(n>180-e||n<-180+e)&&(t=180-r),t}fitAndCenter(t,e){this.fit(t,e),this.center(t)}centerHorOrVer(t,e=!1,i=!1,r=!1,n=!1){let s,o=t.getCenterPoint(!1);if(s=i?this.svg.sheet.getCenterPoint(!1):t.getPart().getCenterPoint(!0),n){let e=this.svg.path.toBoundingBox(t.getPart().bleed),i=this.svg.rootEl.createSVGPoint();i.x=e.x+(e.x2-e.x)/2,i.y=e.y+(e.y2-e.y)/2,s=i}r&&null!=t.collageObject&&(s=this.svg.rootEl.createSVGPoint(),s.x=t.collageObject.path.center.x,s.y=t.collageObject.path.center.y),t.beforeTransform(null,!0),e?t.transform(h.TRANSFORM_MOVE,0,s.y-o.y,0,0,0,0,!0):t.transform(h.TRANSFORM_MOVE,s.x-o.x,0,0,0,0,0,!0),t.afterTransform(!0)}center(t,e=null,i=null,r=null){e=void 0===e?null:e,i=void 0===i?null:i,r=void 0!==r&&r;let n,s=t.getCenterPoint(!1);null==e||null==i?n=r?t.getPart().getCenterPoint(!0):this.svg.sheet.getCenterPoint(!1):(n=this.svg.rootEl.createSVGPoint(),n.x=e,n.y=i),t.beforeTransform(null,!0),t.transform(h.TRANSFORM_MOVE,n.x-s.x,n.y-s.y,0,0,0,0,!0),t.afterTransform(!0)}fit(t,e=null,i=null,r=null,n=null,s=null){e=void 0===e?1:e,s=void 0!==(n=void 0!==n&&n)&&s,r=void 0!==r&&r;let o=1,a=1;(i=void 0!==i&&i)?(o=t.getPart().boundingBox.width/t.boundingBox.width,a=t.getPart().boundingBox.height/t.boundingBox.height,s&&null!=t.getPart().bleedPathNode&&(o=t.getPart().bleedPathNode.boundingBox.width/t.boundingBox.width,a=t.getPart().bleedPathNode.boundingBox.height/t.boundingBox.height)):(o=this.svg.sheet.boundingBox.width/t.boundingBox.width,a=this.svg.sheet.boundingBox.height/t.boundingBox.height);let l=1;return l=r?Math.max(o,a)*e:Math.min(o,a)*e,(l<1||n)&&(t.beforeTransform(null,!0),t.transform(h.TRANSFORM_SCALE,"uni",l,0,0,0,0,!0),t.afterTransform(!0)),l}fitAndCenterOnPart(t,e=null){if(null!=(e=void 0===e?null:e))this.fit(t,e,!0),this.center(t,null,null,!0);else{let e=null;if(null!=t.getPart().bleed)e=this.svg.path.toBoundingBox(t.getPart().bleed);else{let i=2*this.svg.svgSettings.px2mm,r=t.getPart().path;e=this.svg.path.toBoundingBox(r),e.x-=i,e.y-=i,e.x2+=i,e.y2+=i,e.width+=2*i,e.height+=2*i}let i=e.width/e.height,r=t.boundingBox.width/t.boundingBox.height,n=!1;Math.abs(i-r)<.33&&(n=!0);let s=1/(t.boundingBox.height/e.height),o=1/(t.boundingBox.width/e.width),a=1;a=n?Math.max(s,o):Math.min(s,o),t.beforeTransform(null,!0),t.transform(h.TRANSFORM_SCALE,"uni",a,0,0,0,0,!0),t.afterTransform(!0);let l=t.getCenterPoint(!1),d=0,c=0;if(void 0!==t.getPart().options.matrix){let i=this.transformStringToMatrix(t.getPart().options.matrix);d=e.cx-i.e-l.x,c=e.cy-i.f-l.y}else d=e.cx-l.x,c=e.cy-l.y;t.beforeTransform(null,!0),t.transform(h.TRANSFORM_MOVE,d,c,0,0,0,0,!0),t.afterTransform(!0)}}updateNodeAfterTransformation(t,e=null,i=null){return null!=t&&t.afterTransform(!1,e,i)}updateNodeBeforeTransformation(t,e){return null!=t&&t.beforeTransform(e)}scaleNodeAll(t,e){return null!=t&&t.transform(h.TRANSFORM_SCALE,"center",e)}rotateNode(t,e,i=!0){return null!=t&&t.transform(h.TRANSFORM_ROTATE,e,i)}scaleNode(t,e,i,r){return null!=t&&t.transform(h.TRANSFORM_SCALE,e,i,r)}moveNode(t,e,i){return null!=t&&t.transform(h.TRANSFORM_MOVE,e,i)}}class Jt extends yt{constructor(){super(...arguments),this._changeModeBusy=!1}isBusy(){return this._changeModeBusy}zoomOut(){this.svg.svgSettings.zoomMode==c.ZOOM_PART&&this.changeMode(c.ZOOM_SHEET)}isZoomed(){return this.svg.svgSettings.zoomMode==c.ZOOM_PART}changeMode(t,e=null,i){var r;this.isBusy()&&(clearTimeout(this._zoomViewBoxStepTimeOut),this._zoomViewBoxEndCallback&&this._zoomViewBoxEndCallback()),this._changeModeBusy=!0,i=void 0===i?this.svg.svgSettings.noZoom:i;let n=!1;if(t==this.svg.svgSettings.zoomMode&&(n=!0),t==c.ZOOM_PART&&e&&e.type==d.PART&&!e.isEditable)return;this.svg.select.select(null),this.svg.select.hover(null),this.svg.svgSettings.zoomMode=t;let s=this.svg.svgSettings.zoomSteps,o=this.svg.svgSettings.zoomDelay;i&&(s=1,o=1);let a=!!this.svg.activePart&&this.svg.activePart!=e;if(this.svg.filters.disableDropShadow(),t==c.ZOOM_SHEET){this.svg.sheet.isCustomizableSheet&&!e&&this.svg.part.isBackSideActive()&&(s=o=1),null===(r=this.svg.activePart)||void 0===r||r.deactivate(),this.svg.activePart=e;const t=()=>{for(let t=0;t<this.svg.sheet.parts.length;t++){let e;e=this.svg.activePart?this.svg.sheet.parts[t].intId!=this.svg.activePart.intId:"back"==this.svg.sheet.parts[t].side,e?this.svg.sheet.parts[t].hidePart(l.OVER_NEVER):this.svg.sheet.parts[t].showPart(l.OVER_BBOX)}};n&&t(),this.zoomViewBox(this.svg.root.getSheetViewBox(),null,s,o,(()=>{this.svg.shadow.clear(),n||t(),this.svg.trigger(p.RESIZE),this.svg.root.makeBBoxUpdateList(),this.svg.filters.enableDropShadow(),this.svg.preview.updatePreview(),this.svg.shadow.updateShadow()}))}else if(t==c.ZOOM_PART){this.svg.activePart&&this.svg.activePart.deactivate(),this.svg.activePart=e;for(let t=0;t<this.svg.sheet.parts.length;t++){let e=!0;this.svg.sheet.isCustomizableSheet&&!this.svg.part.getActivePartSide()&&(e=!this.svg.sheet.parts[t].isSheetBackground),this.svg.sheet.parts[t].intId!=this.svg.activePart.intId&&e?this.svg.sheet.parts[t].hidePart():this.svg.sheet.parts[t].showPart()}this.performZoomIfBoundingBoxExist(e,s,o)}else this._changeModeBusy=!1;n||this.svg.trigger(p.ZOOM_CHANGE,{zoomMode:this.svg.svgSettings.zoomMode}),this.svg.preview.updatePreview(),this.svg.shadow.updateShadow(),this.svg.trigger(p.SVG_CHANGE_MODE,{zoomMode:t,node:e,noZoom:i,change:!n,partChanged:a})}performZoomIfBoundingBoxExist(t,e,i){if(t&&t.boundingBox){let r=t.boundingBox.x+" "+t.boundingBox.y+" "+t.boundingBox.width+" "+t.boundingBox.height;this.svg.root.viewBoxNoMargin=r,r=this.svg.margin.addMarginToViewBox(r),this.svg.sheet.isCustomizableSheet&&this.svg.part.getActivePartSide()&&(e=i=1,r=this.svg.root.getSheetViewBox()),this.zoomViewBox(r,null,e,i,(()=>{t.activate(),this.svg.trigger(p.RESIZE),this.svg.root.makeBBoxUpdateList(),this.svg.filters.enableDropShadow(),this.svg.preview.updatePreview(),this.svg.shadow.updateShadow()}))}}zoomViewBox(t,e,i,r,n){let s=this.svg.root.getViewBox().split(" "),o=t.split(" "),a=(o[0]-s[0])/i,l=(o[1]-s[1])/i,h=(o[2]-s[2])/i,d=(o[3]-s[3])/i;this.zoomViewBoxStep(a,l,h,d,0,i,r,n)}zoomViewBoxStep(t,e,i,r,n,s,o,a){let l=this.svg.root.getViewBox().split(" "),h=parseFloat(l[0])+parseFloat(t)+" "+(parseFloat(l[1])+parseFloat(e))+" "+(parseFloat(l[2])+parseFloat(i))+" "+(parseFloat(l[3])+parseFloat(r));if(this.svg.rootEl.setAttribute("viewBox",h),0==--s)return this._changeModeBusy=!1,a(),void this.svg.trigger(p.ZOOM_ANIMATION_END);this._zoomViewBoxEndCallback=a,this._zoomViewBoxStepTimeOut=setTimeout((()=>{this.zoomViewBoxStep(t,e,i,r,n,s,o,a)}),o)}}class te extends Dt{constructor(){super(d.DEFS,"defs")}onElementCreated(t=null){this.options.id&&this.element.setAttribute("id",this.options.id),super.onElementCreated(t)}}class ee{constructor(t){this.svg=t,this.dropShadow=null,this.fakeDropShadow=null,this.backgroundPattern=null,this.backSidePrintDealPattern=null,this.lineWidthScale_=1,this.patternWidth=1,this.patternHeight=1,this.dealpatternWidth=1,this.dealpatternHeight=1,this.svg.events.addListener(p.RESIZE,(()=>{null!=this.dropShadow&&this.updateDropShadow(),null!=this.backgroundPattern&&this.UpdatePattern()})),this.svg.events.addListener(p.NODE_TRANSFORMED,(()=>this.updateDropShadow()))}createFilters(){this.dropShadow=this.CreateDropShadow()}CreateFakeDropShadow(){let t=it.createElement("linearGradient");t.setAttribute("id","gradient_1"),t.setAttribute("x1","0%"),t.setAttribute("y1","0%"),t.setAttribute("x2","100%"),t.setAttribute("y2","0%");let e=it.createElement("stop");e.setAttribute("offset","0%"),e.setAttribute("style","stop-color:rgb(f,f,f);stop-opacity:0");let i=it.createElement("stop");i.setAttribute("offset","4%"),i.setAttribute("style","stop-color:rgb(0,0,0);stop-opacity:1");let r=it.createElement("stop");r.setAttribute("offset","96%"),r.setAttribute("style","stop-color:rgb(0,0,0);stop-opacity:1");let n=it.createElement("stop");n.setAttribute("offset","100%"),n.setAttribute("style","stop-color:rgb(f,f,f);stop-opacity:0"),t.appendChild(e),t.appendChild(i),t.appendChild(r),t.appendChild(n),this.svg.defs.element.appendChild(t);let s=it.createElement("linearGradient");s.setAttribute("id","gradient_2"),s.setAttribute("x1","0%"),s.setAttribute("y1","0%"),s.setAttribute("x2","0%"),s.setAttribute("y2","100%");let o=it.createElement("stop");o.setAttribute("offset","0%"),o.setAttribute("style","stop-color:rgb(f,f,f);stop-opacity:0");let a=it.createElement("stop");a.setAttribute("offset","4%"),a.setAttribute("style","stop-color:rgb(0,0,0);stop-opacity:1");let l=it.createElement("stop");l.setAttribute("offset","96%"),l.setAttribute("style","stop-color:rgb(0,0,0);stop-opacity:1");let h=it.createElement("stop");return h.setAttribute("offset","100%"),h.setAttribute("style","stop-color:rgb(f,f,f);stop-opacity:0"),s.appendChild(o),s.appendChild(a),s.appendChild(l),s.appendChild(h),this.svg.defs.element.appendChild(s),t}CreateDropShadow(){let t=it.createElement("filter");t.setAttribute("id","drop_shadow"),t.setAttribute("x","-50%"),t.setAttribute("y","-50%"),t.setAttribute("width","200%"),t.setAttribute("height","200%"),t.setAttribute("filterRes",Math.max(window.innerWidth,window.innerHeight).toString());let e=it.createElement("feOffset");e.setAttribute("result","offOut"),e.setAttribute("in","SourceAlpha"),e.setAttribute("dx","2"),e.setAttribute("dy","2");let i=it.createElement("feGaussianBlur");i.setAttribute("result","blurOut"),i.setAttribute("in","offOut"),i.setAttribute("stdDeviation","2");let r=it.createElement("feColorMatrix");r.setAttribute("result","matrixOut"),r.setAttribute("in","blurOut"),r.setAttribute("type","matrix"),r.setAttribute("values","1 0 0 0 0.2, 0 1 0 0 0.2, 0 0 1 0 0.2, 0 0 0 0.5 0");let n=it.createElement("feBlend");return this.svg.svgSettings.mode==E.MODE_SINGLE?(n.setAttribute("in","SourceGraphic"),n.setAttribute("in2","matrixOut"),n.setAttribute("mode","normal")):(n.setAttribute("in","SourceGraphic"),n.setAttribute("in2","blurOut"),n.setAttribute("mode","normal")),t.appendChild(e),t.feOffset=e,t.appendChild(i),t.feGaussianBlur=i,t.appendChild(r),t.feColorMatrix=r,t.appendChild(n),t.feBlend=n,this.svg.defs.element.appendChild(t),t}CreateBackgroundPattern(t,e,i){this.patternWidth=i,this.patternHeight=i,this.calcLinePathWidthScale();let r=2*this.patternWidth*this.svg.px2mm*this.lineWidthScale_+"px",n=2*this.patternHeight*this.svg.px2mm*this.lineWidthScale_+"px",s=this.patternWidth*this.svg.px2mm*this.lineWidthScale_+"px",o=this.patternHeight*this.svg.px2mm*this.lineWidthScale_+"px";this.backgroundPattern=it.createElement("pattern"),this.backgroundPattern.setAttribute("id",this.svg.id+"-BackgroundPattern"),this.backgroundPattern.setAttribute("shape-rendering","crispEdges"),this.backgroundPattern.setAttribute("patternUnits","userSpaceOnUse"),this.backgroundPattern.setAttribute("x","0px"),this.backgroundPattern.setAttribute("y","0px"),this.backgroundPattern.setAttribute("width",r),this.backgroundPattern.setAttribute("height",n);let a=it.createElement("rect");a.setAttribute("id",this.svg.id+"-BackgroundPatternRect1"),a.setAttribute("shape-rendering","crispEdges"),a.setAttribute("x","0px"),a.setAttribute("y","0px"),a.setAttribute("width",r),a.setAttribute("height",n),a.setAttribute("fill",t),this.backgroundPattern.appendChild(a);let l=it.createElement("rect");l.setAttribute("id",this.svg.id+"-BackgroundPatternRect2"),l.setAttribute("shape-rendering","crispEdges"),l.setAttribute("x","0px"),l.setAttribute("y","0px"),l.setAttribute("width",s),l.setAttribute("height",o),l.setAttribute("fill",e),this.backgroundPattern.appendChild(l);let h=it.createElement("rect");h.setAttribute("id",this.svg.id+"-BackgroundPatternRect3"),h.setAttribute("shape-rendering","crispEdges"),h.setAttribute("x",s),h.setAttribute("y",o),h.setAttribute("width",s),h.setAttribute("height",o),h.setAttribute("fill",e),this.backgroundPattern.appendChild(h),this.svg.defs.element.appendChild(this.backgroundPattern)}CreateBackgroundImage(t,e,i){this.patternWidth=e,this.patternHeight=i,this.calcLinePathWidthScale();let r=2*this.patternWidth*this.svg.px2mm*this.lineWidthScale_+"px",n=2*this.patternHeight*this.svg.px2mm*this.lineWidthScale_+"px";this.patternWidth,this.svg.px2mm,this.lineWidthScale_,this.patternHeight,this.svg.px2mm,this.lineWidthScale_,this.backgroundPattern=it.createElement("pattern"),this.backgroundPattern.setAttribute("id",this.svg.id+"-BackgroundPattern"),this.backgroundPattern.setAttribute("patternUnits","userSpaceOnUse"),this.backgroundPattern.setAttribute("x","0px"),this.backgroundPattern.setAttribute("y","0px"),this.backgroundPattern.setAttribute("width",r),this.backgroundPattern.setAttribute("height",n);let s=it.createElement("image");s.setAttribute("id",this.svg.id+"-BackgroundPatternImage"),s.setAttribute("x","0px"),s.setAttribute("y","0px"),s.setAttribute("width",r),s.setAttribute("height",n),s.setAttributeNS(u.XLINK,"href",t),this.backgroundPattern.appendChild(s),this.svg.defs.element.appendChild(this.backgroundPattern)}CreateBackgroundImageForBackprintDeal(t,e,i){this.dealpatternWidth=e,this.dealpatternHeight=i;let r=this.dealpatternWidth+"px",n=this.dealpatternHeight+"px";this.backSidePrintDealPattern=it.createElement("pattern"),this.backSidePrintDealPattern.setAttribute("id",this.svg.id+"-BackPrintDealPattern"),this.backSidePrintDealPattern.setAttribute("patternUnits","userSpaceOnUse"),this.backSidePrintDealPattern.setAttribute("x","0px"),this.backSidePrintDealPattern.setAttribute("y","0px"),this.backSidePrintDealPattern.setAttribute("width",r),this.backSidePrintDealPattern.setAttribute("height",n),this.backSidePrintDealPattern.setAttribute("patternTransform","rotate(-10)");let s=it.createElement("image");s.setAttribute("id",this.svg.id+"-BackPrintDealPattern"),s.setAttribute("x","0px"),s.setAttribute("y","0px"),s.setAttribute("width",r),s.setAttribute("height",n),s.setAttributeNS(u.XLINK,"href",t),this.backSidePrintDealPattern.appendChild(s),this.svg.defs.element.appendChild(this.backSidePrintDealPattern)}UpdatePattern(){var t,e,i,r,n,s,o,a,l,h,d,c;this.calcLinePathWidthScale();let u=2*this.patternWidth*this.svg.px2mm*this.lineWidthScale_+"px",p=2*this.patternHeight*this.svg.px2mm*this.lineWidthScale_+"px",g=this.patternWidth*this.svg.px2mm*this.lineWidthScale_+"px",m=this.patternHeight*this.svg.px2mm*this.lineWidthScale_+"px";null===(t=document.querySelector("#"+this.svg.id+"-BackgroundPattern"))||void 0===t||t.setAttribute("width",u),null===(e=document.querySelector("#"+this.svg.id+"-BackgroundPattern"))||void 0===e||e.setAttribute("height",p),null===(i=document.querySelector("#"+this.svg.id+"-BackgroundPatternRect1"))||void 0===i||i.setAttribute("width",u),null===(r=document.querySelector("#"+this.svg.id+"-BackgroundPatternRect1"))||void 0===r||r.setAttribute("height",p),null===(n=document.querySelector("#"+this.svg.id+"-BackgroundPatternRect2"))||void 0===n||n.setAttribute("width",g),null===(s=document.querySelector("#"+this.svg.id+"-BackgroundPatternRect2"))||void 0===s||s.setAttribute("height",m),null===(o=document.querySelector("#"+this.svg.id+"-BackgroundPatternRect3"))||void 0===o||o.setAttribute("x",g),null===(a=document.querySelector("#"+this.svg.id+"-BackgroundPatternRect3"))||void 0===a||a.setAttribute("y",m),null===(l=document.querySelector("#"+this.svg.id+"-BackgroundPatternRect3"))||void 0===l||l.setAttribute("width",g),null===(h=document.querySelector("#"+this.svg.id+"-BackgroundPatternRect3"))||void 0===h||h.setAttribute("height",m),null===(d=document.querySelector("#"+this.svg.id+"-BackgroundPatternImage"))||void 0===d||d.setAttribute("width",u),null===(c=document.querySelector("#"+this.svg.id+"-BackgroundPatternImage"))||void 0===c||c.setAttribute("height",p)}updateDropShadow(){if(null!=this.dropShadow){let t=Math.max(this.svg.sheet.width,this.svg.sheet.height)*this.svg.px2mm/100,e=.5;this.svg.svgSettings.mode,E.MODE_SHEET,this.dropShadow.feOffset.setAttribute("dx",2),this.dropShadow.feOffset.setAttribute("dy",2),this.dropShadow.feGaussianBlur.setAttribute("stdDeviation",t*e)}}disableDropShadow(){this.dropShadow&&(this.svg.svgSettings.mode!=E.MODE_SHEET&&this.svg.svgSettings.mode!=E.MODE_SINGLE||this.dropShadow.setAttribute("style","display : none"))}enableDropShadow(){this.dropShadow&&(this.svg.svgSettings.mode!=E.MODE_SHEET&&this.svg.svgSettings.mode!=E.MODE_SINGLE||this.dropShadow.setAttribute("style","display : inline"))}calcLinePathWidthScale(){let t=this.svg.rootEl.viewBox.baseVal.height,e=this.svg.rootEl.viewBox.baseVal.width,i=this.svg.container.clientHeight,r=this.svg.container.clientWidth;r<1&&(r=1),i<1&&(i=1);let n=i/t,s=r/e,o=this.svg.sheet.getTransformationMatrix(),a=Math.sqrt(Math.pow(o.a,2)+Math.pow(o.b,2)),l=Math.sqrt(Math.pow(o.c,2)+Math.pow(o.d,2));this.lineWidthScale_=1/Math.min(n*a,s*l)}}class ie extends Dt{constructor(){super(d.LAYER_SHADOW,"g"),this.isClickThrough=!0,this.isSelectable=!1,this.isOverable=!1,this.overHandling=l.OVER_IGNORE}onElementCreated(t){this.options.id&&this.element.setAttribute("id",this.options.id),super.onElementCreated(t)}onInit(){this.svg.events.addListener(p.RESIZE,(()=>{this.updateShadow()})),this.svg.events.addListenerTo(window,"resize",(()=>{this.updateShadow()}))}updateShadow(t=null){if(null!=this.overlayPath){if(this.svg.preview.isPreviewModeOn&&this.svg.svgSettings.mode!=E.MODE_SHEET)return void(this.overlayPath.element.style.display="none");this.overlayPath.element.style.display="block"}let e=this.getShadowPath(10);if(null==t){if(this.svg.svgSettings.mode==E.MODE_SKIN&&(e+=" "+this.transformPathNode(this.svg.activePart)),this.svg.svgSettings.mode==E.MODE_SHEET)if(this.svg.svgSettings.zoomMode==c.ZOOM_SHEET)e+=" "+this.transformPathNode(this.svg.sheet.pathNode);else{let t=!this.svg.activePart.isSheetBackground&&null!=this.svg.activePart.bleed;e+=" "+this.transformPathNode(this.svg.activePart,t)}this.svg.svgSettings.mode==E.MODE_CASE&&(e+=" "+this.transformPathNode(this.svg.activePart)),this.svg.svgSettings.mode==E.MODE_SINGLE&&(e+=" "+this.transformPathNode(this.svg.activePart))}else e+=" "+t;null==this.overlayPath?(this.overlayPath=this.svg.node.addNode(new J,{d:e,"fill-rule":"evenodd",parentIntId:this.intId,class:"svgShadowOverlay"}),this.overlayPath.ignore=!0,this.overlayPath.overHandling=l.OVER_IGNORE):this.overlayPath.element.setAttribute("d",e)}transformPathNode(t=null,e=!1){if(null==t)return"";if(!t.tempTransform)return"";let i=t.tempTransform.matrix,r=t.orgPath;return("bleed"==this.svg.fadePathId||e)&&(r=t.bleed),this.svg.path.transformByMatrix(r,i).toString()}addCollage(t){null!=this.collageShadow&&this.collageShadow.remove();let e=this.getShadowPath(10);e+=" "+t.path.orgPath,this.collageShadow=this.svg.node.addNode(new J,{d:e,parentIntId:this.intId,class:"svgCollageShadowOverlay"}),this.collageShadow.ignore=!0,this.collageShadow.overHandling=l.OVER_IGNORE}removeCollage(){null!=this.collageShadow&&this.collageShadow.remove(),this.collageShadow=null}getShadowPath(t=0){let e=this.svg.rootEl.createSVGPoint();e.x=this.svg.fixedLeft,e.y=this.svg.fixedTop,e=e.matrixTransform(this.svg.transform.getScreenCTM().inverse()),e.x-=t,e.y-=t;let i=this.svg.rootEl.createSVGPoint();return i.x=this.svg.fixedLeft+this.svg.container.offsetWidth,i.y=this.svg.fixedTop+this.svg.container.offsetHeight,i=i.matrixTransform(this.svg.transform.getScreenCTM().inverse()),i.x+=t,i.y+=t,"M "+e.x+" "+e.y+" L "+e.x+" "+i.y+" L "+i.x+" "+i.y+" L "+i.x+" "+e.y+" z"}clear(){}}class re extends y{constructor(){super(d.LAYER_SHEET,"path"),this.parts=[],this.shadow=null,this.width=0,this.height=0,this.sheet_meta=null,this.bottomTextNode=null,this.topTextNode=null,this.leftTextNode=null,this.rightTextNode=null,this.pathNode=null,this.shadowPathNode1=null,this.shadowPathNode2=null,this.shadowPathNode3=null,this.shadowPathNode4=null,this.backgroundPattern=null,this.backgroundPatternLight=null,this.backgroundPatternDark=null,this.backgroundPatternSize=null,this.backgroundPatternHref=null,this.backgroundPatternWidth=null,this.backgroundPatternHeight=null,this.backprintDealSettings=null,this.isCustomizableSheet=null,this.isClickThrough=!0,this.isSelectable=!1,this.isOverable=!1,this.isTransformable=!1,this.isResizeable=!1,this.isRotateable=!1,this.isSkewable=!1,this.isMoveable=!1,this.ignore=!0,this.overHandling=l.OVER_IGNORE,this.path=null}onElementCreated(t=null){let e=this.options.json;e.width&&(this.width=parseFloat(e.width)),e.height&&(this.height=parseFloat(e.height)),this.sheet_type=e.sheet_type,this.isCustomizableSheet=e.isCustomizableSheet,e.backgroundPattern&&(this.backgroundPattern=e.backgroundPattern,this.backgroundPatternLight=e.backgroundPatternLight,this.backgroundPatternDark=e.backgroundPatternDark,this.backgroundPatternSize=e.backgroundPatternSize,this.backgroundPatternWidth=e.backgroundPatternWidth,this.backgroundPatternHeight=e.backgroundPatternHeight,this.backgroundPatternHref=e.backgroundPatternHref),e.meta&&(this.sheet_meta=e.meta),e.backprintDealSettings&&(this.backprintDealSettings=e.backprintDealSettings);let i="svgSheet "+this.getSvgSheetClass();this.element.setAttribute("class",i),this.id="sheet",super.onElementCreated(t)}onElementCreatedStep2(t){let e="svgSheetPath "+this.getSvgSheetClass();this.pathNode=this.svg.node.addNode(new J,{parentIntId:t.intId,class:e,d:this.sheetPath()}),this.pathNode.ignore=!0,this.pathNode.overHandling=l.OVER_IGNORE,this.createBBoxAndCenter(),"square"==this.backgroundPattern&&this.svg.filters.CreateBackgroundPattern(this.backgroundPatternLight,this.backgroundPatternDark,this.backgroundPatternSize),"image"==this.backgroundPattern&&this.svg.filters.CreateBackgroundImage(this.backgroundPatternHref,this.backgroundPatternWidth,this.backgroundPatternHeight)}createBBoxAndCenter(){this.boundingBox=this.svg.rootEl.createSVGRect(),this.boundingBox.width=this.width*this.svg.px2mm,this.boundingBox.height=this.height*this.svg.px2mm,this.boundingBox.x=0,this.boundingBox.y=0,this.center=this.svg.rootEl.createSVGPoint(),this.center.x=this.boundingBox.width/2,this.center.y=this.boundingBox.height/2,this.element.setAttribute("d",this.sheetPath()),null!=this.pathNode&&this.pathNode.element.setAttribute("d",this.sheetPath())}sheetPath(){return"M 0 0 L 0 "+this.boundingBox.height+" L "+this.boundingBox.width+" "+this.boundingBox.height+" L "+this.boundingBox.width+" 0 z"}addPart(t,e=-1){t.isSubPart=!0,-1==e?this.parts.splice(0,0,t):this.parts.splice(e,0,t)}addDropShadow(){this.element.setAttribute("filter","url(#drop_shadow)")}removeDropShadow(){this.element.removeAttribute("filter")}showSize(){let t=this.getBaseTransformationMatrix(),e=this.boundingBox,i=this.svg.svgSettings.fontSize*this.svg.strokeScale,r=i,n=this.svg.rootEl.createSVGPoint();n.x=e.x,n.x||(n.x=1),n.y=e.y,n.y||(n.y=1),n=n.matrixTransform(t);let s=this.svg.rootEl.createSVGPoint();s.x=e.x+e.width,s.x||(s.x=1),s.y=e.y+e.height,s.y||(s.y=1),s=s.matrixTransform(t);let o=[];o.parentId="infoLayer",o.left=this.boundingBox.width/2,o.top=s.y+r+i/2,o.size=i,o.anchor="middle",o.text=this.svg.size.mmToDisplayable(this.width),o.class="svgPartSizeText",this.bottomTextNode?(this.bottomTextNode.options=o,this.bottomTextNode.onElementCreated()):(this.bottomTextNode=this.svg.node.addNode(new rt,o),this.bottomTextNode.overHandling=l.OVER_NEVER),o.left=0-r,o.top=this.boundingBox.height/2,o.text=this.svg.size.mmToDisplayable(this.height),o.transform="rotate(-90 "+-r/2+","+(o.top-r/2)+") translate(0,"+-r/2+")",this.leftTextNode?(this.leftTextNode.options=o,this.leftTextNode.onElementCreated()):(this.leftTextNode=this.svg.node.addNode(new rt,o),this.leftTextNode.overHandling=l.OVER_NEVER)}updateSize(){this.showSize()}updatePartsOrder(){if(this.parts.length>1){this.updateSheetBackgroundOrder();for(let t=this.parts.length-1;t>=0;t--){this.parts[t].element.parentNode.insertBefore(this.parts[t].element,this.svg.node.getNodeById("shadowLayer").element);let e=this.svg.node.getNodeById("shadowLayer");this.parent.children.splice(this.parts[t].parentIndex,1),this.parent.children.splice(e.parentIndex+1,0,this.parts[t]),this.parent.updateChildrensParentIndex()}for(let t=this.parts.length-1;t>=0;t--)null!=this.parts[t].pathNode&&this.svg.node.getNodeById("partPathLayer").element.appendChild(this.parts[t].pathNode.element)}}updateSheetBackgroundOrder(){for(let t=0;t<this.parts.length;t++)if(this.parts[t].isSheetBackground){this.parts.push(this.parts[t]),this.parts.splice(t,1);break}}getSvgSheetClass(){return this.svg.svgSettings.mode==E.MODE_SHEET?"sheet":"single"}}class ne extends yt{constructor(t){super(t),this.classes=null,this.cache=new Map;for(let t=0;t<document.styleSheets.length;t++)if("svg"==document.styleSheets[t].title){this.classes=document.styleSheets[t].cssRules;break}}getStyle(t,e){if(this.classes){let i=t+":"+e;if(this.cache.has(i))return this.cache.get(i);let r=null;for(let i=0;i<this.classes.length;i++){let n=this.classes.item(i);if(n.selectorText==t){r=n.style.getPropertyValue(e);break}}return this.cache.set(i,r),r}return null}}class se{get built(){return this._built}get transMatrix(){return this._transMatrix}get transMatrixInv(){return this._transMatrixInv}get strokeScale(){return this._strokeScale}constructor(t,e,i,r){this._container=t,this.id=e,this.svgSettings=i,this.runBBox=!0,this.noOnSelect=!1,this.startDragX=0,this.startDragY=0,this.root=null,this.defs=null,this.sheet=null,this.shadow=null,this.infoLayer=null,this.defaultParentNode=null,this.selected=null,this.hovered=null,this.activePart=null,this.collage=null,this.filters=null,this.multiArr=[],this.isInFocus=!1,this._built=!1,this.buildParts=[],this.registerEvents(),this.node=new Rt(this),this.part=new Vt(this),this.zoomHelper=new Jt(this),this.transform=new Qt(this),this.select=new Zt(this),this.icon=new At(this),this.text=new Yt(this),this.margin=new Nt(this),this.sheetHelper=new Wt(this),this.preview=new Ut(this),this.input=new It(this),this.mouse=new Lt(this),this.keyboard=new kt(this),this.touch=new Xt(this),this.dpi=new _t(this),this.import=new Ct(this),this.export=new Tt(this),this.outline=new jt(this),this.path=new zt(this),this.size=new Kt(this),this.style=new ne(this),this.overridables=new H,this.livePreviewEnabled=r}registerEvents(){this.events=new U(this),this.events.addListener(p.RESIZE,(()=>this.refreshMatrixes())),this.events.addListener(p.SVG_CREATED,(()=>this.refreshMatrixes())),this.events.registerHandler(p.CLICK,new ht),this.events.registerHandler(p.DOUBLE_CLICK,new dt),this.events.registerHandler(p.DRAG_START,new pt),this.events.registerHandler(p.DRAG_MOVE,new ut),this.events.registerHandler(p.DRAG_END,new ct),this.events.registerHandler(p.MOUSE_MOVE,new mt),this.events.registerHandler(p.MOUSE_LEAVE,new gt),this.events.registerHandler(p.TOUCH_START,new vt),this.events.registerHandler(p.GESTURE_ROTATE,new G),this.events.registerHandler(p.GESTURE_ZOOM,new W),this.events.registerHandler(p.TOUCH_END,new ft),this.events.registerHandler(p.GESTURE_SWAP_TRANSFORM,new Z),this.events.registerHandler(p.SVG_CREATED,new ot),this.events.registerHandler(p.SVG_PART_LOADED,new lt),this.events.registerHandler(p.SVG_ALL_PARTS_LOADED,new Y),this.events.registerHandler(p.NODE_CREATED,new K),this.events.registerHandler(p.SVG_PART_ASPECT_CHANGED,new at)}refreshMatrixes(){this._transMatrix=this.transform.getScreenCTM(),this._transMatrixInv=this._transMatrix.inverse(),this._strokeScale=this.calcLineWidthScale()}calcLineWidthScale(){let t=this.rootEl.viewBox.animVal.height,e=this.rootEl.viewBox.animVal.width,i=this.container.clientHeight/t,r=this.container.clientWidth/e;return 1/Math.min(i,r)}empty(){this.container.innerHTML="",this.root=null,this.defs=null,this.sheet=null,this.shadow=null,this.infoLayer=null,this.defaultParentNode=null,this.selected=null,this.hovered=null,this.activePart=null,this.collage=null,this.filters=null,this.multiArr=[],this._built=!1,this.events.trigger(p.SVG_DESTROYED)}build(t=[],e=100,i=100){this.buildParts=t,this.built&&this.empty(),this.events.pause(),this.svgSettings.viewBox||(this.svgSettings.viewBox=`0 0 ${e*this.svgSettings.px2mm} ${i*this.svgSettings.px2mm}`),this.svgSettings.preserveAspectRatio=void 0===this.svgSettings.preserveAspectRatio?"xMidYMid meet":this.svgSettings.preserveAspectRatio,this.svgSettings.margin||(this.svgSettings.margin=this.margin.formatSVGMargins()),this.root=new Bt,this.node.addNode(this.root,{id:"roots",preserveAspectRatio:this.svgSettings.preserveAspectRatio,viewBox:this.svgSettings.viewBox,margin:this.svgSettings.margin,px2mm:this.svgSettings.px2mm,noZoom:this.svgSettings.noZoom,zoomDelay:this.svgSettings.zoomDelay,zoomSteps:this.svgSettings.zoomSteps,extraCopy:this.svgSettings.extraCopy,fadePathId:this.svgSettings.fadePathId},(()=>{this.container.appendChild(this.root.element),this.defaultParentNode=this.root,this.margin.setMargin(this.svgSettings.margin),this.margin.refreshMargin(!0)})),this.filters=new ee(this),this.defs=this.node.addNode(new te,{id:"defsLayer"}),this.defs.ignore=!0,this.defs.overHandling=l.OVER_NEVER,this.filters.createFilters();let r=this.node.addNode(new Gt,{id:"preBottomLayer"});r.ignore=!0,r.overHandling=l.OVER_NEVER;let n={json:{sheet_type:this.svgSettings.mode,width:e,height:i,backgroundPattern:this.svgSettings.backgroundPattern,backgroundPatternLight:this.svgSettings.backgroundPatternLight,backgroundPatternDark:this.svgSettings.backgroundPatternDark,backgroundPatternSize:this.svgSettings.backgroundPatternSize,backgroundPatternWidth:this.svgSettings.backgroundPatternWidth,backgroundPatternHeight:this.svgSettings.backgroundPatternHeight,backgroundPatternHref:this.svgSettings.backgroundPatternHref,backprintDealSettings:null,isCustomizableSheet:this.svgSettings.mode==E.MODE_SHEET}};this.events.resume(),this.sheet=new re,this.node.addNode(this.sheet,n,(t=>{})),this.shadow=this.node.addNode(new ie,{id:"shadowLayer"});let s=this.node.addNode(new Gt,{id:"partPathLayer"});s.ignore=!0,s.overHandling=l.OVER_NEVER;let o=this.node.addNode(new Gt,{id:"preTopLayer"});o.ignore=!0,o.overHandling=l.OVER_NEVER,this.infoLayer=this.node.addNode(new Gt,{id:"infoLayer"}),this.infoLayer.ignore=!0,this.infoLayer.overHandling=l.OVER_NEVER,this.sheet.onElementCreatedStep2(s),this.select.onEditorSVGCreated(),this._built=!0,this.trigger(p.SVG_CREATED)}createSVGTransform(){var t;return null===(t=this.rootEl)||void 0===t?void 0:t.createSVGTransform()}createSVGMatrix(){var t;return null===(t=this.rootEl)||void 0===t?void 0:t.createSVGMatrix()}get rootEl(){var t;return null===(t=this.root)||void 0===t?void 0:t.element}get element(){var t;return null===(t=this.root)||void 0===t?void 0:t.element}get px2mm(){return this.svgSettings.px2mm}get fadePathId(){return this.svgSettings.fadePathId}get extraCopy(){return this.svgSettings.extraCopy}get container(){return this._container}get fixedTop(){return this.boundingClientRect.top}get fixedLeft(){return this.boundingClientRect.left}get boundingClientRect(){return this._boundingClientRect||this.refreshBoundingClientRect(),this._boundingClientRect}get isSheetMode(){return this.sheet.sheet_type==E.MODE_SHEET}refreshBoundingClientRect(){this._boundingClientRect=this.container.getBoundingClientRect()}trigger(t,e){this.events.trigger(t,e)}}class oe{constructor(){this._dp={}}add(t,e,i=!0){return!(this.has(t)&&!i||(this.has(t)&&this.delete(t),this._dp[t]=e,0))}delete(t){delete this._dp[t]}has(t){return this._dp.hasOwnProperty(t)}get(t){return this.has(t)?this._dp[t]:null}get length(){var t=0;for(var e in this._dp)t++;return t}get dp(){return this._dp}}class ae extends r{constructor(t,e){super(t),this._listeners=new oe,this._listenersActive=!0,this._enabled=!0,this._editor=e}addListener(t,e,i){return this.addListenerTo(this.$el.get(),t,e,i),this.$el}trigger(t,e){for(let i=0;i<this.$el.length;i++){let r=this.$el.get(i);this.editor.trigger(t,e,r)}}addListenerTo(t,e,i,r){let n=this._listeners.length.toString(),s=(t,e,i)=>this._onCallback(n,t,e,i);return this.editor.svg.events.addListenerTo(t,e,r?i:s,r?s:null),this._listeners.add(n,r||i),n}addListenerToSVG(t,e,i){let r=this._listeners.length.toString(),n=(t,e,i)=>this._onCallback(r,t,e,i);return this.editor.svg.events.addListener(t,i?e:n,i?n:null),this._listeners.add(r,i||e),r}setEnabled(t){t&&this.$el.removeClass("disabled"),this._enabled=t,this.listenersActive=t}get editor(){return this._editor}get context(){return this._editor.context}get helpers(){return this._editor.helpers}get enabled(){return this._enabled}get listenersActive(){return this._listenersActive}set listenersActive(t){this._listenersActive=t}_onCallback(t,e,i,r){this.listenersActive&&"off"!=this.editor.controller.status&&this._listeners.get(t)(e,i,r)}}class le extends ae{constructor(t,e){super(t,e),this.addListenerToSVG(p.ADD_NOTIFICATION,((t,e)=>this.add(e.category,e.type,e.id,e.data))),this.addListenerToSVG(p.REMOVE_NOTIFICATION,((t,e)=>this.remove(e))),this.addListenerToSVG(a.ORIENTATION_UPDATE,(()=>this.renderBasedOnEditorOrientation()))}clear(){this.$el.html("")}add(t,e,i,r){switch(i||(i=Math.floor(1e6*Math.random())),t){case le.CATEGORY_DPI:this.clear(),1==e?this.$el.append('<div class="alert alert-danger" id="'+this.formatNotificationID(i)+'"><i class="glyphicon glyphicon-exclamation-sign"></i> '+this.editor.model.language.dpi_bad+"</div>"):2==e&&this.$el.append('<div class="alert alert-warning" id="'+this.formatNotificationID(i)+'"><i class="glyphicon glyphicon-info-sign"></i> '+this.editor.model.language.dpi_ok+"</div>");break;case 3:$("#overlay").hide(),this.editor.ui.toolPane.cutlineTool.showStickerEmptyAlert();break;case 4:case 5:break;case 6:case 7:this.$el.html('<div class="alert alert-danger alert-dismissable" id="'+this.formatNotificationID(i)+'"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><i class="glyphicon glyphicon-exclamation-sign"></i> '+this.editor.model.language.too_many_images+"</div>");break;case le.CATEGORY_UPLOAD:if("error"==e){this.$(".alert-upload-error").remove();let t=$('<div class="alert alert-danger alert-upload-error">'+r+"</div>");this.$el.prepend(t),t.delay(8e3).fadeOut("fast")}}}remove(t){this.$("#"+this.formatNotificationID(t)).remove()}formatNotificationID(t){return this.notificationBaseID+"-"+t}isEmpty(){return 0==this.$el.children().length}renderBasedOnEditorOrientation(){let t;this.editor.isLandscapeOrientation()?(this.$el.css({bottom:""}),t=0):(this.$el.css({bottom:this.editor.ui.toolPane.$panelToolsOverview.outerHeight()+this.editor.$("> .tool-bar").outerHeight()}),t=4),this.$el.find(".alert").css({marginTop:t})}get notificationBaseID(){return this.editor.id+"-notification"}static get CATEGORY_DPI(){return 1}static get CATEGORY_UPLOAD(){return"upload"}}class he extends ae{constructor(t,e,i){super(t,e),this._visible=!1,this._hideOnClickOutside=!0,this.$el.length,this._name=i,this._$content=this.$el.data("tool-content")?e.$(this.$el.data("tool-content")):$("<div/>"),this.addListener("click",(t=>this.onClick(t))),this.addListenerTo(this.$backButton.get(),"click",(t=>this.onBack(t))),this.addListenerToSVG(p.SVG_DESTROYED,(t=>this.onBack(t)))}get STATE_IN_TRANSITION(){return"state_in_transition"}get STATE_TRANSITION_DONE(){return"state_transition_done"}get $backButton(){return this.$header.find(".cta.back")}get $content(){return this._$content}set $content(t){this._$content=t}get $body(){return this.$content.find(".tool-content-body")}get $header(){return this.$content.find(".tool-content-header")}get $title(){return this.$content.find(".tool-content-title")}get visible(){return this._visible}set visible(t){switch(this._visible=t,this._visible){case!0:this.trigger(a.OPEN_TOOL,this);break;case!1:this.trigger(a.CLOSE_TOOL,this)}}set bodyMaxHeight(t){this.$body.css("max-height",t+"px")}set bodyHeight(t){t="number"==typeof t?t+"px":t,this.$body.css("height",t)}get hideOnClickOutside(){return this._hideOnClickOutside}set hideOnClickOutside(t){this._hideOnClickOutside=t}get name(){return this._name}onClick(t){this.$el.hasClass("disabled")||(this.visible=!0)}onBack(t){this.visible=!1}onTransitionInDone(){}onLeave(){}}class de{static getTranslationsFromMap(t,e,i,r){return i.reduce(((i,n)=>(i[n]=this.getTranslationFromMap(t,e,r,n),i)),{})}static getTranslationFromMap(t,e,i,r){return t[`${e}_${i}_${r}`]??r}static getStringByKey(t,e){return t[e]??e}static async getTranslationByKey(t,e){t=t.toLowerCase();const i=await fetch(`${API_URL}/translation/get_translation_by_keyword/${t}/${e}`);if(200==i.status)return(await i.text()).replace(/['"]+/g,"");{const t=await i.text();throw new Error(t)}}}function ce(){switch(LANG){case"us":return"USD";case"se":return"SEK";case"dk":return"DKK";case"uk":case"gb":return"GBP";case"no":return"NOK";case"pl":return"PLN";case"jp":return"JPY";case"ca":return"CAD";default:return"EUR"}}function ue(t){return JSON.parse(JSON.stringify(t),((t,e)=>{if(null!=e&&""!=e&&e!=[]&&e!={})return"string"==typeof e?e.trim():e}))}"undefined"!=typeof window&&((window.__svelte??={}).v??=new Set).add("5");let pe=!1;pe=!0;const ge="[!",me={},fe=Symbol(),ve=Symbol("filename"),be=(Symbol("hmr"),"undefined"!=typeof window),ye=globalThis.process?.env?.NODE_ENV,_e=ye&&!ye.toLowerCase().startsWith("prod");function Te(t){if(_e){const e=new Error(`lifecycle_outside_component\n\`${t}(...)\` can only be used during component initialisation\nhttps://svelte.dev/e/lifecycle_outside_component`);throw e.name="Svelte error",e}throw new Error("https://svelte.dev/e/lifecycle_outside_component")}var xe=Array.isArray,we=Array.prototype.indexOf,Ee=Array.from,Ae=Object.keys,Pe=Object.defineProperty,Se=Object.getOwnPropertyDescriptor,Oe=Object.getOwnPropertyDescriptors,Me=Object.prototype,Ce=Array.prototype,Ie=Object.getPrototypeOf,ke=Object.isExtensible;const Ne=()=>{};function Le(t){return t()}function De(t){for(var e=0;e<t.length;e++)t[e]()}const Be=256,Re=1024,$e=2048,je=4096,qe=8192,Ve=16384,Fe=65536,He=1<<18,ze=1<<21,Ue=Symbol("$state"),Ge=Symbol("legacy props"),Ze=Symbol("");function We(){if(_e){const t=new Error("bind_invalid_checkbox_value\nUsing `bind:value` together with a checkbox input is not allowed. Use `bind:checked` instead\nhttps://svelte.dev/e/bind_invalid_checkbox_value");throw t.name="Svelte error",t}throw new Error("https://svelte.dev/e/bind_invalid_checkbox_value")}let Ke,Ye=!1;function Xe(t){Ye=t}function Qe(t){if(null===t)throw me;return Ke=t}function Je(){return Qe(fi(Ke))}function ti(t){if(Ye){if(null!==fi(Ke))throw me;Ke=t}}function ei(t=1){if(Ye){for(var e=t,i=Ke;e--;)i=fi(i);Ke=i}}function ii(){for(var t=0,e=Ke;;){if(8===e.nodeType){var i=e.data;if("]"===i){if(0===t)return e;t-=1}else"["!==i&&i!==ge||(t+=1)}var r=fi(e);e.remove(),e=r}}const ri=[];function ni(t,e=!1){if(_e&&!e){const e=[],i=si(t,new Map,"",e);if(1===e.length&&""===e[0]);else if(e.length>0){const t=e.length>10?e.slice(0,7):e.slice(0,10),i=e.length-t.length;let r=t.map((t=>`- <value>${t}`)).join("\n");i>0&&(r+=`\n- ...and ${i} more`)}return i}return si(t,new Map,"",ri)}function si(t,e,i,r,n=null){if("object"==typeof t&&null!==t){var s=e.get(t);if(void 0!==s)return s;if(t instanceof Map)return new Map(t);if(t instanceof Set)return new Set(t);if(xe(t)){var o=Array(t.length);e.set(t,o),null!==n&&e.set(n,o);for(var a=0;a<t.length;a+=1){var l=t[a];a in t&&(o[a]=si(l,e,_e?`${i}[${a}]`:i,r))}return o}if(Ie(t)===Me){for(var h in o={},e.set(t,o),null!==n&&e.set(n,o),t)o[h]=si(t[h],e,_e?`${i}.${h}`:i,r);return o}if(t instanceof Date)return structuredClone(t);if("function"==typeof t.toJSON)return si(t.toJSON(),e,_e?`${i}.toJSON()`:i,r,t)}if(t instanceof EventTarget)return t;try{return structuredClone(t)}catch(e){return _e&&r.push(i),t}}function oi(t){if("object"!=typeof t||null===t||Ue in t)return t;const e=Ie(t);if(e!==Me&&e!==Ce)return t;var i=new Map,r=xe(t),n=tn(0),s=null,o=mr,a=t=>{var e=mr;vr(o);var i=t();return vr(e),i};return r&&i.set("length",tn(t.length,s)),new Proxy(t,{defineProperty(t,e,r){"value"in r&&!1!==r.configurable&&!1!==r.enumerable&&!1!==r.writable||function(){if(_e){const t=new Error("state_descriptors_fixed\nProperty descriptors defined on `$state` objects must contain `value` and always be `enumerable`, `configurable` and `writable`.\nhttps://svelte.dev/e/state_descriptors_fixed");throw t.name="Svelte error",t}throw new Error("https://svelte.dev/e/state_descriptors_fixed")}();var n=i.get(e);return void 0===n?(n=a((()=>tn(r.value,s))),i.set(e,n)):rn(n,a((()=>oi(r.value)))),!0},deleteProperty(t,e){var o=i.get(e);if(void 0===o)e in t&&(i.set(e,a((()=>tn(fe,s)))),ai(n));else{if(r&&"string"==typeof e){var l=i.get("length"),h=Number(e);Number.isInteger(h)&&h<l.v&&rn(l,h)}rn(o,fe),ai(n)}return!0},get(e,r,n){if(r===Ue)return t;var o=i.get(r),l=r in e;if(void 0!==o||l&&!Se(e,r)?.writable||(o=a((()=>tn(oi(l?e[r]:fe),s))),i.set(r,o)),void 0!==o){var h=zr(o);return h===fe?void 0:h}return Reflect.get(e,r,n)},getOwnPropertyDescriptor(t,e){var r=Reflect.getOwnPropertyDescriptor(t,e);if(r&&"value"in r){var n=i.get(e);n&&(r.value=zr(n))}else if(void 0===r){var s=i.get(e),o=s?.v;if(void 0!==s&&o!==fe)return{enumerable:!0,configurable:!0,value:o,writable:!0}}return r},has(t,e){if(e===Ue)return!0;var r=i.get(e),n=void 0!==r&&r.v!==fe||Reflect.has(t,e);return!((void 0!==r||null!==br&&(!n||Se(t,e)?.writable))&&(void 0===r&&(r=a((()=>tn(n?oi(t[e]):fe,s))),i.set(e,r)),zr(r)===fe))&&n},set(t,e,o,l){var h=i.get(e),d=e in t;if(r&&"length"===e)for(var c=o;c<h.v;c+=1){var u=i.get(c+"");void 0!==u?rn(u,fe):c in t&&(u=a((()=>tn(fe,s))),i.set(c+"",u))}void 0===h?d&&!Se(t,e)?.writable||(rn(h=a((()=>tn(void 0,s))),a((()=>oi(o)))),i.set(e,h)):(d=h.v!==fe,rn(h,a((()=>oi(o)))));var p=Reflect.getOwnPropertyDescriptor(t,e);if(p?.set&&p.set.call(l,o),!d){if(r&&"string"==typeof e){var g=i.get("length"),m=Number(e);Number.isInteger(m)&&m>=g.v&&rn(g,m+1)}ai(n)}return!0},ownKeys(t){zr(n);var e=Reflect.ownKeys(t).filter((t=>{var e=i.get(t);return void 0===e||e.v!==fe}));for(var[r,s]of i)s.v===fe||r in t||e.push(r);return e},setPrototypeOf(){!function(){if(_e){const t=new Error("state_prototype_fixed\nCannot set prototype of `$state` object\nhttps://svelte.dev/e/state_prototype_fixed");throw t.name="Svelte error",t}throw new Error("https://svelte.dev/e/state_prototype_fixed")}()}})}function ai(t,e=1){rn(t,t.v+e)}function li(t){try{if(null!==t&&"object"==typeof t&&Ue in t)return t[Ue]}catch{}return t}var hi,di,ci,ui;function pi(){if(void 0===hi){hi=window,document,di=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,i=Text.prototype;ci=Se(e,"firstChild").get,ui=Se(e,"nextSibling").get,ke(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),ke(i)&&(i.__t=void 0),_e&&(t.__svelte_meta=null,function(){const t=Array.prototype,e=Array.__svelte_cleanup;e&&e();const{indexOf:i,lastIndexOf:r,includes:n}=t;t.indexOf=function(t,e){const r=i.call(this,t,e);if(-1===r)for(let i=e??0;i<this.length&&li(this[i])!==t;i+=1);return r},t.lastIndexOf=function(t,e){const i=r.call(this,t,e??this.length-1);if(-1===i)for(let i=0;i<=(e??this.length-1)&&li(this[i])!==t;i+=1);return i},t.includes=function(t,e){const i=n.call(this,t,e);if(!i)for(let e=0;e<this.length&&li(this[e])!==t;e+=1);return i},Array.__svelte_cleanup=()=>{t.indexOf=i,t.lastIndexOf=r,t.includes=n}}())}}function gi(t=""){return document.createTextNode(t)}function mi(t){return ci.call(t)}function fi(t){return ui.call(t)}function vi(t,e){if(!Ye)return mi(t);var i=mi(Ke);if(null===i)i=Ke.appendChild(gi());else if(e&&3!==i.nodeType){var r=gi();return i?.before(r),Qe(r),r}return Qe(i),i}function bi(t,e){if(!Ye){var i=mi(t);return i instanceof Comment&&""===i.data?fi(i):i}if(e&&3!==Ke?.nodeType){var r=gi();return Ke?.before(r),Qe(r),r}return Ke}function yi(t,e=1,i=!1){let r=Ye?Ke:t;for(var n;e--;)n=r,r=fi(r);if(!Ye)return r;var s=r?.nodeType;if(i&&3!==s){var o=gi();return null===r?n?.after(o):r.before(o),Qe(o),o}return Qe(r),r}function _i(t){t.textContent=""}function Ti(t){return t===this.v}function xi(t,e){return t!=t?e==e:t!==e||null!==t&&"object"==typeof t||"function"==typeof t}function wi(t,e){return t!==e}function Ei(t){return!xi(t,this.v)}function Ai(t){var e=2050,i=null!==mr&&2&mr.f?mr:null;null===br||null!==i&&i.f&Be?e|=Be:br.f|=1048576;const r={ctx:on,deps:null,effects:null,equals:Ti,f:e,fn:t,reactions:null,rv:0,v:null,wv:0,parent:i??br};return r}function Pi(t){const e=Ai(t);return Tr(e),e}function Si(t){const e=Ai(t);return e.equals=Ei,e}function Oi(t){var e=t.effects;if(null!==e){t.effects=null;for(var i=0;i<e.length;i+=1)Ui(e[i])}}let Mi=[];function Ci(t){var e,i=br;if(yr(function(t){for(var e=t.parent;null!==e;){if(!(2&e.f))return e;e=e.parent}return null}(t)),_e){let r=Yr;Qr(new Set);try{Mi.includes(t)&&function(){if(_e){const t=new Error("derived_references_self\nA derived value cannot reference itself recursively\nhttps://svelte.dev/e/derived_references_self");throw t.name="Svelte error",t}throw new Error("https://svelte.dev/e/derived_references_self")}(),Mi.push(t),Oi(t),e=Lr(t)}finally{yr(i),Qr(r),Mi.pop()}}else try{Oi(t),e=Lr(t)}finally{yr(i)}return e}function Ii(t){var e=Ci(t);Zr(t,(Sr||t.f&Be)&&null!==t.deps?je:Re),t.equals(e)||(t.v=e,t.wv=Mr())}function ki(t){null===br&&null===mr&&function(t){if(_e){const e=new Error(`effect_orphan\n\`${t}\` can only be used inside an effect (e.g. during component initialisation)\nhttps://svelte.dev/e/effect_orphan`);throw e.name="Svelte error",e}throw new Error("https://svelte.dev/e/effect_orphan")}(t),null!==mr&&mr.f&Be&&null===br&&function(){if(_e){const t=new Error("effect_in_unowned_derived\nEffect cannot be created inside a `$derived` value that was not itself created inside an effect\nhttps://svelte.dev/e/effect_in_unowned_derived");throw t.name="Svelte error",t}throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}(),cr&&function(t){if(_e){const e=new Error(`effect_in_teardown\n\`${t}\` cannot be used inside an effect cleanup function\nhttps://svelte.dev/e/effect_in_teardown`);throw e.name="Svelte error",e}throw new Error("https://svelte.dev/e/effect_in_teardown")}(t)}function Ni(t,e,i,r=!0){var n=br;if(_e)for(;null!==n&&n.f&He;)n=n.parent;var s={ctx:on,deps:null,nodes_start:null,nodes_end:null,f:t|$e,first:null,fn:e,last:null,next:null,parent:n,prev:null,teardown:null,transitions:null,wv:0};if(_e&&(s.component_function=ln),i)try{Rr(s),s.f|=32768}catch(t){throw Ui(s),t}else null!==e&&Fr(s);if((!i||null!==s.deps||null!==s.first||null!==s.nodes_start||null!==s.teardown||1048704&s.f)&&r&&(null!==n&&function(t,e){var i=e.last;null===i?e.last=e.first=t:(i.next=t,t.prev=i,e.last=t)}(s,n),null!==mr&&2&mr.f)){var o=mr;(o.effects??=[]).push(s)}return s}function Li(t){const e=Ni(8,null,!1);return Zr(e,Re),e.teardown=t,e}function Di(t){ki("$effect");var e=null!==br&&!!(32&br.f)&&null!==on&&!on.m;if(_e&&Pe(t,"name",{value:"$effect"}),!e)return Bi(t);var i=on;(i.e??=[]).push({fn:t,effect:br,reaction:mr})}function Bi(t){return Ni(4,t,!1)}function Ri(t,e){var i=on,r={effect:null,ran:!1};i.l.r1.push(r),r.effect=ji((()=>{t(),r.ran||(r.ran=!0,rn(i.l.r2,!0),Ur(e))}))}function $i(){var t=on;ji((()=>{if(zr(t.l.r2)){for(var e of t.l.r1){var i=e.effect;i.f&Re&&Zr(i,je),Cr(i)&&Rr(i),e.ran=!1}t.l.r2.v=!1}}))}function ji(t){return Ni(8,t,!0)}function qi(t,e=[],i=Ai){const r=e.map(i),n=()=>t(...r.map(zr));return _e&&Pe(n,"name",{value:"{expression}"}),Vi(n)}function Vi(t,e=0){return Ni(24|e,t,!0)}function Fi(t,e=!0){return Ni(40,t,!0,e)}function Hi(t){var e=t.teardown;if(null!==e){const t=cr,i=mr;ur(!0),vr(null);try{e.call(null)}finally{ur(t),vr(i)}}}function zi(t,e=!1){var i=t.first;for(t.first=t.last=null;null!==i;){var r=i.next;64&i.f?i.parent=null:Ui(i,e),i=r}}function Ui(t,e=!0){var i=!1;(e||524288&t.f)&&null!==t.nodes_start&&(Gi(t.nodes_start,t.nodes_end),i=!0),zi(t,e&&!i),Br(t,0),Zr(t,Ve);var r=t.transitions;if(null!==r)for(const t of r)t.stop();Hi(t);var n=t.parent;null!==n&&null!==n.first&&Zi(t),_e&&(t.component_function=null),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=null}function Gi(t,e){for(;null!==t;){var i=t===e?null:fi(t);t.remove(),t=i}}function Zi(t){var e=t.parent,i=t.prev,r=t.next;null!==i&&(i.next=r),null!==r&&(r.prev=i),null!==e&&(e.first===t&&(e.first=r),e.last===t&&(e.last=i))}function Wi(t,e){var i=[];Yi(t,i,!0),Ki(i,(()=>{Ui(t),e&&e()}))}function Ki(t,e){var i=t.length;if(i>0){var r=()=>--i||e();for(var n of t)n.out(r)}else e()}function Yi(t,e,i){if(!(t.f&qe)){if(t.f^=qe,null!==t.transitions)for(const r of t.transitions)(r.is_global||i)&&e.push(r);for(var r=t.first;null!==r;){var n=r.next;Yi(r,e,!!(r.f&Fe||32&r.f)&&i),r=n}}}function Xi(t){Qi(t,!0)}function Qi(t,e){if(t.f&qe){t.f^=qe,t.f&Re||(t.f^=Re),Cr(t)&&(Zr(t,$e),Fr(t));for(var i=t.first;null!==i;){var r=i.next;Qi(i,!!(i.f&Fe||32&i.f)&&e),i=r}if(null!==t.transitions)for(const i of t.transitions)(i.is_global||e)&&i.in()}}const Ji="undefined"==typeof requestIdleCallback?t=>setTimeout(t,1):requestIdleCallback;let tr=[],er=[];function ir(){var t=tr;tr=[],De(t)}function rr(){var t=er;er=[],De(t)}function nr(t){0===tr.length&&queueMicrotask(ir),tr.push(t)}function sr(){tr.length>0&&ir(),er.length>0&&rr()}const or=new WeakSet;let ar=!1,lr=!1,hr=null,dr=!1,cr=!1;function ur(t){cr=t}let pr=[],gr=[],mr=null,fr=!1;function vr(t){mr=t}let br=null;function yr(t){br=t}let _r=null;function Tr(t){null!==mr&&mr.f&ze&&(null===_r?_r=[t]:_r.push(t))}let xr=null,wr=0,Er=null,Ar=1,Pr=0,Sr=!1,Or=null;function Mr(){return++Ar}function Cr(t){var e=t.f;if(e&$e)return!0;if(e&je){var i=t.deps,r=!!(e&Be);if(null!==i){var n,s,o=!!(512&e),a=r&&null!==br&&!Sr,l=i.length;if(o||a){var h=t,d=h.parent;for(n=0;n<l;n++)s=i[n],!o&&s?.reactions?.includes(h)||(s.reactions??=[]).push(h);o&&(h.f^=512),!a||null===d||d.f&Be||(h.f^=Be)}for(n=0;n<l;n++)if(Cr(s=i[n])&&Ii(s),s.wv>t.wv)return!0}r&&(null===br||Sr)||Zr(t,Re)}return!1}function Ir(t){return!(t.f&Ve||null!==t.parent&&128&t.parent.f)}function kr(t,e,i,r){if(ar){if(null===i&&(ar=!1),Ir(e))throw t}else{if(null!==i&&(ar=!0),_e&&null!==r&&t instanceof Error&&!or.has(t)){or.add(t);const i=[],s=e.fn?.name;s&&i.push(s);let o=r;for(;null!==o;){var n=o.function?.[ve];if(n){const t=n.split("/").pop();i.push(t)}o=o.p}const a=di?"  ":"\t";Pe(t,"message",{value:t.message+`\n${i.map((t=>`\n${a}in ${t}`)).join("")}\n`}),Pe(t,"component_stack",{value:i});const l=t.stack;if(l){const e=l.split("\n"),i=[];for(let t=0;t<e.length;t++){const r=e[t];r.includes("svelte/src/internal")||i.push(r)}Pe(t,"stack",{value:i.join("\n")})}}if(function(t,e){for(var i=e;null!==i;){if(128&i.f)try{return void i.fn(t)}catch{i.f^=128}i=i.parent}throw ar=!1,t}(t,e),Ir(e))throw t}}function Nr(t,e,i=!0){var r=t.reactions;if(null!==r)for(var n=0;n<r.length;n++){var s=r[n];_r?.includes(t)||(2&s.f?Nr(s,e,!1):e===s&&(i?Zr(s,$e):s.f&Re&&Zr(s,je),Fr(s)))}}function Lr(t){var e=xr,i=wr,r=Er,n=mr,s=Sr,o=_r,a=on,l=fr,h=t.f;xr=null,wr=0,Er=null,Sr=!!(h&Be)&&(fr||!dr||null===mr),mr=96&h?null:t,_r=null,an(t.ctx),fr=!1,Pr++,t.f|=ze;try{var d=(0,t.fn)(),c=t.deps;if(null!==xr){var u;if(Br(t,wr),null!==c&&wr>0)for(c.length=wr+xr.length,u=0;u<xr.length;u++)c[wr+u]=xr[u];else t.deps=c=xr;if(!Sr)for(u=wr;u<c.length;u++)(c[u].reactions??=[]).push(t)}else null!==c&&wr<c.length&&(Br(t,wr),c.length=wr);if(un()&&null!==Er&&!fr&&null!==c&&!(6146&t.f))for(u=0;u<Er.length;u++)Nr(Er[u],t);return null!==n&&n!==t&&(Pr++,null!==Er&&(null===r?r=Er:r.push(...Er))),d}finally{xr=e,wr=i,Er=r,mr=n,Sr=s,_r=o,an(a),fr=l,t.f^=ze}}function Dr(t,e){let i=e.reactions;if(null!==i){var r=we.call(i,t);if(-1!==r){var n=i.length-1;0===n?i=e.reactions=null:(i[r]=i[n],i.pop())}}null===i&&2&e.f&&(null===xr||!xr.includes(e))&&(Zr(e,je),768&e.f||(e.f^=512),Oi(e),Br(e,0))}function Br(t,e){var i=t.deps;if(null!==i)for(var r=e;r<i.length;r++)Dr(t,i[r])}function Rr(t){var e=t.f;if(!(e&Ve)){Zr(t,Re);var i=br,r=on,n=dr;if(br=t,dr=!0,_e){var s=ln;hn(t.component_function)}try{16&e?function(t){for(var e=t.first;null!==e;){var i=e.next;32&e.f||Ui(e),e=i}}(t):zi(t),Hi(t);var o=Lr(t);t.teardown="function"==typeof o?o:null,t.wv=Ar;t.deps;_e&&gr.push(t)}catch(e){kr(e,t,i,r||t.ctx)}finally{dr=n,br=i,_e&&hn(s)}}}function $r(){gr=[]}function jr(){try{!function(){if(_e){const t=new Error("effect_update_depth_exceeded\nMaximum update depth exceeded. This can happen when a reactive block or effect repeatedly sets a new value. Svelte limits the number of nested updates to prevent infinite loops\nhttps://svelte.dev/e/effect_update_depth_exceeded");throw t.name="Svelte error",t}throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}()}catch(t){if(_e&&Pe(t,"stack",{value:""}),null===hr)throw _e&&$r(),t;if(_e)try{kr(t,hr,null,null)}catch(t){throw $r(),t}else kr(t,hr,null,null)}}function qr(){var t=dr;try{var e=0;for(dr=!0;pr.length>0;){e++>1e3&&jr();var i=pr,r=i.length;pr=[];for(var n=0;n<r;n++)Vr(Hr(i[n]));Xr.clear()}}finally{lr=!1,dr=t,hr=null,_e&&(gr=[])}}function Vr(t){var e=t.length;if(0!==e)for(var i=0;i<e;i++){var r=t[i];if(!(24576&r.f))try{Cr(r)&&(Rr(r),null===r.deps&&null===r.first&&null===r.nodes_start&&(null===r.teardown?Zi(r):r.fn=null))}catch(t){kr(t,r,null,r.ctx)}}}function Fr(t){lr||(lr=!0,queueMicrotask(qr));for(var e=hr=t;null!==e.parent;){var i=(e=e.parent).f;if(96&i){if(!(i&Re))return;e.f^=Re}}pr.push(e)}function Hr(t){for(var e=[],i=t;null!==i;){var r=i.f,n=!!(96&r);if(!(n&&r&Re||r&qe)){if(4&r)e.push(i);else if(n)i.f^=Re;else try{Cr(i)&&Rr(i)}catch(t){kr(t,i,null,i.ctx)}var s=i.first;if(null!==s){i=s;continue}}var o=i.parent;for(i=i.next;null===i&&null!==o;)i=o.next,o=o.parent}return e}function zr(t){var e=!!(2&t.f);if(null!==Or&&Or.add(t),null===mr||fr){if(e&&null===t.deps&&null===t.effects){var i=t,r=i.parent;null===r||r.f&Be||(i.f^=Be)}}else if(!_r?.includes(t)){var n=mr.deps;t.rv<Pr&&(t.rv=Pr,null===xr&&null!==n&&n[wr]===t?wr++:null===xr?xr=[t]:Sr&&xr.includes(t)||xr.push(t))}return e&&Cr(i=t)&&Ii(i),cr&&Xr.has(t)?Xr.get(t):t.v}function Ur(t){var e=fr;try{return fr=!0,t()}finally{fr=e}}const Gr=-7169;function Zr(t,e){t.f=t.f&Gr|e}function Wr(t){if("object"==typeof t&&t&&!(t instanceof EventTarget))if(Ue in t)Kr(t);else if(!Array.isArray(t))for(let e in t){const i=t[e];"object"==typeof i&&i&&Ue in i&&Kr(i)}}function Kr(t,e=new Set){if(!("object"!=typeof t||null===t||t instanceof EventTarget||e.has(t))){e.add(t),t instanceof Date&&t.getTime();for(let i in t)try{Kr(t[i],e)}catch(t){}const i=Ie(t);if(i!==Object.prototype&&i!==Array.prototype&&i!==Map.prototype&&i!==Set.prototype&&i!==Date.prototype){const e=Oe(i);for(let i in e){const r=e[i].get;if(r)try{r.call(t)}catch(t){}}}}}let Yr=new Set;const Xr=new Map;function Qr(t){Yr=t}function Jr(t,e){var i={f:0,v:t,reactions:null,equals:Ti,rv:0,wv:0};return i}function tn(t,e){const i=Jr(t);return Tr(i),i}function en(t,e=!1){const i=Jr(t);return e||(i.equals=Ei),null!==on&&null!==on.l&&(on.l.s??=[]).push(i),i}function rn(t,e,i=!1){return null!==mr&&!fr&&un()&&18&mr.f&&!_r?.includes(t)&&function(){if(_e){const t=new Error("state_unsafe_mutation\nUpdating state inside a derived or a template expression is forbidden. If the value should not be reactive, declare it without `$state`\nhttps://svelte.dev/e/state_unsafe_mutation");throw t.name="Svelte error",t}throw new Error("https://svelte.dev/e/state_unsafe_mutation")}(),nn(t,i?oi(e):e)}function nn(t,e){if(!t.equals(e)){var i=t.v;if(cr?Xr.set(t,e):Xr.set(t,i),t.v=e,2&t.f&&(t.f&$e&&Ci(t),Zr(t,t.f&Be?je:Re)),t.wv=Mr(),sn(t,$e),un()&&null!==br&&br.f&Re&&!(96&br.f)&&(null===Er?function(t){Er=t}([t]):Er.push(t)),_e&&Yr.size>0){const t=Array.from(Yr);for(const e of t)e.f&Re&&Zr(e,je),Cr(e)&&Rr(e);Yr.clear()}}return e}function sn(t,e){var i=t.reactions;if(null!==i)for(var r=un(),n=i.length,s=0;s<n;s++){var o=i[s],a=o.f;a&$e||(r||o!==br)&&(_e&&a&He?Yr.add(o):(Zr(o,e),1280&a&&(2&a?sn(o,je):Fr(o))))}}let on=null;function an(t){on=t}let ln=null;function hn(t){ln=t}function dn(t,e=!1,i){var r=on={p:on,c:null,d:!1,e:null,m:!1,s:t,x:null,l:null};!e&&(on.l={s:null,u:null,r1:[],r2:Jr(!1)}),Li((()=>{r.d=!0})),_e&&(on.function=i,ln=i)}function cn(t){const e=on;if(null!==e){void 0!==t&&(e.x=t);const o=e.e;if(null!==o){var i=br,r=mr;e.e=null;try{for(var n=0;n<o.length;n++){var s=o[n];yr(s.effect),vr(s.reaction),Bi(s.fn)}}finally{yr(i),vr(r)}}on=e.p,_e&&(ln=e.p?.function??null),e.m=!0}return t||{}}function un(){return null!==on&&null===on.l}const pn=/\r/g,gn=["touchstart","touchmove"];var mn=new Map;let fn=!1;function vn(){fn||(fn=!0,document.addEventListener("reset",(t=>{Promise.resolve().then((()=>{if(!t.defaultPrevented)for(const e of t.target.elements)e.__on_r?.()}))}),{capture:!0}))}function bn(t){var e=mr,i=br;vr(null),yr(null);try{return t()}finally{vr(e),yr(i)}}const yn=new Set,_n=new Set;function Tn(t,e,i,r,n){var s={capture:r,passive:n},o=function(t,e,i,r={}){function n(t){if(r.capture||wn.call(e,t),!t.cancelBubble)return bn((()=>i?.call(this,t)))}return t.startsWith("pointer")||t.startsWith("touch")||"wheel"===t?nr((()=>{e.addEventListener(t,n,r)})):e.addEventListener(t,n,r),n}(t,e,i,s);e!==document.body&&e!==window&&e!==document||Li((()=>{e.removeEventListener(t,o,s)}))}function xn(t){for(var e=0;e<t.length;e++)yn.add(t[e]);for(var i of _n)i(t)}function wn(t){var e=this,i=e.ownerDocument,r=t.type,n=t.composedPath?.()||[],s=n[0]||t.target,o=0,a=t.__root;if(a){var l=n.indexOf(a);if(-1!==l&&(e===document||e===window))return void(t.__root=e);var h=n.indexOf(e);if(-1===h)return;l<=h&&(o=l)}if((s=n[o]||t.target)!==e){Pe(t,"currentTarget",{configurable:!0,get:()=>s||i});var d=mr,c=br;vr(null),yr(null);try{for(var u,p=[];null!==s;){var g=s.assignedSlot||s.parentNode||s.host||null;try{var m=s["__"+r];if(null!=m&&(!s.disabled||t.target===s))if(xe(m)){var[f,...v]=m;f.apply(s,[t,...v])}else m.call(s,t)}catch(t){u?p.push(t):u=t}if(t.cancelBubble||g===e||null===g)break;s=g}if(u){for(let t of p)queueMicrotask((()=>{throw t}));throw u}}finally{t.__root=e,delete t.currentTarget,vr(d),yr(c)}}}let En;function An(t){var e=document.createElement("template");return e.innerHTML=t,e.content}function Pn(t,e){var i=br;null===i.nodes_start&&(i.nodes_start=t,i.nodes_end=e)}function Sn(t,e){var i,r=!!(1&e),n=!!(2&e),s=!t.startsWith("<!>");return()=>{if(Ye)return Pn(Ke,null),Ke;void 0===i&&(i=An(s?t:"<!>"+t),r||(i=mi(i)));var e=n||di?document.importNode(i,!0):i.cloneNode(!0);return r?Pn(mi(e),e.lastChild):Pn(e,e),e}}function On(t,e,i="svg"){var r,n=!t.startsWith("<!>"),s=!!(1&e),o=`<${i}>${n?t:"<!>"+t}</${i}>`;return()=>{if(Ye)return Pn(Ke,null),Ke;if(!r){var t=mi(An(o));if(s)for(r=document.createDocumentFragment();mi(t);)r.appendChild(mi(t));else r=mi(t)}var e=r.cloneNode(!0);return s?Pn(mi(e),e.lastChild):Pn(e,e),e}}function Mn(){if(Ye)return Pn(Ke,null),Ke;var t=document.createDocumentFragment(),e=document.createComment(""),i=gi();return t.append(e,i),Pn(e,i),t}function Cn(t,e){if(Ye)return br.nodes_end=Ke,void Je();null!==t&&t.before(e)}let In=!0;function kn(t,e){var i=null==e?"":"object"==typeof e?e+"":e;i!==(t.__t??=t.nodeValue)&&(t.__t=i,t.nodeValue=i+"")}function Nn(t,e){return Bn(t,e)}function Ln(t,e){pi(),e.intro=e.intro??!1;const i=e.target,r=Ye,n=Ke;try{for(var s=mi(i);s&&(8!==s.nodeType||"["!==s.data);)s=fi(s);if(!s)throw me;Xe(!0),Qe(s),Je();const r=Bn(t,{...e,anchor:s});if(null===Ke||8!==Ke.nodeType||"]"!==Ke.data)throw me;return Xe(!1),r}catch(r){if(r===me)return!1===e.recover&&function(){if(_e){const t=new Error("hydration_failed\nFailed to hydrate the application\nhttps://svelte.dev/e/hydration_failed");throw t.name="Svelte error",t}throw new Error("https://svelte.dev/e/hydration_failed")}(),pi(),_i(i),Xe(!1),Nn(t,e);throw r}finally{Xe(r),Qe(n),En=void 0}}const Dn=new Map;function Bn(t,{target:e,anchor:i,props:r={},events:n,context:s,intro:o=!0}){pi();var a=new Set,l=t=>{for(var i=0;i<t.length;i++){var r=t[i];if(!a.has(r)){a.add(r);var n=(o=r,gn.includes(o));e.addEventListener(r,wn,{passive:n});var s=Dn.get(r);void 0===s?(document.addEventListener(r,wn,{passive:n}),Dn.set(r,1)):Dn.set(r,s+1)}}var o};l(Ee(yn)),_n.add(l);var h=void 0,d=function(){const d=Ni(64,(()=>{var d=i??e.appendChild(gi());return Fi((()=>{s&&(dn({}),on.c=s),n&&(r.$$events=n),Ye&&Pn(d,null),In=o,h=t(d,r)||{},In=!0,Ye&&(br.nodes_end=Ke),s&&cn()})),()=>{for(var t of a){e.removeEventListener(t,wn);var r=Dn.get(t);0==--r?(document.removeEventListener(t,wn),Dn.delete(t)):Dn.set(t,r)}_n.delete(l),d!==i&&d.parentNode?.removeChild(d)}}),!0);return(t={})=>new Promise((e=>{t.outro?Wi(d,(()=>{Ui(d),e(void 0)})):(Ui(d),e(void 0))}))}();return Rn.set(h,d),h}let Rn=new WeakMap;function $n(t,e,[i,r]=[0,0]){Ye&&0===i&&Je();var n=t,s=null,o=null,a=fe,l=!1;const h=(t,e=!0)=>{l=!0,d(e,t)},d=(t,e)=>{if(a===(a=t))return;let l=!1;if(Ye&&-1!==r){if(0===i){const t=n.data;"["===t?r=0:t===ge?r=1/0:(r=parseInt(t.substring(1)))!=r&&(r=a?1/0:-1)}!!a==r>i&&(Qe(n=ii()),Xe(!1),l=!0,r=-1)}a?(s?Xi(s):e&&(s=Fi((()=>e(n)))),o&&Wi(o,(()=>{o=null}))):(o?Xi(o):e&&(o=Fi((()=>e(n,[i+1,r])))),s&&Wi(s,(()=>{s=null}))),l&&Xe(!0)};Vi((()=>{l=!1,e(h),l||d(null,null)}),i>0?Fe:0),Ye&&(n=Ke)}function jn(t,e,i){Ye&&Je();var r,n=t,s=fe,o=un()?wi:xi;Vi((()=>{o(s,s=e())&&(r&&Wi(r),r=Fi((()=>i(n))))})),Ye&&(n=Ke)}let qn=null;function Vn(t,e){return e}function Fn(t,e,i,r,n,s=null){var o=t,a={flags:e,items:new Map,first:null};if(4&e){var l=t;o=Ye?Qe(mi(l)):l.appendChild(gi())}Ye&&Je();var h=null,d=!1,c=Si((()=>{var t=i();return xe(t)?t:null==t?[]:Ee(t)}));Vi((()=>{var t=zr(c),l=t.length;if(d&&0===l)return;d=0===l;let u=!1;if(Ye&&o.data===ge!=(0===l)&&(Qe(o=ii()),Xe(!1),u=!0),Ye){for(var p,g=null,m=0;m<l;m++){if(8===Ke.nodeType&&"]"===Ke.data){o=Ke,u=!0,Xe(!1);break}var f=t[m],v=r(f,m);p=zn(Ke,a,g,null,f,v,m,n,e,i),a.items.set(v,p),g=p}l>0&&Qe(ii())}Ye||function(t,e,i,r,n,s,o){var a,l,h,d,c,u,p=!!(8&n),g=!!(3&n),m=t.length,f=e.items,v=e.first,b=null,y=[],_=[];if(p)for(u=0;u<m;u+=1)d=s(h=t[u],u),void 0!==(c=f.get(d))&&(c.a?.measure(),(l??=new Set).add(c));for(u=0;u<m;u+=1)if(d=s(h=t[u],u),void 0!==(c=f.get(d))){if(g&&Hn(c,h,u,n),c.e.f&qe&&(Xi(c.e),p&&(c.a?.unfix(),(l??=new Set).delete(c))),c!==v){if(void 0!==a&&a.has(c)){if(y.length<_.length){var T,x=_[0];b=x.prev;var w=y[0],E=y[y.length-1];for(T=0;T<y.length;T+=1)Un(y[T],x,i);for(T=0;T<_.length;T+=1)a.delete(_[T]);Gn(e,w.prev,E.next),Gn(e,b,w),Gn(e,E,x),v=x,b=E,u-=1,y=[],_=[]}else a.delete(c),Un(c,v,i),Gn(e,c.prev,c.next),Gn(e,c,null===b?e.first:b.next),Gn(e,b,c),b=c;continue}for(y=[],_=[];null!==v&&v.k!==d;)v.e.f&qe||(a??=new Set).add(v),_.push(v),v=v.next;if(null===v)continue;c=v}y.push(c),b=c,v=c.next}else b=zn(v?v.e.nodes_start:i,e,b,null===b?e.first:b.next,h,d,u,r,n,o),f.set(d,b),y=[],_=[],v=b.next;if(null!==v||void 0!==a){for(var A=void 0===a?[]:Ee(a);null!==v;)v.e.f&qe||A.push(v),v=v.next;var P=A.length;if(P>0){var S=4&n&&0===m?i:null;if(p){for(u=0;u<P;u+=1)A[u].a?.measure();for(u=0;u<P;u+=1)A[u].a?.fix()}!function(t,e,i,r){for(var n=[],s=e.length,o=0;o<s;o++)Yi(e[o].e,n,!0);var a=s>0&&0===n.length&&null!==i;if(a){var l=i.parentNode;_i(l),l.append(i),r.clear(),Gn(t,e[0].prev,e[s-1].next)}Ki(n,(()=>{for(var i=0;i<s;i++){var n=e[i];a||(r.delete(n.k),Gn(t,n.prev,n.next)),Ui(n.e,!a)}}))}(e,A,S,f)}}p&&nr((()=>{if(void 0!==l)for(c of l)c.a?.apply()})),br.first=e.first&&e.first.e,br.last=b&&b.e}(t,a,o,n,e,r,i),null!==s&&(0===l?h?Xi(h):h=Fi((()=>s(o))):null!==h&&Wi(h,(()=>{h=null}))),u&&Xe(!0),zr(c)})),Ye&&(o=Ke)}function Hn(t,e,i,r){1&r&&nn(t.v,e),2&r?nn(t.i,i):t.i=i}function zn(t,e,i,r,n,s,o,a,l,h){var d=qn,c=!!(1&l),u=c?16&l?Jr(n):en(n):n,p=2&l?Jr(o):o;_e&&c&&(u.debug=()=>{var t="number"==typeof p?o:p.v;h()[t]});var g={i:p,v:u,k:s,a:null,e:null,prev:i,next:r};qn=g;try{return g.e=Fi((()=>a(t,u,p,h)),Ye),g.e.prev=i&&i.e,g.e.next=r&&r.e,null===i?e.first=g:(i.next=g,i.e.next=g.e),null!==r&&(r.prev=g,r.e.prev=g.e),g}finally{qn=d}}function Un(t,e,i){for(var r=t.next?t.next.e.nodes_start:i,n=e?e.e.nodes_start:i,s=t.e.nodes_start;s!==r;){var o=fi(s);n.before(s),s=o}}function Gn(t,e,i){null===e?t.first=i:(e.next=i,e.e.next=i&&i.e),null!==i&&(i.prev=e,i.e.prev=e&&e.e)}function Zn(t,e,i=!1,r=!1,n=!1){var s=t,o="";qi((()=>{var t=br;if(o!==(o=e()??"")){if(null!==t.nodes_start&&(Gi(t.nodes_start,t.nodes_end),t.nodes_start=t.nodes_end=null),""!==o){if(Ye){for(var a=Ke.data,l=Je(),h=l;null!==l&&(8!==l.nodeType||""!==l.data);)h=l,l=fi(l);if(null===l)throw me;return _e&&!n&&function(t,e,i){if(!e||e===function(t){let e=5381,i=(t=t.replace(pn,"")).length;for(;i--;)e=(e<<5)-e^t.charCodeAt(i);return(e>>>0).toString(36)}(String(i??"")))return;let r;const n=t.__svelte_meta?.loc;n?r=`near ${n.file}:${n.line}:${n.column}`:ln?.[ve]&&(r=`in ${ln[ve]}`),function(t){t?.replace(/\//g,"/​")}(r)}(l.parentNode,a,o),Pn(Ke,h),void(s=Qe(l))}var d=o+"";i?d=`<svg>${d}</svg>`:r&&(d=`<math>${d}</math>`);var c=An(d);if((i||r)&&(c=mi(c)),Pn(mi(c),c.lastChild),i||r)for(;mi(c);)s.before(mi(c));else s.before(c)}}else Ye&&Je()}))}function Wn(t,e,i,r,n){Ye&&Je();var s=e.$$slots?.[i],o=!1;!0===s&&(s=e["default"===i?"children":i],o=!0),void 0===s?null!==n&&n(t):s(t,o?()=>r:r)}function Kn(t,e){nr((()=>{var i=t.getRootNode(),r=i.host?i:i.head??i.ownerDocument.head;if(!r.querySelector("#"+e.hash)){const t=document.createElement("style");t.id=e.hash,t.textContent=e.code,r.appendChild(t),_e&&function(t,e){var i=mn.get(t);i||(i=new Set,mn.set(t,i)),i.add(e)}(e.hash,t)}}))}var Yn=__webpack_require__(71508),Xn=__webpack_require__.n(Yn);function Qn(t){return"object"==typeof t?(0,Yn.clsx)(t):t??""}new Map([[!0,"yes"],[!1,"no"]]);const Jn=[..." \t\n\r\f \v\ufeff"];function ts(t,e=!1){var i=e?" !important;":";",r="";for(var n in t){var s=t[n];null!=s&&""!==s&&(r+=" "+n+": "+s+i)}return r}function es(t){return"-"!==t[0]||"-"!==t[1]?t.toLowerCase():t}function is(t,e,i,r,n,s){var o=t.__className;if(Ye||o!==i||void 0===o){var a=function(t,e,i){var r=null==t?"":""+t;if(e&&(r=r?r+" "+e:e),i)for(var n in i)if(i[n])r=r?r+" "+n:n;else if(r.length)for(var s=n.length,o=0;(o=r.indexOf(n,o))>=0;){var a=o+s;0!==o&&!Jn.includes(r[o-1])||a!==r.length&&!Jn.includes(r[a])?o=a:r=(0===o?"":r.substring(0,o))+r.substring(a+1)}return""===r?null:r}(i,r,s);Ye&&a===t.getAttribute("class")||(null==a?t.removeAttribute("class"):e?t.className=a:t.setAttribute("class",a)),t.__className=i}else if(s&&n!==s)for(var l in s){var h=!!s[l];null!=n&&h===!!n[l]||t.classList.toggle(l,h)}return s}function rs(t,e={},i,r){for(var n in i){var s=i[n];e[n]!==s&&(null==i[n]?t.style.removeProperty(n):t.style.setProperty(n,s,r))}}function ns(t,e,i,r){var n=t.__style;if(Ye||n!==e){var s=function(t,e){if(e){var i,r,n="";if(Array.isArray(e)?(i=e[0],r=e[1]):i=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var s=!1,o=0,a=!1,l=[];i&&l.push(...Object.keys(i).map(es)),r&&l.push(...Object.keys(r).map(es));var h=0,d=-1;const e=t.length;for(var c=0;c<e;c++){var u=t[c];if(a?"/"===u&&"*"===t[c-1]&&(a=!1):s?s===u&&(s=!1):"/"===u&&"*"===t[c+1]?a=!0:'"'===u||"'"===u?s=u:"("===u?o++:")"===u&&o--,!a&&!1===s&&0===o)if(":"===u&&-1===d)d=c;else if(";"===u||c===e-1){if(-1!==d){var p=es(t.substring(h,d).trim());l.includes(p)||(";"!==u&&c++,n+=" "+t.substring(h,c).trim()+";")}h=c+1,d=-1}}}return i&&(n+=ts(i)),r&&(n+=ts(r,!0)),""===(n=n.trim())?null:n}return null==t?null:String(t)}(e,r);Ye&&s===t.getAttribute("style")||(null==s?t.removeAttribute("style"):t.style.cssText=s),t.__style=e}else r&&(Array.isArray(r)?(rs(t,i?.[0],r[0]),rs(t,i?.[1],r[1],"important")):rs(t,i,r));return r}Symbol("class"),Symbol("style");const ss=Symbol("is custom element"),os=Symbol("is html");function as(t){if(Ye){var e,i=!1,r=()=>{if(!i){if(i=!0,t.hasAttribute("value")){var e=t.value;ls(t,"value",null),t.value=e}if(t.hasAttribute("checked")){var r=t.checked;ls(t,"checked",null),t.checked=r}}};t.__on_r=r,e=r,0===er.length&&Ji(rr),er.push(e),vn()}}function ls(t,e,i,r){var n=hs(t);Ye&&(n[e]=t.getAttribute(e),"src"===e||"srcset"===e||"href"===e&&"LINK"===t.nodeName)?r||function(t,e,i){_e&&("srcset"===e&&function(t,e){var i=us(t.srcset),r=us(e);return r.length===i.length&&r.every((([t,e],r)=>e===i[r][1]&&(cs(i[r][0],t)||cs(t,i[r][0]))))}(t,i)||cs(t.getAttribute(e)??"",i)||(t.outerHTML.replace(t.innerHTML,t.innerHTML&&"..."),String(i)))}(t,e,i??""):n[e]!==(n[e]=i)&&("loading"===e&&(t[Ze]=i),null==i?t.removeAttribute(e):"string"!=typeof i&&function(t){var e,i=ds.get(t.nodeName);if(i)return i;ds.set(t.nodeName,i=[]);for(var r=t,n=Element.prototype;n!==r;){for(var s in e=Oe(r))e[s].set&&i.push(s);r=Ie(r)}return i}(t).includes(e)?t[e]=i:t.setAttribute(e,i))}function hs(t){return t.__attributes??={[ss]:t.nodeName.includes("-"),[os]:"http://www.w3.org/1999/xhtml"===t.namespaceURI}}var ds=new Map;function cs(t,e){return t===e||new URL(t,document.baseURI).href===new URL(e,document.baseURI).href}function us(t){return t.split(",").map((t=>t.trim().split(" ").filter(Boolean)))}const ps=be?()=>performance.now():()=>Date.now(),gs={tick:t=>(be?requestAnimationFrame:Ne)(t),now:()=>ps(),tasks:new Set};function ms(){const t=gs.now();gs.tasks.forEach((e=>{e.c(t)||(gs.tasks.delete(e),e.f())})),0!==gs.tasks.size&&gs.tick(ms)}function fs(t,e){bn((()=>{t.dispatchEvent(new CustomEvent(e))}))}function vs(t){if("float"===t)return"cssFloat";if("offset"===t)return"cssOffset";if(t.startsWith("--"))return t;const e=t.split("-");return 1===e.length?e[0]:e[0]+e.slice(1).map((t=>t[0].toUpperCase()+t.slice(1))).join("")}function bs(t){const e={},i=t.split(";");for(const t of i){const[i,r]=t.split(":");if(!i||void 0===r)break;e[vs(i.trim())]=r.trim()}return e}const ys=t=>t;function _s(t,e,i,r,n){var s=1===r;if("function"==typeof e){var o,a=!1;return nr((()=>{if(!a){var l=e({direction:s?"in":"out"});o=_s(t,l,i,r,n)}})),{abort:()=>{a=!0,o?.abort()},deactivate:()=>o.deactivate(),reset:()=>o.reset(),t:()=>o.t()}}if(i?.deactivate(),!e?.duration)return n(),{abort:Ne,deactivate:Ne,reset:Ne,t:()=>r};const{delay:l=0,css:h,tick:d,easing:c=ys}=e;var u=[];if(s&&void 0===i&&(d&&d(0,1),h)){var p=bs(h(0,1));u.push(p,p)}var g=()=>1-r,m=t.animate(u,{duration:l});return m.onfinish=()=>{var s=i?.t()??1-r;i?.abort();var o=r-s,a=e.duration*Math.abs(o),l=[];if(a>0){var u=!1;if(h)for(var p=Math.ceil(a/(1e3/60)),f=0;f<=p;f+=1){var v=s+o*c(f/p),b=bs(h(v,1-v));l.push(b),u||="hidden"===b.overflow}u&&(t.style.overflow="hidden"),g=()=>{var t=m.currentTime;return s+o*c(t/a)},d&&function(t){let e;0===gs.tasks.size&&gs.tick(ms),new Promise((i=>{gs.tasks.add(e={c:t,f:i})}))}((()=>{if("running"!==m.playState)return!1;var t=g();return d(t,1-t),!0}))}(m=t.animate(l,{duration:a,fill:"forwards"})).onfinish=()=>{g=()=>r,d?.(r,1-r),n()}},{abort:()=>{m&&(m.cancel(),m.effect=null,m.onfinish=Ne)},deactivate:()=>{n=Ne},reset:()=>{0===r&&d?.(1,0)},t:()=>g()}}function Ts(t,e,i=e){var r=un();!function(t,e,i,r=i){t.addEventListener(e,(()=>bn(i)));const n=t.__on_r;t.__on_r=n?()=>{n(),r(!0)}:()=>r(!0),vn()}(t,"input",(n=>{_e&&"checkbox"===t.type&&We();var s=n?t.defaultValue:t.value;if(s=xs(t)?ws(s):s,i(s),r&&s!==(s=e())){var o=t.selectionStart,a=t.selectionEnd;t.value=s??"",null!==a&&(t.selectionStart=o,t.selectionEnd=Math.min(a,t.value.length))}})),(Ye&&t.defaultValue!==t.value||null==Ur(e)&&t.value)&&i(xs(t)?ws(t.value):t.value),ji((()=>{_e&&"checkbox"===t.type&&We();var i=e();xs(t)&&i===ws(t.value)||("date"!==t.type||i||t.value)&&i!==t.value&&(t.value=i??"")}))}function xs(t){var e=t.type;return"number"===e||"range"===e}function ws(t){return""===t?null:+t}function Es(t,e){return t===e||t?.[Ue]===e}function As(t={},e,i,r){return Bi((()=>{var n,s;return ji((()=>{n=s,s=r?.()||[],Ur((()=>{t!==i(...s)&&(e(t,...s),n&&Es(i(...n),t)&&e(null,...n))}))})),()=>{nr((()=>{s&&Es(i(...s),t)&&e(null,...s)}))}})),t}function Ps(t){return function(...e){return e[0].preventDefault(),t?.apply(this,e)}}function Ss(t=!1){const e=on,i=e.l.u;if(!i)return;let r=()=>Wr(e.s);if(t){let t=0,i={};const n=Ai((()=>{let r=!1;const n=e.s;for(const t in n)n[t]!==i[t]&&(i[t]=n[t],r=!0);return r&&t++,t}));r=()=>zr(n)}var n;i.b.length&&(n=()=>{Os(e,r),De(i.b)},ki("$effect.pre"),_e&&Pe(n,"name",{value:"$effect.pre"}),ji(n)),Di((()=>{const t=Ur((()=>i.m.map(Le)));return()=>{for(const e of t)"function"==typeof e&&e()}})),i.a.length&&Di((()=>{Os(e,r),De(i.a)}))}function Os(t,e){if(t.l.s)for(const e of t.l.s)zr(e);e()}if(new Set,new WeakMap,_e){function Cd(t){if(!(t in globalThis)){let e;Object.defineProperty(globalThis,t,{configurable:!0,get:()=>{if(void 0!==e)return e;!function(t){if(_e){const e=new Error(`rune_outside_svelte\nThe \`${t}\` rune is only available inside \`.svelte\` and \`.svelte.js/ts\` files\nhttps://svelte.dev/e/rune_outside_svelte`);throw e.name="Svelte error",e}throw new Error("https://svelte.dev/e/rune_outside_svelte")}(t)},set:t=>{e=t}})}}Cd("$state"),Cd("$effect"),Cd("$derived"),Cd("$inspect"),Cd("$props"),Cd("$bindable")}function Ms(t){var e,i;null===on&&Te("onMount"),null!==on.l?(e=on,i=e.l,i.u??={a:[],b:[],m:[]}).m.push(t):Di((()=>{const e=Ur(t);if("function"==typeof e)return e}))}function Cs(){const t=on;return null===t&&Te("createEventDispatcher"),(e,i,r)=>{const n=t.s.$$events?.[e];if(n){const s=xe(n)?n.slice():[n],o=function(t,e,{bubbles:i=!1,cancelable:r=!1}={}){return new CustomEvent(t,{detail:e,bubbles:i,cancelable:r})}(e,i,r);for(const e of s)e.call(t.x,o);return!o.defaultPrevented}return!0}}let Is,ks=!1;function Ns(t){return t.ctx?.d??!1}function Ls(t,e,i,r){var n,s=!!(1&i),o=!!(2&i),a=!!(8&i),l=!!(16&i),h=!1;a?[n,h]=function(){var i=ks;try{return ks=!1,[t[e],ks]}finally{ks=i}}():n=t[e];var d,c=Ue in t||Ge in t,u=a&&(Se(t,e)?.set??(c&&e in t&&(i=>t[e]=i)))||void 0,p=r,g=!0,m=!1,f=()=>(m=!0,g&&(g=!1,p=l?Ur(r):r),p);if(void 0===n&&void 0!==r&&(u&&o&&function(t){if(_e){const e=new Error(`props_invalid_value\nCannot do \`bind:${t}={undefined}\` when \`${t}\` has a fallback value\nhttps://svelte.dev/e/props_invalid_value`);throw e.name="Svelte error",e}throw new Error("https://svelte.dev/e/props_invalid_value")}(e),n=f(),u&&u(n)),o)d=()=>{var i=t[e];return void 0===i?f():(g=!0,m=!1,i)};else{var v=(s?Ai:Si)((()=>t[e]));v.f|=131072,d=()=>{var t=zr(v);return void 0!==t&&(p=void 0),void 0===t?p:t}}if(!(4&i))return d;if(u){var b=t.$$legacy;return function(t,e){return arguments.length>0?(o&&e&&!b&&!h||u(e?d():t),t):d()}}var y=!1,_=!1,T=en(n),x=Ai((()=>{var t=d(),e=zr(T);return y?(y=!1,_=!0,e):(_=!1,T.v=t)}));return a&&zr(x),s||(x.equals=Ei),function(t,e){if(null!==Or&&(y=_,d(),zr(T)),arguments.length>0){const i=e?zr(x):o&&a?oi(t):t;if(!x.equals(i)){if(y=!0,rn(T,i),m&&void 0!==p&&(p=i),Ns(x))return t;Ur((()=>zr(x)))}return t}return Ns(x)?x.v:zr(x)}}function Ds(t){return new Bs(t)}Symbol();class Bs{#t;#e;constructor(t){var e=new Map,i=(t,i)=>{var r=en(i);return e.set(t,r),r};const r=new Proxy({...t.props||{},$$events:{}},{get:(t,r)=>zr(e.get(r)??i(r,Reflect.get(t,r))),has:(t,r)=>r===Ge||(zr(e.get(r)??i(r,Reflect.get(t,r))),Reflect.has(t,r)),set:(t,r,n)=>(rn(e.get(r)??i(r,n),n),Reflect.set(t,r,n))});this.#e=(t.hydrate?Ln:Nn)(t.component,{target:t.target,anchor:t.anchor,props:r,context:t.context,intro:t.intro??!1,recover:t.recover}),t?.props?.$$host&&!1!==t.sync||function(t){var e;for(t&&(lr=!0,qr(),e=t()),sr();pr.length>0;)lr=!0,qr(),sr()}(),this.#t=r.$$events;for(const t of Object.keys(this.#e))"$set"!==t&&"$destroy"!==t&&"$on"!==t&&Pe(this,t,{get(){return this.#e[t]},set(e){this.#e[t]=e},enumerable:!0});this.#e.$set=t=>{Object.assign(r,t)},this.#e.$destroy=()=>{!function(t){const e=Rn.get(t);e?(Rn.delete(t),e(void 0)):Promise.resolve()}(this.#e)}}$set(t){this.#e.$set(t)}$on(t,e){this.#t[t]=this.#t[t]||[];const i=(...t)=>e.call(this,...t);return this.#t[t].push(i),()=>{this.#t[t]=this.#t[t].filter((t=>t!==i))}}$destroy(){this.#e.$destroy()}}function Rs(t,e,i,r){const n=i[t]?.type;if(e="Boolean"===n&&"boolean"!=typeof e?null!=e:e,!r||!i[t])return e;if("toAttribute"===r)switch(n){case"Object":case"Array":return null==e?null:JSON.stringify(e);case"Boolean":return e?"":null;case"Number":return null==e?null:e;default:return e}else switch(n){case"Object":case"Array":return e&&JSON.parse(e);case"Boolean":default:return e;case"Number":return null!=e?+e:e}}"function"==typeof HTMLElement&&(Is=class extends HTMLElement{$$ctor;$$s;$$c;$$cn=!1;$$d={};$$r=!1;$$p_d={};$$l={};$$l_u=new Map;$$me;constructor(t,e,i){super(),this.$$ctor=t,this.$$s=e,i&&this.attachShadow({mode:"open"})}addEventListener(t,e,i){if(this.$$l[t]=this.$$l[t]||[],this.$$l[t].push(e),this.$$c){const i=this.$$c.$on(t,e);this.$$l_u.set(e,i)}super.addEventListener(t,e,i)}removeEventListener(t,e,i){if(super.removeEventListener(t,e,i),this.$$c){const t=this.$$l_u.get(e);t&&(t(),this.$$l_u.delete(e))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){if(await Promise.resolve(),!this.$$cn||this.$$c)return;function t(t){return e=>{const i=document.createElement("slot");"default"!==t&&(i.name=t),Cn(e,i)}}const e={},i=function(t){const e={};return t.childNodes.forEach((t=>{e[t.slot||"default"]=!0})),e}(this);for(const r of this.$$s)r in i&&("default"!==r||this.$$d.children?e[r]=t(r):(this.$$d.children=t(r),e.default=!0));for(const n of this.attributes){const s=this.$$g_p(n.name);s in this.$$d||(this.$$d[s]=Rs(s,n.value,this.$$p_d,"toProp"))}for(const o in this.$$p_d)o in this.$$d||void 0===this[o]||(this.$$d[o]=this[o],delete this[o]);this.$$c=Ds({component:this.$$ctor,target:this.shadowRoot||this,props:{...this.$$d,$$slots:e,$$host:this}}),this.$$me=function(t){const e=Ni(64,t,!0);return()=>{Ui(e)}}((()=>{ji((()=>{this.$$r=!0;for(const t of Ae(this.$$c)){if(!this.$$p_d[t]?.reflect)continue;this.$$d[t]=this.$$c[t];const e=Rs(t,this.$$d[t],this.$$p_d,"toAttribute");null==e?this.removeAttribute(this.$$p_d[t].attribute||t):this.setAttribute(this.$$p_d[t].attribute||t,e)}this.$$r=!1}))}));for(const a in this.$$l)for(const l of this.$$l[a]){const h=this.$$c.$on(a,l);this.$$l_u.set(l,h)}this.$$l={}}}attributeChangedCallback(t,e,i){this.$$r||(t=this.$$g_p(t),this.$$d[t]=Rs(t,i,this.$$p_d,"toProp"),this.$$c?.$set({[t]:this.$$d[t]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then((()=>{!this.$$cn&&this.$$c&&(this.$$c.$destroy(),this.$$me(),this.$$c=void 0)}))}$$g_p(t){return Ae(this.$$p_d).find((e=>this.$$p_d[e].attribute===t||!this.$$p_d[e].attribute&&e.toLowerCase()===t))||t}});var $s=Sn('<img class="list-group-item-icon bs5-me-3 svelte-1g8679m">'),js=Sn('<li data-bs-toggle="bs5-tooltip" data-bs-title="Default tooltip" tabindex="-1"><!> <input> <label><span><!> <!></span></label></li>'),qs=Sn("<ul></ul>");const Vs={hash:"svelte-1g8679m",code:':root {--primary-color: #FFDB00;--black-color: #040404;--white-color: #FFFFFF;--success-color: #6CB676;--success-secondary-color: #9ECFA5;--success-tertiary-color: #CEE7D2;--blue: #3796f6;--light-blue: #bbdbfc;--info-color: #3696F6;--info-secondary-color: #7ABAF9;--info-tertiary-color: #BDDCFC;--warning-color: #DA5246;--warning-secondary-color: #E78D85;--warning-tertiary-color: #F3C6C2;--gray-900: #1D1D1D;--gray-800: #2D2D2D;--gray-700: #505050;--gray-600: #757575;--gray-500: #979797;--gray-400: #CCCCCC;--gray-300: #DDDDDD;--gray-200: #F2F2F2;--gray-100: #FAFAFA;}.cols-3 {grid-template-columns:1fr 1fr 1fr;}.cols-2 {grid-template-columns:1fr 1fr;}.bs5-list-group.svelte-1g8679m {font-family:"Helvetica Neue", sans-serif;}.bs5-list-group.svelte-1g8679m > li:where(.svelte-1g8679m):only-child:has(img:where(.svelte-1g8679m)) {padding:0.75rem;}.bs5-list-group.svelte-1g8679m > li:where(.svelte-1g8679m):only-child:has(img:where(.svelte-1g8679m)) img:where(.svelte-1g8679m) {scale:1.75;}.bs5-list-group.svelte-1g8679m .bs5-list-group-item:where(.svelte-1g8679m) {border-width:3px;overflow-y:hidden;}.bs5-list-group.svelte-1g8679m .bs5-list-group-item:where(.svelte-1g8679m) .bs5-form-check-label:where(.svelte-1g8679m) {display:flex;gap:1em;margin-bottom:0;font-size:1rem;font-weight:normal;color:var(--gray-600);user-select:none;-webkit-user-select:none;}.bs5-list-group.svelte-1g8679m .bs5-list-group-item:where(.svelte-1g8679m) .bs5-form-check-input[type=radio]:where(.svelte-1g8679m) {display:none;}.bs5-list-group.svelte-1g8679m .bs5-list-group-item:where(.svelte-1g8679m) .bs5-form-check-input[type=radio].forceradio:where(.svelte-1g8679m) {display:inline-block;}.bs5-list-group.svelte-1g8679m .bs5-list-group-item:where(.svelte-1g8679m) img:where(.svelte-1g8679m) {width:1.5em;aspect-ratio:1;object-fit:cover;scale:1.5;}.bs5-list-group.svelte-1g8679m .bs5-list-group-item:where(.svelte-1g8679m):hover:not(.disabled) .bs5-form-check-label:where(.svelte-1g8679m) {cursor:pointer;}.bs5-list-group.svelte-1g8679m .bs5-list-group-item.disabled:where(.svelte-1g8679m) {opacity:1 !important;}.bs5-list-group.svelte-1g8679m .bs5-list-group-item.disabled:where(.svelte-1g8679m) :where(.svelte-1g8679m) {cursor:not-allowed;}.bs5-list-group.svelte-1g8679m .bs5-list-group-item.disabled:where(.svelte-1g8679m):focus {border:3px solid var(--warning-color);}.bs5-list-group.svelte-1g8679m .bs5-list-group-item:where(.svelte-1g8679m):focus {background-color:#e8e8e8 !important;}.bs5-list-group.svelte-1g8679m .bs5-list-group-item[data-active=true]:where(.svelte-1g8679m) {background-color:#e8e8e8 !important;}.bs5-list-group.svelte-1g8679m .bs5-list-group-item[data-active=true]:where(.svelte-1g8679m) .bs5-form-check-label:where(.svelte-1g8679m) {color:var(--gray-800);}.bs5-list-group.compact.svelte-1g8679m > .bs5-list-group-item:where(.svelte-1g8679m) {padding:0;border:0;font-size:13px;}'};function Fs(t,e){dn(e,!1),Kn(t,Vs);let i=Ls(e,"options",24,(()=>[])),r=Ls(e,"multiSelect",8,!1),n=Ls(e,"disabled",8,!1),s=Ls(e,"deselectable",8,!1),o=Ls(e,"compact",8,!1),a=Ls(e,"flush",8,!1),l=Ls(e,"dropdown",8,!1),h=Ls(e,"forceRadio",8,!1),d=Ls(e,"isModalWizard",8,!1);const c=(Math.random()+1).toString(36).substring(7)+"-",u=Cs();let p=null,g=en(null);function m(){return h()||!s()&&!r()}function f(t,e){if(e.selected&&m()||b(e))return void t.stopPropagation();const i={...e,selected:!v(e)};u("select",i),y()}function v(t){return!!t.selected}function b(t){return n()||!!t.disabled}function y(){p&&(p.dispose(),p=null)}Ms((()=>{d()&&rn(g,function(){let t=document.querySelectorAll(".wizard-content")[0];return t?`max-height: ${t.clientHeight-30}px;`:null}())})),Ss();var _=Mn();jn(bi(_),i,(t=>{var e=qs();let r;Fn(e,5,i,(t=>t.value),((t,e)=>{var i=js();let r;var n=vi(i),s=t=>{var i=$s();qi((()=>{ls(i,"alt",zr(e).title),ls(i,"src",zr(e).icon)})),Cn(t,i)};$n(n,(t=>{zr(e).icon&&t(s)}));var o=yi(n,2);let a;as(o);var d=yi(o,2);let u;var g=vi(d);let _;var T=vi(g);Zn(T,(()=>zr(e).title));var x=yi(T,2),w=t=>{var i=Mn();Zn(bi(i),(()=>zr(e).badge)),Cn(t,i)};$n(x,(t=>{zr(e).badge&&t(w)})),ti(g),ti(d),ti(i),qi(((t,n,s,l,h,p,m,f)=>{var v,b,y;r=is(i,1,"bs5-list-group-item bs5-d-flex bs5-align-items-center list-group-selectable-option svelte-1g8679m",null,r,t),ls(i,"data-active",n),ls(o,"id",c+zr(e).value),ls(o,"type",s),function(t,e){var i=hs(t);i.value!==(i.value=e??void 0)&&(t.value!==e||0===e&&"PROGRESS"===t.nodeName)&&(t.value=e??"")}(o,zr(e).value),a=is(o,1,"bs5-form-check-input bs5-me-1 svelte-1g8679m",null,a,l),b=h,(y=hs(v=o)).checked!==(y.checked=b??void 0)&&(v.checked=b),o.disabled=p,u=is(d,1,"bs5-form-check-label bs5-stretched-link bs5-w-100 svelte-1g8679m",null,u,m),ls(d,"for",c+zr(e).value),ls(g,"id",zr(e).value),_=is(g,1,"bs5-w-100 bs5-text-nowrap svelte-1g8679m",null,_,f)}),[()=>({dropdown:l(),disabled:b(zr(e))}),()=>v(zr(e)),()=>m()?"radio":"checkbox",()=>({forceradio:h(),"bs5-d-none":m()}),()=>v(zr(e)),()=>b(zr(e)),()=>({"bs5-fw-bold":v(zr(e))}),()=>({"bs5-d-grid":!!zr(e).badge,"cols-3":!zr(e).out_of_stock,"cols-2":zr(e).badge&&zr(e).out_of_stock,"bs5-container-fluid":!zr(e).badge,"bs5-p-0":!zr(e).badge,"bs5-d-flex":!zr(e).badge,"bs5-justify-content-betweer":!zr(e).badge,"bs5-align-items-center":!zr(e).badge})],Si),Tn("click",o,(t=>t.stopPropagation())),Tn("mouseover",i,(t=>function(t,e){if(y(),!e.tooltip)return;const i=t.target.closest(".bs5-list-group-item");p=new bootstrap.Popover(i,{title:"",content:e.tooltip,trigger:"manual",placement:"left"}),p.show()}(t,zr(e)))),Tn("focus",i,(()=>{})),Tn("click",i,(t=>f(t,zr(e)))),Tn("keydown",i,(t=>function(t,e){"Enter"!==t.key&&" "!==t.key||(f(t,e),t.preventDefault())}(t,zr(e)))),Cn(t,i)})),ti(e),qi((t=>{r=is(e,1,"bs5-list-group bs5-justify-content-sm-between bs5-justify-content-xl-start list-group-selectable svelte-1g8679m",null,r,t),ns(e,zr(g))}),[()=>({"bs5-list-group-flush":a(),compact:o()})],Si),Tn("mouseleave",e,y),Cn(t,e)})),Cn(t,_),cn()}var Hs=__webpack_require__(36083),zs=Sn("<span>No title</span>"),Us=Sn('<input type="number" min="0" class="bs5-form-control" placeholder="Custom option">'),Gs=Sn('<input type="text" class="bs5-form-control" placeholder="Custom option">'),Zs=Sn('<form class="bs5-pt-2 bs5-ps-2 bs5-pe-2"><div class="bs5-input-group bs5-bg-white bs5-mb-1"><!> <button class="bs5-btn bs5-btn-light btn-custom svelte-10zajgz"><span class="glyphicon glyphicon-ok" aria-hidden="true"></span></button></div></form>'),Ws=Sn('<div><div><!></div> <div><div class="bs5-dropdown"><button type="button" data-bs-toggle="bs5-dropdown" aria-expanded="false" tabindex="0"><!></button> <div class="bs5-dropdown-menu bs5-w-100"><!> <!></div></div></div></div>'),Ks=Sn("<span>No title</span>"),Ys=Sn('<span class="box-title bs5-fw-bold bs5-d-flex bs5-align-items-center bs5-justify-content-between svelte-10zajgz"><!></span> <!>',1);const Xs={hash:"svelte-10zajgz",code:':root {--primary-color: #FFDB00;--black-color: #040404;--white-color: #FFFFFF;--success-color: #6CB676;--success-secondary-color: #9ECFA5;--success-tertiary-color: #CEE7D2;--blue: #3796f6;--light-blue: #bbdbfc;--info-color: #3696F6;--info-secondary-color: #7ABAF9;--info-tertiary-color: #BDDCFC;--warning-color: #DA5246;--warning-secondary-color: #E78D85;--warning-tertiary-color: #F3C6C2;--gray-900: #1D1D1D;--gray-800: #2D2D2D;--gray-700: #505050;--gray-600: #757575;--gray-500: #979797;--gray-400: #CCCCCC;--gray-300: #DDDDDD;--gray-200: #F2F2F2;--gray-100: #FAFAFA;}.dropdown-menu-title.svelte-10zajgz {color:var(--gray-600);font-family:Helvetica Neue, Helvetica, Arial, sans-serif;}.bs5-btn.svelte-10zajgz {--bs-btn-disabled-bg: var(--gray-200);font-family:"Helvetica Neue", Helvetica, Arial, sans-serif;color:var(--gray-600);border-color:#cccccc;padding:1em 1.5em;border:0;font-size:1rem;}.bs5-btn.svelte-10zajgz:focus {box-shadow:0 0 0 0.25rem var(--gray-400);}.box-title.svelte-10zajgz {color:var(--gray-900);font-family:"Futura", "Helvetica Neue", Helvetica, Arial, sans-serif;}.btn-custom.svelte-10zajgz {padding:5px 9px;border:1px solid #ced4da;color:#555555;}'};function Qs(t,e){dn(e,!1),Kn(t,Xs);let i=Ls(e,"attributeName",8),r=Ls(e,"context",8),n=Ls(e,"translations",8,null),s=Ls(e,"preset",8,null),o=Ls(e,"dropdown",8,!1),a=Ls(e,"compact",8,!1),l=Ls(e,"disabled",8,!1),h=Ls(e,"readonly",8,!1),d=Ls(e,"stackHorizontal",8,!1),c=Ls(e,"dropDownButtonClass",8,"white"),u=Ls(e,"textcolor",8,""),p=Ls(e,"labelFormatter",8,(t=>t)),g=Ls(e,"tooltipFormatter",8,(t=>t)),m=Ls(e,"disableOutOfStockValues",8,!0),f=en(null),v=en(),b=en(),y=en(),_=Cs(),T=en(),x=en([]),w=en();function E(){return!r().isAttributeRequired(i())}function A(){return zr(v).isMultiValue(i())}function P(t){if(_("preChange",{from:zr(b).getAttribute(i()),to:t.value}),t.selected)if(rn(f,t.value),zr(y).setAttribute(i(),zr(f)),r().attrComputer.isMultiValue(i())){const t=zr(x).filter((t=>t.selected)).map((t=>t.value));t.push(zr(f)),zr(b).setAttribute(i(),t)}else zr(b).setAttribute(i(),zr(f));else zr(y).removeAttribute(i(),t.value),r().attrComputer.isMultiValue(i())?rn(b,new Hs.MultiValueHelper(zr(b),i()).deleteOne(t.value)):zr(b).removeAttribute(i()),rn(f,null);_("change",t)}function S(t){if(!zr(w))return;const e=String(zr(w)),r=zr(x).some((t=>t.value==e)),n=zr(v).getValueType(i());let s=!1;if("float"==n){const t=Number(zr(w));isNaN(t)&&(s=!0)}else if("integer"==n){const t=Number(zr(w));!isNaN(t)&&Number.isInteger(t)||(s=!0)}else if("boolean"==n){const t=e.toLowerCase();"true"!=t&&"false"!=t&&(s=!0)}if(s)t.stopPropagation();else{if(r)zr(x).forEach((t=>{t.value==e&&(t.selected=!0)}));else{const t={value:e,title:e,selected:!0};zr(x).push(t)}zr(v).isMultiValue(i())?new Hs.MultiValueHelper(zr(b),i()).insertOne(e):zr(b).setAttribute(i(),e),rn(x,zr(x)),rn(w,null),_("change",zr(x).find((t=>t.selected)))}}Ms((()=>{s()&&(rn(f,s()),zr(b).setAttribute("material",s()))})),Ri((()=>(Wr(r()),zr(f))),(()=>{rn(v,r().attrComputer),rn(b,r().productItem),rn(y,r().cherryPicks),rn(x,function(){const t=n()?.strings??{};let e=r().getAttributeOptions(i(),m()).map((e=>({...e,title:t[`products_${i()}_${e.value.toString()}`]??e.value.toString(),badge:e.out_of_stock?'<span class="option-label bs5-badge bs5-text-bg-danger none-ascards">Out of stock</span>':null})));for(let t of e)t=p()(t),t=g()(t);if(s()){const t=e.find((t=>t.value===s()));t&&(e=[t,...e.filter((t=>t.value!==s()))])}return e}().map((t=>(zr(f)&&(t.selected=t.value===zr(f)||t.selected),t)))),rn(T,zr(x).filter((t=>t.selected)).map((t=>p()(t).title)).join(", ")||"---")})),$i(),Ss();var O=Mn(),M=bi(O),C=t=>{var n=Ws();let s;var o=vi(n);let p;Wn(vi(o),e,"title",{},(t=>{Cn(t,zs())})),ti(o);var g=yi(o,2);let m;var f=vi(g),b=vi(f);let y;Zn(vi(b),(()=>zr(T))),ti(b);var _=yi(b,2),O=vi(_);const M=Si(A),C=Si(E);Fs(O,{get multiSelect(){return zr(M)},get deselectable(){return zr(C)},dropdown:!0,get options(){return zr(x)},get disabled(){return l()},get compact(){return a()},$$events:{select:t=>P(t.detail)}});var I=yi(O,2),k=t=>{var e=Zs(),n=vi(e),s=vi(n),o=t=>{var e=Us();as(e),qi((t=>ls(e,"step",t)),[()=>r().attrComputer.isFloatType(i())?.1:1],Si),Ts(e,(()=>zr(w)),(t=>rn(w,t))),Cn(t,e)},a=t=>{var e=Gs();as(e),Ts(e,(()=>zr(w)),(t=>rn(w,t))),Cn(t,e)};$n(s,(t=>{r().attrComputer.isNumberType(i())?t(o):t(a,!1)}));var h=yi(s,2);ti(n),ti(e),qi((()=>h.disabled=l())),Tn("click",h,Ps(S)),Tn("submit",e,Ps(S)),Cn(t,e)};$n(I,(t=>{zr(v).isDynamicValue(i())&&t(k)})),ti(_),ti(f),ti(g),ti(n),qi(((t,e,i,r,a)=>{s=is(n,1,"",null,s,t),p=is(o,1,"",null,p,e),m=is(g,1,"",null,m,i),y=is(b,1,`bs5-btn bs5-btn-$${c()??""} bs5-w-100 bs5-text-truncate bs5-py-3 bs5-text-break btn-default bs5-text-wrap dropdown-menu-title`,"svelte-10zajgz",y,r),b.disabled=zr(x).length<2||l()||h(),ns(b,(""!==u()?" color:"+u():"")+";"),ls(b,"data-bs-auto-close",a)}),[()=>({"bs5-row":d()}),()=>({"bs5-col":d()}),()=>({"bs5-col":d()}),()=>({"bs5-out-of-stock":h(),"bs5-disabled":l()||h(),"bs5-bg-white":!l(),"bs5-dropdown-toggle":zr(x).length>1}),()=>A()?"outside":"true"],Si),Cn(t,n)},I=t=>{var r=Ys(),n=bi(r);Wn(vi(n),e,"title",{},(t=>{var e=Mn(),r=bi(e),n=t=>{Cn(t,Ks())};$n(r,(t=>{"laminate"!==i()&&"material"!==i()&&t(n)})),Cn(t,e)})),ti(n);var s=yi(n,2);const o=Si(A),h=Si(E),d=Si((()=>"sheet_name"===i()||"laminate"===i()||"material"===i()));Fs(s,{get multiSelect(){return zr(o)},get deselectable(){return zr(h)},get forceRadio(){return zr(d)},get options(){return zr(x)},get disabled(){return l()},get compact(){return a()},$$events:{select:t=>P(t.detail)}}),Cn(t,r)};$n(M,(t=>{o()&&!r().isBusy?t(C):t(I,!1)})),Cn(t,O),cn()}var Js,to,eo;!function(t){t.VIEW_PREVIEW="editor_view_preview",t.VIEW_EDIT="editor_view_edit",t.VIEW_BPP="editor_view_bpp",t.CLOSE="editor_close",t.CHANGE_OUTLINE="editor_change_outline",t.CHANGE_MATERIAL="editor_change_material",t.CHANGE_HEIGHT="editor_change_height",t.CHANGE_WIDTH="editor_change_width",t.CHANGE_LAMINATE="editor_change_laminate",t.CHANGE_QUANTITY="editor_change_quantity",t.REMOVE_COMMENT="editor_remove_comment",t.ADD_COMMENT="editor_add_comment",t.UPLOAD_FILE="editor_upload_file",t.ADD_BACKGROUND="editor_add_background",t.BPP_ADD_BACKGROUND="editor_bpp_add_background",t.ADD_TEXT="editor_add_text",t.BPP_ADD_TEXT="editor_bpp_add_text",t.ADD_CLIPART="editor_add_clipart",t.BPP_ADD_CLIPART="editor_bpp_add_clipart",t.BPP_SHOW="editor_bpp_show",t.BPP_UPLOAD_FILE="editor_bpp_upload_file",t.BPP_REMOVE_FILE="editor_bpp_remove_file",t.EFFECT_LAYER_ADD="editor_effect_layer_add",t.EFFECT_LAYER_BROWSE="editor_effect_layer_browse",t.EFFECT_LAYER_DONE="editor_effect_layer_done",t.EFFECT_LAYER_REMOVE="editor_effect_layer_remove",t.EFFECT_LAYER_UPLOADED="editor_effect_layer_uploaded",t.SAVE_DESIGN="editor_save_design",t.INVERT_EFFECT="editor_invert_effect",t.SELECT_EFFECT="editor_select_effect",t.RESET_EFFECT="editor_reset_effect"}(Js||(Js={})),function(t){t.CHECKOUT_EDITOR="checkout_editor",t.WIZARD_EDITOR="wizard_editor"}(to||(to={})),function(t){t.EDITOR_PREVIEW="editor_preview",t.EDITOR_EDIT="editor_edit",t.EDITOR_BPP="editor_bpp"}(eo||(eo={}));class io extends he{constructor(t,e){super(t,e,"material-preset"),this._changed=!1,this._queuedAfterUploadDone=!1,this.mounted=!1,t.data("editor","#"+e.id),t.data("viewport","#"+e.id),t.data("container","#"+e.id),t.data("placement","top"),this.attributeBoxWrapper=document.createElement("div"),this.attributeBoxWrapper.classList.add("bs5-w-100"),this.$body.append(this.attributeBoxWrapper),this.mountAttributeBox(),this.addListenerToSVG(a.PRODUCT_ATTR_EVALUATED,(()=>{this.setEnabled(!this.shouldHideTool()),this.enabled||t.addClass("hidden"),this.render()})),this.addListener(a.OPEN_TOOL,(t=>{this.renderScrollTop()}))}mountAttributeBox(){const t={attributeName:"material",context:this.editor.context,stackHorizontal:!0,translations:{lang:LANG,strings:this.editor.model.language.products}},e={preChange:t=>{!function(t,e,i={}){let r={event:"change_material",event_params:{action:"editor",material_from:t,material_to:e}};Object.keys(i).length&&(r.ecommerce={items:[Object.assign(Object.assign({},i),{currency:ce()})]},dataLayer.push({ecommerce:null})),dataLayer.push({event_params:null}),dataLayer.push(ue(r))}(t.detail.from,t.detail.to),this.editor.helpers.eventTracker.trackEditorChange(Js.CHANGE_MATERIAL,t.detail.from,t.detail.to)},change:t=>this.onUserSelectMaterial(t.detail)};this.mounted?Ln(Qs,{target:this.attributeBoxWrapper,props:t,events:e}):(Nn(Qs,{target:this.attributeBoxWrapper,props:t,events:e}),this.mounted=!0)}shouldHideTool(){return 1===this.editor.context.getAttributeOptions("material").length&&!this.editor.model.settings.isAdmin}render(){this.renderTitle(),this.enabled?(this.editor.$el.addClass("has-material-selector"),this.editor.$el.removeClass("has-no-material-selector"),this.$el.removeClass("hidden"),this.renderList()):(this.editor.$el.addClass("has-no-material-selector"),this.editor.$el.removeClass("has-material-selector"),this.$el.addClass("hidden"))}renderList(){this.mountAttributeBox()}renderTitle(){const t=de.getTranslationFromMap(this.editor.model.language.products,"products","material",this.helpers.product.getMaterial());this.$(".value").html(t+' <i class="icon-drop-up"></i>')}renderScrollTop(){let t=this.attributeBoxWrapper.querySelector(".bs5-list-group-item[data-active='true']");if(t){let e=$(t).offset().top-this.$body.offset().top+this.$body.scrollTop()-this.$body.height()/3;this.$body.scrollTop(e)}}setEnabled(t){super.setEnabled(t),this.render()}changeMaterial(t=null){const e=t.value;this.helpers.product.setMaterial(e),this.editor.trigger(a.REQUEST_PRODUCT_ATTR_EVALUATION),this.editor.trigger(a.MATERIAL_CHANGE,{to:e}),this.editor.helpers.event.requestUpdate(0,{rebuildSVG:!this.editor.helpers.livePreview.isOn(),partChanged:!0,showSpinner:!this.editor.helpers.livePreview.isOn(),rebuildLivePreview:!1})}processQueue(){this._queuedAfterUploadDone&&(this.changeMaterial(),this._queuedAfterUploadDone=!1)}onUserSelectMaterial(t){this.helpers.product.setCherryPickValue("material",t.value,!this.editor.model.settings.isAdmin),this.changeMaterial(t),this.renderTitle(),this.renderList()}onBack(t){this.editor.orientation==wd.ORIENTATION_PORTRAIT&&(this.visible=!1)}}class ro extends r{constructor(t,e){if(super(t),this._visible=!1,this._disabled=!1,this._sticky=!1,this._closeOnClickAgain=!0,this._closeOnClickInside=!0,!t.length)return;this.$content=$('<div class="w-12"></div>');let i={animation:!1,html:!0,content:()=>this.$content,title:"",template:this.template,trigger:"manual",placement:"bottom",customClass:"",fallbackPlacements:[]};e=Object.assign(Object.assign({},i),e),this.popover=new window.bootstrap.Popover(this.$el,e),this._onBodyMouseDownHandler=t=>this.onBodyClick(t),$("body").on("click",this._onBodyMouseDownHandler)}renderPopover(){this._visible?(this.$el.addClass("active"),this.popover.show()):(this.popover.hide(),this.$el.removeClass("active"))}destroy(){$("body").off("click",this._onBodyMouseDownHandler),this.disabled=!0,this.popover.dispose()}disable(){this.popover.disable()}enable(){this.popover.enable()}hide(){this.popover.hide()}get disabled(){return!this.$el.data("bs.popover")||this._disabled}set disabled(t){this._disabled=t,1==t&&this.visible&&(this.visible=!1)}get visible(){return this.$popover?this.$popover.is(":visible"):this._visible}set visible(t){this._visible!=t&&(this._visible=t,this.renderPopover())}get $content(){return this._$content}set $content(t){this._$content=t}get $popover(){return $(this.popover.tip)}get $contentContainer(){return this.$popover.find(".bs5-popover-body")}get $header(){return this.$popover.find(".bs5-popover-header")}get $closeButton(){return this.$popover.find("button.close")}get template(){return'\n\t\t\t<div class="bs5-popover editor-popover" role="tooltip">\n\t\t\t\t<div class="bs5-popover-arrow"></div>\n\t\t\t\t<div class="bs5-popover-header bs5-p-0">\n\t\t\t\t\t<span class="popover-title"></span>\n\t\t\t\t</div>\n\t\t\t\t<button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="icon-cross"></i></button>\n\t\t\t\t<div class="bs5-popover-body"></div>\n\t\t\t</div>\n\t\t'}get closeOnClickAgain(){return this._closeOnClickAgain}set closeOnClickAgain(t){this._closeOnClickAgain=t}get sticky(){return this._sticky}set sticky(t){this._sticky=t}get closeOnClickInside(){return this._closeOnClickInside}set closeOnClickInside(t){this._closeOnClickInside=t}onBodyClick(t){this._disabled||this.sticky||$(t.target).parents().is(".bs5-popover-body")&&!this.closeOnClickInside||(this.$el.has(t.target).length||this.$el.is(t.target)||this.$popover.has(t.target).length||this.$popover.is(t.target)?this.$el.hasClass("disabled")||$(t.target).hasClass("close")||$(t.target).parent().hasClass("close")||(this.$el.has(t.target).length||this.$el.is(t.target))&&this.visible&&this.closeOnClickAgain?this.visible=!1:this.visible=!0:this.visible=!1)}}class no extends he{constructor(t,e){super(t,e,"note"),t.data("editor","#"+e.id),t.data("viewport","#"+e.id),t.data("container","#"+e.id),t.data("placement","top"),this._popover=new ro(t,{placement:"top"}),this._popover.$closeButton.remove(),this._popover.$header.remove();const i=this.editor.model.productItem.attributes.note;i&&i.length>0&&this.$textarea.val(i),this.addListenerTo(this.$el.get(),a.CLOSE_TOOL+" hidden.bs.popover",(()=>this.render(this.$textarea.val(),!0))),this.addListenerToSVG(a.PRE_SAVE,(()=>{!i&&this.$textarea.val()&&this.helpers.eventTracker.trackEditorEvent(Js.ADD_COMMENT),i&&!this.$textarea.val()&&this.helpers.eventTracker.trackEditorEvent(Js.REMOVE_COMMENT)})),this.addListenerTo(this.$el.get(),"show.bs.popover",(t=>this.onShowPopover())),this.addListenerTo(this.$el.get(),"shown.bs.popover",(t=>this.onShownPopover())),this.addListenerToSVG(a.ORIENTATION_UPDATE,(t=>this.renderBasedOnEditorOrientation())),this.addListenerTo(this.$body.get(),"click",".cta.done",(t=>this.onDone(t)))}render(t,e=!1){this.enabled?(this.$el.removeClass("hidden"),t?(this.$el.addClass("has-note"),this.$(".preview").text(t),this.$textarea.val(t),this.editor.helpers.product.item.setAttribute("note",t)):(this.editor.helpers.product.item.removeAttribute("note"),this.$el.removeClass("has-note"))):this.$el.addClass("hidden"),e&&function(t,e){if(t===e||!t&&!e)return;let i={event:""===e?"comment_removed":"comment_added",event_params:{action:"editor",label:"comment"}};dataLayer.push({event_params:null}),dataLayer.push(ue(i))}(this.editor.helpers.product.note,t)}setEnabled(t){super.setEnabled(t),this.render(this.helpers.product.getNote())}renderBasedOnEditorOrientation(){this.editor.isLandscapeOrientation()?(this._popover.disabled=!1,0==this._popover.$content.find(".tool-content-body").length&&this._popover.$content.append(this.$body)):(this._popover.disabled=!0,0==this.$content.find(".tool-content-body").length&&this.$content.append(this.$body))}get $textarea(){return this.$body.find("textarea")}get $body(){return this._$body||(this._$body=$(this.$content.find(".tool-content-body"))),this._$body}get $header(){return this._$header||(this._$header=$(this.$content.find(".tool-content-header"))),this._$header}onClick(t){this.editor.isLandscapeOrientation()||(t.preventDefault(),super.onClick(t))}onShowPopover(){}onDone(t){t.stopPropagation(),this._popover.visible=!1}onShownPopover(){n.isTouchDevice()||this.$textarea.trigger("focus")}onTransitionInDone(){n.isTouchDevice()||this.$textarea.trigger("focus")}}class so{baseURL="";init={};url="";urlParams="";constructor(t=""){this.baseURL=t}createRequest(){return this.init={},this.url="",this.urlParams="",this}setMethod(t){return this.init.method=t,this}setBody(t){return this.init.body=t,this}setSignal(t){return this.init.signal=t,this}setHeader(t,e){const i=this.init.headers||new Headers;return i.set(t,e),this.init.headers=i,this}setURL(t){return this.url=t,this}setURLParams(t){for(const[e,i]of Object.entries(t))"string"!=typeof i&&(t[e]=JSON.stringify(i));return this.urlParams="?"+new URLSearchParams(t).toString(),this}async execute(){const t=await fetch(this.baseURL+this.url+this.urlParams,this.init),e=await t.text();try{const i=JSON.parse(e);if(t.ok)return i;const r=new Error(i.message??i.error??Object.values(i)[0]??JSON.stringify(i));throw r.name="CustomError",r}catch(i){if(t.ok)return e;const r=i;throw new Error("CustomError"===r.name?r.message:e)}}}class oo{baseURL;qb;constructor(t=window.API_URL){this.baseURL=t,this.qb=new so(t)}async calculatePrice(t,e){return this.qb.createRequest().setURL(`/product/calculate_price/${e}`).setURLParams({item:t}).execute()}async validateEditorProductItem(t,e=!1){return this.qb.createRequest().setURL("/product/validate_product_item").setURLParams({item:t,excludeOutOfStock:e}).execute()}async getEditor(t,e,i){return this.qb.createRequest().setURL(`/product/get_editor/${e}/${i?"1":"0"}`).setURLParams({item:t}).execute()}async getProductMap(t,e){return this.qb.createRequest().setURL(`/product/get_product_attr_map/${t}/${e}`).execute()}}class ao extends ro{constructor(t){var e,i,r;if(super(t,{placement:null!==(i=null===(e=t[0].dataset)||void 0===e?void 0:e.bsPlacement)&&void 0!==i?i:"auto"}),this._asc=!0,this.closeOnClickAgain=!1,!this.$el.data("product-item"))throw Error("Cannot work with legacy sheets.");this.productItem=(r=this.$el.data("product-item"),new Hs.ProductItem("","").reset(r)),this.productService=new oo(API_URL),this.$popover.addClass("editor-popover-md editor-popover-lg-when-screen-sm editor-popover-quantity-selector"),this.$contentContainer.addClass("stretch"),this.$el.data("editor")&&$(this.$el.data("editor")).get(0).addEventListener(a.UPDATED,(t=>this.onResult(t.detail,!0))),this.$content.on("mousedown",".list-item",(t=>this.onSelect(t))),this.$el.on("change update",(t=>this.render())),this.$el.on("shown.bs.popover",(t=>this.onShown(t))),this.$el.on("blur",(t=>this.visible=!1))}update(){return t=this,e=arguments,r=function*(t=!0,e=null){var i;this._xhr&&this._xhr.abort(),t&&this.$content.html(`<div class="f-row"><div class="f-col-12 text-center"><img src="${STATIC_BASE_URL}images/web/loaders/light.gif" width="16" height="16"></div></div>`),this.visible&&this.$popover.show();let r=yield this.productService.getEditor(this.$el.data("product-item"),null!==(i=this.lang)&&void 0!==i?i:LANG,"1"==this.inc_vat);this.onResult(r,t),e&&e()},new((i=void 0)||(i=Promise))((function(n,s){function o(t){try{l(r.next(t))}catch(t){s(t)}}function a(t){try{l(r.throw(t))}catch(t){s(t)}}function l(t){t.done?n(t.value):function(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(o,a)}l((r=r.apply(t,e||[])).next())}));var t,e,i,r}formatAddToCartURI(t=!0){let e=`/editor/new_product?productItem=${JSON.stringify(this.productItem)}`;return t&&(e+="&checkout"),e}render(){this.quantity&&Number(this.quantity)%1==0&&(this.$content.find(".list-item").removeClass("active"),this.$content.find(".list-item[data-quantity="+this.quantity+"]").addClass("active"))}clear(){this.$content.html("")}renderPopover(){super.renderPopover(),this._visible&&(this.$content.find(".list-item").length||this.update())}select(t){const e=this.quantity;this.quantity=t.data("quantity"),this.render(),this.$el.trigger("focus"),this.$el.trigger("update"),o.isCheckout()&&!this.$el.data("editor")?M.triggerQuantityStepSelect(this.quantity,t.find(".price-formatted").html(),"checkout",e):M.triggerQuantityStepSelect(this.quantity,t.find(".price-formatted").html(),"editor",e),this.trigger({type:"select.stapp",priceFormatted:t.find(".price-formatted").html()})}static get DATA_KEY(){return"QuantitySelector"}set quantity(t){this.$el.val(t)}get quantity(){return this.$el.val()}get lang(){return this.$el.data("lang")}get inc_vat(){return this.$el.data("inc_vat")}get backprint_modified(){return this.$el.data("backprint_modified")}get template(){return'\n\t\t\t<div class="bs5-popover editor-popover bs5-text-center" role="tooltip">\n\t\t\t\t<div class="bs5-popover-arrow"></div>\n\t\t\t\t<div class="bs5-popover-body bs5-p-0"></div>\n\t\t\t</div>\n\t\t'}set options(t){let e=this;$(t).each((function(t,i){let r=$(`\n\t\t\t<div class="bs5-p-2 f-row f-row-as-li cta list-item" data-quantity="${i.quantity}">\n\t\t\t   <div class="bs5-col">\n\t\t\t      <div class="quantity-formatted">${i.quantityFormatted}</div>\n\t\t\t   </div>\n\t\t\t   <div class="bs5-col">\n\t\t\t      <div class="price-formatted">${i.price}</div>\n\t\t\t   </div>\n\t\t\t   <div class="bs5-col">\n\t\t\t      <div class="save">\n\t\t\t         <div class="price-tag sm">\n\t\t\t            <div class="price">-${i.save}%</div>\n\t\t\t         </div>\n\t\t\t      </div>\n\t\t\t   </div>\n\t\t\t</div>\n\t\t\t`);i.save&&0!=parseInt(i.save)||r.find(".save").addClass("hidden"),e.$content.append(r)}))}set minQuantity(t){this.$el.attr("min",t)}onResult(t,e=!1){e&&(this.$content.html(""),this._asc=!0,this.options=t.settings.quantityAndPriceOptions,this.minQuantity=t.settings.minQuantity,this.$popover.hasClass("top")&&(this.$content.append(this.$content.find(".list-item").get().reverse()),this._asc=!1)),this.visible&&this.$popover.show(),this.render(),this.trigger({type:"refresh.stapp",editorData:t})}onSelect(t){return t.preventDefault(),t.stopPropagation(),this.select($(t.currentTarget).closest(".list-item")),this.$el.trigger("blur"),!1}onShown(t){this.$popover.hasClass("top")&&this.$content.find(".list-item").length&&this._asc&&(this.$content.append(this.$content.find(".list-item").get().reverse()),this._asc=!1)}}class lo extends ae{constructor(t,e){super(t,e),this.$input.data("editor","#"+e.id),this.$input.data("viewport","#"+e.id),this.$input.data("container","#"+e.id),this.$input.data("placement","top"),this.$input.data("product-item",this.context.productItem),this._quantitySelector=new ao(this.$input),this.addListenerToSVG(p.CLICK,(t=>this.onEditorContainerClick())),this.addListenerToSVG(a.DESTROY,(t=>this._quantitySelector.destroy())),this.addListenerToSVG(a.UPDATED,((t,e)=>this.onEditorUpdated(t,e))),this.addListenerToSVG(p.READY,(t=>this.onEditorUpdated(t,this.editor.model))),this.$input.on("update",(()=>this.onQuantityUpdate())),this.addListenerTo(this.$input.get(),"shown.bs.popover",(()=>this.onShown())),this.addListenerToSVG(a.PRODUCT_ATTR_EVALUATED,(()=>{this.$input.data("product-item",this.context.productItem)}))}render(){this._quantitySelector.render()}focus(){this.$input.trigger("focus")}update(){this.$input.trigger("update")}set options(t){this._quantitySelector.options=t}set oldQuantity(t){this.$input.attr("old",t)}set minQuantity(t){this.$input.attr("min",t),parseInt(this.quantity)<parseInt(t)&&(this.quantity=t)}get minQuantity(){return this.$input.attr("min")}set quantity(t){parseInt(t)<parseInt(this.minQuantity)&&(t=this.minQuantity),t==this.quantity||isNaN(parseInt(t))||(this.helpers.product.setQuantity(parseInt(t)),this._quantitySelector.quantity=t)}get quantity(){return this.$input.val()}get $input(){return this.editor.model.ui.inputQuantity?$(this.editor.model.ui.inputQuantity):this.$("input.summary-quantity")}onShown(){if(this._quantitySelector.$popover.hasClass("top")){let t=parseFloat(this._quantitySelector.$popover.css("top"));this._quantitySelector.$popover.css("top",t-25+"px")}}onEditorContainerClick(){this.$input.trigger("blur"),this._quantitySelector.visible=!1}onEditorUpdated(t,e){this.minQuantity=String(e.settings.minQuantity),this.quantity=String(e.productItem.attributes.quantity),this._quantitySelector.onResult(e,!0)}onQuantityUpdate(){String(this.helpers.product.getQuantity())!=this.quantity&&(this.editor.helpers.eventTracker.trackEditorChange(Js.CHANGE_QUANTITY,String(this.helpers.product.getQuantity()),this.quantity),this.helpers.product.setQuantity(parseInt(this.quantity)),this.editor.helpers.event.requestUpdate())}}class ho extends he{constructor(t,e){super(t,e,"text"),this._canvasID="text-canvas-"+this.editor.id,this.$body.find(".canvas-text").attr("id",this._canvasID),this._canvas=document.getElementById(this._canvasID),this.$colorpicker.spectrum({color:"#000000",flat:!0,showButtons:!1,move:t=>this.onChangeTextColor(t.toHexString())}),this.locked=!1,this.registerCallBacks()}registerCallBacks(){this.addListenerTo(this.$el.get(),a.OPEN_TOOL,(t=>this.onOpenTool(t))),this.addListenerTo(this.$content.get(),"input propertychange","textarea",(t=>this.onInputText(t))),this.addListenerTo(this.$content.get(),"change","[name=rgb_text_input_type]",(()=>this.onRGBTextInputTypeChange())),this.addListenerTo(this.$content.get(),"change","[name^=rgb_text_input_]",(t=>this.onRGBChange(t))),this.addListenerTo(this.$content.get(),"click","#save-text",(()=>this.editor.svg.select.deselect())),this.addListenerTo(this.$content.get(),"click","li a",(t=>this.onSelectFont(t))),this.addListenerTo(this.$content.get(),"click",".btn-alignment",(t=>this.onClickAlignment(t))),this.addListenerToSVG(p.DESELECT_NODE,(t=>this.hide())),this.addListenerTo(this.$content.get(),"mousemove","#"+this._canvasID,(t=>this.onMouseMoveCanvas(t))),this.addListenerTo(this.$content.get(),"mousedown","#"+this._canvasID,(t=>this.onMouseDownCanvas(t))),this.addListenerToSVG(p.NEW_TEXT_NODE_ADDED,(t=>{const e=this.editor.svg.part.isBackSideActive()?Js.BPP_ADD_TEXT:Js.ADD_TEXT;this.helpers.eventTracker.trackEditorEvent(e)}))}render(){if(this.enabled){this.$el.removeClass("hidden"),this.$content.find(".font-preview").text(this.title),this.$content.find(".font-preview").css("font-family",this.fontName),this.$textarea.removeClass("text-center text-right");let t=this.$content.find("input[name=text-align][checked]").siblings("i");this.$content.find(".align-preview > i").attr("class",t.attr("class")),"end"==this.anchor?this.$textarea.addClass("text-right"):"middle"==this.anchor&&this.$textarea.addClass("text-center")}else this.$el.addClass("hidden"),this.hide()}reset(){this.text="",this.fontName="",this.color="",this.align="left"}hide(){this.visible=!1,this.editor.isLandscapeOrientation()&&this.reset()}show(){this.render(),this.visible=!0}setEnabled(t){super.setEnabled(t),this.render()}setTextByJSON(t){this.enabled&&(this.text=t.text,this.fontName=t.font,this.color=t.color,this.anchor=t.align,this.render(),this.editor.isLandscapeOrientation()&&(this.$el.hasClass("active")?this.$textarea.trigger("focus"):this.show()))}get $textarea(){return this.$body.find("textarea")}get $colorpicker(){return this.$body.find("input.colorpicker")}set text(t){this.$textarea.val(t)}get text(){return this.$textarea.val()}set bodyMaxHeight(t){this.$body.css("max-height",t);let e=t-80;this.$body.find(".sp-container.sp-flat .sp-top-inner").css("max-height",e>=60?e:t-10+"px"),this.$colorpicker.spectrum("reflow")}set color(t){this.$colorpicker.spectrum("set",t)}get color(){return this.$colorpicker.spectrum("get").toHexString()}set align(t){switch(t){case"right":t="end";break;case"center":t="middle";break;default:t="start"}this.$content.find("input[name=text-align]").prop("checked",!1).parent("label").removeClass("active"),this.$content.find("input[name=text-align][value="+t+"]").prop("checked",!0).parent("label").addClass("active")}get align(){let t="left";switch(this.anchor){case"end":t="right";break;case"middle":t="center"}return t}get anchor(){return this.$content.find("input[name=text-align][checked]").val()}set anchor(t){t||(t="start"),this.$content.find("input[name=text-align]").prop("checked",null).attr("checked",null).parent("label").removeClass("active"),this.$content.find("input[name=text-align][value="+t+"]").attr("checked","checked").prop("checked","checked").parent("label").addClass("active")}get title(){return this.$activeFontLink.data("title")}set fontName(t){let e=this.$content.find(".font-wrapper ul li a").first();this.$content.find(".font-wrapper ul li a").each((function(){$(this).data("fontName")==t&&(e=$(this))})),this.$activeFontLink=e}get fontName(){return this.$activeFontLink.data("fontName")}get $activeFontLink(){return this.$content.find(".font-wrapper ul li.active a")}set $activeFontLink(t){this.$content.find(".font-wrapper ul li").removeClass("active"),t.parent("li").addClass("active"),this.$content.find(".font-preview").text(this.title),this.$content.find(".font-preview").css("font-family",this.fontName)}get canvas(){return this._canvas}onOpenTool(t){this.visible&&(this.$colorpicker.spectrum("reflow"),this.editor.helpers.canvas.setColorPickerCanvas(this.canvas))}onTransitionInDone(){n.isTouchDevice()||this.$textarea.trigger("focus")}onInputText(t){"back"!=this.editor.svg.part.getActivePartSide()||this.helpers.product.hasBackprint()||this.editor.trigger(a.BACKSIDEPRINT_MODIFIED),this.editor.svg.selected&&this.editor.trigger(a.PART_EDITED,{edited:"text"}),this.editor.svg.text.changeText({font:this.fontName,text:this.text,color:this.color,align:this.anchor,locked:this.locked}),this.editor.helpers.canvas.setColorPickerCanvas(this.canvas),this.onChangeTextColor(this.color)}onChangeTextColor(t,e=!0){switch(e&&this.editor.svg.text.changeTextColor(t),this.$content.find("[name=rgb_text_input_type]").val()){case"dec":case"hex":this.$content.find("[name=rgb_text_input_red]").removeClass("hidden"),this.$content.find("[name=rgb_text_input_green]").removeClass("hidden"),this.$content.find("[name=rgb_text_input_blue]").removeClass("hidden"),this.$content.find("[name=rgb_text_input_cyan]").addClass("hidden"),this.$content.find("[name=rgb_text_input_magenta]").addClass("hidden"),this.$content.find("[name=rgb_text_input_yellow]").addClass("hidden"),this.$content.find("[name=rgb_text_input_black]").addClass("hidden");break;case"cmyk":this.$content.find("[name=rgb_text_input_red]").addClass("hidden"),this.$content.find("[name=rgb_text_input_green]").addClass("hidden"),this.$content.find("[name=rgb_text_input_blue]").addClass("hidden"),this.$content.find("[name=rgb_text_input_cyan]").removeClass("hidden"),this.$content.find("[name=rgb_text_input_magenta]").removeClass("hidden"),this.$content.find("[name=rgb_text_input_yellow]").removeClass("hidden"),this.$content.find("[name=rgb_text_input_black]").removeClass("hidden")}this.editor.svg.part.setInputsValues(t,this.$content),this.editor.helpers.canvas.setColorPickerCanvas(this.canvas),this.editor.svg.selected&&this.editor.trigger(a.PART_EDITED,{edited:"text"})}onRGBTextInputTypeChange(){this.onChangeTextColor(this.color,!1)}onRGBChange(t){let e="#";if("dec"==this.$content.find("[name=rgb_text_input_type]").val()){if(isNaN(parseInt(this.$content.find("[name=rgb_text_input_red]").val()))||isNaN(parseInt(this.$content.find("[name=rgb_text_input_green]").val()))||isNaN(parseInt(this.$content.find("[name=rgb_text_input_blue]").val())))return e=this.color,this.$content.find("[name=rgb_text_input_red]").val(parseInt(e.replace("#","").substring(0,2),16)),this.$content.find("[name=rgb_text_input_green]").val(parseInt(e.replace("#","").substring(2,4),16)),void this.$content.find("[name=rgb_text_input_blue]").val(parseInt(e.replace("#","").substring(4,6),16));let t=parseInt(this.$content.find("[name=rgb_text_input_red]").val()),i=parseInt(this.$content.find("[name=rgb_text_input_green]").val()),r=parseInt(this.$content.find("[name=rgb_text_input_blue]").val());t<0&&(t=0),i<0&&(i=0),r<0&&(r=0),t>255&&(t=255),i>255&&(i=255),r>255&&(r=255),this.$content.find("[name=rgb_text_input_red]").val(t),this.$content.find("[name=rgb_text_input_green]").val(i),this.$content.find("[name=rgb_text_input_blue]").val(r),e+=qt.paddy(t.toString(16),2),e+=qt.paddy(i.toString(16),2),e+=qt.paddy(r.toString(16),2)}if("hex"==this.$content.find("[name=rgb_text_input_type]").val()){let t=this.$content.find("[name=rgb_text_input_red]").val(),i=this.$content.find("[name=rgb_text_input_green]").val(),r=this.$content.find("[name=rgb_text_input_blue]").val();if(!qt.checkHex(t)||!qt.checkHex(i)||!qt.checkHex(r))return e=this.color,this.$content.find("[name=rgb_text_input_red]").val(e.replace("#","").substring(0,2).toUpperCase()),this.$content.find("[name=rgb_text_input_green]").val(e.replace("#","").substring(2,4).toUpperCase()),void this.$content.find("[name=rgb_text_input_blue]").val(e.replace("#","").substring(4,6).toUpperCase());e+=qt.paddy(t,2),e+=qt.paddy(i,2),e+=qt.paddy(r,2)}if("cmyk"==this.$content.find("[name=rgb_text_input_type]").val()){if(isNaN(parseInt(this.$content.find("[name=rgb_text_input_cyan]").val()))||isNaN(parseInt(this.$content.find("[name=rgb_text_input_magenta]").val()))||isNaN(parseInt(this.$content.find("[name=rgb_text_input_yellow]").val()))||isNaN(parseInt(this.$content.find("[name=rgb_text_input_black]").val()))){let t=qt.hexToCmyk(this.color);return this.$content.find("[name=rgb_text_input_cyan]").val(Math.round(100*t.c)),this.$content.find("[name=rgb_text_input_magenta]").val(Math.round(100*t.m)),this.$content.find("[name=rgb_text_input_yellow]").val(Math.round(100*t.y)),void this.$content.find("[name=rgb_text_input_black]").val(Math.round(100*t.k))}let i=$(t.target),r=i.data("cmyk"),n=i.val();r&&n.toString().length>0&&n>=0&&n<=100&&(this.color=this.editor.svg.part.changeCMYKvalues(r,n,this.color)),e=this.color,this.replaceRGBtoCMYK()}this.color=e,this.onChangeTextColor(e)}onSelectFont(t){this.editor.svg.selected&&this.editor.trigger(a.PART_EDITED,{edited:"text"}),t.preventDefault(),this.$activeFontLink=$(t.target),this.editor.svg.text.changeText({font:this.fontName}),this.render()}onClickAlignment(t){this.editor.svg.selected&&this.editor.trigger(a.PART_EDITED,{edited:"text"});let e=$(t.currentTarget).find("input").val();this.anchor=e,this.$content.find("textarea").trigger("focus"),this.editor.svg.text.changeText({align:e}),this.render()}onClick(t){if(t.preventDefault(),this.$el.hasClass("disabled"))return!1;this.editor.svg.selected&&this.editor.svg.selected.type==d.SHAPE_TEXT||(this.reset(),this.editor.svg.select.deselect()),this.show()}replaceRGBtoCMYK(){let t=this.color,e=qt.hexToCmyk(t);this.$content.find("[name=rgb_text_input_cyan]").val(Math.round(100*e.c)),this.$content.find("[name=rgb_text_input_magenta]").val(Math.round(100*e.m)),this.$content.find("[name=rgb_text_input_yellow]").val(Math.round(100*e.y)),this.$content.find("[name=rgb_text_input_black]").val(Math.round(100*e.k))}disable(){super.setEnabled(!1),this.$el.addClass("disabled")}onMouseMoveCanvas(t){let e=this.editor.helpers.canvas.getMousMoveCanvasHex(this.canvas,t);this.$body.find(".text-canvas-swatch").css("background-color",e)}onMouseDownCanvas(t){let e=qt.rgb2hex(this.$body.find(".text-canvas-swatch").css("background-color"));this.color=e,this.onChangeTextColor(e)}}class co extends he{constructor(t,e){super(t,e,"cutline"),this._tooltipActive=!1,this.processingQueue=!1,this._canvasID="cutline-canvas-"+this.editor.id,this.$body.find(".canvas-cutline").attr("id",this._canvasID),this._canvas=document.getElementById(this._canvasID),this.currentOutline=this.editor.model.productItem.attributes.sheet_name.toString(),this.addListenerTo(this.$el.get(),a.OPEN_TOOL,(t=>this.onShow(t))),this.addListenerTo(this.$el.get(),"hidden.bs.tooltip",(t=>this.onHiddenToolTip(t))),this.addListenerTo(this.$content.get(),"click",".btn-path-new-s",(t=>this.onClickBtnPathNewS(t))),this.addListenerTo(this.$content.get(),"click",".btn-path-new-m",(t=>this.onClickBtnPathNewM(t))),this.addListenerTo(this.$content.get(),"click",".btn-path-new-l",(t=>this.onClickBtnPathNewL(t))),this.addListenerTo(this.$content.get(),"click",".cutline .cta, .shapes .cta, #old-outline, #new-outline, .btn-extra-new-outline",(t=>this.onClickOutline(t))),this.addListenerToSVG(a.UPLOAD_END,(t=>this.processQueue())),this.addListenerToSVG(a.UPLOAD_CANCEL,(t=>this.processQueue())),this.addListenerTo(this.$content.get(),"click",".btn-get-cutline",(t=>this.onClickBtnGetCutline(t))),this.addListenerTo(this.$content.get(),"click",".cta",(t=>{const e=t.currentTarget.getAttribute("data-type");this.editor.helpers.eventTracker.trackEditorChange(Js.CHANGE_OUTLINE,this.currentOutline,e),this.currentOutline=t.currentTarget.getAttribute("data-type")}))}render(){if(this.enabled){if(this.$el.removeClass("hidden"),this.$el.data("has-tooltip")){let t=this.$el;this.$el.each((function(){$(this).is(":visible")&&(t=$(this))}));let e=new window.bootstrap.Tooltip(t,{placement:this.editor.orientation==wd.ORIENTATION_PORTRAIT?"top":"left",container:"#"+this.editor.id,trigger:"manual"});e.show(),t.on("click",(()=>{e.hide()})),this._tooltipActive=!0}}else this.$el.addClass("hidden"),this.visible=!1,this._tooltipActive=!1}show(){this.visible=!0}showStickerEmptyAlert(){this.$content.find(".alert").stop(!0,!0).slideDown("fast")}hide(){this.visible=!1}setEnabled(t){super.setEnabled(t),this.render()}get canvas(){return this._canvas}processQueue(){!this._queued||this.processingQueue||this.editor.ui.uploadTool.isUploading||(this.processingQueue=!0,this.helpers.product.setOutline(this._queued.corner_radius&&this._queued.part_type==d.PART_TYPE_RECT?this._queued.part_type+" "+this._queued.corner_radius:this._queued.part_type),function(t,e){var i,r;let n=(null===(i=null==t?void 0:t.meta)||void 0===i?void 0:i.LAST_OUTLINE)?null===(r=null==t?void 0:t.meta)||void 0===r?void 0:r.LAST_OUTLINE:null==t?void 0:t.sheet_name;if(n&&"string"==typeof n){switch(n=n.split(" ")[0],n){case"circle":n="round";break;case"rounded":n="rect"}if(n!==e){let t={event:"change_outline",event_params:{action:"editor",outline_from:n,outline_to:e}};dataLayer.push({event_params:null}),dataLayer.push(ue(t))}}}(this.helpers.product.formatToOrderSheet(),this._queued.part_type),this.editor.svg.part.change(this._queued,(()=>this.onChangePartCallback())))}onShow(t){this.$content.find(".alert").hide(),this.visible&&this.editor.helpers.canvas.setHiddenCanvas()}onHiddenToolTip(t){t.stopPropagation(),this._tooltipActive&&(this._tooltipActive=!1)}onClickBtnGetCutline(t){for(var e=document.createElement("a"),i=this.helpers.exportHelper.exportAndDetectChanges(),r=i.parts,n=5.6693,s=2.83465*i.sheet.height+n+n,o='<svg viewbox="-'+n+" -"+n+" "+(2.83465*i.sheet.width+n+n)+" "+s+'" xmlns="http://www.w3.org/2000/svg" version="1.1">',a=0;a<r.length;a++)o+='<path d="'+r[a].cuttingline+'" fill="none" stroke="black" stroke-width="1" vector-effect="non-scaling-stroke" transform="'+r[a].matrix+'"/>';o+="</svg >",e.setAttribute("href","data:text/svg;charset=utf-8,"+encodeURIComponent(o)),e.setAttribute("download","cutline_sheet_"+this.editor.model.id+".svg"),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}onClickOutline(t){t.preventDefault(),this.$content.find(".alert").hide(),$("#overlay").show();let e={corner_radius:"0",part_type:$(t.currentTarget).data("type")};"rounded"===e.part_type&&(e.part_type="rect",e.corner_radius="25"),this._queued=e,this.processQueue()}onChangePartCallback(){this.editor.trigger(a.PART_EDITED,{edited:"cutline"}),this.editor.trigger(a.UPDATE_BACKPRINT_PATH),"phone"==i&&(this.visible=!1),$("#overlay").hide(),this.processingQueue=!1,this._queued=null}onClickBtnPathNewL(t){t.preventDefault(),this.$content.find("[name=new-outline-size]").val("800"),this.$content.find("[name=new-outline-threshold1]").val("200"),this.$content.find("[name=new-outline-gaussian]").val("3"),this.$content.find("[name=new-outline-k]").val("0.5"),this.$content.find("[name=new-outline-a]").val("1.2"),this.$content.find("[name=new-outline-O]").val("0.1"),this.$content.find("[name=new-outline-expand]").val("4"),this.$content.find("[name=new-outline-contract]").val("0.1"),this.$content.find("[name=new-outline-keep]").prop("checked",!1),this.$content.find("[name=new-outline-auto]").prop("checked",!0),this.$content.find("[name=new-outline-overcut]").prop("checked",!1),this.$content.find("[name=new-outline-padding]").prop("checked",!0)}onClickBtnPathNewM(t){t.preventDefault(),this.$content.find("[name=new-outline-size]").val("800"),this.$content.find("[name=new-outline-threshold1]").val("200"),this.$content.find("[name=new-outline-gaussian]").val("2"),this.$content.find("[name=new-outline-k]").val("0.5"),this.$content.find("[name=new-outline-a]").val("1.2"),this.$content.find("[name=new-outline-O]").val("0.1"),this.$content.find("[name=new-outline-expand]").val("2.9"),this.$content.find("[name=new-outline-contract]").val("0.1"),this.$content.find("[name=new-outline-keep]").prop("checked",!1),this.$content.find("[name=new-outline-auto]").prop("checked",!0),this.$content.find("[name=new-outline-overcut]").prop("checked",!1),this.$content.find("[name=new-outline-padding]").prop("checked",!0)}onClickBtnPathNewS(t){t.preventDefault(),this.$content.find("[name=new-outline-size]").val("800"),this.$content.find("[name=new-outline-threshold1]").val("200"),this.$content.find("[name=new-outline-gaussian]").val("1"),this.$content.find("[name=new-outline-k]").val("0.5"),this.$content.find("[name=new-outline-a]").val("1.2"),this.$content.find("[name=new-outline-O]").val("0.1"),this.$content.find("[name=new-outline-expand]").val("1.7"),this.$content.find("[name=new-outline-contract]").val("0.1"),this.$content.find("[name=new-outline-keep]").prop("checked",!1),this.$content.find("[name=new-outline-auto]").prop("checked",!0),this.$content.find("[name=new-outline-overcut]").prop("checked",!1),this.$content.find("[name=new-outline-padding]").prop("checked",!0)}}class uo extends he{constructor(t,e){super(t,e,"template"),t.data("editor","#"+e.id),t.data("viewport","#"+e.id),t.data("container","#"+e.id),t.data("placement","top"),this._popover=new ro(t),this._popover.$header.css("height","auto"),this._popover.$contentContainer.addClass("stretch"),this._popover.$closeButton.remove(),this._$categoryDropdown=this.$header.find(".category-dropdown"),this.$body.append(this._$categoryDropdown.find(".template-menu")),this.addListenerTo(this._$categoryDropdown.get(),"click","li:not(.disabled) a",(t=>this.onCategoryClick(t))),this.addListenerTo(this.$body.get(),"click",".link-template:not(.disabled)",(t=>this.onClickTemplate(t))),this.addListenerToSVG(a.ORIENTATION_UPDATE,(t=>this.renderBasedOnEditorOrientation())),this.addListenerToSVG(a.DESTROY,(t=>this._popover.destroy())),this.addListenerTo(this.$el.get(),"show.bs.popover",(t=>this.onShowPopover())),this.addListenerTo(this.$el.get(),"shown.bs.popover",(t=>this.onShownPopover())),this.addListenerToSVG(p.CLICK,(t=>this._popover.visible=!1)),this.addListenerToSVG(a.UPLOAD_START,(t=>this.onUploadStart())),this.addListenerToSVG(a.UPLOAD_END,(t=>this.onUploadEnd())),this.addListenerToSVG(a.UPLOAD_CANCEL,(t=>this.onUploadEnd()))}render(){this.enabled?(this.$el.removeClass("hidden"),this.renderBasedOnEditorOrientation(),this.$header.find(".active").removeClass("active"),this.$body.find(".active").removeClass("active"),"case"==this.helpers.product.getSheetType()?"iphone-6-tough"==this.helpers.product.getSheetName()?(this.$currentTemplateLink.removeClass("active"),this.$body.find(".link-template[data-template-name='iphone-6-tough']").addClass("active").removeClass("hidden"),this.$body.find(".link-template[data-template-name='iphone5']").removeClass("active").removeClass("hidden"),this.$body.find(".link-template[data-template-name='iphone6'], .link-template[data-template-name='iphone-5-tough']").addClass("hidden").removeClass("active")):"iphone-5-tough"==this.helpers.product.getSheetName()?(this.$currentTemplateLink.removeClass("active"),this.$body.find(".link-template[data-template-name='iphone-5-tough']").addClass("active").removeClass("hidden"),this.$body.find(".link-template[data-template-name='iphone6']").removeClass("active").removeClass("hidden"),this.$body.find(".link-template[data-template-name='iphone-6-tough'], .link-template[data-template-name='iphone5']").addClass("hidden").removeClass("active")):"iphone6"==this.helpers.product.getSheetName()?(this.$currentTemplateLink.removeClass("active"),this.$body.find(".link-template[data-template-name='iphone6']").addClass("active").removeClass("hidden"),this.$body.find(".link-template[data-template-name='iphone5']").removeClass("active").removeClass("hidden"),this.$body.find(".link-template[data-template-name='iphone-5-tough'], .link-template[data-template-name='iphone-6-tough']").addClass("hidden").removeClass("active")):"iphone5"==this.helpers.product.getSheetName()?(this.$currentTemplateLink.removeClass("active"),this.$body.find(".link-template[data-template-name='iphone5']").addClass("active").removeClass("hidden"),this.$body.find(".link-template[data-template-name='iphone6']").removeClass("active").removeClass("hidden"),this.$body.find(".link-template[data-template-name='iphone6'], .link-template[data-template-name='iphone-5-tough'], .link-template[data-template-name='iphone-6-tough']").addClass("hidden").removeClass("active")):(this.$currentTemplateLink.addClass("active"),this.$body.find(".link-template[data-template-name='iphone5'], .link-template[data-template-name='iphone6']").removeClass("hidden").removeClass("active"),this.$body.find(".link-template[data-template-name='iphone-5-tough'], .link-template[data-template-name='iphone-6-tough']").addClass("hidden").removeClass("active")):this.$currentTemplateLink.addClass("active"),this.$currentTemplateCategoryLink.addClass("active"),this._$categoryDropdown.find(".dropdown-title").text(this.currentCategoryTitle),this.$(".template-title").html(this.$currentTemplateLink.text()+' <i class="icon-drop-up"></i>'),this.$body.find(".template-menu[data-category-id='"+this.currentCategoryID+"']").removeClass("hidden").addClass("active").siblings().removeClass("active").addClass("hidden")):this.$el.addClass("hidden")}setEnabled(t){super.setEnabled(t),this.render()}renderBasedOnEditorOrientation(){this.editor.isLandscapeOrientation()?(this._popover.disabled=!1,this._popover.$content.append(this.$body),this._popover.$header.append(this.$header)):(this._popover.disabled=!0,this.$content.append(this.$header),this.$content.append(this.$body))}renderScrollTop(){if(this.editor.isLandscapeOrientation()){let t=this.$currentTemplateLink.offset().top-this._popover.$contentContainer.offset().top+this._popover.$contentContainer.scrollTop();this._popover.$contentContainer.scrollTop(t)}else{let t=this.$currentTemplateLink.offset().top-this.$body.offset().top+this.$body.scrollTop();this.$body.scrollTop(t)}}get $currentTemplateLink(){let t=this.helpers.product.getSheetName().replace("-tough",""),e=this.$body.find(".link-template[data-template-name='"+t+"']");"iphone-6-tough"!=this.helpers.product.getSheetName()&&"iphone-5-tough"!=this.helpers.product.getSheetName()||(t=this.helpers.product.getSheetName(),e=this.$body.find(".link-template[data-template-name='"+t.replace("-","").replace("tough","")+"']"));let i=this.$body.find(".link-template[data-template-name='"+this.helpers.product.getSheetName()+"']");return e.length>0&&!e.hasClass("disabled")?e:i}get currentCategoryID(){return this.$currentTemplateLink.closest(".template-menu").data("category-id")}get currentCategoryTitle(){return this.$currentTemplateCategoryLink.data("category-title")}get $currentTemplateCategoryLink(){return this._$categoryDropdown.find("li[data-category-id='"+this.currentCategoryID+"']")}get $body(){return this._$body||(this._$body=$(this.$content.find(".tool-content-body"))),this._$body}get $header(){return this._$header||(this._$header=$(this.$content.find(".tool-content-header"))),this._$header}onClick(t){M.openTemplateSelector(this.helpers.product.getSheetName()),this.editor.isLandscapeOrientation()||(t.preventDefault(),super.onClick(t),this.renderScrollTop())}onCategoryClick(t){t.preventDefault();let e=$(t.target).parent("li").data("category-id"),i=$(t.target).parent("li").data("category-title");return M.changeTemplateCategory(this.currentCategoryTitle,i),$(t.target).parent("li").addClass("active").siblings().removeClass("active"),this.$body.find(".template-menu[data-category-id='"+e+"']").removeClass("hidden").addClass("active").siblings().removeClass("active").addClass("hidden"),this._$categoryDropdown.find(".dropdown-title").text(i),this._popover.disabled||this._popover.renderPopover(),!1}onClickTemplate(t){t.preventDefault(),t.stopPropagation();let e=t.currentTarget.dataset,i=e.templateName;this._popover.disabled||(this._popover.visible=!1),this.visible&&(this.visible=!1),i!=this.helpers.product.getSheetName()&&(null!=this.editor.svg.collage?s.instance.confirmOrCancel(this.editor.model.language.change_template_collage_warning,(()=>{"case"==this.helpers.product.getSheetType()?this.editor.trigger(EditorEventType.CHANGE_TEMPLATE,{templateName:i,templateData:e}):this.editor.trigger(EditorEventType.CHANGE_TEMPLATE,{templateName:i})})):"case"==this.helpers.product.getSheetType()?this.editor.trigger(EditorEventType.CHANGE_TEMPLATE,{templateName:i,templateData:e}):this.editor.trigger(EditorEventType.CHANGE_TEMPLATE,{templateName:i}))}onShowPopover(){let t=this.editor.ui.toolPane.$el.outerHeight()-this.editor.ui.toolPane.$panelToolsOverview.outerHeight()-this.$el.position().top-this.$el.outerHeight()-75;this._popover.$contentContainer.css("max-height",t+"px")}onShownPopover(){this.renderScrollTop()}onUploadStart(){this.$el.addClass("disabled"),this.$body.find(".cta").addClass("disabled")}onUploadEnd(){this.$el.removeClass("disabled"),this.$body.find(".cta").removeClass("disabled")}}class po extends he{constructor(t,e){super(t,e,"template-type"),t.data("editor","#"+e.id),t.data("viewport","#"+e.id),t.data("container","#"+e.id),t.data("placement","top"),this._popover=new ro(t),this._popover.$header.css("height","auto"),this._popover.$contentContainer.addClass("stretch"),this._popover.$closeButton.remove(),this._$templateTypeDropdown=this.$header.find(".template-type-dropdown"),this.$body.append(this._$templateTypeDropdown.find(".template-type-dropdown-menu")),this.addListenerToSVG(a.OPEN_TEMPLATE_TYPE_SELECTOR,((t,e)=>this.updateTemplateTypes(t,e))),this.addListenerToSVG("click",".template-type-dropdown-item:not(.disabled)",(t=>this.onClickTemplateType(t))),this.addListenerToSVG(a.ORIENTATION_UPDATE,(t=>this.renderBasedOnEditorOrientation())),this.addListenerToSVG(a.DESTROY,(t=>this._popover.destroy())),this.addListener("show.bs.popover",(t=>this.onShowPopover())),this.addListenerToSVG(p.CLICK,(t=>this._popover.visible=!1)),this.addListenerToSVG(a.UPLOAD_START,(t=>this.onUploadStart())),this.addListenerToSVG(a.UPLOAD_END,(t=>this.onUploadEnd())),this.addListenerToSVG(a.UPLOAD_CANCEL,(t=>this.onUploadEnd()))}render(){this.enabled?(this.$el.removeClass("hidden"),this.renderBasedOnEditorOrientation(),this.$currentTemplateTypeLink.addClass("active")):this.$el.addClass("hidden")}setEnabled(t){super.setEnabled(t),this.render()}renderBasedOnEditorOrientation(){this.editor.isLandscapeOrientation()?(this._popover.disabled=!1,this._popover.$content.append(this.$body),this._popover.$header.append(this.$header)):(this._popover.disabled=!0,this.$content.append(this.$header),this.$content.append(this.$body))}renderScrollTop(){if(this.editor.isLandscapeOrientation()){let t=this.$currentTemplateTypeLink.offset().top-this._popover.$contentContainer.offset().top+this._popover.$contentContainer.scrollTop();this._popover.$contentContainer.scrollTop(t)}}get $triggerPopoverTemplateTypeLink(){return this.$body.find(".cta.tool-template-type")}get $currentTemplateTypeLink(){return this.$body.find('.template-type-dropdown-item[data-template-name="'+this.helpers.product.getSheetName()+'"]')}get $header(){return this._$header||(this._$header=$(this.$content.find(".tool-content-header"))),this._$header}get $body(){return this._$body||(this._$body=$(this.$content.find(".tool-content-body"))),this._$body}onClick(t){this.editor.isLandscapeOrientation()||(t.preventDefault(),super.onClick(t),this.renderScrollTop())}onClickTemplate(t,e){let i=e.templateName,r=i.replace("-tough",""),n=!1;"iphone-6"!=r&&"iphone-5"!=r||(n=!0);let s,o,l,h=e.templateData.templateTypeStrings,d=e.templateData.slimStatus,c=e.templateData.toughStatus,u=i.indexOf("tough")>-1,p=h.split(","),g=p[0];g.indexOf("-")>-1?(l=g.split("-"),s=l[0]+" <small>"+l[1]+"</small>"):(l=[g],s=g);let m,f=p[1];f.indexOf("-")>-1?(m=f.split("-"),o=m[0]+" <small>"+m[1]+"</small>"):(m=[f],o=f);let v=r;u&&(v=i),!0===n&&r.replace("-","");let b="";!0===n||u?b=i:"1"!=c||u||(b=r+"-tough");let y={slim:{templateType:v,html:s,disabled:"1"!=d},tough:{templateType:b,html:o,disabled:"1"!=c}};u?this.$(".template-type-title.value").html(m[0]+' <i class="icon-drop-up hidden-xs"></i>'):this.$(".template-type-title.value").html(l[0]+' <i class="icon-drop-up hidden-xs"></i>'),this.$(".template-type-title.value").html(l+' <i class="icon-drop-up hidden-xs"></i>'),this.editor.trigger(a.OPEN_TEMPLATE_TYPE_SELECTOR,{buttons:y,eventString:h})}updateTemplateTypes(t,e){this.$triggerPopoverTemplateTypeLink.trigger("click"),this._popover.visible=!0;let i=e.buttons;this.$body.find(".template-type-dropdown-item").removeClass("active");let r=document.querySelector('.template-type-dropdown-item[data-template-type="slim"]');r.innerHTML=i.slim.html,r.classList.add("active"),r.dataset.templateName=i.slim.templateType;let n=document.querySelector('.template-type-dropdown-item[data-template-type="tough"]');n.innerHTML=i.tough.html,n.dataset.templateName=i.tough.templateType,i.slim.disabled?(r.setAttribute("disabled","disabled"),r.classList.add("disabled"),r.classList.remove("active")):(r.removeAttribute("disabled"),r.classList.remove("disabled"),r.classList.add("active")),i.tough.disabled?(n.setAttribute("disabled","disabled"),n.classList.add("disabled"),n.classList.remove("active")):(n.removeAttribute("disabled"),n.classList.remove("disabled"),i.slim.disabled&&(r.classList.remove("active"),n.classList.add("active")))}onClickTemplateType(t){t.preventDefault(),t.stopPropagation();let e=t.currentTarget.dataset,i=e.templateName;if(this._popover.disabled||(this._popover.visible=!1),this.visible&&(this.visible=!1),"iphone6-tough"==i&&(i="iphone-6-tough",e.templateName="iphone-6-tough"),"iphone5-tough"==i&&(i="iphone-5-tough",e.templateName="iphone-5-tough"),i!==this.helpers.product.getSheetName()){if(null!=this.editor.svg.collage)$("body").find('div.template-menu .f-row[data-template-name="'+i+'"]'),s.instance.confirmOrCancel(this.editor.model.language.change_template_collage_warning,(()=>this.helpers.event.changeTemplate(i)));else{M.changeTemplate(this.helpers.product.sheetName,i),this.helpers.product.sheetName=i,this.helpers.event.requestUpdate(0,{rebuildSVG:!0});let t=this.$body.find('li.template-type-dropdown-item[data-template-name="'+i+'"]').text();this.$(".value").html(t+'<i class="icon-drop-up hidden-xs"></i>')}this.$body.find("li.template-type-dropdown-item").removeClass("active"),this.$body.find('li.template-type-dropdown-item[data-template-name="'+i+'"]').addClass("active")}}onShowPopover(){let t=this.editor.ui.toolPane.$el.outerHeight()-this.editor.ui.toolPane.$panelToolsOverview.outerHeight()-this.$el.position().top-this.$el.outerHeight()+75;this._popover.$contentContainer.css("max-height",t+"px")}onUploadStart(){this.$el.addClass("disabled"),this.$body.find(".cta").addClass("disabled")}onUploadEnd(){this.$el.removeClass("disabled"),this.$body.find(".cta").removeClass("disabled")}}class go extends he{constructor(t,e,i,r,n){super(t,e,n),this._productsRendered=!1,this.dataURLGetDataProvider=i,this.dataURLGetProductSVG=r,this._$categoryDropdown=this.$header.find(".category-dropdown"),this.addListenerTo(this._$categoryDropdown.get(),"click","li a",(t=>this.onCategoryClick(t))),this.addListenerTo(this.$body.get(),"click",".products a",(t=>this.onProductClick(t)))}render(){this.enabled?(this.$el.removeClass("hidden"),this.productsRendered||this.renderProducts()):this.$el.addClass("hidden")}renderProducts(){this._$categoryDropdown.find(".dropdown-title").text(this._$categoryDropdown.find("li.active a").text());let t=this.$body.find(".products > #cat-"+this.categoryID);if($(t).length)return this.$body.find(".products>.category").addClass("hidden"),$(t).removeClass("hidden"),void(this._productsRendered=!0);this._productsRendered=!0,this.$body.find(".loader").show(),$.ajax({async:!1,type:"get",dataType:"json",timeout:15e3,url:this.dataURLGetDataProvider,data:{id:this.categoryID},success:t=>this.onReceive(t),error:t=>this.onError(t)})}add(t){let e='<a class="bs5-col-4 bs5-p-1" href="#!" data-id="'+t.attachment_id+'" style=""><span class="product-card">';e+=t._img,e+="</span>",e+="</a>";let i=$(e);i.find("img.lazy[data-original]").each((function(){$(this).removeClass("lazy"),$(this).attr("src",$(this).data("original"))})),this.$body.find(".products > #cat-"+this.categoryID).append(i),this.$body.find(".img-tall").removeClass("img-tall")}get categoryID(){return this._$categoryDropdown.find("li.active a").data("id")}get productsRendered(){return this._productsRendered}get dataProvider(){return this._dataProvider}set dataProvider(t){this._dataProvider=t,this.$body.find(".products>.category").addClass("hidden"),this.$body.find(".products").append('<div class="category bs5-row bs5-p-2" id="cat-'+this.categoryID+'"></div>'),$.each(t,((t,e)=>this.add(e)))}get dataURLGetDataProvider(){return this._dataURLGetDataProvider}set dataURLGetDataProvider(t){this._dataURLGetDataProvider=t}get dataURLGetProductSVG(){return this._dataURLGetProductSVG}set dataURLGetProductSVG(t){this._dataURLGetProductSVG=t}onReceive(t){this.dataProvider=t,this.$content.find(".loader").hide(),this.$body.scrollTop(0)}onCategoryClick(t){return t.preventDefault(),$(t.target).parent("li").addClass("active").siblings().removeClass("active"),this.renderProducts(),!1}onProductClick(t){return t.preventDefault(),$("#overlay").show(),$.ajax({type:"get",dataType:"json",timeout:15e3,url:this.dataURLGetProductSVG+"/"+$(t.currentTarget).data("id"),success:t=>this.onReceiveProduct(t),error:t=>this.onError(t)}),!1}onReceiveProduct(t){this.editor.svg.import.importJSON(t,(t=>this.onAddedToEditor(t)),!0)}onAddedToEditor(t){$("#overlay").hide()}onError(t){$("#overlay").hide(),$("#connection-error").modal("show"),this.$content.find(".loader").hide()}onTransitionInDone(t){this.productsRendered||this.renderProducts()}}class mo extends go{constructor(t,e){super(t,e,"/editor/get_cliparts","/editor/get_clipart","cliparts")}onAddedToEditor(t){this.editor.svg.part.getActivePartId()!=this.editor.svg.part.getBackPart().id||this.helpers.product.hasBackprint()||this.editor.trigger(a.BACKSIDEPRINT_MODIFIED),this.editor.trigger(a.PART_EDITED,{edited:"clipart"}),this.editor.svg.transform.fit(t,.7,!0,!1,!0),this.editor.svg.transform.center(t,null,null,!0);const e=this.editor.svg.part.isBackSideActive()?Js.BPP_ADD_CLIPART:Js.ADD_CLIPART;this.helpers.eventTracker.trackEditorEvent(e),super.onAddedToEditor(t)}setEnabled(t){super.setEnabled(t),this.render()}disable(){super.setEnabled(!1),this.$el.addClass("disabled")}render(){this.enabled?(this.$el.removeClass("hidden"),this.$el.removeClass("disabled")):(this.$el.addClass("hidden"),this.visible=!1)}}class fo extends go{constructor(t,e){super(t,e,"/editor/get_stickers","/editor/get_sticker","stickers")}add(t){let e='<a class="f-col-4" href="#!" data-id="'+t.id+'">';e+=t._img,e+="</a>";let i=$(e);i.find("img.lazy[data-original]").each((function(){$(this).removeClass("lazy"),$(this).attr("src",$(this).data("original"))})),this.$body.find(".products > #cat-"+this.categoryID).append(i)}onReceiveProduct(t){this.editor.svg.import.importJSON(t,(t=>this.onAddedToEditor(t)),!0)}}class vo{static get IDLE(){return"idle"}static get START(){return"start"}static get DONE(){return"done"}static get ERROR(){return"error"}}class bo{static get UPLOAD(){return"upload"}static get CUTLINE(){return"cutline"}static get CLIPARTS(){return"cliparts"}static get EFFECT_LAYER_UPLOAD(){return"effect_layer_upload"}static get SHEET_BG_UPLOAD(){return"sheet_bg_upload"}}class yo extends he{constructor(t,e,i=bo.UPLOAD){super(t,e,i),this._status=vo.IDLE,this._quickloadedNodes=[],this._quickloadBytesLimit=3e6,this.showTooltip=!0,this._isActive=!0,this.hideOnClickOutside=!1,this.initFileUpload(e),this.$progressionZone.addClass("hidden"),this.addListenerTo(this.$cancelButton.get(),"click",(t=>this.onCancel(t))),this.addListenerTo(this.$dropZone.get(),"click",(()=>this.open())),this.addListenerToSVG(p.NODE_MENU_CLICK_UPLOAD,(()=>this.open())),this._fileuploadName=this.$fileupload.attr("class")}setAsDefaultUpload(){$(document).trigger("changeCurrentFileUpload",this._fileuploadName)}initFileUpload(t){this.$fileupload.fileupload({i18n:{lang:t.model.settings.lang,mimeTypeError:t.model.language.mime_type_error,fileAppEnabled:t.model.settings.fileAppEnabled},done:(t,e)=>this.onDone(t,e),progressall:(t,e)=>this.onProgressAll(t,e),send:(t,e)=>this.filterSend(t,e),start:t=>this.onStart(t),error:(t,e)=>this.onError(t,e)})}setEnabled(t){super.setEnabled(t),this.renderEnabled()}renderOnStart(){let t=window.bootstrap.Tooltip.getInstance(this.$el);t&&t.dispose(),this.$progressionZone.removeClass("hidden"),this.$dropZone.addClass("hidden"),this.editor.ui.$uploadMessages.remove(),this.progress=0,this.visible=!0}disableDropZone(t){t?(this._isActive=!1,this.$dropZone.addClass("drop-zone-disabled"),this.$dropZone.find(".btn").addClass("disabled")):(this._isActive=!0,this.$dropZone.removeClass("drop-zone-disabled"),this.$dropZone.find(".btn").removeClass("disabled"))}renderOnDone(){this.editor.isLandscapeOrientation()||(this.visible=!1),this.$progressionZone.addClass("hidden"),this.$dropZone.removeClass("hidden"),this.progress=0,this.$(".progress").addClass("hidden")}renderEnabled(){if(this.enabled){this.$el.removeClass("hidden"),this.$el.removeClass("disabled");let t=this.$el;if(this.$el.each((function(){$(this).is(":visible")&&(t=$(this))})),this.showTooltip){let e=new window.bootstrap.Tooltip(t,{placement:"left",fallbackPlacements:["top"],trigger:"manual",title:()=>t[0].dataset.title||""});e.show(),setTimeout((()=>e.dispose()),2500),this.showTooltip=!1}this.renderDropZone()}else{this.$el.addClass("hidden");let t=window.bootstrap.Tooltip.getInstance(this.$el);t&&t.dispose()}}renderDropZone(){this.helpers.product.isCustomizableSheet()||(this.editor.isLandscapeOrientation()?this.$dropZone.attr("style","padding: 15px 0 20px 0;"):this.$dropZone.css("display","none"))}destroy(){this.$fileupload.fileupload("destroy")}open(){this._isActive&&this.$fileupload.trigger("click")}quickLoad(t){for(let e=0;e<t.length;e++){let i=this.editor.ui.$fileupload.data("stapp.fileupload").test(t.item(e));if(i.isApprovedForUpload()&&i.file.size<=this._quickloadBytesLimit){let i=new FileReader,r="image/svg+xml"==t.item(e).type;i.onload=t=>{let i=new Image;i.onload=()=>{let t={svg:'<image uploaded="0" upload_id="'+e+'" vector="'+(r?"true":"")+'" xlink:href="'+i.src+'" x="0" y="0" height="'+i.height+'" width="'+i.width+'" />'};this.editor.svg.import.importJSON(t,(t=>{this._status==vo.DONE||this._status==vo.ERROR?t.remove():this._quickloadedNodes[e]=t}),!0)},i.src=t.target.result},i.readAsDataURL(t.item(e))}}return t}removeQuickLoaded(){if(this._quickloadedNodes.length){for(let t=0;t<this._quickloadedNodes.length;t++){let e=this._quickloadedNodes[t];e.onDeleteMenu()&&e.remove()}this.editor.svg.select.select(null)}}getQuickloadedImageNodeByUploadID(t){if(this._quickloadedNodes[t]){let e=this._quickloadedNodes[t];if(e){let i=e.findChildWithOption("upload_id",t);if(i)return i}}return!1}get $fileupload(){return this.editor.ui.$fileupload}set bodyMaxHeight(t){this.$body.css("max-height",t+"px"),this.$body.css("height",t+"px")}get $progressBar(){return this.$content.find(".progress-bar").eq(0)}set progress(t){this.$(".progress-bar").css("width",t+"%"),this.$progressBar.css("width",t+"%"),this.$progressBar.attr("aria-valuenow",t),t>0?this.$(".progression").html(t+"%"):this.$(".progression").html("")}get $cancelButton(){return this.$body.find(".btn.cancel").eq(0)}get $browseButton(){return this.$body.find("a.browse-link").eq(0)}get $progressionZone(){return this.$body.find(".progression-zone").eq(0)}get $dropZone(){return this.$body.find(".drop-zone").eq(0)}get isUploading(){return this._status==vo.START}get isActive(){return this._isActive}onDone(t,e){let i=e.result.files.length;$.each(e.result.files,((t,e)=>{let r=this.getQuickloadedImageNodeByUploadID(e.upload_id);if(void 0===e.error){if(r)this._quickloadedNodes[e.upload_id].options.json.svg=null,r.element.setAttribute("xlink:href",e.thumb_url),r.link=e.thumb_url,e.vector?(r.element.setAttribute("vector",e.vector),this.editor.svg.dpi.removeImageNode(r)):r.element.removeAttribute("vector"),r.element.setAttribute("uploaded","1"),r.element.removeAttribute("upload_id"),r.uploaded="1",e.fileapp_id&&(r.element.setAttribute("fileapp_id",e.fileapp_id),r.element.setAttribute("fileapp_region",e.fileapp_region)),r.vector=e.vector,r.checkUploadImageQuality(),this._name!=bo.SHEET_BG_UPLOAD&&this.editor.svg.svgSettings.mode==E.MODE_SHEET&&r.getPart().part_type==d.PART_TYPE_RECT&&(r.getPart().setPartType(d.PART_TYPE_PATH),r.getPart().addBleed()),--i,i<=0&&this.renderOnDone();else{let t={svg:""};e.fileapp_id?t.svg='<image fileapp_id="'+e.fileapp_id+'" fileapp_region="'+e.fileapp_region+'" uploaded="1" xlink:href="'+e.thumb_url+'" x="0" y="0" height="'+e.height+'" width="'+e.width+'"':t.svg='<image uploaded="1" xlink:href="'+e.thumb_url+'" x="0" y="0" height="'+e.height+'" width="'+e.width+'"',(e.vector||e.name.endsWith(".pdf")||e.name.endsWith(".ai")||e.name.endsWith(".svg"))&&(t.svg+=' vector="true"'),t.svg+="/>",this.editor.svg.import.importJSON(t,(t=>{if(--i,i<=0&&this.renderOnDone(),null==t){let t=this.editor.model.language.editor_image_error;this.editor.ui.showMessage(le.CATEGORY_UPLOAD,"error",null,t)}else"function"==typeof t.addBleed&&t.addBleed()}),!0)}this._quickloadedNodes[e.upload_id]&&delete this._quickloadedNodes[e.upload_id]}else--i,this.handleFileError(r,e,i)})),this._quickloadedNodes=[],this._status=vo.DONE,this.editor.svg.part.getActivePartId()!=this.editor.svg.part.getBackPart().id||this.helpers.product.hasBackprint()||this.editor.trigger(a.BACKSIDEPRINT_MODIFIED),this.trackUploadFile(),this.editor.trigger(a.PART_EDITED,{edited:"upload"}),this.editor.trigger(a.UPLOAD_END)}handleFileError(t,e,i){if(t){let t=this._quickloadedNodes[e.upload_id];this.editor.svg.selected==t&&this.editor.svg.select.deselect(),t.onDeleteMenu()&&t.remove()}i<=0&&(this.renderOnDone(),this.editor.ui.showMessage(le.CATEGORY_UPLOAD,"error",null,e.error))}onProgressAll(t,e){this.progress=parseInt((e.loaded/e.total*100).toString(),10)}trackUploadFile(){this.editor.svg.part.isBackSideActive()?this.helpers.eventTracker.trackEditorEvent(Js.BPP_UPLOAD_FILE):this.helpers.eventTracker.trackEditorEvent(Js.UPLOAD_FILE)}filterSend(t,e){if(!this.enabled)return!1;if(this.helpers.menu.isTooManyImages())return this.renderOnDone(),!1;let i=!0;for(let t=0;t<e.files.length;t++)switch(e.files.item(t).type){case"image/png":case"image/svg+xml":case"image/jpeg":case"image/gif":break;default:i=!1}return i?(this.quickLoad(e.files),!0):void 0}onStart(t){this._status=vo.START,this.renderOnStart(),this.visible=!0,this.editor.trigger(a.UPLOAD_START)}onError(t,e){this.removeQuickLoaded(),this.renderOnDone(),$("#connection-error").modal("show"),this._status=vo.ERROR,this.editor.trigger(a.UPLOAD_END)}onCancel(t){t.preventDefault(),this._status==vo.START&&(this.$fileupload.fileupload("abort"),this._status=vo.IDLE),this.removeQuickLoaded(),this.renderOnDone(),this.editor.trigger(a.UPLOAD_CANCEL)}onClick(t){if(this.$el.hasClass("disabled"))return!1;this.renderDropZone(),this.helpers.product.isCustomizableSheet()?super.onClick(t):this.visible||this.editor.isLandscapeOrientation()?this.visible&&this.editor.isLandscapeOrientation()?this.open():super.onClick(t):this.open()}onTransitionInDone(){this.$(".progress").addClass("hidden")}onLeave(){this._status==vo.START&&this.$(".progress").removeClass("hidden")}set visible(t){super.visible=t}show(){this.visible=!0}disable(){super.setEnabled(!1),this.$el.addClass("disabled")}}class _o extends ae{constructor(t,e){super(t,e),this.addListener("click","a",(t=>this.onSelectPart(t)))}render(){this.enabled?(this.$el.removeClass("hidden"),this.editor.$el.addClass("has-parts-selector"),this.editor.$el.removeClass("has-no-parts-selector"),this.$("a").removeClass("active"),this.$("a[data-id="+this.editor.svg.part.getActivePartId()+"]").addClass("active")):(this.editor.$el.addClass("has-no-parts-selector"),this.editor.$el.removeClass("has-parts-selector"),this.$el.addClass("hidden"))}setEnabled(t){super.setEnabled(t),this.render()}onSelectPart(t){t.preventDefault();let e=$(t.currentTarget).data("id");e!=this.editor.svg.part.getActivePartId()&&(this.editor.svg.zoomHelper.changeMode(c.ZOOM_PART,this.editor.svg.node.getNodeById(e)),this.$("a").removeClass("active"),this.$("a[data-id="+e+"]").addClass("active"))}}function To(t){const e=t-1;return e*e*e+1}var xo,wo,Eo,Ao,Po,So,Oo,Mo=!1;function Co(t,{delay:e=0,duration:i=400,easing:r=To,axis:n="y"}={}){const s=getComputedStyle(t);_e&&!Mo&&/(contents|inline|table)/.test(s.display)&&(Mo=!0,Promise.resolve().then((()=>Mo=!1)),s.display);const o=+s.opacity,a="y"===n?"height":"width",l=parseFloat(s[a]),h="y"===n?["top","bottom"]:["left","right"],d=h.map((t=>`${t[0].toUpperCase()}${t.slice(1)}`)),c=parseFloat(s[`padding${d[0]}`]),u=parseFloat(s[`padding${d[1]}`]),p=parseFloat(s[`margin${d[0]}`]),g=parseFloat(s[`margin${d[1]}`]),m=parseFloat(s[`border${d[0]}Width`]),f=parseFloat(s[`border${d[1]}Width`]);return{delay:e,duration:i,easing:r,css:t=>`overflow: hidden;opacity: ${Math.min(20*t,1)*o};${a}: ${t*l}px;padding-${h[0]}: ${t*c}px;padding-${h[1]}: ${t*u}px;margin-${h[0]}: ${t*p}px;margin-${h[1]}: ${t*g}px;border-${h[0]}-width: ${t*m}px;border-${h[1]}-width: ${t*f}px;min-${a}: 0`}}!function(t){t.Loop="Loop",t.OnMouseMove="OnMouseMove",t.OnMouseMoveReset="OnMouseMoveReset",t.OnDeviceOrientation="OnDeviceOrientation",t.None="None"}(xo||(xo={})),function(t){t.Path="path",t.Rect="rect",t.Circle="circle",t.Rounded="rounded"}(wo||(wo={})),function(t){t.Vinyl="white",t.Holographic="holographic",t.Prismatic="prismatic",t.Glitter="glitter",t.Metal="metal",t.Recycled="kraft_paper",t.Pixie="pixie_dust",t.Brushed="brushed_alloy",t.Mirror="mirror",t.Clear="clear",t.Gitd="gitd_industrial",t.WhiteRemovable="white_removable",t.WhiteHiTack="white_hi_tack",t.Reflective="reflective",t.WhiteThin="white_thin",t.WhiteWall="white_wall",t.WhiteSturdy="white_sturdy",t.ClearThin="clear_thin",t.KraftThin="kraft_thin",t.SilverThin="silver_thin"}(Eo||(Eo={})),function(t){t.Glossy="glossy_uv",t.Matte="soft_touch",t.SatinMatte="satin_matte",t.Cracked="cracked_ice",t.Uncoated="uncoated",t.GlossyThin="glossy_thin",t.GlossyThinNoUV="glossy_thin_no_uv"}(Ao||(Ao={})),function(t){t.None="Color",t.Mix="Mix",t.Full="Effect"}(Po||(Po={})),function(t){t.Color="white",t.Mix="gray",t.Effect="black"}(So||(So={})),function(t){t.COMBINED="combinedMasks",t.SAVED_MASK="savedMaskOptions",t.CHANGED_SAVED_MASK="changedSavedMaskOptions",t.GENERATED="generatedMasks"}(Oo||(Oo={}));var Io=function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function o(t){try{l(r.next(t))}catch(t){s(t)}}function a(t){try{l(r.throw(t))}catch(t){s(t)}}function l(t){t.done?n(t.value):function(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(o,a)}l((r=r.apply(t,e||[])).next())}))};function ko(t,e){let i="";e instanceof SVGUseElement&&(i=function(t){const e=t.getAttribute("href");if(!e)return"";const i=document.querySelector(e);if(!i)return"";const r=window.getComputedStyle(i).getPropertyValue("transform");if("none"===r||!r)return"";const n=new DOMMatrix(r);return`matrix(${n.a}, ${n.b}, ${n.c}, ${n.d}, ${n.e}, ${n.f})`}(e));const r=function(t,e,i){const r=t.viewBox.baseVal,n=r.width,s=r.height,o=e.getAttribute("scale"),a=e.getBBox();let l=`${i} translate(${(n-a.width)/2-a.x}, ${(s-a.height)/2-a.y})`;return o&&(l+=` scale(${o})`),l}(t,e,i);return e.setAttribute("transform",r),r}function No(t){const e=(new DOMParser).parseFromString(t,"image/svg+xml").documentElement.getAttribute("viewBox");if(!e)throw new Error("SVG viewBox attribute is missing");const[i,r,n,s]=e.split(" ").map(Number);return{xMin:i,yMin:r,xMax:n,yMax:s}}function Lo(t,e,i,r){return Io(this,arguments,void 0,(function*(t,e,i,r,n=!1){const s=(new DOMParser).parseFromString(t,"image/svg+xml"),o=Array.from(s.querySelectorAll("text")).map((t=>t.getAttribute("font-family"))).filter(((t,e,i)=>i.indexOf(t)===e&&"Arial"!==t)),a=document.createElement("defs");for(const t of o){const i=e.find((e=>e.fontFamily===t)),r=document.createElement("style");r.textContent=`\n      @font-face {\n        font-family: "${null==i?void 0:i.fontFamily}";\n        /* .. */\n        src: url(${null==i?void 0:i.base64}) format("woff2");\n      }`,a.appendChild(r)}s.documentElement.appendChild(a);const l=yield function(t){return Io(this,void 0,void 0,(function*(){const e=t.querySelectorAll("image");for(const t of Array.from(e)){const e=t.getAttribute("xlink:href");if(e&&e.startsWith("http")){const r=yield(i=e,fetch(i,{cache:"no-cache"}).then((t=>t.blob())).then((t=>new Promise(((e,i)=>{const r=new FileReader;r.onloadend=()=>e(r.result),r.onerror=i,r.readAsDataURL(t)})))));t.setAttribute("xlink:href",r)}}var i;return(new XMLSerializer).serializeToString(t)}))}(s);return new Promise(((t,e)=>{const o=function(t,e,i){const r={height:i,width:e};return t<1&&(r.width=e*t),t>1&&(r.height=i/t),r}(function(t){const e=t.documentElement.getAttribute("viewBox");if(!e)return 1;const[i,r,n,s]=e.split(" ").map(Number);return n/s}(s),i,r),a=document.createElement("canvas");a.width=o.width,a.height=o.height;const h=new Image;h.onload=n?()=>Io(this,void 0,void 0,(function*(){const e=a.getContext("2d");let i=0;requestAnimationFrame((function r(){return Io(this,void 0,void 0,(function*(){if(i+=1,i<10)return void requestAnimationFrame(r);null==e||e.drawImage(h,0,0,o.width,o.height);const n=a.toDataURL("image/png");t(n)}))}))})):()=>Io(this,void 0,void 0,(function*(){const e=a.getContext("2d");null==e||e.drawImage(h,0,0,o.width,o.height);const i=a.toDataURL("image/png");t(i)})),h.onerror=t=>{e(new Error(`Failed to load SVG: ${t}`))},h.src="data:image/svg+xml;base64,"+btoa(l)}))}))}function Do(t,e){return t.replace(/-?\d*\.?\d+/g,(t=>(parseFloat(t)*e).toString()))}function Bo(t){const e=Ro(t.width),i=Ro(t.height),r=function(t,e=!1){let i="";const r=t.translate?`transform="translate(${t.translate})"`:"";if(t.translate){const[e,r]=t.translate.split(",").map(Number);i=` translate(${-1*e},${-1*r}) `}const n=$o(t.matrix),s=Math.round(Ro(t.side?4:2)/n),o=`mask_${jo()}`,a=t.background,l=Math.round(Ro(1));let h="";return h+=`<g transform="${t.matrix}${i}">`,h+="<defs>",h+=`<mask id="${o}">`,h+=`<path d="${t.cuttingline}" fill="white" stroke="white" stroke-width="${s}" stroke-linecap="square"/>`,h+="</mask>",h+="</defs>",h+=`<g mask="url(#${o})">`,h+=`<path d="${t.cuttingline}" fill="${a}" stroke="${a}" stroke-width="${s}" stroke-linecap="square"/>`,h+=`<g ${r}>${t.svg}</g>`,h+="</g>",e&&(h+=`<path d="${t.cuttingline}" fill="none" stroke="magenta" stroke-width="${l}" stroke-linecap="square"/>`),h+="</g>",h}(t,!1),n=Ro(4);return`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="${-n/2} ${-n/2} ${e+n} ${i+n}">${r}</svg>`}function Ro(t){return 2.83465*t}function $o(t){let e=1;if(t&&""!==t.trim()){const i=(t=t.substring(t.indexOf("matrix"))).match(/\(([^()]+)\)/);if(i&&i[1]){let t;t=i[1].includes(",")?i[1].split(","):i[1].trim().split(/\s+/);const r=parseFloat(t[0]),n=parseFloat(t[1]);e=Math.sqrt(Math.pow(r,2)+Math.pow(n,2))}}return e}function jo(){return Math.random().toString(36).slice(2,11)}function qo(){return Io(this,arguments,void 0,(function*(t="",e=[]){try{const i=new URLSearchParams;e.forEach((t=>i.append("fontFamilies[]",t)));const r=yield fetch(`${t}/editor/get_b64fonts?${i.toString()}`);return yield r.json()}catch(t){return[]}}))}var Vo=On("<use></use>"),Fo=On('<g><use class="glitterLayer svelte-1wd83oa"></use></g>'),Ho=On("<use></use>"),zo=On("<use></use>"),Uo=On('<use opacity=".3"></use>'),Go=On("<use></use>"),Zo=On("<use></use>"),Wo=On("<use></use>"),Ko=On("<use></use>"),Yo=On('<use opacity=".2" class="recycled-extra svelte-1wd83oa"></use>'),Xo=On('<use opacity="0"></use><g style="z-index: -1;"><use></use><!><!><!><!><use class="printLayer svelte-1wd83oa"></use><use style="opacity:0;"></use><!><!><!></g>',1);const Qo={hash:"svelte-1wd83oa",code:".basePlateLayer.svelte-1wd83oa {fill:transparent;}.clear.svelte-1wd83oa .basePlateLayer:where(.svelte-1wd83oa) {fill:#ffffff38;stroke:#a3a3a385;stroke-width:1px;}.brushed_alloy.svelte-1wd83oa .basePlateLayer:where(.svelte-1wd83oa),\n  .reflective.svelte-1wd83oa .basePlateLayer:where(.svelte-1wd83oa) {fill:#c0c0c0;}.mirror.svelte-1wd83oa .basePlateLayer:where(.svelte-1wd83oa),\n  .silver_thin.svelte-1wd83oa .basePlateLayer:where(.svelte-1wd83oa) {fill:#fefefe;}.prismatic.svelte-1wd83oa .basePlateLayer:where(.svelte-1wd83oa) {fill:#ffffff;}.holographic.svelte-1wd83oa .basePlateLayer:where(.svelte-1wd83oa) {fill:#ffffff;}.prismatic.svelte-1wd83oa .basePlateLayer:where(.svelte-1wd83oa) {fill:#bababa;}.effectLayerDisabled.basePlateLayer.svelte-1wd83oa {fill:#fff;}.glitter.svelte-1wd83oa .basePlateLayer:where(.svelte-1wd83oa),\n  .pixie_dust.svelte-1wd83oa .basePlateLayer:where(.svelte-1wd83oa) {fill:#aaaaaa;}.gitd.svelte-1wd83oa .basePlateLayer:where(.svelte-1wd83oa),\n  .gitd_industrial.svelte-1wd83oa .basePlateLayer:where(.svelte-1wd83oa) {fill:#fdffe0;}.kraft_paper.svelte-1wd83oa .printLayer:where(.svelte-1wd83oa),\n  .kraft_thin.svelte-1wd83oa .printLayer:where(.svelte-1wd83oa) {opacity:0.9;}.recycled-extra.svelte-1wd83oa {pointer-events:none;filter:saturate(0) contrast(3);opacity:0.2;}.glitterLayer.svelte-1wd83oa {mix-blend-mode:color-dodge;}"};var Jo=function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function o(t){try{l(r.next(t))}catch(t){s(t)}}function a(t){try{l(r.throw(t))}catch(t){s(t)}}function l(t){t.done?n(t.value):function(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(o,a)}l((r=r.apply(t,e||[])).next())}))};function ta(t,e,i){return Jo(this,arguments,void 0,(function*(t,e,i,r=!0){const n=document.createElement("canvas"),s=n.getContext("2d");if(!s)return n;n.width=t.imgWidth,n.height=t.imgHeight;const o=yield function(t,e,i){return Jo(this,void 0,void 0,(function*(){return yield Promise.all(t.filter((t=>""!==t.maskImgUrl&&(e===i&&t.mode!==i||e!==i&&t.mode===i))).map((t=>Jo(this,void 0,void 0,(function*(){return{img:yield ea(t.maskImgUrl),color:t.colorRange}})))))}))}(i,e,t.filterMode);return function(t,e,i,r){r.fillStyle&&(t.fillStyle=r.fillStyle,t.fillRect(0,0,e.width,e.height)),t.globalCompositeOperation=r.globalCompositeOperation,t.imageSmoothingEnabled=!0,t.imageSmoothingQuality="high",i.forEach((i=>{t.drawImage(i.img,0,0,e.width,e.height)}))}(s,n,o,t),r?ia(n):n}))}function ea(t){return new Promise(((e,i)=>{const r=new Image;r.onload=()=>e(r),r.onerror=t=>{i(new Error("Failed to load image"))},r.src=t}))}function ia(t){const e=document.createElement("canvas"),i=e.getContext("2d");return i?(e.width=t.width,e.height=t.height,i.fillStyle=So.Effect,i.fillRect(0,0,t.width,t.height),i.drawImage(t,0,0),e):e}function ra(t,e){const i=document.createElement("canvas"),r=i.getContext("2d");return r?(i.width=t.width,i.height=t.height,r.fillStyle=e,r.fillRect(0,0,t.width,t.height),r.globalCompositeOperation="destination-in",r.drawImage(t,0,0),i):i}class na{constructor(t){this.context=t}setDefaultValues(){this.context.productItem.setAttrValue("delivery_sheet_width",na.DELIVERY_SHEET_WIDTH_DEFAULT),this.context.productItem.setAttrValue("delivery_sheet_height",na.DELIVERY_SHEET_HEIGHT_DEFAULT),this.context.productItem.setAttrValue("delivery_sheet_inside_padding",na.DELIVERY_SHEET_INSIDE_PADDING_DEFAULT),this.context.productItem.setAttrValue("delivery_sheet_outside_padding",na.DELIVERY_SHEET_OUTSIDE_PADDING_DEFAULT)}get sheetHeight(){return this.toFixedInt(this.context.productItem.getAttrValue("delivery_sheet_height"))}get sheetWidth(){return this.toFixedInt(this.context.productItem.getAttrValue("delivery_sheet_width"))}get minimumSheetWidth(){return na.DELIVERY_SHEET_WIDTH_MINIMUM}get minimumSheetHeight(){return na.DELIVERY_SHEET_HEIGHT_MINIMUM}get insidePadding(){return this.toFixedInt(this.context.productItem.getAttrValue("delivery_sheet_inside_padding"))}get outsidePadding(){return this.toFixedInt(this.context.productItem.getAttrValue("delivery_sheet_outside_padding"))}toFixedInt(t){const e=parseInt(Number(t).toFixed(0));return isNaN(e)?0:e}}na.DELIVERY_SHEET_WIDTH_DEFAULT=204,na.DELIVERY_SHEET_HEIGHT_DEFAULT=270,na.DELIVERY_SHEET_WIDTH_MINIMUM=25,na.DELIVERY_SHEET_HEIGHT_MINIMUM=25,na.DELIVERY_SHEET_INSIDE_PADDING_DEFAULT=2,na.DELIVERY_SHEET_OUTSIDE_PADDING_DEFAULT=0;class sa{static getMaxAndMinValues(...t){if(!t.length)throw new Error("Array must not be empty.");let e=t[0],i=t[0];for(const r of t)r>e&&(e=r),r<i&&(i=r);return{max:e,min:i}}}class oa{constructor(t){this.size=t}evaluateScale(t,e){const{max:i,min:r}=sa.getMaxAndMinValues(...e);return e=e.map((e=>e*t)),this.areDimensionsValid("min_size_mm",e)?this.size.hasMaxSizeOtherSide()&&!this.areDimensionsValid("max_size_other_side_mm",e)&&i/r<this.size.maxSizeMM/this.size.maxSizeOtherSideMM?this.size.maxSizeOtherSideMM/r:this.areDimensionsValid("max_size_mm",e)?t:this.size.maxSizeMM/i:this.size.minSizeMM/r}areDimensionsValid(t,e){switch(t){case"min_size_mm":return!e.some((t=>t<this.size.minSizeMM));case"max_size_other_side_mm":return!e.every((t=>t>this.size.maxSizeOtherSideMM));case"max_size_mm":return!e.some((t=>t>this.size.maxSizeMM));default:return!1}}}class aa{static get MAX_SIZE_MM_DIGITAL(){return 1250}static get MAX_SIZE_MM_LASER(){return 275}static get MIN_SIZE_MM_DEFAULT(){return 25}constructor(t){this.context=t,this.mm2pxFactor=2.83465,this.minSizeMM=0,this.maxSizeMM=0,this.maxSizeOtherSideMM=0,this.fixedSize=!1,this.autoFitToSizeConstraintsOnEvaluate=!0,this.meassureDisplayAbbr="cm",this.minSize=0,this.maxSize=0,this.maxSizeOtherSide=0,this.deliverySheet=new na(t),this.transform=new oa(this)}toString(){let t="|";return t+=this.getMeasureAttrInMM("width")+"|",t+=this.getMeasureAttrInMM("height")+"|",t+=this.minSizeMM+"|",t+=this.maxSizeMM+"|",t+=this.fixedSize+"|",t+=this.isImperialUnits()+"|",t}evaluate(){this.evaluateMaxSize(),this.evaluateMinSize(),this.evaluateMaxSizeOtherSide(),this.evaluateFixedSize(),this.isImperialUnits()?(this.meassureDisplayAbbr='"',this.minSize=this.convertMMToInches(this.minSizeMM),this.maxSize=this.convertMMToInches(this.maxSizeMM),this.maxSizeOtherSide=this.convertMMToInches(this.maxSizeOtherSideMM)):(this.meassureDisplayAbbr="cm",this.minSize=this.convertMMToCM(this.minSizeMM),this.maxSize=this.convertMMToCM(this.maxSizeMM),this.maxSizeOtherSide=this.convertMMToCM(this.maxSizeOtherSideMM))}evaluateFixedSize(){this.fixedSize=this.context.productItem.getAttrValue("fixed_size")?this.context.productItem.getAttrValue("fixed_size"):this.context.attrComputer.isInFilteredValues("fixed_size",!0)}evaluateMaxSize(){var t;let e=this.canBeProductionLine("digital")?aa.MAX_SIZE_MM_DIGITAL:aa.MAX_SIZE_MM_LASER;const i=this.context.productItem.getAttrValue("max_size_mm")?this.context.productItem.getAttrValue("max_size_mm"):this.context.attrComputer.getHighestAvailableValue("max_size_mm");this.isIndependentOfMaxProdLineSize()&&(e=null!==(t=this.context.attrComputer.getHighestAvailableValue("max_size_mm"))&&void 0!==t?t:Math.max(aa.MAX_SIZE_MM_DIGITAL,aa.MAX_SIZE_MM_LASER)),this.maxSizeMM=Math.min(Number(i)||1/0,e)}evaluateMinSize(){var t;this.context.productItem.getAttrValue("min_size_mm")?this.minSizeMM=Number(this.context.productItem.getAttrValue("min_size_mm")):this.minSizeMM=null!==(t=this.context.attrComputer.getLowestAvailableValue("min_size_mm"))&&void 0!==t?t:aa.MIN_SIZE_MM_DEFAULT}evaluateMaxSizeOtherSide(){let t=this.getMaxSizeOtherSideValue();this.ensureMaxAndMinSizesEvaluated(),!t||t>this.maxSizeMM?t=this.maxSizeMM:t<this.minSizeMM&&(t=this.minSizeMM),this.maxSizeOtherSideMM=t}getMaxSizeOtherSideValue(){let t=this.context.productItem.getAttrValue("max_size_other_side_mm");if(!t){const e=this.context.attrComputer.getFilteredValues("max_size_other_side_mm");e.length&&(t=Number(e[0]))}return t?Number(t):null}ensureMaxAndMinSizesEvaluated(){this.maxSizeMM||this.evaluateMaxSize(),this.minSizeMM||this.evaluateMinSize()}canBeProductionLine(t){return!this.context.attrComputer.isConstrained("production_line",t)}formatDisplayableMeassure(t){return t.toString()+" "+this.meassureDisplayAbbr}formatMM(t){return t=Math.round(10*t)/10,Number(t.toFixed(0))}convertMMToInches(t){const e=(t=this.formatMM(t))/25.4;return Math.round(10*e)/10}convertInchesToMM(t){return this.formatMM(25.4*t)}convertMMToCM(t){return Number((t/10).toFixed(1))}convertCMToMM(t){return Number((10*t).toFixed(0))}setMeasureBySizeString(t){if(t){const e=this.extractMeassuresFromString(t);this.setMeasureAttr("width_mm",e.width),this.setMeasureAttr("height_mm",e.height)}}extractMeassuresFromString(t){const e=t.replace("A5","").match(/([\d]{1,3}\.?[\d]{1,3})|([\d]{1,3})/g);return{width:parseFloat(e[0]),height:parseFloat(e[1])}}setMeasureAttr(t,e){t=this.sanitizeMeasureAttrName(t);const i=this.convertMeassureToMM(e);return this.setMeasureAttrInMM(t,i)}setMeasureAttrInMM(t,e){return t=this.sanitizeMeasureAttrName(t),this.maxSizeMM&&e>this.maxSizeMM?e=this.maxSizeMM:this.minSizeMM&&e<this.minSizeMM&&(e=this.minSizeMM),e=this.formatMM(e),this.context.productItem.setAttrValue(t,e),e}convertMeassureToMM(t){let e;return e=this.isImperialUnits()?this.convertInchesToMM(t):this.convertCMToMM(t),e}getMeasureAttrInMM(t){return t=this.sanitizeMeasureAttrName(t),parseInt(this.context.productItem.getAttrValue(t))}getMeasureAttrInInches(t){const e=this.getMeasureAttrInMM(t);return this.convertMMToInches(e)}getMeasureAttrInPixels(t){return this.getMeasureAttrInMM(t)*this.mm2pxFactor}getMeasureAttrDisplayable(t){return t=this.sanitizeMeasureAttrName(t),this.convertMMToLocalizedMeassure(this.getMeasureAttrInMM(t))}convertMMToLocalizedMeassure(t){let e;return e=this.isImperialUnits()?this.convertMMToInches(t):this.convertMMToCM(t),e}sanitizeMeasureAttrName(t){return t.indexOf("_mm")<0&&(t+="_mm"),t}get sqm(){const t=Number(this.context.productItem.getAttrValue("quantity"));return this.getMeasureAttrInMM("width")*this.getMeasureAttrInMM("height")*t/1e6}get widthDisplayable(){return this.getMeasureAttrDisplayable("width_mm")}get heightDisplayable(){return this.getMeasureAttrDisplayable("height_mm")}get selectedProductionLine(){return this.context.productItem.getAttrValue("production_line")}isImperialUnits(){const t=this.context.productItem.getAttrValue("imperial_units");return!0===t||"true"===t}isSizeFixed(){return this.fixedSize}hasMaxSizeOtherSide(){return this.maxSizeOtherSideMM!=this.maxSizeMM}isIndependentOfMaxProdLineSize(){return"labels_on_roll"==this.context.productItem.productName}get maxSizeWidthMM(){return this.hasMaxSizeOtherSide()&&this.getMeasureAttrInMM("width")<this.getMeasureAttrInMM("height")?this.maxSizeOtherSideMM:this.maxSizeMM}get maxSizeHeightMM(){return this.hasMaxSizeOtherSide()&&this.getMeasureAttrInMM("width")>=this.getMeasureAttrInMM("height")?this.maxSizeOtherSideMM:this.maxSizeMM}}class la{constructor(t,e,i,r){this.autoOptDefaultValue=t,this.cherryPicks=e,this.ignoreAttributeFromAutoPickerCallback=i,this.isAttributeRequiredCallback=r}invoke(t,e){var i;let r={runAutoPick:!0,iteration:0};return r=this.startRunAutoPick("attributes",e,t),r.runAutoPick=!0,t.attributes.imperial_units=null!==(i=t.attributes.imperial_units)&&void 0!==i&&i,r=this.startRunAutoPick("cherries",e,t),!r.runAutoPick&&1==r.iteration}startRunAutoPick(t,e,i){let r=!0,n=0;switch(t){case"cherries":for(;r&&(n++,e.evaluate(i),r=this.tryAutoPickFromCherries(i,e),!(n>=5)););return{runAutoPick:r,iteration:n};case"attributes":for(;r&&(n++,e.evaluate(i),r=this.autoPickAttributes(i,e),!(n>=5)););return{runAutoPick:r,iteration:n}}}autoPickAttributes(t,e){const i=t.attributesToString();for(const i in e.attributes){if(this.ignoreAttributeFromAutoPickerCallback(i))continue;let r=null==t?void 0:t.getAttrValue(i);if(r||this.isAttributeRequiredCallback(i)){const n=this.cherryPicks.getAttrValue(i);r=e.isNumberType(i)?Number(r):r,this.autoPick({productItem:t,currentValue:r},e,i,n)}}return i!=t.attributesToString()}tryAutoPickFromCherries(t,e){const i=t.attributesToString();for(const i in e.attributes)if(this.cherryPicks.hasAttr(i)){const r=this.cherryPicks.getAttrValue(i);let n=null==t?void 0:t.getAttrValue(i);n=e.isNumberType(i)?Number(n):n,n&&n==r||this.autoPick({productItem:t,currentValue:n},e,i,r)}return i!=t.attributesToString()}autoPick(t,e,i,r){var n;if(null==e?void 0:e.isMultiValue(i)){Array.isArray(t.currentValue)||(t.currentValue=[t.currentValue]);let s=t.currentValue.filter((t=>e.isAvailable(i,t)));r&&(r=r.filter((t=>e.isAvailable(i,t)&&s.indexOf(t)<0)),s=[...s,...r]),this.cherryPicks.maybeRegisterALost(i,s),null===(n=t.productItem)||void 0===n||n.setAttrValue(i,s)}else this.autPickNoneMulti(t,e,i,r)}autPickNoneMulti(t,e,i,r){var n;const s=e.getDefaultValue(i);let o=null==t.currentValue&&!this.isAttributeRequiredCallback(i)||e.isAvailable(i,t.currentValue)?t.currentValue:s;o||(o=this.getNewValue(e,i)),r&&(o=null!==(n=this.getNewValueWithCherryPick(r,e,i))&&void 0!==n?n:o),this.cherryPicks.maybeRegisterALost(i,o),t.productItem.setAttrValue(i,o)}getNewValue(t,e){const i=t.getDefaultValue(e);return t.isDynamicValue(e)&&i?i:null}getNewValueWithCherryPick(t,e,i){return e.isAvailable(i,t)&&!e.isDynamicValue(i)?t:null}shouldAutoOptForDefaultValue(t){return this.autoOptDefaultValue.indexOf(t)>=0}}var ha,da=__webpack_require__(17723);class ca{constructor(t){this.sizeHelper=t,this.lastEvaluation="",this.name=ca.name}invoke(t,e){var i,r;this.sizeHelper.evaluate();const n=this.sizeHelper.toString();if(this.lastEvaluation!=n){this.lastEvaluation=n,da.o.log("SizeHelper try auto fit",this.sizeHelper.getMeasureAttrInMM("width_mm"),this.sizeHelper.getMeasureAttrInMM("height_mm"));let s=this.sizeHelper.getMeasureAttrInMM("width_mm"),o=this.sizeHelper.getMeasureAttrInMM("height_mm");if(this.sizeHelper.fixedSize){const n=e.getSuggestedValues("size"),{currentDimensionsFoundInSizeOptions:a,defaultSizeOption:l,defaultMeassures:h,convertedMeasures:d}=this.iterateSizeOption(n,s,o);if(!a&&this.isDefault(h,l)){const e=this.findClosestMatch(d,s,o);(null==e?void 0:e.distance)&&e.distance<1.5?(t.setAttrValue("size",e.index),da.o.log("Size difference is within 1.5 mm, not adjusting size.")):(da.o.log("Auto fit to fixed meassures","from",s,o),t.setAttrValue("size",l),s=this.sizeHelper.setMeasureAttr("width_mm",null!==(i=null==h?void 0:h.width)&&void 0!==i?i:50),o=this.sizeHelper.setMeasureAttr("height_mm",null!==(r=null==h?void 0:h.height)&&void 0!==r?r:50),da.o.log("...to",s,o,h))}}const a=Math.max(s,o),l=Math.min(s,o);this.setMeasures(l,a,s,o)}}setMeasures(t,e,i,r){if(this.sizeHelper.hasMaxSizeOtherSide()&&[e,t].every((t=>t>this.sizeHelper.maxSizeOtherSideMM))){da.o.log("Auto fit because larger than max size other side",this.sizeHelper.maxSizeOtherSideMM);const e=t/this.sizeHelper.maxSizeOtherSideMM;this.sizeHelper.setMeasureAttrInMM("width_mm",i/e),this.sizeHelper.setMeasureAttrInMM("height_mm",r/e)}else if(e>this.sizeHelper.maxSizeMM){da.o.log("Auto fit because larger than max size",this.sizeHelper.maxSizeMM);const t=e/this.sizeHelper.maxSizeMM;this.sizeHelper.setMeasureAttrInMM("width_mm",i/t),this.sizeHelper.setMeasureAttrInMM("height_mm",r/t)}else if(t<this.sizeHelper.minSizeMM){da.o.log("Auto fit because smaller than min size",this.sizeHelper.minSizeMM);const e=this.sizeHelper.minSizeMM/t;this.sizeHelper.setMeasureAttrInMM("width_mm",i*e),this.sizeHelper.setMeasureAttrInMM("height_mm",r*e)}}isDefault(t,e){var i;return null!==(i=t&&Boolean(e))&&void 0!==i&&i}iterateSizeOption(t,e,i){let r=!1,n=null,s=null;const o=[];for(const a in t){const l=t[a],h=this.sizeHelper.extractMeassuresFromString(l);s||(s=h,n=l);const d=this.sizeHelper.convertMeassureToMM(h.width),c=this.sizeHelper.convertMeassureToMM(h.height);if(o[a]=[d,c],e==d&&c==i)return r=!0,{currentDimensionsFoundInSizeOptions:r,defaultSizeOption:n,defaultMeassures:s,convertedMeasures:o}}return{currentDimensionsFoundInSizeOptions:r,defaultSizeOption:n,defaultMeassures:s,convertedMeasures:o}}findClosestMatch(t,e,i){let r=null,n=Number.MAX_SAFE_INTEGER;for(let s=0;s<t.length;s++){const o=Math.abs(e-t[s][0])+Math.abs(i-t[s][1]);o<n&&(n=o,r={index:s,distance:o})}return r}}!function(t){t.FIX_ATTR_BOOL_VALUES="fix_attr_bool_values",t.AUTOPICK="autopick",t.SIZE="size",t.DELIVERY_SHEET_SIZES="delivery_sheet_sizes",t.COLOR="color",t.DELIVERY_ROLL="delivery_roll",t.OUT_OF_STOCK="out_of_stock"}(ha||(ha={}));class ua{constructor(t,e={}){this.attrComputer=t,this.attributes=e,this.lostAttributes={}}reset(){this.attributes={},this.lostAttributes={}}hasLostAttributeValue(t,e){if(this.hasLostAttribute(t)){if(this.attrComputer.isMultiValue(t)){let i=!1;const r=this.lostAttributes[t];return Array.isArray(e)||(e=[e]),e.forEach((t=>{i||(i=r.indexOf(t)>=0)})),i}return this.lostAttributes[t]!=e}return!1}hasLostAttribute(t){return Object.prototype.hasOwnProperty.call(this.lostAttributes,t)}maybeRegisterALost(t,e){if(this.hasAttr(t))if(this.attrComputer.isMultiValue(t)){const i=[],r=this.getAttrValue(t);if(Array.isArray(e)||(e=[e]),null==r||r.forEach((t=>{null!=t&&e.indexOf(t)<0&&i.push(t)})),i.length)return this.lostAttributes[t]=i,!0;delete this.lostAttributes[t]}else{const i=this.getAttrValue(t);if(JSON.stringify(i)!=JSON.stringify(e))return this.lostAttributes[t]=i,!0;Object.prototype.hasOwnProperty.call(this.lostAttributes,t)&&delete this.lostAttributes[t]}return!1}removeAttr(t,e){if(this.attrComputer.isMultiValue(t)&&this.attributes[t]){const i=this.attributes[t];this.attributes[t]=null==i?void 0:i.filter((t=>t!=e))}else Object.prototype.hasOwnProperty.call(this.attributes,t)&&delete this.attributes[t]}hasAttr(t){return Object.prototype.hasOwnProperty.call(this.attributes,t)}setAttrValue(t,e){this.attrComputer.isMultiValue(t)?(this.attributes[t]||(this.attributes[t]=[]),e&&this.attributes[t].push(e)):this.attributes[t]=e}getAttrValue(t){return this.hasAttr(t)?this.attributes[t]:null}}class pa{constructor(){this.productFamilyName="",this.productName="",this.units=0,this.attributes={},this.sku=""}attributesToString(){return Object.entries(this.attributes).map((([t,e])=>`|${t}:${e}|`)).join("")}setAttrValue(t,e){if("string"==typeof e&&("true"===e.toLowerCase()?e=!0:"false"===e.toLowerCase()&&(e=!1)),Array.isArray(e)){const t=e.map((t=>{if("string"==typeof t){if("true"===t.toLowerCase())return!0;if("false"===t.toLowerCase())return!1}return t}));e=t}this.attributes[t]=e}removeAttr(t,e){if(Array.isArray(this.attributes[t])){const i=this.attributes[t];this.attributes[t]=null==i?void 0:i.filter((t=>t!=e))}else this.attributes[t]=null}getAttrValue(t){var e;return null===(e=this.attributes)||void 0===e?void 0:e[t]}fromJSON(t){Object.assign(this,t)}toJSON(){return{productFamilyName:this.productFamilyName,productName:this.productName,units:this.units,attributes:Object.assign({},this.attributes),sku:this.sku}}toTestableOneDimensionalObject(){const t={"item.productFamilyName":this.productFamilyName,"item.productName":this.productName,"item.units":this.units,"item.sku":this.sku};return Object.entries(this.attributes).forEach((([e,i])=>{t[`item.attributes.${e}`]=i})),t}}class ga{constructor(t){this.attrEvaluator=t,this.attributes={},this.useFilters=!0,this.attributesConstrained={},this.attributesFiltered={},this.attributesOutOfStock={},this.attributesFiltersMatched={},this.attributesSuggested={},this.attributesPreferred={}}reset(t){this.attributes=t}evaluate(t){this.evaluateFilteredValues(t),this.evaluateConstrainedValues(t),this.evaluateSuggestedValues(),this.evaluateOutOfStockValues()}evaluateFilteredValues(t){da.o.groupCollapsed("evaluateFilteredValues()"),this.attributesFiltered={},this.attributesFiltersMatched={};for(const e in this.attributes)this.attributesFiltered[e]=this.attrEvaluator.filter(t.toTestableOneDimensionalObject(),e,((t,e,i)=>(i&&i.length?this.attributesFiltersMatched[t]=i.length:this.attributesFiltersMatched[t]=0,e)));da.o.groupEnd()}evaluateConstrainedValues(t){this.attrEvaluator.clearDebug(),this.attributesConstrained={};for(const e in this.attributes){const i=this.attributes[e];this.attributesConstrained[e]=[];for(const r in i.valuesAndConstraints)this.attrEvaluator.canIChangeAttribute(t.toTestableOneDimensionalObject(),e,r)||this.attributesConstrained[e].push(r)}}evaluateSuggestedValues(){da.o.groupCollapsed("evaluateSuggestedValues()"),da.o.log("Use filters:",this.useFilters),this.attributesSuggested={};for(const t in this.attributes){da.o.groupCollapsed("evaluateSuggestedValues( "+t+" )");let e=this.useFilters?this.getFilteredValues(t):[];if(da.o.log(e),e&&e.length||(e=this.getAllValues(t)),this.hasPreferredValue(t)){let i=this.getPreferredValue(t);da.o.log("Prefered value:",i),null!=i&&null!=i&&(Array.isArray(i)||(i=[i]),i=i.filter((i=>(da.o.log("Preferred value is constrained:",this.isConstrained(t,i)&&this.canValueBe(t,i),this.attributes[t].valuesAndConstraints),!this.isConstrained(t,i)&&this.canValueBe(t,i)&&e.indexOf(i)<0))),da.o.log("Will concat preferred values",i),e=e.concat(i))}this.attributesSuggested[t]=e,da.o.log("Suggested",e),da.o.groupEnd()}da.o.groupEnd()}evaluateOutOfStockValues(){var t;this.attributesOutOfStock={};for(const e in this.attributes){const i=null!==(t=this.attributes[e].outOfStockValues)&&void 0!==t?t:[];i.length>0&&(this.attributesOutOfStock[e]=i)}}isAvailable(t,e){return!this.isConstrained(t,e)&&(this.isInSuggestedValues(t,e)||this.isDynamicValue(t))}isUnavailable(t,e){return!this.isAvailable(t,e)}getDefaultValue(t){if(this.isMultiValue(t))return[];const e=this.getSuggestedValues(t);if(e&&e.length)for(const i in e){const r=e[i];if(!this.isConstrained(t,r))return r}return null}getAllValues(t){if(Object.prototype.hasOwnProperty.call(this.attributes,t)){const e=[];for(const[i]of Object.entries(this.attributes[t].valuesAndConstraints)){let r=i;if(this.isBooleanType(t))try{r=JSON.parse(i)}catch(t){da.o.error(t)}else this.isIntType(t)?r=parseInt(i):this.isFloatType(t)&&(r=parseFloat(i));e.push(r)}return e}return[]}getHighestAvailableValue(t){let e=null;return this.getSuggestedValues(t).forEach((i=>{if(!this.isConstrained(t,i)){const t=parseFloat(String(i));(!e||t>e)&&(e=t)}})),e}getLowestAvailableValue(t){let e=null;return this.getSuggestedValues(t).forEach((i=>{if(!this.isConstrained(t,i)){const t=parseFloat(String(i));(!e||t<e)&&(e=t)}})),e}getSuggestedValues(t){return Object.prototype.hasOwnProperty.call(this.attributesSuggested,t)?this.attributesSuggested[t]:[]}getFilteredValues(t){return Object.prototype.hasOwnProperty.call(this.attributesFiltered,t)?this.attributesFiltered[t]:[]}hasBeenFiltered(t){return!!Object.prototype.hasOwnProperty.call(this.attributesFiltersMatched,t)&&this.attributesFiltersMatched[t]>0}hasPreferredValue(t){return Object.prototype.hasOwnProperty.call(this.attributesPreferred,t)}removePreferredValue(t,e){if(this.isMultiValue(t)&&this.attributesPreferred[t]){const i=this.attributesPreferred[t];this.attributesPreferred[t]=i.filter((t=>t!=e))}else this.attributesPreferred[t]=null}getPreferredValue(t){return this.hasPreferredValue(t)?this.attributesPreferred[t]:null}setPreferredValue(t,e){this.attributesPreferred[t]=e}getConstrainedValues(t){return Object.prototype.hasOwnProperty.call(this.attributesConstrained,t)?this.attributesConstrained[t]:[]}getOutOfStockValues(t){return Object.prototype.hasOwnProperty.call(this.attributesOutOfStock,t)?this.attributesOutOfStock[t]:[]}getIcons(t){var e,i;return null!==(i=null===(e=this.attributes[t])||void 0===e?void 0:e.icons)&&void 0!==i?i:[]}getAttributeNames(){return this.attributes?Object.keys(this.attributes):[]}isSupported(t){return Object.prototype.hasOwnProperty.call(this.attributes,t)}isRequired(t){var e;return this.isSupported(t)&&(null===(e=this.attributes[t])||void 0===e?void 0:e.isRequired)}isMultiValue(t){var e;return null===(e=this.attributes[t])||void 0===e?void 0:e.isMultiValue}isDynamicValue(t){var e;return null===(e=this.attributes[t])||void 0===e?void 0:e.isDynamicValue}isBooleanType(t){var e;return"boolean"==(null===(e=this.attributes[t])||void 0===e?void 0:e.valueType)}isIntType(t){var e;return"integer"==(null===(e=this.attributes[t])||void 0===e?void 0:e.valueType)}isFloatType(t){var e;return"float"==(null===(e=this.attributes[t])||void 0===e?void 0:e.valueType)}isNumberType(t){return this.isIntType(t)||this.isFloatType(t)}isInFilteredValues(t,e){const i=this.getFilteredValues(t);return!!i&&i.indexOf(e)>=0}isInSuggestedValues(t,e){const i=this.getSuggestedValues(t);return!!i&&i.indexOf(e)>=0}canValueBe(t,e){var i;return!!this.isDynamicValue(t)||("boolean"==typeof e&&(e=JSON.stringify(e)),Object.prototype.hasOwnProperty.call(null===(i=this.attributes[t])||void 0===i?void 0:i.valuesAndConstraints,e))}isConstrained(t,e){const i=this.getConstrainedValues(t);return!!i&&(i.indexOf(e)>=0||i.indexOf(String(e))>=0)}isOutOfStockValues(t,e){const i=this.getOutOfStockValues(t);return!!i&&i.indexOf(e)>=0}get debugList(){return this.attrEvaluator.debugList}set debugEnabled(t){this.attrEvaluator.debugEnabled=t}get debugEnabled(){return this.attrEvaluator.debugEnabled}}class ma{constructor(){this.processors=new Map}invokeProcessors(t,e){this.processors.forEach(((i,r)=>{da.o.log("Invoking processor: ",r),i(t,e)}))}registerProcessor(t,e){if(this.processors.has(t.valueOf()))throw Error(`Processor with id ${t} already exists.`);"invoke"in e?this.processors.set(t.valueOf(),((t,i)=>e.invoke(t,i))):this.processors.set(t.valueOf(),e)}unregisterProcessor(t){return!!this.processors.has(t.valueOf())&&this.processors.delete(t.valueOf())}}var fa=__webpack_require__(13703);class va{invoke(t,e){if(t.attributes)for(const i of Object.entries(t.attributes)){const r=i[0];let n=i[1];if(e.isBooleanType(r)&&"string"==typeof n){try{n=JSON.parse(n)}catch(t){}t.setAttrValue(r,n)}}}}class ba{constructor(){this.processors=new ma,this.productItem=new pa,this.attrEvaluator=new fa.x,this.attrComputer=new ga(this.attrEvaluator),this.cherryPicks=new ua(this.attrComputer,{}),this.processors.registerProcessor(ha.FIX_ATTR_BOOL_VALUES,new va)}reset(t,e,i=!1){this.productItem.productName=t.productName,this.productItem.productFamilyName=t.productFamilyName,this.productItem.units=t.units,this.productItem.attributes=t.attributes,this.productItem.sku=t.sku,this.attrComputer.reset(e),this.attrEvaluator.reset(e),i||this.cherryPicks.reset()}invokeProcessors(){da.o.groupCollapsed("ProductContext::invokeProcessors()"),this.processors.invokeProcessors(this.productItem,this.attrComputer),da.o.groupEnd()}setCherryPicks(t,e=!1){da.o.log("ProductContext::setCherryPicks()","preferred",e,JSON.stringify(t)),this.cherryPicks.attributes=t,e&&(this.attrComputer.attributesPreferred=JSON.parse(JSON.stringify(t)))}resetPreferredValues(){this.attrComputer.attributesPreferred={}}}class ya{static getTranslationsFromMap(t,e,i,r){return i.reduce(((i,n)=>(i[n]=this.getTranslationFromMap(t,e,r,n),i)),{})}static getTranslationFromMap(t,e,i,r){var n;return null!==(n=t[`${e}_${i}_${r}`])&&void 0!==n?n:r}}class _a extends ba{constructor(){super(),this.attributesRequiredByWizard=["size","imperial_units","shape"],this.neverDisable=["material","quantity"],this.quantityAndPriceOptions=[],this.isBusy=!1,this.sizeHelper=new aa(this);const t=new la(["laminate"],this.cherryPicks,(t=>this.neverDisable.indexOf(t)>=0),(t=>this.isAttributeRequired(t)));this.processors.registerProcessor(ha.AUTOPICK,t),this.processors.registerProcessor(ha.SIZE,new ca(this.sizeHelper)),this.attrEvaluator.ignoreConstraintsFromTo("feature","laminate"),this.attrEvaluator.ignoreConstraintsFromTo("ink","laminate")}resetQuantity(t){this.quantityAndPriceOptions=t;const e=this.quantityAndPriceOptions.find((t=>0!==t.quantity)),i=e?e.quantity:0;!this.cherryPicks.hasAttr("quantity")&&i&&this.productItem.setAttrValue("quantity",i)}canAttrValuesBeDisabled(t){return this.neverDisable.indexOf(t)<0}isAttributeRequired(t){return this.attrComputer.isRequired(t)||this.attributesRequiredByWizard.indexOf(t)>=0}getListOptionsForAttribute(t,e,i=!0,r=!0){const n=this.productItem.getAttrValue(t),s=this.attrComputer.getSuggestedValues(t);if(this.attrComputer.isDynamicValue(t)&&null!=n){let e=n;this.attrComputer.isNumberType(t)&&(e=Number(n)),s.includes(e.toString())||s.push(e.toString())}const o=this.getDisabledOptions(t);r||delete o.outOfStock;let a=null;e&&(a=ya.getTranslationsFromMap(e,"products",s,t));const l=this.mapOptions(s,t,o,a);return i?this.sortOptions(l,t):l}mapOptions(t,e,i,r){const n=Object.values(i).flat(),s=this.attrComputer.getIcons(e);return t.map((t=>{var i,o,a,l;const h=this.productItem.getAttrValue(e),d=Array.isArray(h)?h.includes(t):String(this.productItem.getAttrValue(e))===String(t);return{value:t,title:null!==(i=null==r?void 0:r[t])&&void 0!==i?i:t,badge:void 0,disabled:n.includes(String(t)),image:{url:null!==(o=null==s?void 0:s[t])&&void 0!==o?o:null,alt:null!==(a=null==r?void 0:r[t])&&void 0!==a?a:t},icon:null!==(l=null==s?void 0:s[t])&&void 0!==l?l:null,selected:d}}))}sortOptions(t,e){const i=t.reduce(((t,i)=>i.disabled?Object.assign(Object.assign({},t),{low:[...t.low,i]}):this.attrComputer.hasBeenFiltered(e)&&!this.attrComputer.isInFilteredValues(e,i.value)?Object.assign(Object.assign({},t),{medium:[...t.medium,i]}):Object.assign(Object.assign({},t),{high:[...t.high,i]})),{high:[],medium:[],low:[]});return[...i.high,...i.medium,...i.low]}getDisabledOptions(t){var e;return{constrained:this.canAttrValuesBeDisabled(t)?this.attrComputer.getConstrainedValues(t):[],outOfStock:null!==(e=this.attrComputer.getOutOfStockValues(t))&&void 0!==e?e:[]}}}var Ta=Sn('<div class="ruler width svelte-yg7hqj"><div><div></div></div> <div> </div> <div><div></div></div></div> <div class="ruler height svelte-yg7hqj"><div><div></div></div> <div> </div> <div><div></div></div></div>',1);const xa={hash:"svelte-yg7hqj",code:".ruler.svelte-yg7hqj {position:absolute;display:flex;&.width {flex-direction:row;.left-line-container:where(.svelte-yg7hqj) {width:40%;display:flex;align-items:center;border-left:1px solid;border-color:grey;&.dark {border-color:rgb(77, 77, 77);}}.right-line-container:where(.svelte-yg7hqj) {width:40%;display:flex;align-items:center;border-right:1px solid;border-color:grey;&.dark {border-color:rgb(77, 77, 77);}}.line:where(.svelte-yg7hqj) {height:1px;background-color:grey;width:100%;&.dark {background-color:rgb(77, 77, 77);}}.text:where(.svelte-yg7hqj) {width:20%;display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:bold;color:grey;&.dark {color:rgb(77, 77, 77);}}}&.height {flex-direction:column;align-items:center;.top-line-container:where(.svelte-yg7hqj) {height:30%;width:100%;justify-content:center;display:flex;align-items:center;border-top:1px solid;border-color:grey;&.dark {border-color:rgb(77, 77, 77);}}.bottom-line-container:where(.svelte-yg7hqj) {height:30%;width:100%;justify-content:center;display:flex;align-items:center;border-bottom:1px solid;border-color:grey;&.dark {border-color:rgb(77, 77, 77);}}.line:where(.svelte-yg7hqj) {width:1px;background-color:grey;height:100%;&.dark {background-color:rgb(77, 77, 77);}}.text:where(.svelte-yg7hqj) {height:40%;width:100px;display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:bold;color:grey;transform:rotate(-90deg);&.dark {color:rgb(77, 77, 77);}}}}"};var wa=Sn("<!> <!>",1),Ea=Sn("<!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <!>",1),Aa=On('<filter><feColorMatrix type="matrix" in="SourceGraphic" result="mask" values="0 0 0 0 1\n              0 0 0 0 1\n              0 0 0 0 1\n              0 0 0 1 0"></feColorMatrix><feComponentTransfer in="mask" result="inverted"><feFuncR type="table" tableValues="1 0"></feFuncR><feFuncG type="table" tableValues="1 0"></feFuncG><feFuncB type="table" tableValues="1 0"></feFuncB><feFuncA type="table" tableValues="1 0"></feFuncA></feComponentTransfer><feColorMatrix type="matrix" in="inverted" result="result" values="1 0 0 0 1\n              0 1 0 0 1\n              0 0 1 0 1\n              0 0 0 1 0"></feColorMatrix></filter>'),Pa=On('<pattern patternUnits="userSpaceOnUse" width="300" height="300"><image width="300" height="300" preserveAspectRatio="xMidYMid meet" transform="rotate(90 150 150)"></image></pattern><rect></rect>',1),Sa=On('<path class="svelte-ssl2j6"></path>'),Oa=On('<clipPath class="clip-path svelte-ssl2j6"><path class="svelte-ssl2j6"></path></clipPath>'),Ma=On("<image></image>"),Ca=On('<pattern patternUnits="userSpaceOnUse" width="1000" height="1000"><image width="1000" height="1000" preserveAspectRatio="xMinYMid meet"></image></pattern><rect></rect>',1),Ia=On('<pattern patternUnits="userSpaceOnUse" width="40" height="40"><image width="80" height="80" transform-origin="20 20"></image><image width="80" height="80" transform-origin="20 20" preserveAspectRatio="xMidYMid slice"></image></pattern><rect></rect>',1),ka=On('<filter filterUnits="objectBoundingBox"><feTurbulence type="turbulence" baseFrequency="0.05" numOctaves="1" result="turbulence"></feTurbulence><feDisplacementMap in2="turbulence" in="SourceGraphic" scale="20" xChannelSelector="R" yChannelSelector="G"></feDisplacementMap></filter>'),Na=On('<image preserveAspectRatio="xMidYMid slice" transform-origin="center"></image>'),La=On('<image preserveAspectRatio="xMidYMid slice" transform-origin="center"></image>'),Da=On("<g><image></image></g>"),Ba=On('<pattern patternUnits="userSpaceOnUse" patternTransform="scale(1)"><image preserveAspectRatio="xMinYMid meet"></image></pattern><mask><rect width="100%" height="100%"></rect></mask><image></image>',1),Ra=On('<pattern patternUnits="userSpaceOnUse"><image preserveAspectRatio="none"></image></pattern><mask><rect width="100%" height="100%"></rect></mask><rect></rect>',1),$a=Sn("<div> </div>"),ja=On("<image></image>"),qa=On('<rect fill="rgb(25,25,25)"></rect>'),Va=On("<image></image>"),Fa=On("<rect></rect>"),Ha=On("<g><mask><!></mask><mask><!></mask></g>"),za=On('<svg style="position: absolute; overflow:hidden; width:unset;" class="svelte-ssl2j6"><!></svg>'),Ua=On('<!><svg color-interpolation-filters="linearRGB" xmlns="http://www.w3.org/2000/svg" version="1.1" transform="scale(.8)"><defs><!></defs><!></svg>',1),Ga=Sn("<!>         <div><!> <!></div>",1);const Za={hash:"svelte-ssl2j6",code:"svg.svelte-ssl2j6 {&.max-width-70 {max-width:70%;}&.max-height-70 {max-height:70%;}}.clip-path.svelte-ssl2j6 path:where(.svelte-ssl2j6) {fill:#aaa;}svg.svelte-ssl2j6 {filter:drop-shadow(var(--shadow));--posX: 0;--posY: 0;--accentColor: #cfb400;--shadow: 0 0 15px rgba(0, 0, 30, 0.12);--hueshift: 0;}.svg-container.inspecting.svelte-ssl2j6 .svgCanvas:where(.svelte-ssl2j6) {\n    /*Scaling to maximum 1 for better quality image.\n    Newsalert Scaling sometimes creates tearing at the edges of the svg.\n    If this is a big problem, scale 1 to 1.2 instead*/transform:perspective(600px) rotateX(calc(var(--posY) * -45deg))\n      rotateY(calc(var(--posX) * -45deg));}.svg-container.svelte-ssl2j6 .svgCanvas:where(.svelte-ssl2j6) {transform:scale(1) translate3d(0, 0, 0);}.svg-container.svelte-ssl2j6 {display:grid;place-items:center;width:100%; /* Adjust to your desired width */height:100%; /* Adjust to your desired height */\n    /* position relative for positioning background options in container */position:relative;}"};function Wa(t,e){dn(e,!0),Kn(t,Za);const i=function(){let t=tn("0"),e=tn(0),i=Date.now();return{update(){const r=Date.now();!function(t,e=1){var i=zr(t),r=1===e?i++:i--;rn(t,i)}(e);const n=(r-i)/1e3;n>=1&&(rn(t,(zr(e)/n).toFixed(2),!0),rn(e,0),i=r)},getFps:()=>zr(t)}}();let r=Ls(e,"settings",15),n=Ls(e,"visible",11,!1);const s=jo(),o=[Ao.Glossy,Ao.GlossyThin,Ao.GlossyThinNoUV];let a,l,h,d,c=tn(void 0),u=tn(void 0),p=tn(!1),g=tn(!1),m=Pi((()=>e.baseProps.material.metallicOpacity?"function"==typeof e.baseProps.material.metallicOpacity?e.baseProps.material.metallicOpacity(e.baseProps.laminate):e.baseProps.material.metallicOpacity:e.baseProps.material.isMetal?.3:0)),f=Pi((()=>o.includes(e.baseProps.laminate)));const v=Pi((()=>r().fullSize?"":"max-w-[70%] max-width-70 max-h-[70%] max-height-70"));let b=tn(0),y=tn(0),_={x:0,y:0},T={x:0,y:0},x=tn(oi(E("large")));function w(t){return e.baseProps.material.type===Eo.Pixie?"small"===t?.4*r().patternScale:.2*r().patternScale:"small"===t?2*r().patternScale:.6*r().patternScale}function E(t){const e="small"===t?540:1080,i="small"===t?540:1080;let r=[];for(let t=0;t<3;t++)for(let n=0;n<4;n++)r.push({x:e*n,y:i*t});return{indices:r,width:4*e,height:3*i,frameWidth:e,frameHeight:i,imgSrc:`/images/web/preview/effects/glitter-masks/${"small"===t?"spritesheet_small":"spritesheet_large"}.jpg`,patternScale:w(t)}}Di((()=>{rn(x,E("large"),!0)}));let A,P=Pi((()=>e.baseProps.sticker.pathWidth?e.baseProps.sticker.pathWidth:e.baseProps.sticker.width)),S=Pi((()=>e.baseProps.sticker.pathHeight?e.baseProps.sticker.pathHeight:e.baseProps.sticker.height)),O=Pi((()=>{let t=3*zr(P)/1e3,e=3*zr(S)/698,i=Math.max(t,e);return{width:1e3*i,height:698*i,scale:i,bufferFactor:3}})),M=Pi((()=>{let t=5*zr(P)/1090,e=5*zr(S)/1636,i=Math.max(t,e);return{width:1090*i,height:1636*i,scale:i,bufferFactor:5}})),C=0,I=0,k=tn(0),N=tn(0),L=0,D=tn(""),B=tn("");function R(t){let e=a?.getBoundingClientRect();if(e){let i=t.beta,r=t.gamma;if(i&&r){i>40&&(i=40),i<-40&&(i=-40),i+=80,r+=80;let t=r/180,n=i/180;V(Math.round(t*e.width+e.left),Math.round(n*e.height+e.top),e)}}}async function j(t){return await q({startPosition:0,endPosition:100},{startPosition:0,endPosition:100},t),await q({startPosition:100,endPosition:100},{startPosition:100,endPosition:0},t),await q({startPosition:100,endPosition:100},{startPosition:0,endPosition:100},t),await q({startPosition:100,endPosition:0},{startPosition:100,endPosition:0},t),await q({startPosition:0,endPosition:50},{startPosition:0,endPosition:50},t/2),await q({startPosition:50,endPosition:100},{startPosition:50,endPosition:50},t/2),await q({startPosition:100,endPosition:0},{startPosition:50,endPosition:50},t/2),await q({startPosition:0,endPosition:50},{startPosition:50,endPosition:50},t/2),await q({startPosition:50,endPosition:50},{startPosition:50,endPosition:100},t/2),await q({startPosition:50,endPosition:0},{startPosition:100,endPosition:0},t/2),new Promise((e=>{j(t),e()}))}function q(t,e,n){return new Promise((s=>{if(!a)return void s();const o=performance.now();let l=a?.getBoundingClientRect();A=requestAnimationFrame((function a(h){r().showFps&&i.update();const d=h-o,c=Math.min(d/n,1),u=(p=c)<.5?2*p*p:1-Math.pow(-2*p+2,2)/2;var p;let g=t.startPosition+(t.endPosition-t.startPosition)*u,m=e.startPosition+(e.endPosition-e.startPosition)*u;V(g/100*l.width+l.left,m/100*l.height+l.top,l),c<1?A=requestAnimationFrame(a):s()}))}))}function V(t,i,r){C=t-r.left,I=i-r.top,rn(k,-(C/a.clientWidth-.5).toFixed(3)),rn(N,+(I/a.clientHeight-.5).toFixed(3));const n=Math.atan2(I-e.baseProps.sticker.height/2,C-e.baseProps.sticker.width/2);L=180*n/Math.PI+90,L<0&&(L+=360),zr(c)?.style.setProperty("--posX",(-zr(k)).toString()),zr(c)?.style.setProperty("--posY",(-zr(N)).toString()),function(){if(!zr(c))return;const t=zr(c).getBoundingClientRect(),e=Math.max(t.width,t.height),i=30*e/500,r=.02*e,n=Math.min(30,Math.max(5,i));let s=`${(-zr(k)*n*2).toFixed(1)}px ${(zr(N)*n).toFixed(1)}px ${r}px rgba(0,0,30,0.3)`;zr(c).style.setProperty("--shadow",s)}(),e.baseProps.material.type!==Eo.Glitter&&e.baseProps.material.type!==Eo.Pixie||function(){if(!zr(x)||0===zr(x).indices.length)return;const t=120*zr(N)+240*zr(k);let e=zr(x).indices.length,i=Math.abs(Math.floor(t/5))%e,r=zr(x).indices[i];void 0!==r&&(d.style.transform=`translate(-${r.x*zr(x).patternScale}px, -${r.y*zr(x).patternScale}px)`)}(),e.baseProps.material.type==Eo.Reflective&&function(){let t=Math.abs(Math.floor((120*zr(N)+240*zr(k))/10))%22%22;t>11&&(t=22-t),rn(b,t%4),rn(y,Math.floor(t/4)%3)}()}function F(t){if(!a)return t;const e=a.getBoundingClientRect();return{x:e.left+.5*e.width,y:e.top+.5*e.height}}function H(){_=F(_)}function z(t){_.x=t.clientX,_.y=t.clientY,T=F(T)}function U(t){r().showFps&&i.update(),_.x=t.clientX,_.y=t.clientY,async function(){zr(p)||(rn(p,!0),new Promise((t=>{let e=performance.now();requestAnimationFrame((function i(r){if(1==zr(g))return rn(g,!1),T=F(T),t(),void rn(p,!1);const n=.001*(r-e);e=r;let s=(_.x-T.x)*n*10,o=(_.y-T.y)*n*10;T.x+=s,T.y+=o;const l=_.x-T.x,h=_.y-T.y;if(l<0&&T.x<_.x&&(T.x=_.x),l>0&&T.x>_.x&&(T.x=_.x),h<0&&T.y<_.y&&(T.y=_.y),h>0&&T.y>_.y&&(T.y=_.y),Math.abs(l)<10&&(_.x=T.x),Math.abs(h)<10&&(_.y=T.y),V(T.x,T.y,a.getBoundingClientRect()),T.x==_.x&&T.y==_.y)return t(),void rn(p,!1);requestAnimationFrame(i)}))})))}()}function G(){rn(g,!0)}Di((()=>{e.baseProps.sticker.originOffset&&(h?.setAttribute("transform",`translate(${e.baseProps.sticker.originOffset.x.toString()}, ${e.baseProps.sticker.originOffset?.y.toString()})`),r().effectLayerEnabled&&zr(u)?.querySelectorAll("image").forEach((t=>{t.setAttribute("transform",`translate(${e.baseProps.sticker.originOffset?.x.toString()}, ${e.baseProps.sticker.originOffset?.y.toString()})`)})))})),Di((()=>{switch(A&&cancelAnimationFrame(A),r().animationMode){case xo.Loop:j(3e3);break;case xo.OnMouseMove:return a.addEventListener("mousemove",W),()=>a.removeEventListener("mousemove",W);case xo.OnMouseMoveReset:return a.addEventListener("mousemove",U),a.addEventListener("mouseenter",z),a.addEventListener("mouseleave",H),window.addEventListener("scroll",G),()=>{a.removeEventListener("mousemove",U),a.removeEventListener("mouseenter",z),a.removeEventListener("mouseleave",H),window.removeEventListener("scroll",G)};case xo.OnDeviceOrientation:return addEventListener("deviceorientation",R,!1),()=>removeEventListener("deviceorientation",R,!1)}})),Di((()=>{if(!e.wiggle&&a){const t=a?.getBoundingClientRect();V(.5*t.width,.5*t.height,t)}}));let Z=!1;function W(t){r().showFps&&i.update(),t.stopImmediatePropagation(),e.wiggle&&!Z&&a&&requestAnimationFrame((()=>{a&&(Z=!0,V(t.clientX,t.clientY,a.getBoundingClientRect()),Z=!1)}))}Di((()=>{e.baseProps.sticker.whiteLayerMasks.length>0?function(t){return Jo(this,void 0,void 0,(function*(){const e=t.sticker.whiteLayerMasks,i=t.maskBackground,r=e[0].maskImgUrl,n=yield ea(r),s=n.naturalWidth,o=n.naturalHeight,a=yield ta({imgWidth:n.naturalWidth,imgHeight:n.naturalHeight,fillStyle:i===Po.None?So.Color:void 0,globalCompositeOperation:i===Po.None?"destination-out":"source-over",filterMode:Po.None},i,e,!1),l=yield ta({imgWidth:n.naturalWidth,imgHeight:n.naturalHeight,fillStyle:i===Po.Mix?So.Mix:void 0,globalCompositeOperation:i===Po.Mix?"destination-out":"source-over",filterMode:Po.Mix},i,e,!1);let h=document.createElement("canvas");return h.width=s,h.height=o,h.getContext("2d")?(h=ia(a),{combinedMask:h.toDataURL("image/png"),mixMask:ra(l,So.Color).toDataURL("image/png")}):{combinedMask:h.toDataURL("image/png"),mixMask:l.toDataURL("image/png"),whitelayerMask:a.toDataURL("image/png")}}))}(e.baseProps).then((t=>{rn(D,t.combinedMask,!0),rn(B,t.mixMask,!0)})):(rn(D,""),rn(B,""))}));let K=tn("");Di((()=>{switch(r().holoIndex){case 0:rn(K,e.staticUrl+"/images/web/preview/effects/holographic-swirl.png");break;case 1:rn(K,e.staticUrl+"/images/web/preview/effects/holographic-swirl2.png");break;case 2:rn(K,e.staticUrl+"/images/web/preview/effects/holoimage.png");break;case 3:rn(K,e.staticUrl+"/images/web/preview/effects/holoimage_blur.png");break;case 4:rn(K,e.staticUrl+"/images/web/preview/effects/holoimage_2.png");break;case 5:rn(K,e.staticUrl+"/images/web/preview/effects/holoimage_3.png")}}));var Y=Ga(),X=bi(Y),Q=t=>{var e=$a();ns(e,"\n    position:absolute;\n    font-weight: bold;\n    font-size: 20px;\n    color:crimson;\n    z-index: 100;\n    top: 650px;\n    left: 280px;\n    ");var r=vi(e,!0);ti(e),qi((t=>kn(r,t)),[()=>"FPS: "+i.getFps()]),Cn(t,e)};$n(X,(t=>{r().showFps&&t(Q)}));var J=yi(X,2);let tt;ls(J,"id",`svgContainer-${s??""}`);var et=vi(J);jn(et,(()=>zr(D)||zr(B)),(t=>{var i=za();ls(i,"id",`mask-svg-${s??""}`);var n=vi(i),o=t=>{var i=Ha(),r=vi(i);ls(r,"id",`combined-mask-${s??""}`);var n=vi(r),o=t=>{var e=ja();qi((()=>{ls(e,"height",zr(S)),ls(e,"width",zr(P)),ls(e,"href",zr(D))})),Cn(t,e)},a=t=>{var e=qa();qi((()=>{ls(e,"width",zr(P)),ls(e,"height",zr(S))})),Cn(t,e)};$n(n,(t=>{""===zr(D)||e.isLoading?t(a,!1):t(o)})),ti(r);var l=yi(r);ls(l,"id",`mix-mask-${s??""}`);var h=vi(l),d=t=>{var e=Va();qi((()=>{ls(e,"height",zr(S)),ls(e,"width",zr(P)),ls(e,"href",zr(B))})),Cn(t,e)},c=t=>{var e=Fa();qi((()=>{ls(e,"width",zr(P)),ls(e,"height",zr(S)),ls(e,"fill",So.Color)})),Cn(t,e)};$n(h,(t=>{""===zr(B)||e.isLoading?t(c,!1):t(d)})),ti(l),ti(i),As(i,(t=>rn(u,t)),(()=>zr(u))),Cn(t,i)};$n(n,(t=>{r().effectLayerEnabled&&t(o)})),ti(i),Cn(t,i)}));var it=yi(et,2),rt=t=>{var i=Ua(),n=bi(i);const o=Pi((()=>!e.wiggle));!function(t,e){dn(e,!0),Kn(t,xa);let i=tn(0),r=tn(0),n=tn(0),s=tn(0),o=tn(0);const a=new _a,l=new aa(a);function h(){const t=document.getElementById(`baseplateLayer-${e.uniqueId}`);t&&(rn(i,t.getBoundingClientRect().x,!0),rn(r,t.getBoundingClientRect().y,!0),rn(n,t.getBoundingClientRect().width,!0),rn(s,t.getBoundingClientRect().height,!0),rn(o,30+.02*zr(s)))}function d(t){return e.productItemDimensions&&t?e.productItemDimensions.imperialUnits?`${l.convertMMToInches(t).toString()} "`:`${l.convertMMToCM(t).toString()} cm`:""}window.onresize=()=>{h()},Di((()=>{e.show&&h()}));var c=Mn(),u=bi(c),p=t=>{var a=Ta(),l=bi(a),h=vi(l),c=vi(h);ti(h);var u=yi(h,2),p=vi(u,!0);ti(u);var g=yi(u,2),m=vi(g);ti(g),ti(l);var f=yi(l,2),v=vi(f),b=vi(v);ti(v);var y=yi(v,2),_=vi(y,!0);ti(y);var T=yi(y,2),x=vi(T);ti(T),ti(f),qi(((t,a)=>{ns(l,`top: ${zr(r)-60}px; left: ${zr(i)}px; width: ${zr(n)}px; height: ${zr(o)}px;`),is(h,1,`left-line-container ${e.backgroundOption}`,"svelte-yg7hqj"),is(c,1,`line ${e.backgroundOption}`,"svelte-yg7hqj"),is(u,1,`text ${e.backgroundOption}`,"svelte-yg7hqj"),kn(p,t),is(g,1,`right-line-container ${e.backgroundOption}`,"svelte-yg7hqj"),is(m,1,`line ${e.backgroundOption}`,"svelte-yg7hqj"),ns(f,`left: ${zr(i)-60}px; top: ${zr(r)}px; height: ${zr(s)}px; width: ${zr(o)}px;`),is(v,1,`top-line-container ${e.backgroundOption}`,"svelte-yg7hqj"),is(b,1,`line ${e.backgroundOption}`,"svelte-yg7hqj"),is(y,1,`text ${e.backgroundOption}`,"svelte-yg7hqj"),kn(_,a),is(T,1,`bottom-line-container ${e.backgroundOption}`,"svelte-yg7hqj"),is(x,1,`line ${e.backgroundOption}`,"svelte-yg7hqj")}),[()=>d(e.productItemDimensions?.widthMM),()=>d(e.productItemDimensions?.heightMM)]),Cn(t,a)};$n(u,(t=>{e.show&&t(p)})),Cn(t,c),cn()}(n,{get show(){return zr(o)},uniqueId:s,get productItemDimensions(){return e.productItemDimensions},get backgroundOption(){return r().backgroundOption}});var a=yi(n);ls(a,"id",`canvas-${s??""}`);var u=vi(a);(t=>{var i=Ea(),n=bi(i),o=t=>{(t=>{var i=Ia();const n=Pi((()=>360*zr(N)+360*zr(k)));var o=bi(i);ls(o,"id",`prism-pattern-${s??""}`);var a=vi(o);ls(a,"id",`prism-img-${s??""}`);var l=yi(a);ls(l,"id",`prism-img-addition-${s??""}`),ti(o);var h=yi(o);ls(h,"id",`prismaticLayerDef-${s??""}`),ls(h,"fill",`url(#prism-pattern-${s??""})`),qi(((t,i)=>{ls(o,"patternTransform",`scale(${r().patternScale??""})`),ls(a,"href",e.staticUrl+"/images/web/preview/effects/prism-100x100.png"),ls(a,"transform",`rotate(${zr(n)??""}) translate(-20 -20)`),ls(a,"opacity",t),ls(l,"href",e.staticUrl+"/images/web/preview/effects/prism-addition-100x100_1.png"),ls(l,"transform",`rotate(${zr(n)??""}) translate(-20 -20)`),ls(l,"opacity",i),ls(h,"height",zr(S)),ls(h,"width",zr(P)),ns(h,`filter: hue-rotate(${zr(n)??""}deg);`)}),[()=>Math.min(Math.abs(zr(k)+.6),.6),()=>Math.abs(zr(k))]),Cn(t,i)})(t)};$n(n,(t=>{e.baseProps.material.type==Eo.Prismatic&&t(o)}));var a=yi(n,2),c=t=>{(t=>{var e=Ma();ls(e,"id",`holographicLayerDef-${s??""}`),qi((()=>{ns(e,`transform: translate(${-zr(k)*(zr(O).width/1.5)}px, ${zr(N)*(zr(O).height/1.5)}px);`),ls(e,"href",zr(K)),ls(e,"width",zr(O).width),ls(e,"height",zr(O).height)})),Cn(t,e)})(t)};$n(a,(t=>{e.baseProps.material.type==Eo.Holographic&&t(c)}));var u=yi(a,2),p=t=>{(t=>{var i=Ba(),r=bi(i);ls(r,"id",`glitterMaskPattern-${s??""}`);var n=vi(r);As(n,(t=>d=t),(()=>d)),ti(r);var o=yi(r);ls(o,"id",`glitterMask-${s??""}`),ls(vi(o),"fill",`url(#glitterMaskPattern-${s??""})`),ti(o);var a=yi(o);ls(a,"id",`glitterLayerDef-${s??""}`),qi((()=>{ls(r,"width",zr(x).frameWidth*zr(x).patternScale),ls(r,"height",zr(x).frameHeight*zr(x).patternScale),ls(n,"width",zr(x).width*zr(x).patternScale),ls(n,"height",zr(x).height*zr(x).patternScale),ls(n,"href",e.staticUrl+zr(x).imgSrc),ns(a,`transform: translate(${-zr(k)*(zr(O).width/1.5)}px, ${zr(N)*(zr(O).height/1.5)}px);`),ls(a,"href",e.staticUrl+"/images/web/preview/effects/holoimage_3.png"),ls(a,"width",zr(O).width),ls(a,"height",zr(O).height)})),Cn(t,i)})(t)};$n(u,(t=>{e.baseProps.material.type!=Eo.Glitter&&e.baseProps.material.type!=Eo.Pixie||t(p)}));var g=yi(u,2);(t=>{var i=Pa(),n=bi(i);ls(n,"id",`brushed-pattern-${s??""}`);var o=vi(n);ti(n);var a=yi(n);ls(a,"id",`brushedLayerDef-${s??""}`),ls(a,"fill",`url(#brushed-pattern-${s??""})`),qi((()=>{ls(n,"patternTransform",`scale(${r().patternScale??""})`),ls(o,"href",e.staticUrl+"/images/web/preview/effects/brush-tile.jpg"),ls(a,"width",zr(P)),ls(a,"height",zr(S))})),Cn(t,i)})(g);var v=yi(g,2);(t=>{var i=Ra(),n=bi(i);ls(n,"id",`reflectivePattern-${s??""}`);var o=vi(n);ls(o,"id",`reflectiveImage-${s??""}`),ti(n);var a=yi(n);ls(a,"id",`reflectiveMask-${s??""}`),ls(vi(a),"fill",`url(#reflectivePattern-${s??""})`),ti(a);var l=yi(a);ls(l,"id",`reflectiveLayerDef-${s??""}`),ls(l,"mask",`url(#reflectiveMask-${s??""})`),qi((()=>{ls(n,"width",1080*r().patternScale/13),ls(n,"height",1080*r().patternScale/13),ls(o,"href",e.staticUrl+"/images/web/preview/effects/reflex_sprite.jpg"),ls(o,"width",4320*r().patternScale/13),ls(o,"height",3240*r().patternScale/13),ls(o,"x","-"+1080*zr(b)*r().patternScale/13),ls(o,"y","-"+1080*zr(y)*r().patternScale/13),ls(o,"data-indexX",zr(b)),ls(o,"data-indexY",zr(y)),ls(l,"fill",So.Color),ls(l,"width",zr(P)),ls(l,"height",zr(S))})),Cn(t,i)})(v);var _=yi(v,2);(t=>{var i=Da();ls(i,"id",`imageGroup-${s??""}`);var r=vi(i);ls(r,"id",`printImage-${s??""}`),As(r,(t=>h=t),(()=>h)),ti(i),qi((()=>{ls(r,"href",e.baseProps.sticker.previewImage),ls(r,"width",e.baseProps.sticker.width),ls(r,"height",e.baseProps.sticker.height)})),Cn(t,i)})(_);var T=yi(_,2);(t=>{var i=Oa();ls(i,"id",`clippy-${s??""}`);var r=vi(i);ls(r,"id",`clippySvgPath-${s??""}`),ti(i),qi((()=>ls(r,"d",e.baseProps.sticker.path))),Cn(t,i)})(T);var w=yi(T,2),E=t=>{(t=>{var e=ka();ls(e,"id",`displacementFilter-${s??""}`),Cn(t,e)})(t)};$n(w,(t=>{r().lightweight||t(E)}));var A=yi(w,2),C=t=>{var i=wa(),r=bi(i);(t=>{var i=Na();ls(i,"id",`laminateLayerDef-${s??""}`),ls(i,"scale",1),As(i,(t=>l=t),(()=>l)),qi((()=>{ls(i,"width",zr(M).width),ls(i,"height",zr(M).height),ns(i,`transform: translate(${e.wiggle?200*-zr(k)*zr(M).scale:0}px, ${e.wiggle?200*zr(N)*zr(M).scale:0}px);`),ls(i,"href",zr(f)?e.staticUrl+"/images/web/preview/reflections/escaltor-shine.jpg":e.staticUrl+"/images/web/preview/reflections/escaltor-matte.jpg")})),Cn(t,i)})(r),(t=>{var i=La();ls(i,"id",`metallicLayerDef-${s??""}`),ls(i,"scale",1),qi((()=>{ls(i,"opacity",zr(m)),ls(i,"href",zr(f)?e.staticUrl+"/images/web/preview/reflections/escaltor-shine.jpg":e.staticUrl+"/images/web/preview/reflections/escaltor-matte.jpg"),ls(i,"width",zr(M).width),ls(i,"height",zr(M).height),ns(i,`transform: translate(${e.wiggle?200*-zr(k)*zr(M).scale:0}px, ${e.wiggle?200*zr(N)*zr(M).scale:0}px);`)})),Cn(t,i)})(yi(r,2)),Cn(t,i)};$n(A,(t=>{e.wiggle&&t(C)}));var I=yi(A,2);(t=>{var i=Ca(),n=bi(i);ls(n,"id",`recycled-pattern-${s??""}`);var o=vi(n);ti(n);var a=yi(n);ls(a,"id",`recycledLayerDef-${s??""}`),ls(a,"fill",`url(#recycled-pattern-${s??""})`),qi((()=>{ls(n,"patternTransform",`scale(${r().patternScale??""})`),ls(o,"href",e.staticUrl+"/images/web/preview/effects/recycled.jpg"),ls(a,"width",zr(P)),ls(a,"height",zr(S))})),Cn(t,i)})(I);var L=yi(I,2);(t=>{var i=Sa();ls(i,"id",`baseplate-${s??""}`),qi((()=>ls(i,"d",e.baseProps.sticker.path))),Cn(t,i)})(L),(t=>{var e=Aa();ls(e,"id",`invertMaskFilter-${s??""}`),Cn(t,e)})(yi(L,2)),Cn(t,i)})(vi(u)),ti(u),jn(yi(u),(()=>e.baseProps),(t=>{!function(t,e){let i;dn(e,!0),Kn(t,Qo);let r,n=tn(void 0),s=tn(void 0),o=tn(void 0),a=tn(void 0),l=tn(void 0),h=tn(void 0),d=tn(void 0),c=tn(void 0),u=tn(void 0),p=tn(void 0),g=Pi((()=>e.selectedMaterial.laminateSettings.laminateOpacity??0));Di((()=>{let t=document.querySelector(`#canvas-${e.uniqueId}`);if(t){zr(s)&&ko(t,zr(s)),zr(o)&&ko(t,zr(o)),zr(l)&&ko(t,zr(l)),zr(d)&&ko(t,zr(d)),r&&ko(t,r);let i=document.querySelector(`#clippySvgPath-${e.uniqueId}`);if(i?.removeAttribute("transform"),i&&zr(p)){zr(p)?.removeAttribute("transform");let e=function(t,e){const i=t.viewBox.baseVal,r=i.width,n=i.height,s=e.getAttribute("scale"),o=e.getBBox();let a="translate("+((r-o.width)/2-o.x)+","+((n-o.height)/2-o.y)+")";return s&&(a+=" scale("+s+")"),e.setAttribute("transform",a),a}(t,zr(p));i.setAttribute("transform",e)}}})),Di((()=>{r&&(e.selectedMaterial.type!=Eo.Recycled&&e.selectedMaterial.type!=Eo.KraftThin||(r.style.fill="url(#recycled-pattern-"+e.uniqueId+")")),i&&e.selectedMaterial.type==Eo.Clear&&(i.style.mask="url(#combined-mask-"+e.uniqueId+")")})),Di((()=>{zr(n)&&(e.selectedMaterial.type===Eo.Glitter||e.selectedMaterial.type===Eo.Pixie?zr(n).style.mixBlendMode="color-burn":zr(n).style.mixBlendMode="multiply")}));var m=Xo(),f=bi(m);As(f,(t=>rn(p,t)),(()=>zr(p)));var v=yi(f),b=vi(v);let y;As(b,(t=>r=t),(()=>r));var _=yi(b),T=t=>{var i=Vo();As(i,(t=>rn(s,t)),(()=>zr(s))),qi((()=>{ls(i,"id",`holographicLayer-${e.uniqueId??""}`),ls(i,"href",`#holographicLayerDef-${e.uniqueId??""}`)})),Cn(t,i)},x=(t,i)=>{var r=t=>{var i=Fo(),r=vi(i);As(r,(t=>rn(o,t)),(()=>zr(o))),ti(i),qi((()=>{ls(i,"mask",`url(#glitterMask-${e.uniqueId??""})`),ls(r,"id",`glitterLayer-${e.uniqueId??""}`),ls(r,"href",`#glitterLayerDef-${e.uniqueId??""}`)})),Cn(t,i)},n=(t,i)=>{var r=t=>{var i=Ho();As(i,(t=>rn(a,t)),(()=>zr(a))),qi((()=>ls(i,"href",`#prismaticLayerDef-${e.uniqueId??""}`))),Cn(t,i)};$n(t,(t=>{e.selectedMaterial.type===Eo.Prismatic&&t(r)}),i)};$n(t,(t=>{e.selectedMaterial.type===Eo.Glitter||e.selectedMaterial.type===Eo.Pixie?t(r):t(n,!1)}),i)};$n(_,(t=>{e.selectedMaterial.type===Eo.Holographic?t(T):t(x,!1)}));var w=yi(_),E=t=>{var i=zo();As(i,(t=>rn(l,t)),(()=>zr(l))),qi((()=>{ls(i,"id",`metallicLayer-${e.uniqueId??""}`),ls(i,"href",`#metallicLayerDef-${e.uniqueId??""}`)})),Cn(t,i)};$n(w,(t=>{e.selectedMaterial.isMetal&&t(E)}));var A=yi(w),P=t=>{var i=Uo();As(i,(t=>rn(h,t)),(()=>zr(h))),qi((()=>{ls(i,"id",`brushedLayer-${e.uniqueId??""}`),ls(i,"href",`#brushedLayerDef-${e.uniqueId??""}`)})),Cn(t,i)};$n(A,(t=>{e.selectedMaterial.type===Eo.Brushed&&t(P)}));var S=yi(A),O=t=>{var i=Go();qi((()=>{ls(i,"id",`reflectiveLayer-${e.uniqueId??""}`),ls(i,"href",`#reflectiveLayerDef-${e.uniqueId??""}`)})),Cn(t,i)};$n(S,(t=>{e.selectedMaterial.type===Eo.Reflective&&t(O)}));var M=yi(S);As(M,(t=>i=t),(()=>i));var C=yi(M);As(C,(t=>rn(u,t)),(()=>zr(u)));var I=yi(C),k=t=>{var i=Zo();As(i,(t=>rn(n,t)),(()=>zr(n))),qi((()=>{ls(i,"id",`mixModeMaskLayer-${e.uniqueId??""}`),ls(i,"href",`#imageGroup-${e.uniqueId??""}`),ls(i,"mask",`url(#mix-mask-${e.uniqueId??""})`),ls(i,"opacity",e.selectedMaterial.type===Eo.Clear?.5:.8)})),Cn(t,i)};$n(I,(t=>{e.settings.effectLayerEnabled&&t(k)}));var N=yi(I),L=t=>{var i=Mn(),r=bi(i),n=t=>{var i=Wo();As(i,(t=>rn(d,t)),(()=>zr(d))),qi((()=>{ls(i,"id",`laminateLayer-${e.uniqueId??""}`),ls(i,"href",`#laminateLayerDefAnimation-${e.uniqueId??""}`),ls(i,"opacity",e.selectedMaterial.laminateSettings.enabled?zr(g):.01)})),Cn(t,i)},s=t=>{var i=Ko();As(i,(t=>rn(d,t)),(()=>zr(d))),qi((()=>{ls(i,"id",`laminateLayer-${e.uniqueId??""}`),ls(i,"href",`#laminateLayerDef-${e.uniqueId??""}`),ls(i,"filter",`url(#displacementFilter-${e.uniqueId??""})`),ls(i,"opacity",e.selectedMaterial.laminateSettings.enabled?zr(g):.01)})),Cn(t,i)};$n(r,(t=>{e.settings.lightweight?t(n):t(s,!1)})),Cn(t,i)};$n(N,(t=>{e.settings.laminateLayerEnabled&&t(L)}));var D=yi(N),B=t=>{var i=Yo();As(i,(t=>rn(c,t)),(()=>zr(c))),qi((()=>{ls(i,"id",`recycled-extra-${e.uniqueId??""}`),ls(i,"href",`#recycledLayerDef-${e.uniqueId??""}`)})),Cn(t,i)};$n(D,(t=>{e.selectedMaterial.type===Eo.Recycled&&t(B)})),ti(v),qi((t=>{ls(f,"href",`#clippySvgPath-${e.uniqueId??""}`),is(v,0,Qn(e.selectedMaterial.type),"svelte-1wd83oa"),ls(v,"clip-path",`url(#clippy-${e.uniqueId??""})`),ls(b,"id",`baseplateLayer-${e.uniqueId??""}`),ls(b,"href",`#baseplate-${e.uniqueId??""}`),y=is(b,0,"basePlateLayer svelte-1wd83oa",null,y,t),ls(M,"id",`printLayer-${e.uniqueId??""}`),ls(M,"href",`#imageGroup-${e.uniqueId??""}`),ls(M,"mask",`url(#combined-mask-${e.uniqueId??""})`),ls(C,"id",`printref-${e.uniqueId??""}`),ls(C,"href",`#printImage-${e.uniqueId??""}`)}),[()=>({effectLayerDisabled:!e.settings.effectLayerEnabled})]),Cn(t,m),cn()}(t,{get selectedMaterial(){return e.baseProps.material},uniqueId:s,get settings(){return r()},set settings(t){r(t)}})})),ti(a),As(a,(t=>rn(c,t)),(()=>zr(c))),qi((t=>{is(a,0,t,"svelte-ssl2j6"),ls(a,"viewBox",`0 0 ${zr(P)} ${zr(S)}`)}),[()=>Qn(Xn()(zr(v),"svgCanvas h-full w-full"))]),function(t,e){var i,n,s,o=!1,a=e.inert,l=e.style.overflow;function h(){var t=mr,n=br;vr(null),yr(null);try{return i??=Co(e,{duration:r().lightweight?0:200,delay:r().lightweight?0:300}??{})}finally{vr(t),yr(n)}}var d={is_global:o,in(){e.inert=a,n?.abort(),fs(e,"introstart"),n=_s(e,h(),s,1,(()=>{fs(e,"introend"),n?.abort(),n=i=void 0,e.style.overflow=l}))},out:t=>(t?.(),void(i=void 0)),stop:()=>{n?.abort(),s?.abort()}},c=br;if((c.transitions??=[]).push(d),In){var u=o;if(!u){for(var p=c.parent;p&&p.f&Fe;)for(;(p=p.parent)&&!(16&p.f););u=!p||!!(32768&p.f)}u&&Bi((()=>{Ur((()=>d.in()))}))}}(0,a),Cn(t,i)};$n(it,(t=>{n()&&t(rt)})),ti(J),As(J,(t=>a=t),(()=>a)),qi(((t,e)=>tt=is(J,1,t,"svelte-ssl2j6",tt,e)),[()=>Qn(Xn()("svg-container overflow-hidden",e.baseProps.material.type,e.className)),()=>({inspecting:e.wiggle})]),Cn(t,Y),cn()}var Ka=On('<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentcolor"><circle cx="4" cy="12" r="3" opacity="1"><animate id="spinner_qYjJ" begin="0;spinner_t4KZ.end-0.25s" attributeName="opacity" dur="1s" values="1;.2" fill="currentcolor"></animate></circle><circle cx="12" cy="12" r="3" opacity=".4"><animate begin="spinner_qYjJ.begin+0.15s" attributeName="opacity" dur="1s" values="1;.2" fill="currentcolor"></animate></circle><circle cx="20" cy="12" r="3" opacity=".3"><animate id="spinner_t4KZ" begin="spinner_qYjJ.begin+0.3s" attributeName="opacity" dur="1s" values="1;.2" fill="currentcolor"></animate></circle></svg>');var Ya;!function(t){t.Light="light",t.Dark="dark"}(Ya||(Ya={}));var Xa=(t,e)=>{e(Ya.Light)},Qa=(t,e)=>{"Enter"!==t.key&&" "!==t.key||e(Ya.Light)},Ja=(t,e)=>{e(Ya.Dark)},tl=(t,e)=>{"Enter"!==t.key&&" "!==t.key||e(Ya.Dark)},il=Sn('<div class="bg-buttons-container svelte-fkzgn0"><div role="button" aria-label="option" tabindex="0"> </div> <div class="bg-border svelte-fkzgn0"></div> <div role="button" aria-label="option" tabindex="0"> </div></div>');const rl={hash:"svelte-fkzgn0",code:".bg-border.svelte-fkzgn0 {width:1px;height:60%;background-color:#cccccc;}.bg-buttons-container.svelte-fkzgn0 {display:flex;align-items:center;height:100%;width:fit-content;border-radius:5px;background-color:white;border:1px solid #cccccc;}.bg-buttons-option.svelte-fkzgn0 {padding:10px 20px;display:flex;justify-content:center;align-items:center;min-width:100px;&.selected {font-weight:bold;}}"};function nl(t,e){dn(e,!0),Kn(t,rl);let i=tn(oi(Ya.Light));function r(t){rn(i,t,!0),e.onSelectBackground&&e.onSelectBackground(zr(i))}var n=il(),s=vi(n);let o;s.__click=[Xa,r],s.__keydown=[Qa,r];var a=vi(s,!0);ti(s);var l=yi(s,4);let h;l.__click=[Ja,r],l.__keydown=[tl,r];var d=vi(l,!0);ti(l),ti(n),qi(((t,i)=>{o=is(s,1,"bg-buttons-option svelte-fkzgn0",null,o,t),kn(a,e.translations.lightText),h=is(l,1,"bg-buttons-option svelte-fkzgn0",null,h,i),kn(d,e.translations.darkText)}),[()=>({selected:zr(i)==Ya.Light}),()=>({selected:zr(i)==Ya.Dark})]),Cn(t,n),cn()}xn(["click","keydown"]);var sl=__webpack_require__(29988),ol=__webpack_require__(2698);const al=async(t,e)=>{const i=Jl.find((e=>e.type===t?.attributes.material)),r="function"==typeof i?.metallicOpacity?i.metallicOpacity(t?.attributes.laminate):i?.metallicOpacity??0;return Promise.all(["front","back"].map((async n=>{let s=e.find((t=>t.side===n||t.meta?.SIDE===n));if(!s)return[n,void 0];s.width||(s.width=+(t?.attributes.width_mm??0)),s.height||(s.height=+(t?.attributes.height_mm??0));const o=Bo(s),a=$o(s.matrix),l=Do(s.cuttingline,a),h=await function(t){return Io(this,arguments,void 0,(function*(t,e=""){const i=function(t){const e=(new DOMParser).parseFromString(t,"image/svg+xml").querySelectorAll("text, tspan"),i=new Set;return e.forEach((t=>{const e=t.getAttribute("font-family");e&&i.add(e)})),Array.from(i)}(t);return 0===i.length?[]:yield qo(e,i)}))}(o),d=await Lo(o,h,1080,1080),c=No(o),u=await async function(t){const e=t?.attributes.live_preview_opacity_mask?.toString(),i=t?.attributes.live_preview_white_layer_mask?.toString();if(!e||!i)return[];const r=new URLSearchParams({opacityLayer:e||"",whiteLayer:i||""});try{const t=await fetch(`/editor/get_masks?${r.toString()}`),e=await t.json();return e.length>0?await Yl(e):[]}catch(t){return[]}}(t),p={patternScale:.5,sticker:{width:0,height:0,pathWidth:0,pathHeight:0,original:{height:0,width:0,originOffset:{x:0,y:0},path:"",pathHeight:0,pathWidth:0},previewImage:"",path:"",whiteLayerMasks:[]},laminate:Ao.Glossy,material:Jl[0],maskBackground:Po.Mix};return[n,{...p,sticker:{path:l,width:c?.xMax,height:c?.yMax,previewImage:d,whiteLayerMasks:u},laminate:t.attributes.laminate?.toString()??Ao.Uncoated,material:{...p.material,type:t?.attributes.material,metallicOpacity:r,isMetal:i?.isMetal??!1,laminateSettings:{enabled:i?.laminateSettings.enabled??!0,laminateOpacity:i?.laminateSettings.laminateOpacity}}}]})))},ll=oi(new Map);let hl=tn(oi({STICKERAPP_API_URL:"",ATLAS_ASSET_BASE_URL:"https://d6ce0no7ktiq.cloudfront.net"}));var dl=Sn('<img class="max-h-full max-w-full object-contain" alt="">'),cl=Sn("<!> <!> <!>",1);function ul(t,e){dn(e,!0);const i=Ls(e,"animationMode",19,(()=>xo.None)),r=Ls(e,"side",3,"front"),n=(t=>{const e=Pi(t);let i=tn(oi({type:"initial"})),r=tn(void 0);return Di((()=>{if(!zr(e))return void rn(i,{type:"initial"},!0);let t=!1;return rn(i,{type:"loading"},!0),zr(e).then((e=>{t||(rn(i,{type:"resolved",value:e},!0),rn(r,e,!0))})).catch((e=>{t||rn(i,{type:"rejected",error:e},!0)})),()=>{t=!0}})),n=()=>Object.assign({value:zr(r)},zr(i)),new Proxy({},{get:(t,e)=>n()[e]});var n})((()=>(async t=>{const e=await t;if(!e)return null;const i=`${e.id}-${e.version}`,r=ll.get(i);if(r)return r;const n=await(s=e,fetch(`${zr(hl).STICKERAPP_API_URL}/sheet/getCustomStickerPreview`,{body:JSON.stringify(s),method:"POST"}).then((t=>t.json())).then((t=>{if(ol.Value.Check(sl.Type.Object({preview:sl.Type.String(),livePreviewAvailable:sl.Type.Boolean()}),t))return t}))).catch((()=>{}));var s;const o=void 0===n||n.livePreviewAvailable?{type:"livePreview",value:await al(e.productItem,e.parts)}:{type:"legacyPreview",base64Image:n.preview};return ll.set(i,o),o})(e.customStickerPromise))),s=Pi((()=>{if(void 0!==n.value)return"livePreview"===n.value?.type?n.value.value.find((t=>t?.[0]===r()))?.[1]:n.value?.base64Image}));var o=cl(),a=bi(o),l=t=>{!function(t,e){dn(e,!0);const i=Ls(e,"sizeClass",3,"w-full h-full");var r=Ka();qi((t=>is(r,0,t)),[()=>Qn(Xn()(i(),"overflow-hidden align-middle"))]),Cn(t,r),cn()}(t,{sizeClass:"h-12 w-12"})};$n(a,(t=>{"loading"==n.type&&void 0===n.value&&t(l)}));var h=yi(a,2),d=t=>{var e=dl();qi((()=>ls(e,"src",`data:image/png;base64, ${zr(s)}`))),Cn(t,e)};$n(h,(t=>{"string"==typeof zr(s)&&t(d)}));var c=yi(h,2),u=t=>{const e=Pi((()=>!!n.value)),o=Pi((()=>!n.value)),a=Pi((()=>({laminateLayerEnabled:zr(s).material?.laminateSettings.enabled??!0,patternScale:.5,lightweight:!0,animationMode:i()??xo.None,effectLayerEnabled:!zr(s).material?.type.includes("white")&&"back"!==r(),holoIndex:2,showFps:!1,backgroundOption:Ya.Light,fullSize:!0})));Wa(t,{className:"p-2",get visible(){return zr(e)},get staticUrl(){return zr(hl).ATLAS_ASSET_BASE_URL},get isLoading(){return zr(o)},get baseProps(){return zr(s)},get settings(){return zr(a)},wiggle:!0})};$n(c,(t=>{"object"==typeof zr(s)&&t(u)})),Cn(t,o),cn()}var pl=On('<svg fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><style>.spinner_P7sC {\n      transform-origin: center;\n      animation: spinner_svv2 0.75s infinite linear;\n    }\n    @keyframes spinner_svv2 {\n      100% {\n        transform: rotate(360deg);\n      }\n    }</style><path d="M10.14,1.16a11,11,0,0,0-9,8.92A1.59,1.59,0,0,0,2.46,12,1.52,1.52,0,0,0,4.11,10.7a8,8,0,0,1,6.66-6.61A1.42,1.42,0,0,0,12,2.69h0A1.57,1.57,0,0,0,10.14,1.16Z" class="spinner_P7sC"></path></svg>');function gl(t,e){var i=pl();qi((()=>is(i,0,Qn(e.sizeClass)))),Cn(t,i)}On('<svg viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.986 0.666504C6.62602 0.666504 0.666016 6.63984 0.666016 13.9998C0.666016 21.3598 6.62602 27.3332 13.986 27.3332C21.3593 27.3332 27.3327 21.3598 27.3327 13.9998C27.3327 6.63984 21.3593 0.666504 13.986 0.666504ZM13.9993 24.6665C8.10602 24.6665 3.33268 19.8932 3.33268 13.9998C3.33268 8.1065 8.10602 3.33317 13.9993 3.33317C19.8927 3.33317 24.666 8.1065 24.666 13.9998C24.666 19.8932 19.8927 24.6665 13.9993 24.6665Z" fill="currentColor"></path><path d="M13.9993 5.99984C15.8438 5.99984 17.3327 7.53486 17.3327 9.43646C17.3327 11.3381 15.8438 12.8731 13.9993 12.8731C12.1549 12.8731 10.666 11.3381 10.666 9.43646C10.666 7.53486 12.1549 5.99984 13.9993 5.99984ZM13.9993 22.2665C11.2216 22.2665 8.76602 20.8002 7.33268 18.5779C7.36602 16.2982 11.7771 15.0496 13.9993 15.0496C16.2105 15.0496 20.6327 16.2982 20.666 18.5779C19.2327 20.8002 16.7771 22.2665 13.9993 22.2665Z" fill="currentColor"></path></svg>'),On('<svg fill="currentColor" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M810.65984 170.65984q18.3296 0 30.49472 12.16512t12.16512 30.49472q0 18.00192-12.32896 30.33088l-268.67712 268.32896 268.67712 268.32896q12.32896 12.32896 12.32896 30.33088 0 18.3296-12.16512 30.49472t-30.49472 12.16512q-18.00192 0-30.33088-12.32896l-268.32896-268.67712-268.32896 268.67712q-12.32896 12.32896-30.33088 12.32896-18.3296 0-30.49472-12.16512t-12.16512-30.49472q0-18.00192 12.32896-30.33088l268.67712-268.32896-268.67712-268.32896q-12.32896-12.32896-12.32896-30.33088 0-18.3296 12.16512-30.49472t30.49472-12.16512q18.00192 0 30.33088 12.32896l268.32896 268.67712 268.32896-268.67712q12.32896-12.32896 30.33088-12.32896z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M440-440H240q-17 0-28.5-11.5T200-480q0-17 11.5-28.5T240-520h200v-200q0-17 11.5-28.5T480-760q17 0 28.5 11.5T520-720v200h200q17 0 28.5 11.5T760-480q0 17-11.5 28.5T720-440H520v200q0 17-11.5 28.5T480-200q-17 0-28.5-11.5T440-240v-200Z"></path></svg>'),On('<svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960"><path d="m142-480 294 294q15 15 14.5 35T435-116q-15 15-35 15t-35-15L57-423q-12-12-18-27t-6-30q0-15 6-30t18-27l308-308q15-15 35.5-14.5T436-844q15 15 15 35t-15 35L142-480Z"></path></svg>'),On('<svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960"><path d="M579-480 285-774q-15-15-14.5-35.5T286-845q15-15 35.5-15t35.5 15l307 308q12 12 18 27t6 30q0 15-6 30t-18 27L356-115q-15 15-35 14.5T286-116q-15-15-15-35.5t15-35.5l293-293Z"></path></svg>'),On('<defs><clipPath id="cut-off-half"><rect x="0" y="0" width="48" height="96"></rect></clipPath></defs>'),On('<svg viewBox="0 0 96 96" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><!><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" clip-path="url(#cut-off-half)"><g><g><g fill-rule="nonzero"><rect x="48" y="0" width="48" height="96"></rect><rect x="0" y="0" width="48" height="96"></rect></g><path d="M48,64.7 L62.6,61 L68.7,79.8 L48,64.7 Z M81.6,40.4 L55.9,40.4 L48,16.2 L40.1,40.4 L14.4,40.4 L35.2,55.4 L27.3,79.6 L48.1,64.6 L60.9,55.4 L81.6,40.4 L81.6,40.4 L81.6,40.4 L81.6,40.4 Z" fill-rule="nonzero"></path></g></g></g></svg>'),On('<svg viewBox="0 0 96 96" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g><g><rect fill-rule="nonzero" x="0" y="0" width="96" height="96"></rect><path d="M48,64.7 L62.6,61 L68.7,79.8 L48,64.7 Z M81.6,40.4 L55.9,40.4 L48,16.2 L40.1,40.4 L14.4,40.4 L35.2,55.4 L27.3,79.6 L48.1,64.6 L60.9,55.4 L81.6,40.4 L81.6,40.4 L81.6,40.4 L81.6,40.4 Z" fill-rule="nonzero"></path></g></g></g></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 156.69 179.12"><defs><style>.cheese-1 {\n        fill: #fada39;\n      }\n      .cheese-2 {\n        fill: #e8b221;\n      }\n      .cheese-3 {\n        fill: #2e2b22;\n      }</style></defs><g id="Layer_1-2"><g><path class="cheese-3" d="M0,73.63C41.95,48.89,82.91,24.73,124.84,0c10.5,15.93,21.99,31,30.57,47.58,3.12,6.03-.33,15.69-1.38,23.61-4.28,32.53-9.57,71.92-14.19,105.94-.2,1.45-1.68,2.35-3.06,1.85-27.3-9.88-55.32-22.01-81.21-31.36-12.33-4.45-31.15-14.73-32.95-18.8-4.82-10.94-10.41-23.52-15.17-35.71-2.44-6.25-4.8-12.53-7.45-19.48Zm43.84,31.16c34.26-18.34,68.56-36.04,104.07-55.05-10.57-13.08-20.03-24.76-29.63-36.65-32.41,19.19-63.97,37.87-95.52,56.55l1.01,2.05c12.63-5.05,25.26-10.09,37.89-15.14l.79,1.47c-11.61,8.09-23.22,16.17-34.83,24.26-1.07,.46-2.14,.91-3.22,1.37l.32,1.11,4.34-.65,30.18-9.79,.84,1.76c-10.37,6.74-20.75,13.48-31.12,20.21l.66,1.5c8.68-2.23,17.35-4.46,26.03-6.69l.73,1.44c-4.14,3.38-7.06,7.31-11.2,10.69-1.06,.43-2.23,.7-3.29,1.13l-.08,.57c1.3,.58,.75-.75,2.05-.17Zm103.11-39.58l-3.27-2.24c-34.51,19.64-69.01,39.27-105.28,59.91,32.2,14.15,62.23,27.34,93.91,41.27,5.15-34.8,9.89-66.87,14.63-98.94Z"></path><path class="cheese-1" d="M146.95,65.2c-4.74,32.07-9.49,64.14-14.63,98.94-31.69-13.92-61.72-27.12-93.91-41.27,36.28-20.65,70.81-40.29,105.33-59.94,1.07,.76,2.15,1.51,3.22,2.27Z"></path><path class="cheese-2" d="M27.6,82.29c11.58-8.06,23.15-16.12,34.73-24.18-.23-.52-.46-1.03-.69-1.55-12.68,5.06-25.35,10.13-38.03,15.19-.29-.7-.58-1.4-.87-2.1,31.56-18.68,63.11-37.36,95.52-56.55,9.61,11.88,19.06,23.57,29.63,36.65-35.02,18.75-68.81,36.83-102.6,54.92-.46-.65-.92-1.3-1.38-1.95l12.29-10.02c-.2-.52-.39-1.04-.59-1.56-8.68,2.23-17.35,4.46-26.03,6.69-.18-.52-.37-1.04-.55-1.57,10.32-6.7,20.64-13.4,30.96-20.11-.26-.6-.52-1.2-.78-1.8-10.06,3.26-20.12,6.52-30.18,9.79-.48-.61-.96-1.22-1.44-1.83Z"></path><path class="cheese-2" d="M29.05,84.12l-4.34,.65c-.1-.37-.19-.75-.29-1.12,1.06-.45,2.13-.91,3.19-1.36,.48,.61,.96,1.22,1.44,1.83Z"></path><path class="cheese-2" d="M45.31,104.66c-1.42,.18-6.92,2.63-8.34,2.81-.1-.4,3.98-2.66,3.88-3.06,1.06-.43,2.02-1.27,3.07-1.7,.46,.65,.92,1.3,1.38,1.95Z"></path></g></g></svg>'),On('<svg fill="currentcolor" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960"><path d="M240-120q-45 0-89-22t-71-58q26 0 53-20.5t27-59.5q0-50 35-85t85-35q50 0 85 35t35 85q0 66-47 113t-113 47Zm0-80q33 0 56.5-23.5T320-280q0-17-11.5-28.5T280-320q-17 0-28.5 11.5T240-280q0 23-5.5 42T220-202q5 2 10 2h10Zm230-160L360-470l358-358q11-11 27.5-11.5T774-828l54 54q12 12 12 28t-12 28L470-360Zm-190 80Z"></path></svg>'),On('<svg fill="currentcolor" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960"><path d="m520-473 90 90q11 11 11 27.5T610-327q-12 12-28.5 12T553-327L452-428q-6-6-9-13.5t-3-15.5v-143q0-17 11.5-28.5T480-640q17 0 28.5 11.5T520-600v127Zm-40-247q-17 0-28.5-11.5T440-760v-40h80v40q0 17-11.5 28.5T480-720Zm240 240q0-17 11.5-28.5T760-520h40v80h-40q-17 0-28.5-11.5T720-480ZM480-240q17 0 28.5 11.5T520-200v40h-80v-40q0-17 11.5-28.5T480-240ZM240-480q0 17-11.5 28.5T200-440h-40v-80h40q17 0 28.5 11.5T240-480ZM480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm320-400q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93q134 0 227-93t93-227Zm-320 0Z"></path></svg>'),On('<svg fill="currentcolor" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960"><path d="M840-640q32 0 56 24t24 56v80q0 7-2 15t-4 15L794-168q-9 20-30 34t-44 14H280v-520l240-238q15-15 35.5-17.5T595-888q19 10 28 28t4 37l-45 183h258Zm-480 34v406h360l120-280v-80H480l54-220-174 174ZM160-120q-33 0-56.5-23.5T80-200v-360q0-33 23.5-56.5T160-640h120v80H160v360h120v80H160Zm200-80v-406 406Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="m313-440 196 196q12 12 11.5 28T508-188q-12 11-28 11.5T452-188L188-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l264-264q11-11 27.5-11t28.5 11q12 12 12 28.5T508-715L313-520h447q17 0 28.5 11.5T800-480q0 17-11.5 28.5T760-440H313Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M459-381 314-526q-3-3-4.5-6.5T308-540q0-8 5.5-14t14.5-6h304q9 0 14.5 6t5.5 14q0 2-6 14L501-381q-5 5-10 7t-11 2q-6 0-11-2t-10-7Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M328-400q-9 0-14.5-6t-5.5-14q0-2 6-14l145-145q5-5 10-7t11-2q6 0 11 2t10 7l145 145q3 3 4.5 6.5t1.5 7.5q0 8-5.5 14t-14.5 6H328Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M647-440H200q-17 0-28.5-11.5T160-480q0-17 11.5-28.5T200-520h447L451-716q-12-12-11.5-28t12.5-28q12-11 28-11.5t28 11.5l264 264q6 6 8.5 13t2.5 15q0 8-2.5 15t-8.5 13L508-188q-11 11-27.5 11T452-188q-12-12-12-28.5t12-28.5l195-195Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M526-314 381-459q-5-5-7-10t-2-11q0-6 2-11t7-10l145-145q3-3 6.5-4.5t7.5-1.5q8 0 14 5.5t6 14.5v304q0 9-6 14.5t-14 5.5q-2 0-14-6Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="m233-440 75 75q11 12 11.5 28.5T308-308q-12 12-28 12t-28-12L108-452q-6-6-8.5-13T97-480q0-8 2.5-15t8.5-13l144-144q12-12 28-12t28 12q12 12 12 28.5T308-595l-75 75h494l-75-75q-11-12-11.5-28.5T652-652q12-12 28-12t28 12l144 144q6 6 8.5 13t2.5 15q0 8-2.5 15t-8.5 13L708-308q-12 12-28 12t-28-12q-12-12-12-28.5t12-28.5l75-75H233Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M420-308q-8 0-14-5.5t-6-14.5v-304q0-9 6-14.5t14-5.5q2 0 14 6l145 145q5 5 7 10t2 11q0 6-2 11t-7 10L434-314q-3 3-6.5 4.5T420-308Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M727-440H520v-80h207l-75-75q-11-12-11.5-28.5T652-652q12-12 28-12t28 12l144 144q6 6 8.5 13t2.5 15q0 8-2.5 15t-8.5 13L708-308q-12 12-28 12t-28-12q-12-12-12-28.5t12-28.5l75-75Zm-494 0 75 75q11 12 11.5 28.5T308-308q-12 12-28 12t-28-12L108-452q-6-6-8.5-13T97-480q0-8 2.5-15t8.5-13l144-144q12-12 28-12t28 12q12 12 12 28.5T308-595l-75 75h207v80H233Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M200-80q-33 0-56.5-23.5T120-160v-560q0-33 23.5-56.5T200-800h40v-40q0-17 11.5-28.5T280-880q17 0 28.5 11.5T320-840v40h320v-40q0-17 11.5-28.5T680-880q17 0 28.5 11.5T720-840v40h40q33 0 56.5 23.5T840-720v560q0 33-23.5 56.5T760-80H200Zm0-80h560v-400H200v400Zm0-480h560v-80H200v80Zm0 0v-80 80Zm280 240q-17 0-28.5-11.5T440-440q0-17 11.5-28.5T480-480q17 0 28.5 11.5T520-440q0 17-11.5 28.5T480-400Zm-160 0q-17 0-28.5-11.5T280-440q0-17 11.5-28.5T320-480q17 0 28.5 11.5T360-440q0 17-11.5 28.5T320-400Zm320 0q-17 0-28.5-11.5T600-440q0-17 11.5-28.5T640-480q17 0 28.5 11.5T680-440q0 17-11.5 28.5T640-400ZM480-240q-17 0-28.5-11.5T440-280q0-17 11.5-28.5T480-320q17 0 28.5 11.5T520-280q0 17-11.5 28.5T480-240Zm-160 0q-17 0-28.5-11.5T280-280q0-17 11.5-28.5T320-320q17 0 28.5 11.5T360-280q0 17-11.5 28.5T320-240Zm320 0q-17 0-28.5-11.5T600-280q0-17 11.5-28.5T640-320q17 0 28.5 11.5T680-280q0 17-11.5 28.5T640-240Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M200-80q-33 0-56.5-23.5T120-160v-560q0-33 23.5-56.5T200-800h40v-40q0-17 11.5-28.5T280-880q17 0 28.5 11.5T320-840v40h320v-40q0-17 11.5-28.5T680-880q17 0 28.5 11.5T720-840v40h40q33 0 56.5 23.5T840-720v560q0 33-23.5 56.5T760-80H200Zm0-80h560v-400H200v400Zm0-480h560v-80H200v80Zm0 0v-80 80Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="m240-240-92 92q-19 19-43.5 8.5T80-177v-623q0-33 23.5-56.5T160-880h640q33 0 56.5 23.5T880-800v480q0 33-23.5 56.5T800-240H240Zm-34-80h594v-480H160v525l46-45Zm-46 0v-480 480Zm120-80h240q17 0 28.5-11.5T560-440q0-17-11.5-28.5T520-480H280q-17 0-28.5 11.5T240-440q0 17 11.5 28.5T280-400Zm0-120h400q17 0 28.5-11.5T720-560q0-17-11.5-28.5T680-600H280q-17 0-28.5 11.5T240-560q0 17 11.5 28.5T280-520Zm0-120h400q17 0 28.5-11.5T720-680q0-17-11.5-28.5T680-720H280q-17 0-28.5 11.5T240-680q0 17 11.5 28.5T280-640Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="m382-354 339-339q12-12 28-12t28 12q12 12 12 28.5T777-636L410-268q-12 12-28 12t-28-12L182-440q-12-12-11.5-28.5T183-497q12-12 28.5-12t28.5 12l142 143Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M480-424 284-228q-11 11-28 11t-28-11q-11-11-11-28t11-28l196-196-196-196q-11-11-11-28t11-28q11-11 28-11t28 11l196 196 196-196q11-11 28-11t28 11q11 11 11 28t-11 28L536-480l196 196q11 11 11 28t-11 28q-11 11-28 11t-28-11L480-424Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M480-424 364-308q-11 11-28 11t-28-11q-11-11-11-28t11-28l116-116-116-115q-11-11-11-28t11-28q11-11 28-11t28 11l116 116 115-116q11-11 28-11t28 11q12 12 12 28.5T651-595L535-480l116 116q11 11 11 28t-11 28q-12 12-28.5 12T595-308L480-424Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M440-474v-242q-76 14-118 73.5T280-520h-20q-58 0-99 41t-41 99q0 58 41 99t99 41h480q42 0 71-29t29-71q0-42-29-71t-71-29h-60v-80q0-48-22-89.5T600-680v-93q74 35 117 103.5T760-520q69 8 114.5 59.5T920-340q0 75-52.5 127.5T740-160H260q-91 0-155.5-63T40-377q0-78 47-139t123-78q17-72 85-137t145-65q33 0 56.5 23.5T520-716v242l36-35q11-11 27.5-11t28.5 12q11 11 11 28t-11 28L508-348q-12 12-28 12t-28-12L348-452q-11-11-11.5-27.5T348-508q11-11 27.5-11.5T404-509l36 35Zm40-44Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="m440-446-36 35q-11 11-27.5 11T348-412q-11-11-11-28t11-28l104-104q12-12 28-12t28 12l104 104q11 11 11.5 27.5T612-412q-11 11-27.5 11.5T556-411l-36-35v206h220q42 0 71-29t29-71q0-42-29-71t-71-29h-60v-80q0-83-58.5-141.5T480-720q-83 0-141.5 58.5T280-520h-20q-58 0-99 41t-41 99q0 58 41 99t99 41h60q17 0 28.5 11.5T360-200q0 17-11.5 28.5T320-160h-60q-91 0-155.5-63T40-377q0-78 47-139t123-78q25-92 100-149t170-57q117 0 198.5 81.5T760-520q69 8 114.5 59.5T920-340q0 75-52.5 127.5T740-160H520q-33 0-56.5-23.5T440-240v-206Zm40 6Z"></path></svg>'),On('<svg width="900" height="900" viewBox="0 0 900 900" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M900 350V850C900 863.261 894.732 875.979 885.355 885.355C875.979 894.732 863.261 900 850 900H350C336.739 900 324.021 894.732 314.645 885.355C305.268 875.979 300 863.261 300 850V350C300 336.739 305.268 324.021 314.645 314.645C324.021 305.268 336.739 300 350 300H850C863.261 300 875.979 305.268 885.355 314.645C894.732 324.021 900 336.739 900 350ZM150 550H100V100H550V150C550 163.261 555.268 175.979 564.645 185.355C574.021 194.732 586.739 200 600 200C613.261 200 625.979 194.732 635.355 185.355C644.732 175.979 650 163.261 650 150V50C650 36.7392 644.732 24.0215 635.355 14.6447C625.979 5.26784 613.261 0 600 0H50C36.7392 0 24.0215 5.26784 14.6447 14.6447C5.26784 24.0215 0 36.7392 0 50V600C0 613.261 5.26784 625.979 14.6447 635.355C24.0215 644.732 36.7392 650 50 650H150C163.261 650 175.979 644.732 185.355 635.355C194.732 625.979 200 613.261 200 600C200 586.739 194.732 574.021 185.355 564.645C175.979 555.268 163.261 550 150 550Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M880-720v480q0 33-23.5 56.5T800-160H160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h640q33 0 56.5 23.5T880-720Zm-720 80h640v-80H160v80Zm0 160v240h640v-240H160Zm0 240v-480 480Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M280-120q-33 0-56.5-23.5T200-200v-520q-17 0-28.5-11.5T160-760q0-17 11.5-28.5T200-800h160q0-17 11.5-28.5T400-840h160q17 0 28.5 11.5T600-800h160q17 0 28.5 11.5T800-760q0 17-11.5 28.5T760-720v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM400-280q17 0 28.5-11.5T440-320v-280q0-17-11.5-28.5T400-640q-17 0-28.5 11.5T360-600v280q0 17 11.5 28.5T400-280Zm160 0q17 0 28.5-11.5T600-320v-280q0-17-11.5-28.5T560-640q-17 0-28.5 11.5T520-600v280q0 17 11.5 28.5T560-280ZM280-720v520-520Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M480-337q-8 0-15-2.5t-13-8.5L308-492q-12-12-11.5-28t11.5-28q12-12 28.5-12.5T365-549l75 75v-286q0-17 11.5-28.5T480-800q17 0 28.5 11.5T520-760v286l75-75q12-12 28.5-11.5T652-548q11 12 11.5 28T652-492L508-348q-6 6-13 8.5t-15 2.5ZM240-160q-33 0-56.5-23.5T160-240v-80q0-17 11.5-28.5T200-360q17 0 28.5 11.5T240-320v80h480v-80q0-17 11.5-28.5T760-360q17 0 28.5 11.5T800-320v80q0 33-23.5 56.5T720-160H240Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M360-160q-33 0-56.5-23.5T280-240q0-33 23.5-56.5T360-320q33 0 56.5 23.5T440-240q0 33-23.5 56.5T360-160Zm240 0q-33 0-56.5-23.5T520-240q0-33 23.5-56.5T600-320q33 0 56.5 23.5T680-240q0 33-23.5 56.5T600-160ZM360-400q-33 0-56.5-23.5T280-480q0-33 23.5-56.5T360-560q33 0 56.5 23.5T440-480q0 33-23.5 56.5T360-400Zm240 0q-33 0-56.5-23.5T520-480q0-33 23.5-56.5T600-560q33 0 56.5 23.5T680-480q0 33-23.5 56.5T600-400ZM360-640q-33 0-56.5-23.5T280-720q0-33 23.5-56.5T360-800q33 0 56.5 23.5T440-720q0 33-23.5 56.5T360-640Zm240 0q-33 0-56.5-23.5T520-720q0-33 23.5-56.5T600-800q33 0 56.5 23.5T680-720q0 33-23.5 56.5T600-640Z"></path></svg>');var ml=On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M480-280q17 0 28.5-11.5T520-320q0-17-11.5-28.5T480-360q-17 0-28.5 11.5T440-320q0 17 11.5 28.5T480-280Zm0-160q17 0 28.5-11.5T520-480v-160q0-17-11.5-28.5T480-680q-17 0-28.5 11.5T440-640v160q0 17 11.5 28.5T480-440Zm0 360q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z"></path></svg>');On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M480-147q-14 0-28.5-5T426-168l-69-63q-106-97-191.5-192.5T80-634q0-94 63-157t157-63q53 0 100 22.5t80 61.5q33-39 80-61.5T660-854q94 0 157 63t63 157q0 115-85 211T602-230l-68 62q-11 11-25.5 16t-28.5 5Zm-38-543q-29-41-62-62.5T300-774q-60 0-100 40t-40 100q0 52 37 110.5T285.5-410q51.5 55 106 103t88.5 79q34-31 88.5-79t106-103Q726-465 763-523.5T800-634q0-60-40-100t-100-40q-47 0-80 21.5T518-690q-7 10-17 15t-21 5q-11 0-21-5t-17-15Zm38 189Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M478-240q21 0 35.5-14.5T528-290q0-21-14.5-35.5T478-340q-21 0-35.5 14.5T428-290q0 21 14.5 35.5T478-240Zm2 160q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Zm4-172q25 0 43.5 16t18.5 40q0 22-13.5 39T502-525q-23 20-40.5 44T444-427q0 14 10.5 23.5T479-394q15 0 25.5-10t13.5-25q4-21 18-37.5t30-31.5q23-22 39.5-48t16.5-58q0-51-41.5-83.5T484-720q-38 0-72.5 16T359-655q-7 12-4.5 25.5T368-609q14 8 29 5t25-17q11-15 27.5-23t34.5-8Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M240-200h120v-240h240v240h120v-360L480-740 240-560v360Zm-80 80v-480l320-240 320 240v480H520v-240h-80v240H160Zm320-350Z"></path></svg>');var fl=On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M480-280q17 0 28.5-11.5T520-320v-160q0-17-11.5-28.5T480-520q-17 0-28.5 11.5T440-480v160q0 17 11.5 28.5T480-280Zm0-320q17 0 28.5-11.5T520-640q0-17-11.5-28.5T480-680q-17 0-28.5 11.5T440-640q0 17 11.5 28.5T480-600Zm0 520q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z"></path></svg>');function vl(t){const[e,i,r,n=255]=t.split(",").map(Number);return`#${e.toString(16).padStart(2,"0")}${i.toString(16).padStart(2,"0")}${r.toString(16).padStart(2,"0")}${n.toString(16).padStart(2,"0")}`}On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="m432-480 156 156q11 11 11 28t-11 28q-11 11-28 11t-28-11L348-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 28-11t28 11q11 11 11 28t-11 28L432-480Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M504-480 348-636q-11-11-11-28t11-28q11-11 28-11t28 11l184 184q6 6 8.5 13t2.5 15q0 8-2.5 15t-8.5 13L404-268q-11 11-28 11t-28-11q-11-11-11-28t11-28l156-156Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M480-528 324-372q-11 11-28 11t-28-11q-11-11-11-28t11-28l184-184q12-12 28-12t28 12l184 184q11 11 11 28t-11 28q-11 11-28 11t-28-11L480-528Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M480-80q-82 0-155-31.5t-127.5-86Q143-252 111.5-325T80-480q0-83 31.5-155.5t86-127Q252-817 325-848.5T480-880q83 0 155.5 31.5t127 86q54.5 54.5 86 127T880-480q0 82-31.5 155t-86 127.5q-54.5 54.5-127 86T480-80Zm0-82q26-36 45-75t31-83H404q12 44 31 83t45 75Zm-104-16q-18-33-31.5-68.5T322-320H204q29 50 72.5 87t99.5 55Zm208 0q56-18 99.5-55t72.5-87H638q-9 38-22.5 73.5T584-178ZM170-400h136q-3-20-4.5-39.5T300-480q0-21 1.5-40.5T306-560H170q-5 20-7.5 39.5T160-480q0 21 2.5 40.5T170-400Zm216 0h188q3-20 4.5-39.5T580-480q0-21-1.5-40.5T574-560H386q-3 20-4.5 39.5T380-480q0 21 1.5 40.5T386-400Zm268 0h136q5-20 7.5-39.5T800-480q0-21-2.5-40.5T790-560H654q3 20 4.5 39.5T660-480q0 21-1.5 40.5T654-400Zm-16-240h118q-29-50-72.5-87T584-782q18 33 31.5 68.5T638-640Zm-234 0h152q-12-44-31-83t-45-75q-26 36-45 75t-31 83Zm-200 0h118q9-38 22.5-73.5T376-782q-56 18-99.5 55T204-640Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M240-80q-33 0-56.5-23.5T160-160v-400q0-33 23.5-56.5T240-640h40v-80q0-83 58.5-141.5T480-920q83 0 141.5 58.5T680-720v80h40q33 0 56.5 23.5T800-560v400q0 33-23.5 56.5T720-80H240Zm0-80h480v-400H240v400Zm240-120q33 0 56.5-23.5T560-360q0-33-23.5-56.5T480-440q-33 0-56.5 23.5T400-360q0 33 23.5 56.5T480-280ZM360-640h240v-80q0-50-35-85t-85-35q-50 0-85 35t-35 85v80ZM240-160v-400 400Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M240-80q-33 0-56.5-23.5T160-160v-400q0-33 23.5-56.5T240-640h360v-80q0-50-35-85t-85-35q-42 0-73.5 25.5T364-751q-4 14-16.5 22.5T320-720q-17 0-28.5-11t-8.5-26q14-69 69-116t128-47q83 0 141.5 58.5T680-720v80h40q33 0 56.5 23.5T800-560v400q0 33-23.5 56.5T720-80H240Zm0-80h480v-400H240v400Zm240-120q33 0 56.5-23.5T560-360q0-33-23.5-56.5T480-440q-33 0-56.5 23.5T400-360q0 33 23.5 56.5T480-280ZM240-160v-400 400Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h640q33 0 56.5 23.5T880-720v480q0 33-23.5 56.5T800-160H160Zm640-480L501-453q-5 3-10.5 4.5T480-447q-5 0-10.5-1.5T459-453L160-640v400h640v-400ZM480-520l320-200H160l320 200ZM160-640v10-59 1-32 32-.5 58.5-10 400-400Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-240q-17 0-28.5-11.5T120-280q0-17 11.5-28.5T160-320h640q17 0 28.5 11.5T840-280q0 17-11.5 28.5T800-240H160Zm0-200q-17 0-28.5-11.5T120-480q0-17 11.5-28.5T160-520h640q17 0 28.5 11.5T840-480q0 17-11.5 28.5T800-440H160Zm0-200q-17 0-28.5-11.5T120-680q0-17 11.5-28.5T160-720h640q17 0 28.5 11.5T840-680q0 17-11.5 28.5T800-640H160Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M240-400q-33 0-56.5-23.5T160-480q0-33 23.5-56.5T240-560q33 0 56.5 23.5T320-480q0 33-23.5 56.5T240-400Zm240 0q-33 0-56.5-23.5T400-480q0-33 23.5-56.5T480-560q33 0 56.5 23.5T560-480q0 33-23.5 56.5T480-400Zm240 0q-33 0-56.5-23.5T640-480q0-33 23.5-56.5T720-560q33 0 56.5 23.5T800-480q0 33-23.5 56.5T720-400Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M480-160q-33 0-56.5-23.5T400-240q0-33 23.5-56.5T480-320q33 0 56.5 23.5T560-240q0 33-23.5 56.5T480-160Zm0-240q-33 0-56.5-23.5T400-480q0-33 23.5-56.5T480-560q33 0 56.5 23.5T560-480q0 33-23.5 56.5T480-400Zm0-240q-33 0-56.5-23.5T400-720q0-33 23.5-56.5T480-800q33 0 56.5 23.5T560-720q0 33-23.5 56.5T480-640Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M806-440H360q-17 0-28.5-11.5T320-480q0-17 11.5-28.5T360-520h446l-34-34q-12-12-11.5-28t11.5-28q12-12 28.5-12.5T829-611l103 103q12 12 12 28t-12 28L829-349q-12 12-28.5 11.5T772-350q-11-12-11.5-28t11.5-28l34-34ZM600-640v-120H200v560h400v-120q0-17 11.5-28.5T640-360q17 0 28.5 11.5T680-320v120q0 33-23.5 56.5T600-120H200q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h400q33 0 56.5 23.5T680-760v120q0 17-11.5 28.5T640-600q-17 0-28.5-11.5T600-640Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M480-160q-56 0-105.5-17.5T284-227l-56 55q-11 11-28 11t-28-11q-11-11-11-28t11-28l55-55q-32-41-49.5-91T160-480q0-134 93-227t227-93h240q33 0 56.5 23.5T800-720v240q0 134-93 227t-227 93Zm0-80q100 0 170-70t70-170v-240H480q-100 0-170 70t-70 170q0 39 12 74.5t33 64.5l207-207q11-11 28-11t28 11q12 12 12 28.5T548-491L341-284q29 21 64.5 32.5T480-240Zm0-240Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h240q17 0 28.5 11.5T480-800q0 17-11.5 28.5T440-760H200v560h560v-240q0-17 11.5-28.5T800-480q17 0 28.5 11.5T840-440v240q0 33-23.5 56.5T760-120H200Zm560-584L416-360q-11 11-28 11t-28-11q-11-11-11-28t11-28l344-344H600q-17 0-28.5-11.5T560-800q0-17 11.5-28.5T600-840h200q17 0 28.5 11.5T840-800v200q0 17-11.5 28.5T800-560q-17 0-28.5-11.5T760-600v-104Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M440-183v-274L200-596v274l240 139Zm80 0 240-139v-274L520-457v274Zm-80 92L160-252q-19-11-29.5-29T120-321v-318q0-22 10.5-40t29.5-29l280-161q19-11 40-11t40 11l280 161q19 11 29.5 29t10.5 40v318q0 22-10.5 40T800-252L520-91q-19 11-40 11t-40-11Zm200-528 77-44-237-137-78 45 238 136Zm-160 93 78-45-237-137-78 45 237 137Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M560-440q-50 0-85-35t-35-85q0-50 35-85t85-35q50 0 85 35t35 85q0 50-35 85t-85 35ZM280-320q-33 0-56.5-23.5T200-400v-320q0-33 23.5-56.5T280-800h560q33 0 56.5 23.5T920-720v320q0 33-23.5 56.5T840-320H280Zm80-80h400q0-33 23.5-56.5T840-480v-160q-33 0-56.5-23.5T760-720H360q0 33-23.5 56.5T280-640v160q33 0 56.5 23.5T360-400Zm400 240H120q-33 0-56.5-23.5T40-240v-400q0-17 11.5-28.5T80-680q17 0 28.5 11.5T120-640v400h640q17 0 28.5 11.5T800-200q0 17-11.5 28.5T760-160ZM280-400v-320 320Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M480-480q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM160-240v-32q0-34 17.5-62.5T224-378q62-31 126-46.5T480-440q66 0 130 15.5T736-378q29 15 46.5 43.5T800-272v32q0 33-23.5 56.5T720-160H240q-33 0-56.5-23.5T160-240Zm80 0h480v-32q0-11-5.5-20T700-306q-54-27-109-40.5T480-360q-56 0-111 13.5T260-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T560-640q0-33-23.5-56.5T480-720q-33 0-56.5 23.5T400-640q0 33 23.5 56.5T480-560Zm0-80Zm0 400Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm0 0v-560 560Zm80-80h400q12 0 18-11t-2-21L586-459q-6-8-16-8t-16 8L450-320l-74-99q-6-8-16-8t-16 8l-80 107q-8 10-2 21t18 11Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="m380-300 280-180-280-180v360ZM480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M120-104v-752q0-7 6-9.5t11 2.5l29 29q6 6 14 6t14-6l32-32q6-6 14-6t14 6l32 32q6 6 14 6t14-6l32-32q6-6 14-6t14 6l32 32q6 6 14 6t14-6l32-32q6-6 14-6t14 6l32 32q6 6 14 6t14-6l32-32q6-6 14-6t14 6l32 32q6 6 14 6t14-6l32-32q6-6 14-6t14 6l32 32q6 6 14 6t14-6l29-29q5-5 11-2.5t6 9.5v752q0 7-6 9.5T823-97l-29-29q-6-6-14-6t-14 6l-32 32q-6 6-14 6t-14-6l-32-32q-6-6-14-6t-14 6l-32 32q-6 6-14 6t-14-6l-32-32q-6-6-14-6t-14 6l-32 32q-6 6-14 6t-14-6l-32-32q-6-6-14-6t-14 6l-32 32q-6 6-14 6t-14-6l-32-32q-6-6-14-6t-14 6l-32 32q-6 6-14 6t-14-6l-32-32q-6-6-14-6t-14 6l-29 29q-5 5-11 2.5t-6-9.5Zm160-176h400q17 0 28.5-11.5T720-320q0-17-11.5-28.5T680-360H280q-17 0-28.5 11.5T240-320q0 17 11.5 28.5T280-280Zm0-160h400q17 0 28.5-11.5T720-480q0-17-11.5-28.5T680-520H280q-17 0-28.5 11.5T240-480q0 17 11.5 28.5T280-440Zm0-160h400q17 0 28.5-11.5T720-640q0-17-11.5-28.5T680-680H280q-17 0-28.5 11.5T240-640q0 17 11.5 28.5T280-600Zm-80 404h560v-568H200v568Zm0-568v568-568Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-280v80h640v-80H160Zm0-440h88q-5-9-6.5-19t-1.5-21q0-50 35-85t85-35q30 0 55.5 15.5T460-826l20 26 20-26q18-24 44-39t56-15q50 0 85 35t35 85q0 11-1.5 21t-6.5 19h88q33 0 56.5 23.5T880-640v440q0 33-23.5 56.5T800-120H160q-33 0-56.5-23.5T80-200v-440q0-33 23.5-56.5T160-720Zm0 320h640v-240H596l60 82q10 14 8 29.5T648-503q-14 10-29.5 7.5T593-511L480-664 367-511q-10 13-25.5 15.5T312-503q-14-10-16.5-25.5T303-558l59-82H160v240Zm200-320q17 0 28.5-11.5T400-760q0-17-11.5-28.5T360-800q-17 0-28.5 11.5T320-760q0 17 11.5 28.5T360-720Zm240 0q17 0 28.5-11.5T640-760q0-17-11.5-28.5T600-800q-17 0-28.5 11.5T560-760q0 17 11.5 28.5T600-720Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M480-160q-134 0-227-93t-93-227q0-134 93-227t227-93q69 0 132 28.5T720-690v-70q0-17 11.5-28.5T760-800q17 0 28.5 11.5T800-760v200q0 17-11.5 28.5T760-520H560q-17 0-28.5-11.5T520-560q0-17 11.5-28.5T560-600h128q-32-56-87.5-88T480-720q-100 0-170 70t-70 170q0 100 70 170t170 70q68 0 124.5-34.5T692-367q8-14 22.5-19.5t29.5-.5q16 5 23 21t-1 30q-41 80-117 128t-169 48Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M380-320q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l224 224q11 11 11 28t-11 28q-11 11-28 11t-28-11L532-372q-30 24-69 38t-83 14Zm0-80q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M433-80q-27 0-46.5-18T363-142l-9-66q-13-5-24.5-12T307-235l-62 26q-25 11-50 2t-39-32l-47-82q-14-23-8-49t27-43l53-40q-1-7-1-13.5v-27q0-6.5 1-13.5l-53-40q-21-17-27-43t8-49l47-82q14-23 39-32t50 2l62 26q11-8 23-15t24-12l9-66q4-26 23.5-44t46.5-18h94q27 0 46.5 18t23.5 44l9 66q13 5 24.5 12t22.5 15l62-26q25-11 50-2t39 32l47 82q14 23 8 49t-27 43l-53 40q1 7 1 13.5v27q0 6.5-2 13.5l53 40q21 17 27 43t-8 49l-48 82q-14 23-39 32t-50-2l-60-26q-11 8-23 15t-24 12l-9 66q-4 26-23.5 44T527-80h-94Zm7-80h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Zm42-180q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm-2-140Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M240-80q-33 0-56.5-23.5T160-160v-480q0-33 23.5-56.5T240-720h80q0-66 47-113t113-47q66 0 113 47t47 113h80q33 0 56.5 23.5T800-640v480q0 33-23.5 56.5T720-80H240Zm0-80h480v-480h-80v80q0 17-11.5 28.5T600-520q-17 0-28.5-11.5T560-560v-80H400v80q0 17-11.5 28.5T360-520q-17 0-28.5-11.5T320-560v-80h-80v480Zm160-560h160q0-33-23.5-56.5T480-800q-33 0-56.5 23.5T400-720ZM240-160v-480 480Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M280-80q-33 0-56.5-23.5T200-160q0-33 23.5-56.5T280-240q33 0 56.5 23.5T360-160q0 33-23.5 56.5T280-80Zm400 0q-33 0-56.5-23.5T600-160q0-33 23.5-56.5T680-240q33 0 56.5 23.5T760-160q0 33-23.5 56.5T680-80ZM246-720l96 200h280l110-200H246Zm-38-80h590q23 0 35 20.5t1 41.5L692-482q-11 20-29.5 31T622-440H324l-44 80h440q17 0 28.5 11.5T760-320q0 17-11.5 28.5T720-280H280q-45 0-68-39.5t-2-78.5l54-98-144-304H80q-17 0-28.5-11.5T40-840q0-17 11.5-28.5T80-880h65q11 0 21 6t15 17l27 57Zm134 280h280-280Z"></path></svg>'),On('<svg viewBox="0 0 18 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M9.52125 13.8184C9.20124 13.6229 8.79876 13.6229 8.47875 13.8184L5.17397 15.8369C4.41487 16.3006 3.47362 15.6167 3.68001 14.7515L4.57852 10.9847C4.66553 10.6199 4.54116 10.2372 4.25637 9.99322L1.31539 7.47396C0.639853 6.89529 0.999379 5.78878 1.88603 5.7177L5.74612 5.40823C6.11991 5.37827 6.44552 5.1417 6.58953 4.79546L8.07668 1.21993C8.41827 0.398636 9.58173 0.398636 9.92332 1.21993L11.4105 4.79546C11.5545 5.1417 11.8801 5.37827 12.2539 5.40823L16.114 5.7177C17.0006 5.78878 17.3601 6.89529 16.6846 7.47396L13.7436 9.99322C13.4588 10.2372 13.3345 10.6199 13.4215 10.9847L14.32 14.7515C14.5264 15.6167 13.5851 16.3006 12.826 15.8369L9.52125 13.8184Z" fill="currentColor"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M480-675v312l126 77-33-144 111-96-146-13-58-136Zm0 406L314-169q-11 7-23 6t-21-8q-9-7-14-17.5t-2-23.5l44-189-147-127q-10-9-12.5-20.5T140-571q4-11 12-18t22-9l194-17 75-178q5-12 15.5-18t21.5-6q11 0 21.5 6t15.5 18l75 178 194 17q14 2 22 9t12 18q4 11 1.5 22.5T809-528L662-401l44 189q3 13-2 23.5T690-171q-9 7-21 8t-23-6L480-269Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M200-800h560q17 0 28.5 11.5T800-760q0 17-11.5 28.5T760-720H200q-17 0-28.5-11.5T160-760q0-17 11.5-28.5T200-800Zm0 640q-17 0-28.5-11.5T160-200v-200h-7q-19 0-31-14.5t-8-33.5l40-200q3-14 14-23t25-9h574q14 0 25 9t14 23l40 200q4 19-8 33.5T807-400h-7v200q0 17-11.5 28.5T760-160q-17 0-28.5-11.5T720-200v-200H560v200q0 17-11.5 28.5T520-160H200Zm40-80h240v-160H240v160Zm-38-240h556-556Zm0 0h556l-24-120H226l-24 120Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="m233-320 75 75q11 11 11 27.5T308-189q-12 12-28.5 12T251-189L108-332q-6-6-8.5-13T97-360q0-8 2.5-15t8.5-13l144-144q12-12 28-11.5t28 12.5q11 12 11.5 28T308-475l-75 75h247q17 0 28.5 11.5T520-360q0 17-11.5 28.5T480-320H233Zm494-240H480q-17 0-28.5-11.5T440-600q0-17 11.5-28.5T480-640h247l-75-75q-11-11-11-27.5t11-28.5q12-12 28.5-12t28.5 12l143 143q6 6 8.5 13t2.5 15q0 8-2.5 15t-8.5 13L708-428q-12 12-28 11.5T652-429q-11-12-11.5-28t11.5-28l75-75Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="m480-284-96 96q-11 11-28 11t-28-11q-11-11-11-28t11-28l124-124q6-6 13-8.5t15-2.5q8 0 15 2.5t13 8.5l124 124q11 11 11 28t-11 28q-11 11-28 11t-28-11l-96-96Zm0-392 96-96q11-11 28-11t28 11q11 11 11 28t-11 28L508-592q-6 6-13 8.5t-15 2.5q-8 0-15-2.5t-13-8.5L328-716q-11-11-11-28t11-28q11-11 28-11t28 11l96 96Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="m480-236 93-93q12-12 29-12t29 12q12 12 12 29t-12 29L508-148q-6 6-13 8.5t-15 2.5q-8 0-15-2.5t-13-8.5L329-271q-12-12-12-29t12-29q12-12 29-12t29 12l93 93Zm0-484-93 93q-12 12-29 12t-29-12q-12-12-12-29t12-29l123-123q6-6 13-8.5t15-2.5q8 0 15 2.5t13 8.5l123 123q12 12 12 29t-12 29q-12 12-29 12t-29-12l-93-93Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M480-320q75 0 127.5-52.5T660-500q0-75-52.5-127.5T480-680q-75 0-127.5 52.5T300-500q0 75 52.5 127.5T480-320Zm0-72q-45 0-76.5-31.5T372-500q0-45 31.5-76.5T480-608q45 0 76.5 31.5T588-500q0 45-31.5 76.5T480-392Zm0 192q-134 0-244.5-72T61-462q-5-9-7.5-18.5T51-500q0-10 2.5-19.5T61-538q64-118 174.5-190T480-800q134 0 244.5 72T899-538q5 9 7.5 18.5T909-500q0 10-2.5 19.5T899-462q-64 118-174.5 190T480-200Zm0-300Zm0 220q113 0 207.5-59.5T832-500q-50-101-144.5-160.5T480-720q-113 0-207.5 59.5T128-500q50 101 144.5 160.5T480-280Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M607-627q29 29 42.5 66t9.5 76q0 15-11 25.5T622-449q-15 0-25.5-10.5T586-485q5-26-3-50t-25-41q-17-17-41-26t-51-4q-15 0-25.5-11T430-643q0-15 10.5-25.5T466-679q38-4 75 9.5t66 42.5Zm-127-93q-19 0-37 1.5t-36 5.5q-17 3-30.5-5T358-742q-5-16 3.5-31t24.5-18q23-5 46.5-7t47.5-2q137 0 250.5 72T904-534q4 8 6 16.5t2 17.5q0 9-1.5 17.5T905-466q-18 40-44.5 75T802-327q-12 11-28 9t-26-16q-10-14-8.5-30.5T753-392q24-23 44-50t35-58q-50-101-144.5-160.5T480-720Zm0 520q-134 0-245-72.5T60-463q-5-8-7.5-17.5T50-500q0-10 2-19t7-18q20-40 46.5-76.5T166-680l-83-84q-11-12-10.5-28.5T84-820q11-11 28-11t28 11l680 680q11 11 11.5 27.5T820-84q-11 11-28 11t-28-11L624-222q-35 11-71 16.5t-73 5.5ZM222-624q-29 26-53 57t-41 67q50 101 144.5 160.5T480-280q20 0 39-2.5t39-5.5l-36-38q-11 3-21 4.5t-21 1.5q-75 0-127.5-52.5T300-500q0-11 1.5-21t4.5-21l-84-82Zm319 93Zm-151 75Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M340-540h-40q-17 0-28.5-11.5T260-580q0-17 11.5-28.5T300-620h40v-40q0-17 11.5-28.5T380-700q17 0 28.5 11.5T420-660v40h40q17 0 28.5 11.5T500-580q0 17-11.5 28.5T460-540h-40v40q0 17-11.5 28.5T380-460q-17 0-28.5-11.5T340-500v-40Zm40 220q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l224 224q11 11 11 28t-11 28q-11 11-28 11t-28-11L532-372q-30 24-69 38t-83 14Zm0-80q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M320-540q-17 0-28.5-11.5T280-580q0-17 11.5-28.5T320-620h120q17 0 28.5 11.5T480-580q0 17-11.5 28.5T440-540H320Zm60 220q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l224 224q11 11 11 28t-11 28q-11 11-28 11t-28-11L532-372q-30 24-69 38t-83 14Zm0-80q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M200-200h57l391-391-57-57-391 391v57Zm-80 80v-170l528-527q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L290-120H120Zm640-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M120-160v-240l320-80-320-80v-240l760 320-760 320Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M720-120H320v-520l280-280 50 50q7 7 11.5 19t4.5 23v14l-44 174h218q32 0 56 24t24 56v80q0 7-1.5 15t-4.5 15L794-168q-9 20-30 34t-44 14ZM240-640v520H80v-520h160Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M720-330q0 104-73 177T470-80q-104 0-177-73t-73-177v-370q0-75 52.5-127.5T400-880q75 0 127.5 52.5T580-700v350q0 46-32 78t-78 32q-46 0-78-32t-32-78v-370h80v370q0 13 8.5 21.5T470-320q13 0 21.5-8.5T500-350v-350q-1-42-29.5-71T400-800q-42 0-71 29t-29 71v370q-1 71 49 120.5T470-160q70 0 119-49.5T640-330v-390h80v390Z"></path></svg>'),On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentcolor"><path d="M120-120v-320h80v184l504-504H520v-80h320v320h-80v-184L256-200h184v80H120Z"></path></svg>');var bl=(t,e)=>e.onModeSelected(Po.None),yl=(t,e)=>e.onModeSelected(Po.None),_l=(t,e)=>e(Po.None),Tl=(t,e)=>e.onModeSelected(Po.Mix),xl=(t,e)=>e.onModeSelected(Po.Mix),wl=(t,e)=>e(Po.Mix),El=(t,e)=>e.onModeSelected(Po.Full),Al=(t,e)=>e.onModeSelected(Po.Full),Pl=(t,e)=>e(Po.Full),Sl=Sn('<div class="ces-container svelte-13r1zak"><div class="ces-background svelte-13r1zak"><div aria-label="selectNoEffect" role="button" tabindex="0"><div class="ces-circle svelte-13r1zak"></div> <div class="ces-text svelte-13r1zak"> </div></div> <div aria-label="selectMixedEffect" role="button" tabindex="0"><div class="ces-circle svelte-13r1zak"><div class="ces-circle svelte-13r1zak"></div></div> <div class="ces-text svelte-13r1zak"> </div></div> <div aria-label="selectFullEffect" role="button" tabindex="0"><div class="ces-circle svelte-13r1zak"></div> <div class="ces-text svelte-13r1zak"> </div></div></div></div>');const Ol={hash:"svelte-13r1zak",code:".ces-circle.svelte-13r1zak {width:40px;height:40px;border:1px solid lightgrey;}.ces-selection-button.svelte-13r1zak {padding:10px;width:100%;display:flex;align-items:center;cursor:pointer;&.none {border-bottom:1px solid #cccccc;border-radius:10px 10px 0 0;}&.mixed {border-bottom:1px solid #cccccc;}&.full {border-radius:0 0 10px 10px;}&.full:before {content:'';display:block;width:0;height:0;position:absolute;border-left:10px solid transparent;border-right:10px solid transparent;border-top:10px solid var(--arrow-background);left:11%;bottom:-9px;}&:hover {background-color:#f5f5f5;}&.selected {background-color:#e8e8e8;font-weight:bold;}}.ces-circle.svelte-13r1zak {border-radius:9999px;}.ces-text.svelte-13r1zak {margin-left:10px;}.ces-container.svelte-13r1zak {width:0;height:0;}.ces-background.svelte-13r1zak {background-color:white;border-radius:10px;position:relative;width:180px;left:-9px;bottom:210px;display:flex;flex-direction:column;justify-content:space-around;align-items:center;\n    animation: svelte-13r1zak-fade 0.2s linear;box-shadow:rgba(0, 0, 0, 0.4) 0px 4px 12px;}\n\n  @keyframes svelte-13r1zak-fade {\n    0% {\n      opacity: 0;\n    }\n    100% {\n      opacity: 1;\n    }\n  }"};xn(["click","keydown","mouseover"]);var Ml=(t,e)=>e.onReloadMasksClicked(),Cl=(t,e)=>e.onReloadMasksClicked(),Il=Sn('<div class="ces-error-icon-container svelte-kphfou"><div class="ces-error-icon svelte-kphfou"><!></div></div> <div class="ces-error-text-container svelte-kphfou"><b class="svelte-kphfou"> </b> </div> <div class="ces-border svelte-kphfou"></div> <div aria-label="invertMasks" role="button" tabindex="0"><div class="svelte-kphfou"><b class="svelte-kphfou"> </b></div></div>',1),kl=Sn('<div class="ces-tooltip-content svelte-kphfou"> </div>'),Nl=(t,e)=>rn(e,!zr(e)),Ll=(t,e)=>rn(e,!zr(e)),Dl=Sn('<div class="ces-spinner svelte-kphfou"><!></div>'),Bl=Sn('<div class="ces-spinner svelte-kphfou"><!></div>'),Rl=Sn('<div aria-label="selectEffectMode" role="button" tabindex="0"><div class="ces-inner ces-circle svelte-kphfou"></div></div>'),$l=Sn('<div aria-label="selectEffectMode" role="button" tabindex="0"><div class="ces-inner ces-circle svelte-kphfou"><div class="ces-blendImage ces-circle svelte-kphfou"></div></div></div>'),jl=Sn("<!> <!>",1),ql=Sn("<div><!></div>"),Vl=(t,e)=>e.onInvertMasksClicked(),Fl=(t,e)=>e.onInvertMasksClicked(),Hl=(t,e)=>e.onResetMasksClicked(),zl=(t,e)=>e.onResetMasksClicked(),Ul=Sn('<div><!> <div class="ces-tooltip-container svelte-kphfou"><b class="svelte-kphfou"> </b> <div class="ces-tooltip-icon svelte-kphfou" aria-label="showTooltip" role="button" tabindex="0"><!></div></div> </div> <div class="ces-selectorContainer svelte-kphfou"><!></div> <div class="ces-border svelte-kphfou"></div> <div aria-label="invertMasks" role="button" tabindex="0"><div class="svelte-kphfou"><b class="svelte-kphfou"> </b></div></div> <div class="ces-border svelte-kphfou"></div> <div aria-label="resetMasks" role="button" tabindex="0"><div class="svelte-kphfou"><b class="svelte-kphfou"> </b></div></div>',1),Gl=Sn("<div><!></div>");const Zl={hash:"svelte-kphfou",code:".ces-border.svelte-kphfou {width:1px;height:60%;background-color:lightgrey;}.ces-tooltip-content.svelte-kphfou {position:absolute;background:black;color:white;padding:15px;border-radius:10px;width:26rem;height:fit-content;left:0rem;bottom:6rem;opacity:1;\n    animation: svelte-kphfou-fade 0.2s linear;}\n\n  @keyframes svelte-kphfou-fade {\n    0% {\n      opacity: 0;\n    }\n    100% {\n      opacity: 1;\n    }\n  }.ces-tooltip-content.svelte-kphfou:before {content:'';display:block;width:0;height:0;position:absolute;border-left:10px solid transparent;border-right:10px solid transparent;border-top:10px solid black;left:45%;bottom:-10px;}.ces-tooltip-container.svelte-kphfou {display:flex;align-items:center;justify-content:space-between;width:100%;}.ces-error-text-container.svelte-kphfou {display:flex;flex-direction:column;margin-right:30px;text-align:left;white-space:nowrap;}.ces-error-icon-container.svelte-kphfou {display:flex;align-items:center;justify-content:center;height:100%;width:90px;}.ces-error-icon.svelte-kphfou {width:35px;height:35px;color:#d63f33ff;}.ces-tooltip-icon.svelte-kphfou {width:20px;height:20px;}.ces-line.svelte-kphfou {width:100%;height:100%;position:relative;}.ces-disabled.svelte-kphfou {display:none !important;}.ces-loading.svelte-kphfou {pointer-events:none;opacity:0.1;}.ces-inner.svelte-kphfou {width:100%;height:100%;outline:1px solid lightgrey;}.ces-maskButton.svelte-kphfou {width:100%;height:41px;}.ces-circle.svelte-kphfou {display:flex;align-items:center;justify-content:center;border-radius:9999px;}.ces-hover.svelte-kphfou {&:hover {outline:3px solid;outline-offset:3px;}&.large {outline-offset:9px;}}.ces-outline-inside.svelte-kphfou {outline:3px solid;outline-offset:-3px;}.ces-mainContainer.svelte-kphfou {width:100%;height:100%;display:flex;justify-content:space-between;border:1px solid lightgrey;border-radius:10px;align-items:center;background-color:white;}.ces-leftContainer.svelte-kphfou {width:100%;height:100%;display:flex;align-items:center;}.ces-selectorContainer.svelte-kphfou {padding-top:10px;padding-bottom:10px;display:flex;flex-direction:row;justify-content:flex-start;height:100%;gap:25px;margin-right:30px;}.ces-buttonContainer.svelte-kphfou {width:41px;height:100%;display:flex;align-items:center;}.ces-spinner.svelte-kphfou {height:50px;width:100%;display:flex;align-items:center;opacity:0.1;}.ces-spinner.svelte-kphfou svg {width:100%;height:100%;}.ces-effectText.svelte-kphfou {position:relative;display:flex;align-items:flex-start;justify-content:center;flex-direction:column;height:100%;min-width:fit-content;padding-left:30px;padding-right:30px;font-family:Helvetica Neue,\n      Helvetica,\n      Arial,\n      sans-serif;}.ces-action.svelte-kphfou {display:flex;align-items:center;height:100%;padding-left:20px;padding-right:20px;white-space:nowrap;font-family:Helvetica Neue,\n      Helvetica,\n      Arial,\n      sans-serif;justify-content:center;&.ces-reset {&:hover {background-color:rgb(249 250 251);border-top-right-radius:10px;border-bottom-right-radius:10px;}}&.ces-reload {min-width:120px;&:hover {background-color:rgb(249 250 251);border-top-right-radius:10px;border-bottom-right-radius:10px;}}&:hover {background-color:rgb(249 250 251);}}.ces-blendImage.svelte-kphfou {width:100%;height:100%;}"};function Wl(t,e){dn(e,!0),Kn(t,Zl);const i=Ls(e,"disabled",3,!1),r=Ls(e,"hasError",3,!1);let n=tn(-1),s=oi([]),o=tn(oi([])),a=tn(!1),l=tn(void 0);function h(t){zr(n)!=t?rn(n,t,!0):p()}function d(t,i){p(),e.onUpdateMask(t,i)}function c(t,e){if(!t)return!1;let i=t;for(;i;){if(i==e)return!0;i=i.parentElement}return!1}function u(t){zr(l)&&!c(t.target,zr(l))&&rn(a,!1);for(let e of s)if(c(t.target,e))return;for(let e of zr(o))if(c(t.target,e))return;p()}function p(){-1!=zr(n)&&rn(n,-1)}function g(t){return function(t){const e=t.split(",").map((t=>parseInt(t.trim()))),[i,r,n]=e;return(i+r+n)/3}(t)>200?"lightgrey":vl(t)}function m(){return`background-image: url(${e.materialImage}); background-size: 100% 100%;`}Ms((()=>{document.onmouseup=u}));var f=Gl(),v=vi(f),b=t=>{var i=Il(),r=bi(i),n=vi(r);!function(t,e){dn(e,!0);const i=Ls(e,"sizeClass",3,"w-full h-full");var r=ml();qi((t=>is(r,0,t)),[()=>Qn(Xn()(i(),"overflow-hidden align-middle"))]),Cn(t,r),cn()}(vi(n),{}),ti(n),ti(r);var s=yi(r,2),o=vi(s),a=vi(o,!0);ti(o);var l=yi(o);ti(s);var h=yi(s,4);h.__click=[Ml,e],h.__keydown=[Cl,e];var d=vi(h),c=vi(d),u=vi(c,!0);ti(c),ti(d),ti(h),qi((()=>{kn(a,e.translations.errorHeader),kn(l,` ${e.translations.errorText??""}`),is(h,1,"ces-action ces-reload "+(e.isLoading?"ces-loading":""),"svelte-kphfou"),kn(u,e.translations.reload)})),Cn(t,i)},y=t=>{var i=Ul(),r=bi(i),c=vi(r),u=t=>{var i=kl(),r=vi(i,!0);ti(i),qi((()=>kn(r,e.translations.tooltip))),Cn(t,i)};$n(c,(t=>{zr(a)&&t(u)}));var p=yi(c,2),f=vi(p),v=vi(f,!0);ti(f);var b=yi(f,2);b.__click=[Nl,a],b.__keydown=[Ll,a],function(t,e){dn(e,!0);const i=Ls(e,"sizeClass",3,"w-full h-full");var r=fl();qi((t=>is(r,0,t)),[()=>Qn(Xn()(i(),"overflow-hidden align-middle"))]),Cn(t,r),cn()}(vi(b),{}),ti(b),As(b,(t=>rn(l,t)),(()=>zr(l))),ti(p);var y=yi(p);ti(r);var _=yi(r,2),T=vi(_),x=t=>{var e=Dl();gl(vi(e),{sizeClass:""}),ti(e),Cn(t,e)},w=t=>{var i=Mn();Fn(bi(i),17,(()=>e.masks),Vn,((t,i,r)=>{var a=ql();let l;var c=vi(a),u=t=>{var e=Bl();gl(vi(e),{sizeClass:""}),ti(e),Cn(t,e)},p=t=>{var a=jl(),l=bi(a),c=t=>{const n=Pi((()=>vl(zr(i).colorRange))),s=Pi((()=>g(zr(i).colorRange))),a=Pi(m);!function(t,e){dn(e,!0),Kn(t,Ol);const i=Ls(e,"clickableButtonRefs",15);let r=tn(oi(Po.None));function n(t){rn(r,t,!0)}var s=Sl(),o=vi(s),a=vi(o);a.__click=[bl,e],a.__keydown=[yl,e],a.__mouseover=[_l,n];var l=vi(a),h=yi(l,2),d=vi(h,!0);ti(h),ti(a),As(a,(t=>i(i()[0]=t,!0)),(()=>i()?.[0]));var c=yi(a,2);c.__click=[Tl,e],c.__keydown=[xl,e],c.__mouseover=[wl,n];var u=vi(c),p=vi(u);ti(u);var g=yi(u,2),m=vi(g,!0);ti(g),ti(c),As(c,(t=>i(i()[1]=t,!0)),(()=>i()?.[1]));var f=yi(c,2);f.__click=[El,e],f.__keydown=[Al,e],f.__mouseover=[Pl,n];var v=vi(f),b=yi(v,2),y=vi(b,!0);ti(b),ti(f),As(f,(t=>i(i()[2]=t,!0)),(()=>i()?.[2])),ti(o),ti(s),qi((t=>{is(a,1,"ces-selection-button none "+(e.mode==Po.None?"selected":""),"svelte-13r1zak"),ns(l,`background-color: ${e.color};`),kn(d,e.translations.noEffect),is(c,1,"ces-selection-button mixed "+(e.mode==Po.Mix?"selected":""),"svelte-13r1zak"),ns(u,`background-color: ${e.color};`),ns(p,`${e.backgroundStyling} opacity: 0.5;`),kn(m,e.translations.colorEffect),is(f,1,"ces-selection-button full "+(e.mode==Po.Full?"selected":""),"svelte-13r1zak"),ns(f,t),ns(v,`background-color: ${e.color}; ${e.backgroundStyling}`),kn(y,e.translations.fullEffect)}),[()=>`--arrow-background: ${e.mode==Po.Full?"#e8e8e8":zr(r)==Po.Full?"#f5f5f5":"white"};`]),Tn("focus",a,(()=>n(Po.None))),Tn("mouseleave",a,(()=>n(null))),Tn("focus",c,(()=>n(Po.Mix))),Tn("mouseleave",c,(()=>n(null))),Tn("focus",f,(()=>n(Po.Full))),Tn("mouseleave",f,(()=>n(null))),Cn(t,s),cn()}(t,{onModeSelected:t=>{e.whiteLayerMaskSource==Oo.COMBINED?function(t,i){d(t,i),e.onCombinedMaskSourceSelect(t,i)}(t,r):d(t,r)},get mode(){return zr(i).mode},get color(){return zr(n)},get outlineColor(){return zr(s)},get backgroundStyling(){return zr(a)},get materialName(){return e.materialName},get translations(){return e.translations},get clickableButtonRefs(){return zr(o)},set clickableButtonRefs(t){rn(o,t,!0)}})};$n(l,(t=>{r==zr(n)&&t(c)}));var u=yi(l,2),p=t=>{var n=Rl();n.__click=()=>h(r),n.__keydown=()=>h(r),As(n,((t,e)=>s[e]=t),(t=>s?.[t]),(()=>[r])),qi(((t,e)=>{is(n,1,t,"svelte-kphfou"),ns(n,e)}),[()=>Qn(Xn()("ces-maskButton","ces-circle",e.isLoading?"":"ces-hover",e.isLoading?"ces-loading":"")),()=>`background: ${vl(zr(i).colorRange)}; outline-color: ${g(zr(i).colorRange)}`]),Cn(t,n)},f=t=>{var n=$l();n.__click=()=>h(r),n.__keydown=()=>h(r);var o=vi(n),a=vi(o);ti(o),ti(n),As(n,((t,e)=>s[e]=t),(t=>s?.[t]),(()=>[r])),qi(((t,e,i,r)=>{is(n,1,t,"svelte-kphfou"),ns(n,e),ns(o,i),ns(a,r)}),[()=>Qn(Xn()("ces-maskButton","ces-circle",zr(i).mode==Po.Full?"ces-outline-inside":"",e.isLoading?"":"ces-hover",e.isLoading?"ces-loading":"")),()=>`outline-color: ${g(zr(i).colorRange)}`,()=>`\n                          background-color: ${zr(i).mode==Po.Mix?`${vl(zr(i).colorRange)}`:"transparent"};`,()=>`${m()} opacity: ${zr(i).mode==Po.Mix?.5:1}`]),Cn(t,n)};$n(u,(t=>{zr(i).mode==Po.None?t(p):t(f,!1)})),Cn(t,a)};$n(c,(t=>{e.isLoading?t(u):t(p,!1)})),ti(a),qi((t=>l=is(a,1,"ces-buttonContainer svelte-kphfou",null,l,t)),[()=>({combinedPresentationColors:e.whiteLayerMaskSource==Oo.COMBINED,hidden:e.whiteLayerMaskSource==Oo.COMBINED&&zr(i).maskImgUrl.length>1})]),Cn(t,a)})),Cn(t,i)};$n(T,(t=>{0==e.masks.length&&e.isLoading?t(x):t(w,!1)})),ti(_);var E=yi(_,4);E.__click=[Vl,e],E.__keydown=[Fl,e];var A=vi(E),P=vi(A),S=vi(P,!0);ti(P),ti(A),ti(E);var O=yi(E,4);O.__click=[Hl,e],O.__keydown=[zl,e];var M=vi(O),C=vi(M),I=vi(C,!0);ti(C),ti(M),ti(O),qi((()=>{is(r,1,"ces-effectText "+(e.isLoading?"ces-loading":""),"svelte-kphfou"),kn(v,e.translations.materialEffect),kn(y,` ${e.translations.applyOnColors??""}`),is(E,1,"ces-action ces-invert "+(e.isLoading?"ces-loading":""),"svelte-kphfou"),kn(S,e.translations.invertEffects),is(O,1,"ces-action ces-reset "+(e.isLoading?"ces-loading":""),"svelte-kphfou"),kn(I,e.translations.reset)})),Cn(t,i)};$n(v,(t=>{r()?t(b):t(y,!1)})),ti(f),qi((()=>is(f,1,"ces-mainContainer "+(i()?"ces-disabled":""),"svelte-kphfou"))),Cn(t,f),cn()}xn(["click","keydown"]);var Kl=function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function o(t){try{l(r.next(t))}catch(t){s(t)}}function a(t){try{l(r.throw(t))}catch(t){s(t)}}function l(t){t.done?n(t.value):function(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(o,a)}l((r=r.apply(t,e||[])).next())}))};function Yl(t){return Kl(this,void 0,void 0,(function*(){return yield Promise.all(t.map((t=>Kl(this,void 0,void 0,(function*(){return t.mode===Po.Full?t.maskImgUrl=t.maskImgUrl.length?yield function(t){return Kl(this,void 0,void 0,(function*(){return new Promise(((e,i)=>{try{const r=new Image;r.crossOrigin="anonymous",r.src=t,r.onload=()=>{try{const t=document.createElement("canvas");t.width=r.width,t.height=r.height;const n=t.getContext("2d");if(!n)return void i(new Error("Canvas 2D context is not available."));n.imageSmoothingEnabled=!0,n.imageSmoothingQuality="high",n.drawImage(r,0,0,t.width,t.height);const s=n.getImageData(0,0,t.width,t.height),o=s.data;for(let t=0;t<o.length;t+=4){const e=o[t];Xl(e,o[t+1],o[t+2])?o[t+3]=0:(o[t]=255,o[t+1]=255,o[t+2]=255,o[t+3]=255)}n.putImageData(s,0,0);try{const i=t.toDataURL("image/png");e(i)}catch(t){i(new Error("Failed to convert canvas to image: "+t))}}catch(t){i(new Error("Error processing image: "+t))}},r.onerror=()=>{i(new Error("Failed to load image from URL: "+t))}}catch(t){i(new Error("Unexpected error: "+t))}}))}))}(t.maskImgUrl):"":t.mode===Po.None&&(t.maskImgUrl=t.maskImgUrl.length?yield function(t){return Kl(this,void 0,void 0,(function*(){return new Promise(((e,i)=>{const r=new Image;r.crossOrigin="anonymous",r.src=t,r.onload=()=>{const t=document.createElement("canvas");t.width=r.width,t.height=r.height;const n=t.getContext("2d");if(!n)return void i(new Error("Canvas context is not supported."));n.drawImage(r,0,0);const s=n.getImageData(0,0,t.width,t.height),o=s.data;for(let t=0;t<o.length;t+=4)Xl(o[t],o[t+1],o[t+2])||(o[t+3]=0);n.putImageData(s,0,0),e(t.toDataURL("image/png"))},r.onerror=()=>i(new Error("Failed to load image."))}))}))}(t.maskImgUrl):""),t})))))}))}function Xl(t,e,i){return t>200&&e>200&&i>200}function Ql(t,e="",i=512){const r=atob(t.split(",")[1]),n=[];for(let t=0;t<r.length;t+=i){const e=r.slice(t,t+i),s=new Array(e.length);for(let t=0;t<e.length;t++)s[t]=e.charCodeAt(t);const o=new Uint8Array(s);n.push(o)}return new Blob(n,{type:e})}const Jl=[{type:Eo.Vinyl,enabled:!0,title:"Vinyl",isMetal:!1,laminateSettings:{enabled:!0,laminateOpacity:.05}},{type:Eo.Holographic,enabled:!0,title:"Holografisk",isMetal:!0,metallicOpacity:.03,laminateSettings:{enabled:!0,laminateOpacity:.05}},{type:Eo.Prismatic,enabled:!0,title:"Prismatisk",isMetal:!0,metallicOpacity:.03,laminateSettings:{enabled:!0,laminateOpacity:.05}},{type:Eo.Glitter,enabled:!0,title:"Glitter",isMetal:!0,metallicOpacity:.03,laminateSettings:{enabled:!0,laminateOpacity:.05}},{type:Eo.Recycled,enabled:!0,title:"Återvunnet",isMetal:!1,laminateSettings:{enabled:!0,laminateOpacity:.05}},{type:Eo.Pixie,enabled:!0,title:"Pixie Dust",isMetal:!0,metallicOpacity:.03,laminateSettings:{enabled:!0,laminateOpacity:.05}},{type:Eo.Brushed,enabled:!0,title:"Aluminium",isMetal:!0,metallicOpacity:t=>t==Ao.Glossy?.15:.3,laminateSettings:{enabled:!0,laminateOpacity:.05}},{type:Eo.Mirror,enabled:!0,title:"Spegel",isMetal:!0,metallicOpacity:.3,laminateSettings:{enabled:!0,laminateOpacity:.05}},{type:Eo.Clear,enabled:!0,title:"Transparent",isMetal:!1,laminateSettings:{enabled:!0,laminateOpacity:.05}},{type:Eo.WhiteHiTack,enabled:!0,title:"Hi-Tack vinyl",isMetal:!1,laminateSettings:{enabled:!0,laminateOpacity:.05}},{type:Eo.Gitd,enabled:!0,title:"Glow in the dark",isMetal:!1,laminateSettings:{enabled:!0,laminateOpacity:.05}},{type:Eo.Reflective,enabled:!0,title:"Reflective",isMetal:!1,laminateSettings:{enabled:!0,laminateOpacity:.05}},{type:Eo.WhiteRemovable,enabled:!0,title:"Removable Vinyl",isMetal:!1,laminateSettings:{enabled:!0,laminateOpacity:.05}},{type:Eo.WhiteSturdy,enabled:!0,title:"White and Sturdy",isMetal:!1,laminateSettings:{enabled:!0,laminateOpacity:.05}},{type:Eo.WhiteThin,enabled:!0,title:"White Thin",isMetal:!1,laminateSettings:{enabled:!0,laminateOpacity:.05}},{type:Eo.ClearThin,enabled:!0,title:"Thin transparent",isMetal:!1,laminateSettings:{enabled:!0,laminateOpacity:.05}},{type:Eo.KraftThin,enabled:!0,title:"Thin recycled",isMetal:!1,laminateSettings:{enabled:!0,laminateOpacity:.05}},{type:Eo.SilverThin,enabled:!0,title:"silver_thin",isMetal:!0,metallicOpacity:.3,laminateSettings:{enabled:!0,laminateOpacity:.05}}];Ao.Glossy,Ao.Matte,Ao.Cracked,Ao.GlossyThin,Ao.GlossyThinNoUV;class th extends he{constructor(t,e){super(t,e,"background"),this._mouseDown=!1,this._transparentActive=!1,this._originalBackground={color:void 0,transparent:!1},this._canvasID="background-canvas-"+this.editor.id,this.$body.find(".canvas-background").attr("id",this._canvasID),this._canvas=document.getElementById(this._canvasID),this.$colorpicker.spectrum({color:th.DEFAULT_BACKGROUND,flat:!0,showButtons:!1,move:t=>this.onColorsChange(t.toHexString())}),this.addListenerToSVG(p.SVG_CHANGE_MODE,((t,e)=>this.onSVGChangeMode(t,e))),this.addListenerTo(this.$el.get(),a.OPEN_TOOL,(t=>this.onOpenTool(t))),this.addListenerTo(this.editor.el,a.MATERIAL_CHANGE,(t=>this.onMaterialChange(t))),this.addListenerTo(this.editor.el,a.PRE_SAVE,(()=>this.checkTransparentBackground())),this.addListenerTo(this.editor.el,a.UPDATED,(()=>this.checkTransparentBackground())),this.addListenerTo(this.$el.get(),a.CLOSE_TOOL,(t=>this.onMouseLeave(t))),this.addListenerTo(this.$content.get(),"click",".btn-cmyk_rgb_warning",(t=>this.onClickCMYKRGBWarning(t))),this.addListenerTo(this.$content.get(),"click","[name=cmyk_rgb]",(t=>this.onCMYKClick(t))),this.addListenerTo(this.$content.get(),"mousemove","#"+this._canvasID,(t=>this.onMouseMoveCanvas(t))),this.addListenerTo(this.$content.get(),"mousedown","#"+this._canvasID,(t=>this.onMouseDownCanvas(t))),this.addListenerTo(this.$content.get(),"change","[name=rgb_input_type]",(()=>this.onRGBInputTypeChange())),this.addListenerTo(this.$content.get(),"click",".backgroundSwatch",(t=>this.onClickBackgroundSwatch(t))),this.addListenerTo(this.$content.get(),"change","[name^=rgb_input_]",(t=>this.onRGBChange(t))),this.addListenerTo(this.$content.get(),"click","[name=cmyk_input_set]",(()=>this.setCmyk())),this.addListenerTo(this.$el.get(),"mouseleave",(t=>this.onMouseLeave(t))),this.addListenerTo(this.$el.get(),"mousedown",(t=>this.onMouseDown(t))),this.addListenerTo(this.transparentPicker,"change",(()=>this.onTPChange())),this.listenersActive=!1,e.model.settings.livePreviewEnabled&&this.updateTransparentActive()}render(){this.enabled?(this.$el.removeClass("hidden"),this.$el.removeClass("disabled")):(this.$el.addClass("hidden"),this.visible=!1)}renderHEX(t){if("dec"==this.$content.find("[name=rgb_input_type]").val()&&(this.$content.find("[name=rgb_input_red]").val(parseInt(t.replace("#","").substring(0,2),16)),this.$content.find("[name=rgb_input_green]").val(parseInt(t.replace("#","").substring(2,4),16)),this.$content.find("[name=rgb_input_blue]").val(parseInt(t.replace("#","").substring(4,6),16))),"hex"==this.$content.find("[name=rgb_input_type]").val()&&(this.$content.find("[name=rgb_input_red]").val(t.replace("#","").substring(0,2).toUpperCase()),this.$content.find("[name=rgb_input_green]").val(t.replace("#","").substring(2,4).toUpperCase()),this.$content.find("[name=rgb_input_blue]").val(t.replace("#","").substring(4,6).toUpperCase())),"cmyk"==this.$content.find("[name=rgb_input_type]").val()){let e=qt.hexToCmyk(t);this.$content.find("[name=rgb_input_cyan]").val(Math.round(100*e.c)),this.$content.find("[name=rgb_input_magenta]").val(Math.round(100*e.m)),this.$content.find("[name=rgb_input_yellow]").val(Math.round(100*e.y)),this.$content.find("[name=rgb_input_black]").val(Math.round(100*e.k))}this.visible&&this.$(".color-preview").css("fill",t)}setEnabled(t){if(super.setEnabled(t),this.updateTransparentActive(),this.render(),t){let t=this.editor.svg.part.getBackground();t?qt.isHexColor(t)&&(this.background=t,this.updateLastMinicolorIfNotBack()):this.lastMinicolor&&qt.isHexColor(this.lastMinicolor)&&"back"!=this.editor.svg.part.getActivePartSide()?(this.editor.svg.part.changeBackground('{"color":"'+this.lastMinicolor+'", "sync":false}'),this.background=this.lastMinicolor):(this.editor.svg.part.changeBackground('{"color":"'+th.DEFAULT_BACKGROUND+'", "sync":false}'),this.background=th.DEFAULT_BACKGROUND),this.checkTP(this.isTransparent(t))}}updateLastMinicolorIfNotBack(){const t=this.editor.svg.part.getBackground();"back"!==this.editor.svg.part.getActivePartSide()&&(this.lastMinicolor=t)}setCmyk({c:t,m:e,y:i,k:r}={}){if([t=this.processInput({name:"cmyk_input_cyan",value:t}),e=this.processInput({name:"cmyk_input_magenta",value:e}),i=this.processInput({name:"cmyk_input_yellow",value:i}),r=this.processInput({name:"cmyk_input_black",value:r})].some((t=>isNaN(t))))return this.$content.find("[name=cmyk_input_cyan]").val(""),this.$content.find("[name=cmyk_input_magenta]").val(""),this.$content.find("[name=cmyk_input_yellow]").val(""),void this.$content.find("[name=cmyk_input_black]").val("");this.editor.svg.part.setCMYKBackgound(t+" "+e+" "+i+" "+r),$.get(B.getURL("color?c="+t+"&m="+e+"&y="+i+"&k="+r),(t=>{this.editor.svg.part.changeBackground('{"color":"'+t+'", "sync":'+$("#syncBackground").hasClass("active")+"}"),this.editor.$(".bg-preview").css("background",t)}))}processInput({name:t,value:e}){return void 0===e&&(e=this.$content.find(`[name=${t}]`).val()),e=parseInt(String(e)),isNaN(e)?NaN:(e<0&&(e=0),e>100&&(e=100),this.$content.find(`[name=${t}]`).val(e),e)}viewInputs(){"cmyk"==this.$content.find("[name=rgb_input_type]").val()?(this.$content.find("[name=rgb_input_red]").addClass("hidden"),this.$content.find("[name=rgb_input_green]").addClass("hidden"),this.$content.find("[name=rgb_input_blue]").addClass("hidden"),this.$content.find("[name=rgb_input_cyan]").removeClass("hidden"),this.$content.find("[name=rgb_input_magenta]").removeClass("hidden"),this.$content.find("[name=rgb_input_yellow]").removeClass("hidden"),this.$content.find("[name=rgb_input_black]").removeClass("hidden")):(this.$content.find("[name=rgb_input_red]").removeClass("hidden"),this.$content.find("[name=rgb_input_green]").removeClass("hidden"),this.$content.find("[name=rgb_input_blue]").removeClass("hidden"),this.$content.find("[name=rgb_input_cyan]").addClass("hidden"),this.$content.find("[name=rgb_input_magenta]").addClass("hidden"),this.$content.find("[name=rgb_input_yellow]").addClass("hidden"),this.$content.find("[name=rgb_input_black]").addClass("hidden"))}set background(t){this.$colorpicker.spectrum("set",t),this.visible&&this.$(".color-preview").css("fill",t),this.viewInputs(),this.editor.svg.part.setInputsValues(this.editor.svg.part.getBackground(),this.$content.find("[name=rgb_input_type]"))}get background(){return this.$colorpicker.spectrum("get").toHexString()}static get DEFAULT_BACKGROUND(){return"#FFFFFF"}get lastMinicolor(){return this._lastMinicolor}set lastMinicolor(t){this._lastMinicolor=t}get canvas(){return this._canvas}get $colorpicker(){return this.$body.find("input.colorpicker")}get originalBackgroundColor(){return this._originalBackground.color}set originalBackgroundColor(t){this._originalBackground.color||(this._originalBackground.color=t,this._originalBackground.transparent=this.isTransparent(t))}get isOriginalBackgroundTransparent(){return this._originalBackground.transparent}onSetActivePart(t,e){this.background=this.editor.svg.part.getBackground()}onSVGChangeMode(t,e){e.change&&"part"==e.zoomMode?this.background=this.editor.svg.part.getBackground():e.change&&"sheet"==e.zoomMode&&(this.visible=!1)}onColorsChange(t){this.originalBackgroundColor=this.editor.svg.part.getBackground();const e=this.isTransparent(t);this.isTPChecked()&&!e&&this.checkTP(!1),this.listenersActive&&("back"!=this.editor.svg.part.getActivePartSide()||this.helpers.product.hasBackprint()||this.editor.trigger(a.BACKSIDEPRINT_MODIFIED),this.editor.trigger(a.PART_EDITED,{edited:"background"}),e||"back"==this.editor.svg.part.getActivePartSide()||(this._lastMinicolor=t),this.trackBackgroundAdded(t),this.editor.svg.part.changeBackground('{"color":"'+t+'", "sync":'+$("#syncBackground").hasClass("active")+"}"),this.editor.$(".bg-preview").css("background",t),this.renderHEX(t))}trackBackgroundAdded(t){if(this.editor.svg.activePart.getBackground()==th.DEFAULT_BACKGROUND&&t!=th.DEFAULT_BACKGROUND){const t=this.editor.svg.part.isBackSideActive()?Js.BPP_ADD_BACKGROUND:Js.ADD_BACKGROUND;this.helpers.eventTracker.trackEditorEvent(t)}}onRGBInputTypeChange(){this.viewInputs(),this.renderHEX(this.editor.svg.part.getBackground())}onRGBChange(t){let e;switch(this.$content.find("[name=rgb_input_type]").val()){case"dec":e=this.handleDecInput();break;case"hex":e=this.handleHexInput();break;case"cmyk":e=this.handleCmykInput(t);break;default:return}e&&(this.background=e,this.onColorsChange(e))}handleDecInput(){const t=this.editor.svg.part.getBackground(),e=parseInt(String(this.$content.find("[name=rgb_input_red]").val())),i=parseInt(String(this.$content.find("[name=rgb_input_green]").val())),r=parseInt(String(this.$content.find("[name=rgb_input_blue]").val()));if([e,i,r].some((t=>isNaN(t))))return this.editor.svg.part.setInputsValues(t,this.$content),null;if(e<0||e>255)return this.$content.find("[name=rgb_input_red]").val(parseInt(t.replace("#","").substring(0,2),16)),null;if(i<0||i>255)return this.$content.find("[name=rgb_input_green]").val(parseInt(t.replace("#","").substring(2,4),16)),null;if(r<0||r>255)return this.$content.find("[name=rgb_input_blue]").val(parseInt(t.replace("#","").substring(4,6),16)),null;this.$content.find("[name=rgb_input_red]").val(e),this.$content.find("[name=rgb_input_green]").val(i),this.$content.find("[name=rgb_input_blue]").val(r);let n="#";return n+=qt.paddy(e.toString(16),2),n+=qt.paddy(i.toString(16),2),n+=qt.paddy(r.toString(16),2),n}handleHexInput(){const t=this.editor.svg.part.getBackground(),e=String(this.$content.find("[name=rgb_input_red]").val()),i=String(this.$content.find("[name=rgb_input_green]").val()),r=String(this.$content.find("[name=rgb_input_blue]").val());if(this.areAnyHexComponentsInvalid({r:e,g:i,b:r}))return this.editor.svg.part.setInputsValues(t,this.$content),null;let n="#";return n+=qt.paddy(e,2),n+=qt.paddy(i,2),n+=qt.paddy(r,2),n}areAnyHexComponentsInvalid({r:t,g:e,b:i}){return!qt.checkHex(t)||!qt.checkHex(e)||!qt.checkHex(i)}handleCmykInput(t){const e=this.editor.svg.part.getBackground();if([this.$content.find("[name=rgb_input_cyan]").val(),this.$content.find("[name=rgb_input_magenta]").val(),this.$content.find("[name=rgb_input_yellow]").val(),this.$content.find("[name=rgb_input_black]").val()].some((t=>isNaN(parseInt(String(t))))))return this.editor.svg.part.setInputsValues(e,this.$content),null;let i,r=$(t.target),n=r.data("cmyk"),s=r.val();const o=parseInt(String(s)),a=String(s).length>0&&!isNaN(o);return n&&a&&o>=0&&o<=100&&(i=this.editor.svg.part.changeCMYKvalues(n,o,this.editor.svg.part.getBackground())),void 0===i&&(i=this.editor.svg.part.getBackground()),this.renderHEX(i),i}onCMYKClick(t){let e=this.$content.find(".rgb_cmyk_class").length,i=0;this.$content.find(".rgb_cmyk_class").toggle("fast",(()=>{if(i++,i==e)if(this.$content.find(".cmyk_div").is(":visible")){let t=this.editor.svg.part.getBackground(),e=qt.hexToRgb(t);$.get(B.getURL("color?r="+e.r+"&g="+e.g+"&b="+e.b),(function(t){let e=t.split(" ");this.setCmyk({c:e[0],m:e[1],y:e[2],k:e[3]})})),this.$content.find("[name=cmyk_rgb]").html("Switch to RGB")}else this.editor.svg.part.setCMYKBackgound(null),this.background=this.editor.svg.part.getBackground(),this.$content.find("[name=cmyk_rgb]").html("Switch to CMYK")}))}onClickCMYKRGBWarning(t){let e=this.canvas.getContext("2d"),i="#",r=this.canvas.getBoundingClientRect(),n=t.clientX-r.left,s=t.clientY-r.top,o=e.getImageData(n,s,1,1).data,a=o[3]/255,l=255+(o[0]-255)*a,h=255+(o[1]-255)*a,d=255+(o[2]-255)*a;i+=qt.paddy(l.toString(16),2),i+=qt.paddy(h.toString(16),2),i+=qt.paddy(d.toString(16),2),this.background=i,this.$content.find(".btn-cmyk_rgb_warning").hide(),this.$content.find(".rgb_cmyk_class").toggle("fast",(()=>{this.editor.svg.part.setCMYKBackgound(null),this.background=this.editor.svg.part.getBackground()}))}onMouseMoveCanvas(t){let e=this.editor.helpers.canvas.getMousMoveCanvasHex(this.canvas,t);this.$body.find(".background-canvas-swatch").css("background-color",e)}onMouseDownCanvas(t){let e=qt.rgb2hex(this.$body.find(".background-canvas-swatch").css("background-color"));this.background=e,this.onColorsChange(e)}onClickBackgroundSwatch(t){let e=qt.rgb2hex($(t.currentTarget).css("backgroundColor"));this.background=e,this.onColorsChange(e)}onOpenTool(t){if(this.visible){if(null!=this.editor.svg.part.getCmykBackground()){this.$body.find(".cmyk_div").is(":visible")||(this.$body.find("[name=cmyk_rgb]").html("Switch to RGB"),this.$body.find(".rgb_cmyk_class").toggle(0)),this.$body.find(".btn-cmyk_rgb_warning").show();let t=this.editor.svg.part.getCmykBackground().split(" ");this.setCmyk({c:t[0],m:t[1],y:t[2],k:t[3]})}else this.background=this.editor.svg.part.getBackground(),this.editor.helpers.canvas.setColorPickerCanvas(this.canvas);setTimeout((()=>{this.$colorpicker.spectrum("reflow")}),10),this.checkTransparentBackground()}}checkTransparentBackground(){var t,e;if("sheet"!=this.editor.context.productItem.getAttribute("sheet_type")&&this.isTransparent(null===(t=this.editor.svg.activePart)||void 0===t?void 0:t.backGroundNode.element.getAttribute("fill")))if(this.isVinyl(this.getMaterial())||"back"==this.editor.svg.part.getActivePartSide()){const t="back"==this.editor.svg.part.getActivePartSide()?th.DEFAULT_BACKGROUND:null!==(e=this.lastMinicolor)&&void 0!==e?e:th.DEFAULT_BACKGROUND;this.onColorsChange(t)}else this.checkTP(!0),this.onTPChange()}isTransparent(t){return"none"==t||t&&9===t.length&&"00"===t.slice(-2).toLowerCase()}getMaterial(){var t;return null!==(t=this.editor.context.productItem.getAttribute("material"))&&void 0!==t?t:this.editor.model.productItem.attributes.material}isVinyl(t){return t===Eo.Vinyl||t===Eo.WhiteHiTack||t===Eo.WhiteRemovable||t===Eo.WhiteThin||t===Eo.WhiteWall||t===Eo.WhiteSturdy}onClick(t){super.onClick(t),this._mouseDown=!1}onMouseLeave(t){this.visible||this.$(".color-preview").css("fill","#5d5f62")}onMouseDown(t){this._mouseDown=!0}disable(){super.setEnabled(!1),this.$el.addClass("disabled"),this.$el.removeClass("hidden")}get transparentPicker(){return this.$body.find(".transparent-picker")[0]}isTPChecked(){return this.isTransparentActive&&this.transparentPicker.checked}checkTP(t=!0){this.transparentPicker.checked=t}onTPChange(t){var e;if(this.isTransparentActive){let i=this.isTPChecked()?"none":null!==(e=null!=t?t:this._lastMinicolor)&&void 0!==e?e:th.DEFAULT_BACKGROUND;this.background=i,this.onColorsChange(i)}else this.hideTP()}hideTP(t=!0){t?this.transparentPicker.parentElement.classList.add("hidden"):this.transparentPicker.parentElement.classList.remove("hidden")}setTransparentActive(t){var e;if(this._transparentActive!=t){if(this._transparentActive=t,this.hideTP(!t),t){let t=null===(e=this.editor.svg.activePart)||void 0===e?void 0:e.backGroundNode.element.getAttribute("fill");const i=t==th.DEFAULT_BACKGROUND,r=!this.lastMinicolor||this.lastMinicolor==th.DEFAULT_BACKGROUND;i&&r&&(t="none"),this.checkTP(this.isTransparent(t)),this.onTPChange(t)}this.checkTransparentBackground()}else this.checkTransparentBackground()}get isTransparentActive(){return this._transparentActive}get isTransparentChecked(){return this.isTransparentActive&&this.transparentPicker.checked}onMaterialChange(){this.editor.model.settings.livePreviewEnabled&&this.updateTransparentActive()}updateTransparentActive(){const t="back"!=this.editor.svg.part.getActivePartSide()&&!this.isVinyl(this.getMaterial());this.setTransparentActive(t)}}const eh=["goToCheckout","makeNewSticker","duplicateAndEdit"];class ih{constructor(t,e){var i;if(this.handleAnimationEnd=()=>{this.loadingModal?(this.element.classList.remove("loading"),setTimeout((()=>{this.element.classList.add("waiting"),this.element.classList.add("loading")}),0)):(this.element.classList.remove("waiting"),this.element.classList.remove("loading"))},this.onButtonClick=t=>(eh.indexOf(t),e=>{this.buttons.forEach((t=>t.setAttribute("disabled","true"))),this.editor.trigger(a.PRE_CHECKOUT_ACTION,{modal:this,action:t}),M.preCheckoutModal(t)}),t instanceof jQuery){const e=t;this.element=e.get(0)}else this.element=t;this.editor=e;let r=document.querySelector("button[data-action='goToCheckout']");null==r||r.addEventListener("click",(()=>this.onButtonClick("goToCheckout")));let n=document.querySelector("button[data-action='makeNewSticker']");null==n||n.addEventListener("click",(()=>this.onButtonClick("makeNewSticker")));let s=document.querySelector("button[data-action='duplicateAndEdit']");if(null==s||s.addEventListener("click",(()=>this.onButtonClick("duplicateAndEdit"))),this.isActive)for(const t of eh)this.button(t).addEventListener("click",this.onButtonClick(t));null===(i=this.element)||void 0===i||i.addEventListener("animationend",this.handleAnimationEnd)}show(){this.modal=new window.bootstrap.Modal(this.element,{keyboard:!1,backdrop:"static"}),this.modal.show(),M.preCheckoutModal("modal_shown")}hide(){this.modal.hide(),this.buttons.forEach((t=>{t.classList.remove("loading"),t.classList.remove("done")})),this.element.classList.remove("hidden")}enable(){this.loadingModal=!1,this.buttons.forEach((t=>{t.removeAttribute("disabled")}))}disable(){this.loadingModal=!0,this.element.classList.add("loading"),this.buttons.forEach((t=>{t.setAttribute("disabled","true")}))}loading(t,e){if(void 0===e)return this.button(t).classList.contains("loading");e?this.button(t).classList.add("loading"):this.button(t).classList.remove("loading")}done(t,e){if(void 0===e)return this.button(t).classList.contains("done");e?this.button(t).classList.add("done"):this.button(t).classList.remove("done")}get buttons(){return Array.from(this.element.querySelectorAll(".action-section button"))}button(t){return this.buttons.filter((e=>e.dataset.action===t)).pop()}get isActive(){return this.editor.model.settings.preCheckoutModalActive&&!document.querySelector("body").classList.contains("checkout")}}class rh{static getElements(t,e=null){let i=[],r=t.trim().split(" ");return e=e||document,r.forEach((t=>{if(i=this.elementsSearch(t,i,e),!i)return[]})),i}static getElementById(t,e){let i=t.split("#"),r=i[i.length-1].trim();return e.getElementById(r)}static getElementsByClass(t,e){let i=[],r=t.trim().split(".").filter((t=>""!==t)),n=Array.prototype.slice.call(e);for(let t of n)for(let e of t.getElementsByClassName(r[r.length-1])){let t=e,n=e.tagName.toUpperCase()===r[0].toUpperCase(),s=r.length>=3,o=e.classList.contains(r[r.length-1].trim());s&&n&&o&&i.push(t),!s&&o&&i.push(t)}return i}static getElementsByTagName(t,e){let i=[],r=Array.prototype.slice.call(e);for(let e of r)i=[...i,...e.getElementsByTagName(t)];return i}static elementsSearch(t,e,i){return t.includes("#")?this.getElementById(t,document)?[this.getElementById(t,document)]:[]:t.includes(".")?this.getElementsByClass(t,e.length?e:[i]):this.getElementsByTagName(t,e.length?e:[i])}static parseDataAttribute(t,e){if(!t)return;let i=null==(t=Array.isArray(t)?t[0]:t)?void 0:t.getAttribute(e);return i?JSON.parse(i):void 0}}class nh extends ae{constructor(t,e){super(t,e),this.preCheckoutModal=new ih($(".pre-checkout-modal"),this.editor),this.prepPopover(),this.$el.data("viewport","#"+e.id),this.$el.data("container","#"+e.id),this.addListenerTo(this.$el.get(),"mouseenter",(t=>this.onSaveButtonHover(t))),this.addListenerTo(this.$el.get(),"mouseleave",(t=>this.onSaveButtonHoverOut(t))),this.addListenerTo(this.$el.get(),"click",(t=>this.onClick(t))),this.addListenerToSVG(p.ZOOM_CHANGE,(t=>this.onEditorZoomChange(t.zoomMode))),this.addListenerToSVG(a.UPLOAD_START,(t=>this.$el.addClass("disabled").attr("disabled","disabled"))),this.addListenerToSVG(a.UPLOAD_END,(t=>this.$el.removeClass("disabled").attr("disabled",null))),this.addListenerToSVG(a.UPLOAD_CANCEL,(t=>this.$el.removeClass("disabled").attr("disabled",null))),this.addListenerToSVG(a.REQUEST_UPDATE,(t=>this.setEnabled(!1))),this.addListenerToSVG(a.UPDATED,(t=>this.maybeEnable())),this.addListenerToSVG(a.UPDATE_FAILED,(t=>this.maybeEnable()))}maybeEnable(){var t;this.editor.helpers.event.isUpdating||!(null===(t=this.editor.helpers.livePreview)||void 0===t?void 0:t.isVisible)&&this.editor.model.settings.livePreviewEnabled||this.setEnabled(!0)}render(t){t?this.$el.removeClass("disabled").prop("disabled",!1):this.$el.addClass("disabled").attr("disabled","disabled")}setEnabled(t){const e=!this.unsavable&&t;super.setEnabled(e),this.listenersActive=!0,this.render(e)}onClick(t){if(t.preventDefault(),this.editor.model.settings.directionToolEnabled&&this.directionTool&&!this.directionTool.canSkip())return this.directionTool.setVisible(!0);this.editor.trigger(a.PRE_SAVE),isNaN(this.helpers.product.getQuantity())&&this.helpers.product.setQuantity(parseInt(this.editor.ui.toolPane.quantityTool.minQuantity)),window.updateCustomSticker||window.addCustomSticker||function(t){var e,i;const r=function(t){if(t&&"string"==typeof t)switch(LANG){case"us":case"uk":case"gb":case"ca":return Number(t.replace(/[^0-9.-]+/g,"").replace(",",""));case"jp":return Number(t.replace(/[^0-9-]+/g,""));default:return Number(t.replace(/[^\d,-]/g,"").replace(",","."))}}(null===(e=rh.getElements("div.footer div.detailed div.total div.summary-total")[0])||void 0===e?void 0:e.innerText),n=t.item,s="labels_on_roll"===n.getProductName()||"labels_on_sheet"===n.getProductName()?"labels":"stickers",o=null!==(i=t.getQuantity())&&void 0!==i?i:1;var a,l;const h={event:"add_to_cart",ecommerce:{items:[{item_id:t.getSKU(),item_name:n.getProductName(),item_category:"custom",item_category2:s,item_category3:t.getSheetType(),item_category4:(a=t.getWidthMM(),l=t.getHeightMM(),`${a/10}x${l/10}`),item_category5:t.getSheetName(),item_category6:t.getLaminate(),item_variant:t.getMaterial(),quantity:o,price:+(r/o).toFixed(2),currency:ce(),index:1}]}};dataLayer.push(h)}(this.helpers.product),(new oo).validateEditorProductItem(this.context.productItem,this.editor.model.settings.isAdmin).then((t=>{if(function(t,e){if(t==e)return;let i={event:"change_width",event_params:{action:"editor",width_from:(t/10).toFixed(2),width_to:(e/10).toFixed(2)}};dataLayer.push({event_params:null}),dataLayer.push(ue(i))}(this.editor.initWidth,this.context.productItem.getAttribute("width_mm")),function(t,e){if(t==e)return;let i={event:"change_height",event_params:{action:"editor",height_from:(t/10).toFixed(2),height_to:(e/10).toFixed(2)}};dataLayer.push({event_params:null}),dataLayer.push(ue(i))}(this.editor.initHeight,this.context.productItem.getAttribute("height_mm")),this.editor.helpers.eventTracker.dumpSavedEvents(),this.preCheckoutModal.isActive){this.preCheckoutModal.disable(),this.preCheckoutModal.show(),$("#overlay").addClass("pre-checkout-modal-hide-overlay"),this.editor.once(a.DATA_POSTED,((t,e)=>{$("#overlay").removeClass("pre-checkout-modal-hide-overlay"),$.when(this.updateCartIndicator()).then((()=>{this.preCheckoutModal.enable()}))}));const t="noRedirect";this.editor.trigger(a.SAVE,{intent:t})}else this.editor.trigger(a.SAVE)})).catch((t=>{s.instance.confirm(t.message)})).then((()=>{var t,e;null===(t=this.directionTool)||void 0===t||t.setVisible(!1),null===(e=this.directionTool)||void 0===e||e.setSkip(!1)}))}updateCartIndicator(){return $.ajax("/checkout/get_cart_num_items",{success:t=>{let e=$(".c-cart-counter, .c-mobile-cart-counter");t!==e.text()&&(e.attr("data-count",t),e.text(t))},error:t=>{}})}onSaveButtonHover(t){"sheet"==this.helpers.product.getSheetType()&&this.$(".btn-save").hasClass("disabled")&&this.$(".btn-save").tooltip("show")}onSaveButtonHoverOut(t){}onEditorZoomChange(t){"sheet"==this.helpers.product.getSheetType()&&("part"!=t||this.editor.svg.part.isBackSideActive()?this.setEnabled(!0):this.setEnabled(!1))}prepPopover(){const t=$(".btn-save-popover");if(this.unsavable){let e="";switch(this.editor.model.settings.status){case"sent":e="The order containing this sheet has already been sent.";break;case"in_production":e="Currently in production."}new window.bootstrap.Popover(t,{trigger:"hover",title:"Unsavable",content:e}).hide(),t.css("cursor","not-allowed")}}get unsavable(){return["sent","in_production"].includes(this.editor.model.settings.status)}get directionTool(){return this.editor.ui.toolPane.directionTool}}class sh extends ae{constructor(t,e){super(t,e),this.addListener("click","button",(t=>this.onRemove(t)))}onRemove(t){t.preventDefault(),this.isDisabled()?s.instance.confirmWithTitle(this.editor.model.language.nothing_to_remove_backprint_text,this.editor.model.language.nothing_to_remove,(()=>{this.editor.isLandscapeOrientation()&&this.editor.ui.uploadTool.show()})):s.instance.confirmOrCancelWithTitle(this.editor.model.language.are_you_sure_you_want_to_continue,this.editor.model.language.remove_paper_back_print,(()=>{this.remove(),this.helpers.eventTracker.trackEditorEvent(Js.BPP_REMOVE_FILE)}))}remove(){this.editor.svg.part.clearActivePart(),this.editor.isLandscapeOrientation()&&this.editor.ui.uploadTool.show(),this.setDisabled(!0),this.editor.helpers.event.requestUpdate(0),this.helpers.product.setBackprint(!1),this.editor.trigger(a.BACKSIDEPRINT_REMOVED)}setEnabled(t){super.setEnabled(t),t?this.$el.removeClass("hidden"):this.$el.addClass("hidden")}setDisabled(t){t?this.$el.addClass("disabled"):this.$el.removeClass("disabled")}isDisabled(){return this.$el.hasClass("disabled")}}class oh extends ae{constructor(t,e){super(t,e),this.addListener("change","#backside-print-deal-checkbox",(t=>this.toggleDeal(t)))}setEnabled(t){super.setEnabled(t),t?this.$el.removeClass("hidden"):this.$el.addClass("hidden")}toggleDeal(t){$("#backside-print-deal-checkbox").prop("checked")?(this.editor.svg.zoomHelper.changeMode(c.ZOOM_PART,this.editor.svg.part.getBackDealPart()),this.$el.addClass("checked")):(this.editor.svg.zoomHelper.changeMode(c.ZOOM_PART,this.editor.svg.part.getBackPart()),this.$el.removeClass("checked")),this.editor.helpers.event.requestUpdate(0)}}class ah extends ho{constructor(t,e){super(t,e),this.dealText=!1,this._name="text_deal",this.align="center",this.fontName="Bree Serif",this.color="#ffdb00",this.locked=!0}registerCallBacks(){this.addListenerTo(this.$content.get(),"click","textarea",(t=>{this.selectDealText()})),this.addListenerToSVG(p.DESELECT_NODE,(t=>{(null===this.editor.svg.activePart||this.editor.svg.activePart.partGroupNode.children.length<1)&&(this.dealText=!1,this.text="")}))}render(){this.enabled?this.$el.removeClass("hidden"):(this.$el.addClass("hidden"),this.hide())}reset(){}hide(){super.hide()}show(){super.show()}setEnabled(t){super.setEnabled(t)}setTextByJSON(t){super.setTextByJSON(t)}onOpenTool(t){super.onOpenTool(t)}onTransitionInDone(){super.onTransitionInDone()}onInputText(t){this.editor.svg.selected&&this.editor.svg.selected.type===SVGTypeEnum.SHAPE_TEXT||this.selectDealText(),-1==this.text.indexOf("@")&&(this.text="@"+this.text),"@"!==this.text[0]&&(this.text=this.text.substr(this.text.indexOf("@"))+this.text.substr(0,this.text.indexOf("@"))),super.onInputText(t)}onChangeTextColor(t,e=!0){}onRGBTextInputTypeChange(){super.onRGBTextInputTypeChange()}onSelectFont(t){}onClickAlignment(t){}onClick(t){return super.onClick(t)}selectDealText(){this.dealText&&this.editor.svg.activePart.partGroupNode.children.length<1&&(this.dealText=!1),!this.dealText&&this.editor.svg.activePart.partGroupNode.children.length>0&&(this.dealText=this.editor.svg.activePart.partGroupNode.children[0]),this.dealText&&this.editor.svg.select.select(this.dealText)}}class lh extends ae{constructor(t,e){super(t,e),this.addListener("click","button",(t=>{t.preventDefault(),this.onSelectPart(t)})),this.addListenerToSVG(a.BACKSIDEPRINT_MODIFIED,(()=>{this.helpers.product.hasBackprint()||(this.helpers.product.setBackprint(!0),this.editor.ui.toolPane.removeBackPrintTool.setEnabled(!0),this.editor.helpers.event.requestUpdate(0))}))}setEnabled(t,e="",i=""){let r=this.enabled;t&&!r?this.editor.helpers.event.requestUpdate():!t&&r&&(this.context.cherryPicks.hasLostAttributeValue("feature","backpaper_print")&&e&&i&&s.instance.confirmWithTitle(e,i),this.editor.helpers.event.requestUpdate()),t?this.$el.removeClass("disabled"):this.$el.addClass("disabled"),super.setEnabled(t),(t&&!r||!t&&r)&&this.editor.ui.setSizeAndOrientation()}get frontPartButton(){return document.querySelector('[data-id="front"]')}deselectActiveButton(){const t=document.querySelector(".tool-backside-print .active");t&&(t.classList.remove("active"),t.classList.remove("bs5-btn-primary"),t.classList.add("bs5-btn-light"))}selectActiveButton(t){const e=document.querySelector(`button[data-id="${t}"]`);e&&(e.classList.add("active"),e.classList.remove("bs5-btn-light"),e.classList.add("bs5-btn-primary"))}handleOnSelectBack(){if("back"!==this.editor.svg.part.getActivePartSide()&&"back_deal"!==this.editor.svg.part.getActivePartSide()){const t=this.editor.svg.part.getBackPart();$(".editor-header .modal-title").html(this.editor.model.language.paper_backprint),this.helpers.product.isBackprintDealEnabled()?($("#backside-print-deal-checkbox").prop("checked",!0),this.editor.ui.toolPane.backPrintDealTool.$el.addClass("checked"),this.editor.svg.zoomHelper.changeMode(c.ZOOM_PART,this.editor.svg.part.getBackDealPart())):(this.editor.ui.toolPane.backPrintDealTool.$el.removeClass("checked"),this.editor.svg.sheet.isCustomizableSheet&&(this.editor.svg.svgSettings.sheetZoomable=!1,$(".btn-save-sticker").addClass("hidden")),this.editor.svg.zoomHelper.changeMode(c.ZOOM_PART,t),this.editor.helpers.eventTracker.trackEditorEvent(Js.BPP_SHOW)),$("#confirm-modal-backside-print").length&&this.initBackprintInfoModal()}}handleOnSelectFront(){if("front"!==this.editor.svg.part.getActivePartSide()){var t=this.editor.svg.part.getFrontPart();$(".editor-header .modal-title").html(this.editor.model.settings.title),this.editor.svg.sheet.isCustomizableSheet?(this.editor.svg.svgSettings.sheetZoomable=!0,this.editor.svg.part.isBackSideActive()&&$(".btn-save-sticker").removeClass("hidden"),this.editor.svg.zoomHelper.changeMode(c.ZOOM_SHEET)):this.editor.svg.zoomHelper.changeMode(c.ZOOM_PART,t)}}onSelectPart(t){if(t.preventDefault(),t.stopPropagation(),$(t.currentTarget).hasClass("disabled"))return;const e=$(t.currentTarget).data("id");switch(this.deselectActiveButton(),this.selectActiveButton(e),this.editor.svg.select.deselect(),e){case"back":this.handleOnSelectBack(),this.editor.svg.events.trigger(a.SWITCH_SIDE,"back");break;case"front":this.handleOnSelectFront(),this.editor.svg.events.trigger(a.SWITCH_SIDE,"front")}}initBackprintInfoModal(){if(Boolean(window.localStorage.getItem("hideBackPrintInfo")))return;let t=$("#confirm-modal-backside-print"),e=$("#confirm-modal-backside-print .btn-confirm"),i=window.bootstrap.Modal.getOrCreateInstance(t,{keyboard:!1,backdrop:"static"});i.show(),e.on("click",(()=>{$("#show_again_paperback_info").is(":checked")&&window.localStorage.setItem("hideBackPrintInfo","1"),i.hide()}))}disableButtons(){this.listenersActive=!1,this.$el.find("button").addClass("bs5-disabled")}enableButtons(){this.listenersActive=!0,this.$el.find("button").removeClass("bs5-disabled")}hide(){this.listenersActive=!1,this.$el.addClass("hidden")}show(){this.listenersActive=!0,this.$el.removeClass("hidden")}}class hh extends yo{constructor(t,e){super(t,e),this._name=bo.EFFECT_LAYER_UPLOAD,this._hasSavedFile=!1,this._fileName=null,this._fileUrl=null,this._fileappId=null}open(){}get $fileupload(){return this.$el.find("input.effect-layer-fileupload")}get $connectionError(){return $("#connection-error")}get $dropZone(){return this.$el.find(".drop-zone")}filterSend(t,e){return!!this.enabled&&(this.helpers.menu.isTooManyImages()||!this.uploadIsValid(e)?(this.hideProgress(),!1):(this.uploadIsValid(e)&&(this._fileName=e.files[0].name),void M.effectLayerUploaded(this.helpers.product.getMaterial()+"-"+this.helpers.product.getLaminate())))}onStart(t){this._status=vo.START,this.editor.ui.toolPane.effectLayerTool.setFile(!1),this.editor.ui.toolPane.effectLayerTool.setFileError(!1),this.editor.ui.toolPane.effectLayerTool.progress=0,this.showProgress()}onProgressAll(t,e){this.editor.ui.toolPane.effectLayerTool.progress=parseInt((e.loaded/e.total*100).toString(),10)}onDone(t,e){let i=this._fileName?this._fileName:e.result.files[0].name;e.result.files[0].url&&(this._fileUrl=e.result.files[0].url),e.result.files[0].fileapp_id&&(this._fileappId=e.result.files[0].fileapp_id),this.uploadIsValid(e)&&(i&&this._fileUrl||i&&this._fileappId?(this.setMeta(),this.editor.ui.toolPane.effectLayerTool.setFile(!0,!1),this.helpers.eventTracker.trackEditorEvent(Js.EFFECT_LAYER_UPLOADED)):this.onError(t,e)),this.hideProgress(),this._status=vo.DONE,this.editor.trigger(a.UPLOAD_END)}onError(t,e){this._status=vo.ERROR,this.editor.ui.toolPane.effectLayerTool.hideModal(),this.hideProgress(),this.$connectionError.modal("show"),this.editor.trigger(a.UPLOAD_END)}onCancel(t){t.preventDefault(),this._status==vo.START&&(this.$fileupload.fileupload("abort"),this._status=vo.IDLE),this.hideProgress(),this.destroy(),this.editor.trigger(a.UPLOAD_CANCEL)}hasMeta(){return this.editor.helpers.product.getEffectLayerFileName()&&this.editor.helpers.product.getEffectLayerFileAppID()}setMeta(){this.editor.helpers.product.setEffectLayerFileName(this._fileName),this.editor.helpers.product.setEffectLayerFileAppID(this._fileappId),this.helpers.product.setEffectLayer(!0)}removeMeta(){this.context.productItem.removeAttribute("effect_layer_file_name"),this.context.productItem.removeAttribute("effect_layer_upload_fileapp_id"),this.helpers.product.setEffectLayer(!1)}uploadIsValid(t){let e=!0;if(t.result){for(let i=0;i<t.result.files.length;i++)if(t.result.files[i].error){this.removeMeta(),this.editor.ui.toolPane.effectLayerTool.setFileError(!0,t.result.files[i].error),e=!1;break}}else if(t.files.length>1)return this.editor.ui.toolPane.effectLayerTool.setFileError(!0,this.editor.model.language.effect_layer_too_many_images),!1;return e}showProgress(){this.editor.ui.toolPane.effectLayerTool.$modalButtons.addClass("hidden"),this.editor.ui.toolPane.effectLayerTool.$progressionZone.removeClass("hidden"),this.editor.ui.toolPane.effectLayerTool.$progress.removeClass("hidden")}hideProgress(){this.editor.ui.toolPane.effectLayerTool.$modalButtons.removeClass("hidden"),this.editor.ui.toolPane.effectLayerTool.$progressionZone.addClass("hidden"),this.editor.ui.toolPane.effectLayerTool.$progress.addClass("hidden"),this.editor.ui.toolPane.effectLayerTool.progress=0}}class dh extends ae{constructor(t,e){super(t,e),this.init=()=>{this.appendModal();try{new window.bootstrap.Popover(this.$popover,{trigger:"hover",placement:"top"})}catch(t){}this.showBox()},this.onEditorReady=()=>{this._effectLayerUploadEditorTool.hasMeta()?(this.hideBox(),this.editor.helpers.product.setEffectLayer(!0),this.setFile(!0,!0),this.setFile(!0)):this.showBox()},this.onEditorUpdated=()=>{this.uploadedFileIsValidForMaterial()},this.onEditorPreSave=()=>{this._effectLayerUploadEditorTool.hasMeta()&&!this.helpers.product.isEffectLayerPossible()&&this._effectLayerUploadEditorTool.removeMeta()},this.onModalShow=t=>{t.preventDefault(),this.showModal(),this.$modalTextarea.val(this.helpers.product.getNote()),this.effectLayerUploadTool.setAsDefaultUpload(),M.effectLayerAdd(this.helpers.product.getMaterial()+"-"+this.helpers.product.getLaminate())},this.onModalCancel=t=>{t.preventDefault(),this._effectLayerUploadEditorTool._hasSavedFile||this.setFile(!1),this.hideModal()},this.onModalBrowse=t=>{t.preventDefault(),this.$fileupload.trigger("click"),M.effectLayerBrowse(this.helpers.product.getMaterial()+"-"+this.helpers.product.getLaminate()),this.helpers.eventTracker.trackEditorEvent(Js.EFFECT_LAYER_BROWSE)},this.onModalDone=t=>{t.preventDefault(),this._lastNote!=this.$modalTextarea.val().toString()?this.setNote(!0):this.setNote(),this._effectLayerUploadEditorTool.hasMeta()&&(this._effectLayerUploadEditorTool._hasSavedFile=!0,this.hideBox(),this.setFile(!0,!0,!0),this.effectLayerUploadTool.$dropZone.hide()),this.$fileError.is(":visible")&&this.setFileError(!1),this.uploadedFileIsValidForMaterial(),this.hideModal(),M.effectLayerDone(this.helpers.product.getMaterial()+"-"+this.helpers.product.getLaminate()),this.helpers.eventTracker.trackEditorEvent(Js.EFFECT_LAYER_ADD)},this.onUploadCancel=t=>{t.preventDefault(),this._effectLayerUploadEditorTool.onCancel(t)},this.onFileRemove=(t,e=!1)=>{t.preventDefault(),t.stopImmediatePropagation(),this._effectLayerUploadEditorTool._hasSavedFile=!1,this._effectLayerUploadEditorTool.removeMeta(),e?(this.showBox(),this.setFile(!1,!0),this.editor.ui.toolPane.setCurrentToolMaxHeight()):this.setFile(!1),this.$toolNotification.hasClass("hidden")||this.$toolNotification.addClass("hidden"),this.effectLayerUploadTool.$dropZone.show(),M.effectLayerRemove(this.helpers.product.getMaterial()+"-"+this.helpers.product.getLaminate()),this.helpers.eventTracker.trackEditorEvent(Js.EFFECT_LAYER_REMOVE)},this.onFileErrorRemove=t=>{t.preventDefault(),this.setFileError(!1)},this.requirementsFulfilled=()=>{if(!this.editor.isLandscapeOrientation()||o.isAdmin())return!1;{let t=this.editor.svg.part.getActivePartSide();return(t===j.FRONT||this.editor.svg.sheet.isCustomizableSheet&&!t)&&this._mainTools.includes(this.editor.ui.toolPane.currentTool.name)}},this.uploadedFileIsValidForMaterial=()=>{this._effectLayerUploadEditorTool.hasMeta()&&(this.helpers.product.isEffectLayerPossible()?(this.$editorFile.removeClass("hidden"),this.$editorFileTitle.text(this.editor.model.language.effect_layer_added).css({color:"#444"}),this.$toolNotification.hasClass("hidden")||this.$toolNotification.addClass("hidden")):(this.$toolNotification.removeClass("hidden").addClass("animated bounceIn").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",(()=>{this.$toolNotification.removeClass("animated bounceIn")})),this.$editorFileTitle.text(this.editor.model.language.effect_layer_not_supported_for_material).css({color:"#da5246"})))},this.show=()=>{this.enabled&&this.visible?this.$el.hasClass("hidden")&&this.$el.removeClass("hidden"):this.$el.hasClass("hidden")||this.$el.addClass("hidden")},this.disable=()=>{this.disabled?this.$modalShowButton.attr("disabled","true"):this.$modalShowButton.removeAttr("disabled")},this.showBox=()=>{this.$box.removeClass("hidden")},this.hideBox=()=>{this.$box.hasClass("hidden")||this.$box.addClass("hidden")},this.appendModal=()=>{if(!this.$modal.hasClass("appended")){let t=this.$modal;this.$modal.remove(),t.addClass("appended").appendTo(this.editor.$el)}},this.showModal=()=>{this.$modal.css("opacity","1"),this.$modal.css("display","block")},this.hideModal=()=>{var t;this.editor.svg.sheet.isCustomizableSheet&&(null===(t=this.editor.svg.activePart)||void 0===t?void 0:t.isSheetBackground)?this.editor.ui.toolPane.sheetBGTool.setAsDefaultUpload():this.editor.ui.toolPane.uploadTool.setAsDefaultUpload(),this.$modal.css("opacity","0"),this.$modal.css("display","none")},this.setFile=(t,e=!1,i=!1)=>{t?e?(this.$editorFile.removeClass("hidden"),this.editor.ui.toolPane.setCurrentToolMaxHeight(),i&&this.$editorFile.addClass("animated bounceIn").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",(()=>{this.$editorFile.removeClass("animated bounceIn")}))):(this.$modalFile.removeClass("hidden"),this.$fileError.hasClass("hidden")||this.$fileError.addClass("hidden")):e?(this.$editorFile.addClass("hidden"),this.$modalFile.addClass("hidden")):this.$modalFile.addClass("hidden"),this.setFileName(e)},this.setFileName=t=>{let e=this._effectLayerUploadEditorTool._fileName?this._effectLayerUploadEditorTool._fileName:this.editor.helpers.product.getEffectLayerFileName();t?this.$editorFile.find("span").not(".file-title").not(".effect-layer-popover").text(e):this.$modalFile.find("span").text(e)},this.setFileError=(t,e=null)=>{t?(this.$fileError.removeClass("hidden"),this.$modalFile.hasClass("hidden")||this.$modalFile.addClass("hidden")):this.$fileError.addClass("hidden"),this.$fileError.find("span").text(e)},this.setNote=(t=!1)=>{this.helpers.product.setNote(this.$modalTextarea.val().toString()),this.editor.ui.toolPane.noteTool.$textarea.val(this.helpers.product.getNote()),this.editor.ui.toolPane.noteTool.render(this.helpers.product.getNote()),this._lastNote=this.helpers.product.getNote(),t&&this.editor.ui.toolPane.noteTool.$el.addClass("animated bounceIn").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",(()=>{this.editor.ui.toolPane.noteTool.$el.removeClass("animated bounceIn")}))},this.setBoxMaxHeight=()=>{let t,e=this.editor.$el.height();t=e>640&&e<=740?220:e>600&&e<=640?200:e<=600?180:"initial",this.$uploadWrapper.css({"max-height":t})},this._mainTools=[bo.UPLOAD],this._visible=!1,this._disabled=!1,this._effectLayerUploadEditorTool=new hh(this.$el,e),this._lastNote=this.helpers.product.getNote()||"",this.addListenerTo(this.$modalShowButton.get(),"click",(t=>this.onModalShow(t))),this.addListenerTo(this.effectLayerUploadTool.$dropZone.get(),"click",(t=>{this.effectLayerUploadTool.isActive&&this.onModalShow(t)})),this.addListenerTo(this.$modalCancelButton.get(),"click",(t=>this.onModalCancel(t))),this.addListenerTo(this.$modalBrowseButton.get(),"click",(t=>this.onModalBrowse(t))),this.addListenerTo(this.$modalDoneButton.get(),"click",(t=>this.onModalDone(t))),this.addListenerTo(this.$uploadCancelButton.get(),"click",(t=>this.onUploadCancel(t))),this.addListenerTo(this.$editorFileRemoveButton.get(),"click",(t=>this.onFileRemove(t,!0))),this.addListenerTo(this.$modalFileRemoveButton.get(),"click",(t=>this.onFileRemove(t))),this.addListenerTo(this.$fileErrorRemoveButton.get(),"click",(t=>this.onFileErrorRemove(t))),this.addListenerToSVG(p.READY,(()=>this.onEditorReady())),this.addListenerToSVG(a.UPDATED,(()=>this.onEditorUpdated())),this.addListenerToSVG(a.PRE_SAVE,(()=>this.onEditorPreSave())),this.init()}setEnabled(t){super.setEnabled(t)}destroy(){super.destroy(),this._effectLayerUploadEditorTool.destroy()}set visible(t){this._visible=t,this.show()}get visible(){return this._visible}set disabled(t){this._disabled=t,this.disable()}get disabled(){return this._disabled}get $fileupload(){return this.$el.find("input.effect-layer-fileupload")}get $box(){return this.$el.find(".effect-layer-box")}get $modalShowButton(){return this.$el.find(".show-modal-btn")}get $popover(){return this.$el.find("span.effect-layer-popover")}get $editorFileTitle(){return this.$el.find(".file-title")}get $editorFile(){return this.$el.find(".file")}get $editorFileRemoveButton(){return this.$el.find(".remove-btn.remove-file-btn")}get $toolNotification(){return this.editor.$el.find(".tool-notification")}get $uploadWrapper(){return this.editor.$el.find(".upload-wrapper")}get $modal(){return this.editor.$el.find("#effect-layer-modal")}get $modalCancelButton(){return this.$modal.find(".cancel-btn")}get $modalBrowseButton(){return this.$modal.find(".browse-btn")}get $modalDoneButton(){return this.$modal.find(".done-btn")}get $modalTextarea(){return this.$modal.find('textarea[name="note"]')}get $upload(){return this.$modal.find(".upload")}get $modalFile(){return this.$modal.find(".file")}get $modalFileRemoveButton(){return this.$modal.find(".remove-btn.remove-file-btn")}get $fileError(){return this.$modal.find(".file-error")}get $fileErrorRemoveButton(){return this.$modal.find(".remove-btn.remove-file-error-btn")}get $progress(){return this.$modal.find(".progress")}get $progressBar(){return this.$modal.find(".progress-bar")}get $progressionZone(){return this.$modal.find(".progression-zone")}get effectLayerUploadTool(){return this._effectLayerUploadEditorTool}set progress(t){this.$progressBar.css("width",t+"%"),this.$progressBar.css("width",t+"%"),this.$progressBar.attr("aria-valuenow",t),t>0?this.$(".progression").html(t+"%"):this.$(".progression").html("")}get $uploadCancelButton(){return this.$modal.find(".btn.cancel")}get $modalButtons(){return this.$modal.find(".modal-buttons")}}class ch extends he{constructor(t,e){super(t,e,"laminate"),this.lastEvaluatedLaminate=null,this.mounted=!1,t.data("editor","#"+e.id),t.data("viewport","#"+e.id),t.data("container","#"+e.id),t.data("placement","top"),this.attributeBoxWrapper=document.createElement("div"),this.attributeBoxWrapper.classList.add("bs5-w-100"),this.$body.append(this.attributeBoxWrapper),this.renderList();const i={placement:"top",content:this.attributeBoxWrapper,trigger:"focus",template:'\n\t\t\t\t<div class="bs5-popover editor-popover" role="tooltip">\n\t\t\t\t\t<div class="bs5-popover-arrow"></div>\n\t\t\t\t\t<div class="bs5-popover-header">\n\t\t\t\t\t\t<span class="popover-title"></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="icon-cross"></i></button>\n\t\t\t\t\t<div class="bs5-popover-body bs5-p-0"></div>\n\t\t\t\t</div>\n\t\t\t'};this._popover=new ro(t,i),this._popover.$header.css("height","auto"),this._popover.$contentContainer.addClass("stretch"),this._popover.$closeButton.remove(),this._popover.disabled=!this.editor.isLandscapeOrientation(),this.addListenerToSVG(a.ORIENTATION_CHANGE,(()=>this.render(!0))),this.editor.svg.events.addListener(a.PRODUCT_ATTR_EVALUATED,(()=>{this.setEnabled(!this.shouldHideTool()),this.onProductEvaluated()})),this.addListenerTo(this.$el.get(),a.OPEN_TOOL,(()=>setTimeout((()=>this.renderScrollTop()),10))),this.addListenerTo(this.$el.get(),"show.bs.popover",(t=>this.onShowPopover())),this.addListenerTo(this.$el.get(),"shown.bs.popover",(t=>this.renderScrollTop()))}renderList(){const t={attributeName:"laminate",context:this.editor.context,translations:{lang:LANG,strings:this.editor.model.language.products}},e={preChange:t=>{!function(t,e){let i={event:"change_laminate",event_params:{action:"editor",laminate_from:t,laminate_to:e}};dataLayer.push({event_params:null}),dataLayer.push(ue(i))}(t.detail.from,t.detail.to),this.editor.helpers.eventTracker.trackEditorChange(Js.CHANGE_LAMINATE,t.detail.from,t.detail.to)},change:t=>this.onUserSelectLaminate(t.detail)};this.mounted?Ln(Qs,{target:this.attributeBoxWrapper,props:t,events:e}):(Nn(Qs,{target:this.attributeBoxWrapper,props:t,events:e}),this.mounted=!0)}setEnabled(t){super.setEnabled(t),t?this.$el.removeClass("hidden"):this.$el.addClass("hidden"),t&&this.render(!0)}render(t=!1){t&&this.renderPopover(),this._popover&&this.editor.isLandscapeOrientation()&&(this._popover.disabled=!this.laminates||this.laminates.length<=1),this.renderTitle(),this.renderList()}renderPopover(){this.editor.isLandscapeOrientation()?(this._popover.enable(),this._popover.disabled=!this.laminates||this.laminates.length<=1):(this._popover.disabled=!0,this.$body.append(this.attributeBoxWrapper))}renderTitle(){const t=de.getTranslationFromMap(this.editor.model.language.products,"products","laminate",this.helpers.product.getLaminate());this.$(".summary-laminate").text(t),this.laminates&&this.laminates.length>1?(this.$el.addClass("cta"),this.$(".icon-expand").removeClass("hidden")):(this.$el.removeClass("cta"),this.$(".icon-expand").addClass("hidden"))}renderScrollTop(){let t=this.attributeBoxWrapper.querySelector(".bs5-list-group-item[data-active='true']");if(t){let e=t.offsetTop-this.$body.scrollTop()-this.$body.height()/3,i=$(t);if(this.editor.isLandscapeOrientation())this._popover.$contentContainer.scrollTop(e);else{let t=i.offset().top-this.$body.offset().top+this.$body.scrollTop()-this.$body.height()/3;this.$body.scrollTop(t)}}}get laminates(){return this.context.attrComputer.getSuggestedValues("laminate")}get $header(){return this._$header||(this._$header=$(this.$content.find(".tool-content-header"))),this._$header}get $body(){return this._$body||(this._$body=$(this.$content.find(".tool-content-body"))),this._$body}set bodyHeight(t){this.$body.css("height","auto")}onClick(t){t.preventDefault(),!this.editor.isLandscapeOrientation()&&this.laminates&&this.laminates.length>1&&super.onClick(t)}changeLaminate(t){this.helpers.product.setLaminate(t.value),this.editor.trigger(a.REQUEST_PRODUCT_ATTR_EVALUATION),this.editor.helpers.livePreview?this.editor.trigger(a.LAMINATE_CHANGE,{to:t.value}):this.editor.helpers.event.requestUpdate(0,{rebuildSVG:!0})}onUserSelectLaminate(t){this.visible=this._popover.visible=!1,this.helpers.product.setCherryPickValue("laminate",t.value,!this.editor.model.settings.isAdmin),this.changeLaminate(t),this.renderTitle(),this.renderList()}shouldHideTool(){return 1===this.editor.context.getAttributeOptions("laminate").length&&!this.editor.model.settings.isAdmin}onProductEvaluated(){this.enabled&&this.render(!1)}onShowPopover(){let t=this.editor.ui.toolPane.$el.outerHeight()-this.editor.ui.toolPane.$panelToolsOverview.outerHeight()-this.$el.position().top-this.$el.outerHeight()-175;this._popover.$contentContainer.css("max-height",t+"px"),this.renderScrollTop()}}class uh extends yo{constructor(t,e){super(t,e,bo.SHEET_BG_UPLOAD)}renderOnDone(){super.renderOnDone(),this.$(".progress").removeClass("hidden"),this.editor.isLandscapeOrientation()||(this.editor.ui.toolPane.uploadTool.visible=!1)}renderOnStart(){this.editor.svg.activePart=this.editor.svg.node.getActiveNodeSheet(),super.renderOnStart()}get $fileupload(){return this.$el.find("input.sheet-bg-fileupload")}get $progressBar(){return this.$el.find(".progress-bar")}get $cancelButton(){return this.$el.find(".btn.cancel")}get $browseButton(){return this.$el.find("a.browse-link")}get $progressionZone(){return this.$el.find(".progression-zone")}get $dropZone(){return this.$el.find(".drop-zone")}}class ph extends ae{constructor(t,e){super(t,e),this.reloadPath="",this.addListener("click","button",(t=>this.onClick(t)))}onClick(t){t.preventDefault(),this.helpers.settings.isAdmin&&this.editor.svg.isSheetMode&&(this.helpers.change.isChanged2()?s.instance.yesOrNo("You have unsaved changes. Continue anyway?",(()=>{this.showDownloadModal()})):this.showDownloadModal())}showDownloadModal(){s.instance.yesOrNo("Download sticker before converting?",(()=>{let t=document.createElement("a");t.href="/orders/download_sheet/"+this.editor.model.id,t.target="_blank",t.rel="noopener",document.body.appendChild(t),t.click(),t.remove(),this.showConverterModal()}),(()=>{this.showConverterModal()}))}showConverterModal(){s.instance.yesOrNo("Are you sure you want to convert this sheet to single? This cannot be undone.",(()=>{document.getElementById("overlay").style.display="block";const t=new FormData;t.append("sheet_id",String(this.editor.model.id)),fetch("/orders/convert_sheet_to_single",{method:"POST",body:t}).then((t=>{return e=this,i=void 0,n=function*(){if(!t.ok){let e=yield t.json();throw new Error(e.message)}return t.json()},new((r=void 0)||(r=Promise))((function(t,s){function o(t){try{l(n.next(t))}catch(t){s(t)}}function a(t){try{l(n.throw(t))}catch(t){s(t)}}function l(e){e.done?t(e.value):function(t){return t instanceof r?t:new r((function(e){e(t)}))}(e.value).then(o,a)}l((n=n.apply(e,i||[])).next())}));var e,i,r,n})).then((t=>{this.reloadPath=`/editor/edit/${this.editor.model.id}/single`,location.href=this.reloadPath})).catch((t=>{document.getElementById("overlay").style.display="none",this.showErrorModal(t.message)}))}))}showErrorModal(t){return s.instance.confirmWithTitle(t,"Error")}setEnabled(t){super.setEnabled(t),this.el.style.display=t?"block":"none"}}var gh=On('<path d="M31.7343 23.8777L31.7343 46.2559L56.9936 46.2559L45.8872 23.8777L31.7343 23.8777Z" fill="#6E7071" stroke="#979797"></path><path d="M57.8 46.2564C60.8887 46.2564 63.8074 43.8476 65.9835 39.6777C68.1469 35.532 69.5 29.7701 69.5 23.3782C69.5 16.9863 68.1469 11.2244 65.9835 7.07864C63.8074 2.90875 60.8887 0.499999 57.7999 0.499999C54.7112 0.5 51.7925 2.90875 49.6164 7.07864C47.453 11.2244 46.0999 16.9863 46.0999 23.3782C46.0999 29.7701 47.453 35.532 49.6165 39.6777C51.7925 43.8476 54.7112 46.2564 57.8 46.2564Z" fill="#B2B4B4" stroke="#979797"></path><path d="M57.8001 30.3722C58.525 30.3722 59.32 29.7619 59.9635 28.4563C60.5914 27.1827 60.9939 25.3881 60.9939 23.3787C60.9939 21.3692 60.5914 19.5746 59.9635 18.301C59.32 16.9954 58.525 16.3851 57.8001 16.3851C57.0753 16.3851 56.2803 16.9954 55.6367 18.301C55.0089 19.5746 54.6063 21.3692 54.6063 23.3787C54.6063 25.3881 55.0089 27.1827 55.6367 28.4563C56.2803 29.7619 57.0753 30.3722 57.8001 30.3722Z" fill="#6E7071" stroke="#979797"></path><path d="M0.578035 23.3336L0.578045 23.3337L0.580025 23.3559L0.580025 23.3782L0.580027 73.156L45.6955 73.156L45.6955 23.3782C45.6955 13.7761 48.6339 7.81648 51.6142 4.25013C53.1009 2.471 54.5906 1.2964 55.7141 0.564511C55.7477 0.542612 55.781 0.521109 55.8139 0.499998L9.56792 0.5C4.37637 3.23836 2.10387 8.84541 1.14715 13.9009C0.667816 16.4338 0.525415 18.796 0.503258 20.5263C0.492189 21.3908 0.511151 22.0957 0.532767 22.5832C0.543573 22.827 0.555036 23.0162 0.563727 23.1437C0.568072 23.2075 0.571724 23.2558 0.574251 23.2877L0.577147 23.3233L0.577862 23.3316L0.578019 23.3334L0.578035 23.3336Z" fill="white" stroke="#979797"></path><circle cx="22.5" cy="53.5" r="14.25" fill="white" stroke="#979797" stroke-width="0.5"></circle><circle cx="22.5" cy="20.5" r="14.25" fill="white" stroke="#979797" stroke-width="0.5"></circle><path d="M28.9999 49.2613L25.9759 50.4613V56.5093L28.9999 57.7333V61.5733L12.9919 55.1173V51.7333L28.9999 45.4213V49.2613ZM23.1439 55.4293V51.4693L17.7679 53.4373L23.1439 55.4293Z" fill="#757575"></path><path d="M28.9999 16.2613L25.9759 17.4613V23.5093L28.9999 24.7333V28.5733L12.9919 22.1173V18.7333L28.9999 12.4213V16.2613ZM23.1439 22.4293V18.4693L17.7679 20.4373L23.1439 22.4293Z" fill="#757575"></path>',1),mh=On('<path d="M31.7343 23.8777L31.7343 46.2559L56.9936 46.2559L45.8872 23.8777L31.7343 23.8777Z" fill="#6E7071" stroke="#979797"></path><path d="M57.8 46.2564C60.8887 46.2564 63.8074 43.8476 65.9835 39.6777C68.1469 35.532 69.5 29.7701 69.5 23.3782C69.5 16.9863 68.1469 11.2244 65.9835 7.07864C63.8074 2.90875 60.8887 0.499999 57.7999 0.499999C54.7112 0.5 51.7925 2.90875 49.6164 7.07864C47.453 11.2244 46.0999 16.9863 46.0999 23.3782C46.0999 29.7701 47.453 35.532 49.6165 39.6777C51.7925 43.8476 54.7112 46.2564 57.8 46.2564Z" fill="#B2B4B4" stroke="#979797"></path><path d="M57.8001 30.3722C58.525 30.3722 59.32 29.7619 59.9635 28.4563C60.5914 27.1827 60.9939 25.3881 60.9939 23.3787C60.9939 21.3692 60.5914 19.5746 59.9635 18.301C59.32 16.9954 58.525 16.3851 57.8001 16.3851C57.0753 16.3851 56.2803 16.9954 55.6367 18.301C55.0089 19.5746 54.6063 21.3692 54.6063 23.3787C54.6063 25.3881 55.0089 27.1827 55.6367 28.4563C56.2803 29.7619 57.0753 30.3722 57.8001 30.3722Z" fill="#6E7071" stroke="#979797"></path><path d="M0.578035 23.3336L0.578045 23.3337L0.580025 23.3559L0.580025 23.3782L0.580027 73.156L45.6955 73.156L45.6955 23.3782C45.6955 13.7761 48.6339 7.81648 51.6142 4.25013C53.1009 2.471 54.5906 1.2964 55.7141 0.564511C55.7477 0.542612 55.781 0.521109 55.8139 0.499998L9.56792 0.5C4.37637 3.23836 2.10387 8.84541 1.14715 13.9009C0.667816 16.4338 0.525415 18.796 0.503258 20.5263C0.492189 21.3908 0.511151 22.0957 0.532767 22.5832C0.543573 22.827 0.555036 23.0162 0.563727 23.1437C0.568072 23.2075 0.571724 23.2558 0.574251 23.2877L0.577147 23.3233L0.577862 23.3316L0.578019 23.3334L0.578035 23.3336Z" fill="white" stroke="#979797"></path><circle cx="23.5" cy="54.5" r="14.25" fill="white" stroke="#979797" stroke-width="0.5"></circle><path d="M19.2611 47L20.4611 50.024H26.5091L27.7331 47H31.5731L25.1171 63.008H21.7331L15.4211 47H19.2611ZM25.4291 52.856H21.4691L23.4371 58.232L25.4291 52.856Z" fill="#757575"></path><circle cx="23.5" cy="21.5" r="14.25" fill="white" stroke="#979797" stroke-width="0.5"></circle><path d="M19.2611 14L20.4611 17.024H26.5091L27.7331 14H31.5731L25.1171 30.008H21.7331L15.4211 14H19.2611ZM25.4291 19.856H21.4691L23.4371 25.232L25.4291 19.856Z" fill="#757575"></path>',1),fh=On('<path d="M31.7341 23.8772L31.7341 46.2549L56.9935 46.2549L45.887 23.8772L31.7341 23.8772Z" fill="#6E7071" stroke="#979797"></path><path d="M57.8002 46.2554C60.889 46.2554 63.8076 43.8467 65.9837 39.6769C68.1472 35.5313 69.5003 29.7694 69.5003 23.3777C69.5003 16.986 68.1472 11.2241 65.9837 7.0785C63.8076 2.9087 60.889 0.499999 57.8002 0.499999C54.7114 0.5 51.7928 2.9087 49.6167 7.0785C47.4532 11.2241 46.1001 16.986 46.1001 23.3777C46.1001 29.7694 47.4532 35.5313 49.6167 39.6769C51.7928 43.8467 54.7114 46.2554 57.8002 46.2554Z" fill="#B2B4B4" stroke="#979797"></path><path d="M57.8 30.3713C58.5248 30.3713 59.3199 29.761 59.9634 28.4554C60.5912 27.1818 60.9938 25.3873 60.9938 23.3779C60.9938 21.3685 60.5912 19.5739 59.9634 18.3003C59.3199 16.9948 58.5248 16.3845 57.8 16.3845C57.0751 16.3845 56.2801 16.9948 55.6366 18.3003C55.0087 19.5739 54.6062 21.3685 54.6062 23.3779C54.6062 25.3873 55.0087 27.1818 55.6366 28.4554C56.2801 29.761 57.0751 30.3713 57.8 30.3713Z" fill="#6E7071" stroke="#979797"></path><path d="M0.578035 23.3331L0.578045 23.3332L0.580025 23.3554L0.580025 23.3777L0.580027 73.1546L45.6955 73.1546L45.6955 23.3777C45.6955 13.7758 48.6339 7.81631 51.6142 4.25003C53.1009 2.47094 54.5906 1.29636 55.7141 0.564488C55.7477 0.542597 55.781 0.521102 55.8139 0.499998L9.56792 0.5C4.37637 3.23831 2.10387 8.84523 1.14715 13.9006C0.667816 16.4334 0.525415 18.7956 0.503258 20.5259C0.492189 21.3903 0.511151 22.0953 0.532767 22.5828C0.543573 22.8265 0.555036 23.0157 0.563727 23.1432C0.568072 23.207 0.571723 23.2553 0.574251 23.2872L0.577147 23.3228L0.577862 23.3312L0.578019 23.333L0.578035 23.3331Z" fill="white" stroke="#979797"></path><circle cx="23.5" cy="53.5" r="14.25" fill="white" stroke="#979797" stroke-width="0.5"></circle><path d="M27.739 60.9999L26.539 57.9759H20.491L19.267 60.9999H15.427L21.883 44.9919H25.267L31.579 60.9999H27.739ZM21.571 55.1439H25.531L23.563 49.7679L21.571 55.1439Z" fill="#757575"></path><circle cx="23.5" cy="20.5" r="14.25" fill="white" stroke="#979797" stroke-width="0.5"></circle><path d="M27.739 28.0001L26.539 24.9761H20.491L19.267 28.0001H15.427L21.883 11.9921H25.267L31.579 28.0001H27.739ZM21.571 22.1441H25.531L23.563 16.7681L21.571 22.1441Z" fill="#757575"></path>',1),vh=On('<path d="M31.7341 23.8777L31.7341 46.2559L56.9935 46.2559L45.887 23.8777L31.7341 23.8777Z" fill="#6E7071" stroke="#979797"></path><path d="M57.8 46.2564C60.8887 46.2564 63.8074 43.8476 65.9835 39.6777C68.1469 35.532 69.5 29.7701 69.5 23.3782C69.5 16.9863 68.1469 11.2244 65.9835 7.07864C63.8074 2.90875 60.8887 0.499999 57.7999 0.499999C54.7112 0.5 51.7925 2.90875 49.6164 7.07864C47.453 11.2244 46.0999 16.9863 46.0999 23.3782C46.0999 29.7701 47.453 35.532 49.6165 39.6777C51.7925 43.8476 54.7112 46.2564 57.8 46.2564Z" fill="#B2B4B4" stroke="#979797"></path><path d="M57.8 30.3722C58.5248 30.3722 59.3199 29.7619 59.9634 28.4563C60.5912 27.1827 60.9938 25.3881 60.9938 23.3787C60.9938 21.3692 60.5912 19.5746 59.9634 18.301C59.3199 16.9954 58.5248 16.3851 57.8 16.3851C57.0751 16.3851 56.2801 16.9954 55.6366 18.301C55.0088 19.5746 54.6062 21.3692 54.6062 23.3787C54.6062 25.3881 55.0088 27.1827 55.6366 28.4563C56.2801 29.7619 57.0751 30.3722 57.8 30.3722Z" fill="#6E7071" stroke="#979797"></path><path d="M0.578035 23.3336L0.578045 23.3337L0.580025 23.3559L0.580025 23.3782L0.580027 73.156L45.6955 73.156L45.6955 23.3782C45.6955 13.7761 48.6339 7.81648 51.6142 4.25013C53.1009 2.471 54.5906 1.2964 55.7141 0.564511C55.7477 0.542612 55.781 0.521109 55.8139 0.499998L9.56792 0.5C4.37637 3.23836 2.10387 8.84541 1.14715 13.9009C0.667816 16.4338 0.525415 18.796 0.503258 20.5263C0.492189 21.3908 0.511151 22.0957 0.532767 22.5832C0.543573 22.827 0.555036 23.0162 0.563727 23.1437C0.568072 23.2075 0.571724 23.2558 0.574251 23.2877L0.577147 23.3233L0.577862 23.3316L0.578019 23.3334L0.578035 23.3336Z" fill="white" stroke="#979797"></path><circle cx="22.5" cy="53.5" r="14.25" fill="white" stroke="#979797" stroke-width="0.5"></circle><path d="M15 57.739L18.024 56.539V50.491L15 49.267V45.427L31.008 51.883V55.267L15 61.579V57.739ZM20.856 51.571V55.531L26.232 53.563L20.856 51.571Z" fill="#757575"></path><circle cx="22.5" cy="20.5" r="14.25" fill="white" stroke="#979797" stroke-width="0.5"></circle><path d="M15 24.739L18.024 23.539V17.491L15 16.267V12.427L31.008 18.883V22.267L15 28.579V24.739ZM20.856 18.571V22.531L26.232 20.563L20.856 18.571Z" fill="#757575"></path>',1),bh=On('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 70 74" fill="none" transform="rotate(90)"><!></svg>');function yh(t,e){let i=Ls(e,"direction",8),r=Ls(e,"size",8,70);var n=bh(),s=vi(n),o=t=>{var e=gh();ei(7),Cn(t,e)},a=(t,e)=>{var r=t=>{var e=mh();ei(7),Cn(t,e)},n=(t,e)=>{var r=t=>{var e=fh();ei(7),Cn(t,e)},n=(t,e)=>{var r=t=>{var e=vh();ei(7),Cn(t,e)};$n(t,(t=>{"right_first"==i()&&t(r)}),e)};$n(t,(t=>{"bottom_first"==i()?t(r):t(n,!1)}),e)};$n(t,(t=>{"top_first"==i()?t(r):t(n,!1)}),e)};$n(s,(t=>{"left_first"==i()?t(o):t(a,!1)})),ti(n),qi((()=>{ls(n,"width",r()),ls(n,"height",r()+4)})),Cn(t,n)}var _h=Sn('<button tabindex="0"><!> <h6 class="svelte-dxyppo"> </h6></button>'),Th=Sn('<div class="bs5-modal-header bs5-justify-content-center bs5-border-bottom-0"><button class="btn-info-direction svelte-dxyppo" tabindex="0">?</button> <h3 class="bs5-modal-title bs5-mt-4"> </h3></div> <div class="bs5-modal-body"><div class="directions svelte-dxyppo"></div></div> <div class="bs5-modal-footer bs5-border-top-0 bs5-pt-4 bs5-flex-nowrap bs5-gap-3"><button class="bs5-btn bs5-btn-outline-secondary bs5-rounded-pill bs5-m-0 bs5-p-3 bs5-w-75" tabindex="0"><span class="glyphicon glyphicon-arrow-left"></span> </button> <button class="bs5-btn bs5-btn-primary bs5-rounded-pill bs5-m-0 bs5-p-3 bs5-w-100" tabindex="0"> </button></div>',1),xh=Sn('<div class="bs5-d-flex bs5-align-items-center bs5-gap-4"><!> <p class="bs5-m-0"><!></p></div>'),wh=Sn('<div class="bs5-modal-header bs5-border-bottom-0"><div><h3 class="bs5-modal-title bs5-mt-2 bs5-mb-0"> </h3> <p class="bs5-mt-4 bs5-mb-0"> </p> <p class="bs5-mt-3 bs5-mb-0"> </p></div></div> <div class="bs5-modal-body"><div class="action-section bs5-gap-4"></div></div> <div class="bs5-modal-footer bs5-pt-4 bs5-border-top-0 bs5-justify-content-center"><button class="bs5-btn bs5-btn-outline-secondary bs5-rounded-pill bs5-m-0 bs5-p-3 bs5-w-50" tabindex="0"><span class="glyphicon glyphicon-arrow-left"></span> </button></div>',1),Eh=Sn('<div class="bs5-modal" role="dialog" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"><div class="bs5-modal-dialog" role="document"><div class="bs5-modal-content bs5-py-3 bs5-px-4"><!></div></div></div>');const Ah={hash:"svelte-dxyppo",code:":root {--primary-color: #FFDB00;--black-color: #040404;--white-color: #FFFFFF;--success-color: #6CB676;--success-secondary-color: #9ECFA5;--success-tertiary-color: #CEE7D2;--blue: #3796f6;--light-blue: #bbdbfc;--info-color: #3696F6;--info-secondary-color: #7ABAF9;--info-tertiary-color: #BDDCFC;--warning-color: #DA5246;--warning-secondary-color: #E78D85;--warning-tertiary-color: #F3C6C2;--gray-900: #1D1D1D;--gray-800: #2D2D2D;--gray-700: #505050;--gray-600: #757575;--gray-500: #979797;--gray-400: #CCCCCC;--gray-300: #DDDDDD;--gray-200: #F2F2F2;--gray-100: #FAFAFA;}.btn-info-direction.svelte-dxyppo {position:absolute;right:1rem;top:1rem;cursor:pointer;background-color:transparent;border:2px solid #000000;border-radius:50%;width:26px;height:26px;font-weight:bold;display:flex;align-items:center;justify-content:center;}.btn-info-direction.svelte-dxyppo:focus {outline:none;border:2px solid var(--primary-color) !important;color:var(--primary-color);}.directions.svelte-dxyppo {display:grid;grid-template-columns:1fr 1fr;gap:1rem;background-color:#ffffff;width:100%;}.btn-direction.svelte-dxyppo {background-color:transparent;display:flex;align-items:center;justify-content:center;flex-direction:column;width:100%;border:2px solid #e7e7e7;border-radius:4px;padding:30px;gap:17px;}.btn-direction.active.svelte-dxyppo {background-color:#f2f2f2;}.btn-direction.disabled.svelte-dxyppo {opacity:0.4;}.btn-direction.svelte-dxyppo:focus {outline:none;border:2px solid var(--primary-color) !important;}.btn-direction.svelte-dxyppo h6:where(.svelte-dxyppo) {font-family:Helvetica;font-weight:bold;}.btn-direction.svelte-dxyppo:not(.active) h6:where(.svelte-dxyppo) {font-weight:normal;}"};function Ph(t,e){dn(e,!1),Kn(t,Ah);const i=en(),r=en();let n=Ls(e,"context",8),s=Ls(e,"translations",8);const o=Cs();let a=en([]),l=en(!1);const h=["left_first","right_first","top_first","bottom_first"];function d(t){o("visible",t),t?p():rn(l,!1)}function c(t){rn(l,t),zr(l)||p()}function u(){zr(r)&&n().attrComputer.isAvailable("cut_direction",zr(r))&&o("continue")}function p(t){requestAnimationFrame((()=>zr(a).find((e=>e.name==(t??zr(r))))?.focus()))}Ri((()=>(Hs.DeliveryRollHelper,Wr(s()),Wr(n()))),(()=>{rn(i,h.map((t=>{const e=t.split("_")[0],i=e+"_edge_leading";return{attr_name:t,attr_name_prod:Hs.DeliveryRollHelper.getProdDirection(t)??"right_first",label:s()[e],label_leading:s()[i],disabled:n().attrComputer.isConstrained("cut_direction",t)}})))})),Ri((()=>Wr(n())),(()=>{rn(r,n().productItem.getAttribute("cut_direction"))})),$i(),Ss();var g=Eh(),m=vi(g),f=vi(m),v=vi(f),b=t=>{var e=Th(),l=bi(e),h=vi(l),p=yi(h,2),g=vi(p,!0);ti(p),ti(l);var m=yi(l,2),f=vi(m);Fn(f,5,(()=>zr(i)),Vn,((t,e,i)=>{var s=_h();let l;var h=vi(s);yh(h,{get direction(){return zr(e).attr_name}});var d=yi(h,2),c=vi(d,!0);ti(d),ti(s),As(s,((t,e)=>function(t,e){return rn(t,Ur((()=>zr(t)))),e}(a,zr(a)[e]=t)),(t=>zr(a)?.[t]),(()=>[i])),qi((t=>{ls(s,"name",zr(e).attr_name_prod),l=is(s,1,"btn-direction svelte-dxyppo",null,l,t),s.disabled=zr(e).disabled,kn(c,zr(e).label)}),[()=>({active:zr(r)==zr(e).attr_name_prod,disabled:zr(e).disabled})],Si),Tn("click",s,(()=>function(t){t!=zr(r)&&n().attrComputer.isAvailable("cut_direction",t)&&(n().productItem.setAttribute("cut_direction",t),n().cherryPicks.setAttribute("cut_direction",t),o("change"))}(zr(e).attr_name_prod))),Cn(t,s)})),ti(f),ti(m);var v=yi(m,2),b=vi(v),y=vi(b);ns(y,"",{},{"margin-top":"-2px","margin-right":"5px"});var _=yi(y);ti(b);var T=yi(b,2),x=vi(T,!0);ti(T),ti(v),qi((()=>{kn(g,s().select_orientation),kn(_,` ${s().back??""}`),kn(x,s().saveButtonText)})),Tn("click",h,(()=>c(!0))),Tn("click",b,(()=>d(!1))),Tn("click",T,u),Cn(t,e)},y=t=>{var e=wh(),r=bi(e),n=vi(r),o=vi(n),a=vi(o,!0);ti(o);var l=yi(o,2),h=vi(l,!0);ti(l);var d=yi(l,2),u=vi(d,!0);ti(d),ti(n),ti(r);var p=yi(r,2);ns(p,"",{},{"margin-left":"12px"});var g=vi(p);Fn(g,5,(()=>zr(i)),Vn,((t,e)=>{var i=xh(),r=vi(i);yh(r,{get direction(){return zr(e).attr_name},size:50});var n=yi(r,2);Zn(vi(n),(()=>zr(e).label_leading)),ti(n),ti(i),Cn(t,i)})),ti(g),ti(p);var m=yi(p,2),f=vi(m),v=vi(f);ns(v,"",{},{"margin-top":"-2px","margin-right":"5px"});var b=yi(v);ti(f),ti(m),qi((()=>{kn(a,s().winding_and_orientation),kn(h,s().label_winding_indicates_the_direction_desc),kn(u,s().orientation_refers_to_the_placement_label_desc),kn(b,` ${s().back??""}`)})),Tn("click",f,(()=>c(!1))),Cn(t,e)};return $n(v,(t=>{zr(l)?t(y,!1):t(b)})),ti(f),ti(m),ti(g),Tn("keydown",g,(function(t){"Escape"==t.key&&d(!1)})),Cn(t,g),function(t,e,i){var r=Se(t,e);r&&r.set&&(t[e]=i,Li((()=>{t[e]=null})))}(e,"focusOnDirectionElement",p),cn({focusOnDirectionElement:p})}const Sh=["saveButtonText","left","top","bottom","right","back","select_orientation","winding_and_orientation","label_winding_indicates_the_direction_desc","orientation_refers_to_the_placement_label_desc","left_edge_leading","right_edge_leading","top_edge_leading","bottom_edge_leading"];class Oh{constructor(t,e){this._skip=!1,this._editor=e,this._svelte=Ds({component:Ph,target:t,props:{context:this._editor.context,translations:this.getTranslations()}}),this._svelte.$on("change",(()=>this.onChange())),this._svelte.$on("visible",(t=>this.onVisibleChange(t))),this._svelte.$on("continue",(()=>this.onContinue())),this.el=t.firstChild,this._modal=bootstrap.Modal.getOrCreateInstance(this.el,{keyboard:!1,backdrop:"static"})}setVisible(t){t&&!this._editor.context.productItem.getAttribute("cut_direction")&&(this._editor.context.attrComputer.isAvailable("cut_direction","right_first")?this._editor.context.productItem.setAttribute("cut_direction","right_first"):this._editor.context.attrComputer.isAvailable("cut_direction","bottom_first")&&this._editor.context.productItem.setAttribute("cut_direction","bottom_first")),this.changeModalPlacement(this._editor.isLandscapeOrientation()?"top":"bottom"),t?(this.evaluateProduct(),this._modal.show(),this._svelte.focusOnDirectionElement()):this._modal.hide()}onVisibleChange(t){"boolean"==typeof t.detail&&this.setVisible(t.detail)}onChange(){this.evaluateProduct()}evaluateProduct(){this._editor.trigger(a.REQUEST_PRODUCT_ATTR_EVALUATION),this._svelte.$set({context:this._editor.context})}onContinue(){this.setSkip(!0),this._editor.ui.toolPane.saveButtonTool.el.click()}getTranslations(){let t={};return Sh.forEach((e=>{var i;return t[e]=null!==(i=this._editor.model.language[e])&&void 0!==i?i:e})),t}changeModalPlacement(t){let e=this.el.querySelector(".bs5-modal-dialog");this._modal&&e&&(e.style.alignItems=null,"top"==t?e.classList.remove("bs5-modal-dialog-centered"):(e.classList.add("bs5-modal-dialog-centered"),"bottom"==t&&(e.style.alignItems="end")))}canSkip(){return this._skip}setSkip(t){this._skip=t}}class Mh{constructor(t,e){this.selectedBg=Ya.Light,this.selectedMaterial=Eo.Vinyl,t&&Nn(nl,{target:t,props:{translations:{lightText:e.model.language.live_preview.light,darkText:e.model.language.live_preview.dark},onSelectBackground:t=>{this.setNewBackground(t)}}})}onMaterialChanged(t){this.selectedMaterial=t,this.setNewBackground(this.selectedBg)}setNewBackground(t){let e=this.selectedMaterial==Eo.Clear||this.selectedMaterial==Eo.ClearThin?"checkers-"+t:t;document.body.setAttribute("data-editor-background",e),this.selectedBg=t,dispatchEvent(new CustomEvent(a.BACKGROUND_UPDATED))}getSelectedBg(){return this.selectedBg}}class Ch extends ae{constructor(t,e){super(t,e),this._swiping=!1,this._easterEggFound=!1,this._stickyToolPane=!0,this._state=Ch.STATE_TOOLS_OVERVIEW,this._$easteregg=this.editor.$(".easter-egg"),this._materialPresetsTool=new io(e.$(".tool-material-preset"),e),this._noteTool=new no(this.$(".tool.tool-note"),e),this._quantityTool=new lo(this.$(".tool.tool-quantity"),e),this._quantityTool.quantity=String(this.helpers.product.getQuantity()),this._quantityTool.minQuantity=this.model.settings.minQuantity,this._textTool=new ho(e.$(".tool.tool-text"),e),this._cutlineTool=new co(e.$(".tool.tool-cutline"),e),this._templateTool=new uo(this.$(".tool.tool-template"),e),this._templateTypeTool=new po(this.$(".tool.tool-template-type"),e),this._clipartsTool=new mo(e.$(".tool.tool-cliparts"),e),this._stickersTool=new fo(e.$(".tool.tool-stickers"),e),this._uploadTool=new yo(e.$(".tool.tool-upload"),e),this._templatePartTool=new _o(this.$(".tool.tool-parts"),this.editor),this._backgroundTool=new th(e.$(".tool.tool-background"),e),this._saveButtonTool=new nh(this.model.ui.buttonSave?$(this.model.ui.buttonSave):this.editor.$(".btn-save"),e),this._effectLayerTool=new dh(e.$(".tool.tool-effect-layer"),e),this._laminateTool=new ch(e.$(".tool.tool-laminate"),e),this.model.settings.directionToolEnabled&&(this._directionTool=new Oh(document.getElementById("svelte-direction-tool-hook"),this.editor)),this.model.settings.editorBackgroundSelectorEnabled&&(this._editorBackgroundSelector=new Mh(document.querySelector(".editor-background-selector"),e)),this._uploadTool.setAsDefaultUpload(),e.$(".tool.tool-sheet-bg").length&&(this._sheetBGUploadTool=new uh(e.$(".tool.tool-sheet-bg"),e));const i=e.$(".tool.tool-convert-sheet-to-single");this.editor.model.settings.isAdmin&&(null==i?void 0:i.length)&&(this._convertSheetToSingleTool=new ph(i,e)),this.editor.model.settings.backPrintToolEnabled&&(this._backPrintEditorTool=new lh(e.$(".tool.tool-backside-print"),this.editor),this._removeBackPrintTool=new sh(e.$(".tool.tool-backside-print-remove"),this.editor),this._backPrintDealTool=new oh(e.$(".tool.tool-backside-print-deal"),this.editor),this._backPrintDealTextTool=new ah(e.$(".tool.tool-backside-print-deal-text"),e)),this._saveButtonTool.setEnabled(!1),this.addListenerToSVG(p.READY,(t=>this.prepTools())),this.addListenerToSVG(p.CLICK,((t,e)=>this.onClickOutside(t,e))),this.addListenerTo(this.editor.$el.get(),a.OPEN_TOOL,((t,e)=>this.onOpenTool(t,e))),this.addListenerTo(this.editor.$el.get(),a.CLOSE_TOOL,((t,e)=>this.onCloseTool(t,e))),this.addListenerToSVG(a.ORIENTATION_CHANGE,(t=>this.onOrientationChange(t))),this.addListenerToSVG(p.RESIZE,(t=>this.setCurrentToolMaxHeight())),this.addListenerTo(document.body,"click",(t=>this.onBodyClick(t))),this.addListenerToSVG(p.SVG_CHANGE_MODE,((t,e)=>this.onSVGChangeMode(t,e))),this.addListenerToSVG(p.SVG_DESTROYED,(()=>this.stopTools())),this.addListener("click",".panel-confirm .btn-done",(t=>this.onClickOutside(t,!0))),n.isTouchDevice()&&(this.addListener("touchstart",(t=>this.onTouchStart(t))),this.addListener("touchmove",(t=>this.onTouchMove(t))),this.addListener("touchend",(t=>this.onTouchEnd(t))),this.addListenerTo(this.$toolBar.get(0),"touchstart",(t=>this.onTouchStart(t))),this.addListenerTo(this.$toolBar.get(0),"touchmove",(t=>this.onTouchMove(t))),this.addListenerTo(this.$toolBar.get(0),"touchend",(t=>this.onTouchEnd(t)))),this.render()}prepTools(){var t,e,i;this._materialPresetsTool.setEnabled(this.model.settings.materialPresetsSelectorEnabled),this._noteTool.setEnabled(this.model.settings.noteButtonEnabled),this._textTool.setEnabled(this.model.settings.textSelectorEnabled),this._cutlineTool.setEnabled(this.model.settings.cuttinglineSelectorEnabled),this._templateTool.setEnabled(this.model.settings.templatesToolEnabled),this._templateTypeTool.setEnabled(this.model.settings.templateTypesToolEnabled),this._clipartsTool.setEnabled(this.model.settings.clipartSelectorEnabled),this._stickersTool.setEnabled(this.model.settings.stickersSelectorEnabled),this._uploadTool.setEnabled(this.model.settings.uploadEnabled),this._templatePartTool.setEnabled(this.editor.svg.svgSettings.mode==E.MODE_SKIN&&this.model.parts.length>1),this._backgroundTool.setEnabled(this.model.settings.backgroundSelectorEnabled||this.editor.helpers.livePreview.isOn()),this._effectLayerTool.setEnabled(this.model.settings.effectLayerToolEnabled),this._laminateTool.setEnabled(this.model.settings.laminateToolEnabled),null===(t=this._backPrintEditorTool)||void 0===t||t.setEnabled(this.helpers.product.isBackprintPossible()),this.model.settings.isCartFull&&!this.model.id||this._saveButtonTool.maybeEnable(),this.editor.isLandscapeOrientation()&&this.state!=Ch.STATE_TOOL_OPEN&&this._uploadTool.enabled&&this._uploadTool.$el.is(":visible")&&(this._currentTool&&(this._currentTool.visible=!1),this._uploadTool.visible=!0),this.shouldShowLivePreviewOnInit()?null===(e=this.editor.helpers.livePreview)||void 0===e||e.show():null===(i=this.editor.helpers.eventTracker)||void 0===i||i.trackEditorEvent(Js.VIEW_EDIT)}stopTools(){this._stickersTool.listenersActive=!1,this._clipartsTool.listenersActive=!1,this._backgroundTool.listenersActive=!1,this._materialPresetsTool.listenersActive=!1,this._noteTool.listenersActive=!1,this._textTool.listenersActive=!1,this._cutlineTool.listenersActive=!1,this._uploadTool.listenersActive=!1,this._laminateTool.listenersActive=!1,this._saveButtonTool.setEnabled(!1),this._effectLayerTool.setEnabled(!1)}render(){switch(this.state){case Ch.STATE_TOOL_OPEN:this.$el.attr("data-tool",this._currentTool.name),this.$el.removeClass(Ch.STATE_TOOLS_OVERVIEW).addClass(Ch.STATE_TOOL_OPEN),this.editor.$el.removeClass(Ch.STATE_TOOLS_OVERVIEW).addClass(Ch.STATE_TOOL_OPEN),this.$panelToolContent.has(this._currentTool.$content.get(0)).length||this.$panelToolContent.append(this._currentTool.$content),this.$panelToolContent.find(".tool-content").addClass("hidden"),this.editor.$(".tool.active").removeClass("active"),this._currentTool.$el.addClass("active"),this._currentTool.$content.removeClass("hidden"),this.setCurrentToolMaxHeight(),setTimeout((()=>{this._currentTool&&this._currentTool.onTransitionInDone()}),200),this.editor.orientation==wd.ORIENTATION_PORTRAIT&&this.$el.css("bottom","0"),this._effectLayerTool.visible=this._effectLayerTool.enabled&&this._effectLayerTool.requirementsFulfilled(),this._effectLayerTool.disabled=!this.helpers.product.isEffectLayerPossible(),this._effectLayerTool.effectLayerUploadTool.disableDropZone(this._effectLayerTool.disabled);break;case Ch.STATE_TOOLS_OVERVIEW:this.editor.$(".tool.active").removeClass("active"),this.$el.removeClass(Ch.STATE_TOOL_OPEN).addClass(Ch.STATE_TOOLS_OVERVIEW),this.editor.$el.removeClass(Ch.STATE_TOOL_OPEN).addClass(Ch.STATE_TOOLS_OVERVIEW),this.$panelToolContent.find(".tool-content").addClass("hidden"),this._effectLayerTool.$el.addClass("hidden"),this.editor.orientation==wd.ORIENTATION_PORTRAIT?this.$el.css("bottom",this.editor.$("> .tool-bar").outerHeight()+"px"):this.$el.css("bottom","")}}setCurrentToolMaxHeight(){if(this._currentTool){let t=this.$el.height()-this.$footer.outerHeight();this._currentTool.$header.is(":visible")&&(t-=this._currentTool.$header.outerHeight()),this.editor.isLandscapeOrientation()&&(t=t-(parseInt($(".action.btn-container:visible").css("bottom"))||0)-this.$panelToolsOverview.outerHeight()-$(".editor-header").outerHeight()-($(".tool-backside-print-deal:visible").outerHeight()||0)),t-=25,"upload"==this._currentTool.name?this.$uploadToolWrapper.css("max-height",t):this._currentTool.bodyMaxHeight=t,this.editor.isLandscapeOrientation()?this._currentTool.bodyHeight="auto":this._currentTool.bodyHeight=t}}destroy(){super.destroy()}isOpenToolState(){return this.state==Ch.STATE_TOOL_OPEN}static get STATE_TOOLS_OVERVIEW(){return"state-tools-overview"}static get STATE_TOOL_OPEN(){return"state-tool-open"}get $footer(){return this.$(".footer")}get model(){return this.editor.model}get $panelToolsOverview(){return this.$(".panel-tools-overview")}get $panelToolContent(){return this.$(".panel-tool-content")}get $uploadToolWrapper(){return this.$(".upload-wrapper")}get $toolBar(){return this.editor.$("> .tool-bar")}set state(t){this._state=t,this.render()}get state(){return this._state}get quantityTool(){return this._quantityTool}get textTool(){return this._textTool}get backPrintDealTextTool(){return this._backPrintDealTextTool}get uploadTool(){return this._uploadTool}get cutlineTool(){return this._cutlineTool}get backgroundTool(){return this._backgroundTool}get backgroundSelector(){return this._editorBackgroundSelector}get materialPresetsTool(){return this._materialPresetsTool}get clipartsTool(){return this._clipartsTool}get noteTool(){return this._noteTool}get effectLayerTool(){return this._effectLayerTool}get laminateTool(){return this._laminateTool}get removeBackPrintTool(){return this._removeBackPrintTool}set removeBackPrintTool(t){this._removeBackPrintTool=t}get currentTool(){return this._currentTool}get sheetBGTool(){return this._sheetBGUploadTool}get convertSheetToSingleTool(){return this._convertSheetToSingleTool}get directionTool(){return this._directionTool}set swiping(t){this._swiping=t,!0===t?(this.$el.attr("data-swiping","true"),this.$toolBar.attr("data-swiping","true")):(this.$el.attr("data-swiping","false"),this.$toolBar.attr("data-swiping","false"))}get backPrintDealTool(){return this._backPrintDealTool}get swiping(){return this._swiping}get isEasterEggActive(){return this._$easteregg.data("active")}get easterEggHeight(){return this._$easteregg.data("height")}onOpenTool(t,e){if(e.name===bo.EFFECT_LAYER_UPLOAD)return;if(e.name===bo.SHEET_BG_UPLOAD)return;let i=this.state!=Ch.STATE_TOOL_OPEN;this.updateLivePreviewVisibility(e),this._currentTool&&this._currentTool.name!=e.name&&(this._currentTool.onLeave(),this._currentTool.visible=!1),this._currentTool=e,this.state=Ch.STATE_TOOL_OPEN,i&&this.trigger(a.TOOL_PANE_STATE_CHANGE)}updateLivePreviewVisibility(t){var e,i,r;this.editor.model.settings.livePreviewEnabled&&("material-preset"===t.name?null===(e=this.editor.helpers.livePreview)||void 0===e||e.show():(null===(i=this.editor.helpers.livePreview)||void 0===i?void 0:i.isVisible)&&(null===(r=this.editor.helpers.livePreview)||void 0===r||r.hide()))}onCloseTool(t,e){if(this._stickyToolPane&&this.editor.orientation==wd.ORIENTATION_LANDSCAPE)return;let i=this.state!=Ch.STATE_TOOLS_OVERVIEW;e==this._currentTool&&(this._currentTool=null,this.state=Ch.STATE_TOOLS_OVERVIEW,i&&this.trigger(a.TOOL_PANE_STATE_CHANGE),"back"===this.editor.svg.part.getActivePartSide()&&"cliparts"===e.name&&this.editor.ui.setSizeAndOrientation())}onBodyClick(t){this.state==Ch.STATE_TOOL_OPEN&&(this.$el.has(t.target).length||this.$el.is(t.target)||!$(t.target).parents("html").length||$(t.target).hasClass(".tool")||$(t.target).closest(".tool").length||this.onClickOutside())}onClickOutside(t,e,i=!1){(null==e?void 0:e.icon)||(this._currentTool&&this._currentTool.hideOnClickOutside||i&&this._currentTool.name==bo.UPLOAD)&&(this._currentTool.visible=!1)}onOrientationChange(t){this.editor.orientation==wd.ORIENTATION_PORTRAIT&&this._currentTool?this._currentTool.visible=!1:this._currentTool?this._currentTool.visible=!0:this._uploadTool.visible=!0}onTouchStart(t){this._touchStartY=t.touches[0].clientY,this._touchStartX=t.touches[0].clientX}onTouchMove(t){if(this.state==Ch.STATE_TOOL_OPEN)return;let e=t.touches[0].clientY,i=t.touches[0].clientX,r=this._touchStartX-i,n=this._touchStartY-e;Math.abs(r)>Math.abs(n)||(this.isEasterEggActive&&parseInt(this.$el.css("margin-bottom"))<this.easterEggHeight||!this.isEasterEggActive?(t.stopPropagation(),t.preventDefault(),this.swiping=!0,n>0?(n/=2,this.$el.css("margin-bottom",n+"px"),this.$toolBar.css("margin-bottom",n+"px")):(n/=2,this.$el.css("margin-bottom",n/2+"px"),this.$toolBar.css("margin-bottom",n/2+"px"))):!1===this._easterEggFound&&this.isEasterEggActive&&(M.easterEggFound(),this._easterEggFound=!0))}onTouchEnd(t){this.swiping&&(this.swiping=!1)}get backPrintEditorTool(){return this._backPrintEditorTool}get saveButtonTool(){return this._saveButtonTool}onSVGChangeMode(t,e){let i=e.zoomMode;i==c.ZOOM_SHEET?(this.editor.ui.toolPane.materialPresetsTool.setEnabled(this.model.settings.materialPresetsSelectorEnabled),this.editor.ui.toolPane.backgroundTool.setEnabled(this.model.settings.backgroundSelectorEnabled),this.editor.svg.sheet.isCustomizableSheet&&this.onZoomOutCustomizableSheet(),"template"==this.helpers.product.getSheetName()&&(this.uploadTool.visible=!1,this.uploadTool.disableDropZone(!0),this.uploadTool.setEnabled(!1))):i==c.ZOOM_PART&&(this.editor.svg.sheet.isCustomizableSheet&&this.onZoomInCustomizableSheet(),"template"==this.helpers.product.getSheetName()&&(this.uploadTool.disableDropZone(!1),this.uploadTool.setEnabled(!0),this.uploadTool.show()))}onZoomInCustomizableSheet(){var t,e,i;this.editor.ui.toolPane.materialPresetsTool.setEnabled(this.editor.svg.activePart.isSheetBackground),this.editor.ui.toolPane.currentTool instanceof io&&(this.editor.ui.toolPane.uploadTool.visible=!0),this.editor.svg.activePart.isSheetBackground?(this.editor.ui.toolPane.uploadTool.disableDropZone(!0),null===(t=this.editor.ui.toolPane.sheetBGTool)||void 0===t||t.disableDropZone(!1),null===(e=this.editor.ui.toolPane.sheetBGTool)||void 0===e||e.setAsDefaultUpload(),this.editor.ui.toolPane.cutlineTool.setEnabled(!1),this.handleCustomizableModeText("editor-customizable-background-mode-text"),document.getElementById("editor-legend").classList.add("hidden")):this.editor.svg.part.isBackSideActive()?(this.editor.ui.toolPane.uploadTool.disableDropZone(!0),this.editor.ui.toolPane.sheetBGTool.disableDropZone(!1),this.editor.ui.toolPane.sheetBGTool.setAsDefaultUpload(),this.editor.ui.toolPane.cutlineTool.setEnabled(!1)):(this.handleCustomizableModeText("editor-customizable-sticker-mode-text"),document.getElementById("editor-legend").classList.remove("hidden"),this.editor.ui.toolPane.backgroundTool.setEnabled(!0),null===(i=this.editor.ui.toolPane.sheetBGTool)||void 0===i||i.disableDropZone(!0),this.editor.svg.activePart.isMoveable&&this.editor.ui.toolPane.cutlineTool.setEnabled(!0)),this.editor.ui.toolPane.backgroundTool.setTransparentActive(this.editor.svg.part.isStickerActive())}onZoomOutCustomizableSheet(){var t;this.handleCustomizableModeText("editor-customizable-sheet-mode-text"),document.getElementById("editor-legend").classList.remove("hidden"),(this.editor.ui.toolPane.currentTool instanceof th||this.editor.ui.toolPane.currentTool instanceof co)&&(this.editor.ui.toolPane.uploadTool.visible=!0),this.editor.svg.activePart||(this.editor.ui.toolPane.uploadTool.disableDropZone(!1),null===(t=this.editor.ui.toolPane.sheetBGTool)||void 0===t||t.disableDropZone(!1),this.editor.ui.toolPane.uploadTool.setAsDefaultUpload()),this.editor.ui.toolPane.backgroundTool.setTransparentActive(!1)}handleCustomizableModeText(t=""){if(document.querySelectorAll(".editor-customizable-mode-text, .editor-customizable-mode-text-mobile").forEach((t=>{t.classList.add("hidden")})),""!==t){let e=document.getElementById(t),i=document.getElementById(t+"-mobile");null!==e&&e.classList.remove("hidden"),null!==i&&i.classList.remove("hidden")}}shouldShowLivePreviewOnInit(){return this.editor.model.settings.livePreviewEnabled&&"live_preview"==this.editor.model.settings.startUpView}}class Ih{static uniqueID(){return(performance.now()*Math.random()).toString().replace(".","")}}class kh{constructor(t){this.editor_=t}get editor(){return this.editor_}get context(){return this.editor.context}get helpers(){return this.editor.helpers}get settings(){return this.editor.model.settings}get model(){return this.editor.model}get editorSVG(){return this.editor.svg}get editor2(){return this.editor_}}let Nh;function Lh(t,e=500,...i){clearTimeout(Nh),Nh=setTimeout((()=>{t(...i)}),e)}class Dh extends kh{constructor(t){super(t),this.widthEl=this.model.ui.inputWidth?this.editor.el.querySelector(this.model.ui.inputWidth):this.editor.el.querySelector(".summary-width"),this.heightEl=this.model.ui.inputHeight?this.editor.el.querySelector(this.model.ui.inputHeight):this.editor.el.querySelector(".summary-height"),this.widthInput&&this.editorSVG.events.addListenerTo(this.widthEl,"change",(t=>Lh((()=>this.onUpdateMeassure(this.widthInput,"width")),50))),this.heightInput&&this.editorSVG.events.addListenerTo(this.heightInput,"change",(t=>Lh((()=>this.onUpdateMeassure(this.heightInput,"height")),50))),this.editorSVG.events.addListener(p.SVG_PART_SCALING,((t,e)=>this.onSizeChangeBySVG(e.widthMM,e.heightMM))),this.editorSVG.events.addListener(p.SVG_PART_SCALING_DONE,((t,e)=>this.onSizeChangeBySVG(e.widthMM,e.heightMM,!0))),this.editorSVG.events.addListener(p.READY,((e,i)=>{this.currentFormattedDimensions={width:t.svg.size.mmToDisplayable(+this.editor.initWidth),height:t.svg.size.mmToDisplayable(+this.editor.initHeight)},this.render()})),this.editorSVG.events.addListener(a.PRODUCT_ATTR_EVALUATED,(()=>this.onProductAttributesEvaluated()))}render(){this.heightInput?this.heightInput.value=this.context.sizeHelper.height.localized.toString():this.heightEl.textContent=this.context.sizeHelper.height.localized.toString(),this.widthInput?this.widthInput.value=this.context.sizeHelper.width.localized.toString():this.widthEl.textContent=this.context.sizeHelper.width.localized.toString()}get widthInput(){return this.widthEl instanceof HTMLInputElement?this.widthEl:null}get heightInput(){return this.heightEl instanceof HTMLInputElement?this.heightEl:null}get container(){return $(".tool-size")}onUpdateMeassure(t,e){if(!isNaN(t.valueAsNumber)&&this.context.sizeHelper.getSizeByAttribute(e).mm!=this.context.sizeHelper.localizedToMM(t.valueAsNumber)){this.editor.helpers.livePreview.hide(),this.editor.ui.toolPane.saveButtonTool.setEnabled(!1);let i=this.context.sizeHelper.setMeasureAttrLocalized(e,t.valueAsNumber);t.value=this.context.sizeHelper.getSizeByAttribute(e).localized.toString();let r="width"==e?"height_mm":"width_mm",n={[e]:i};this.context.sizeHelper.hasMaxSizeOtherSide()&&i>this.helpers.size.maxSizeOtherSide.mm&&this.context.sizeHelper.getSizeByAttribute(r).mm>this.helpers.size.maxSizeOtherSide.mm&&(this.context.sizeHelper.setMeasureAttrInMM(r,this.helpers.size.maxSizeOtherSide.mm),("width_mm"==r?this.widthInput:this.heightInput).value=this.context.sizeHelper.getSizeByAttribute(r).localized.toString(),n[r]=this.helpers.size.maxSizeOtherSide.mm),this.trackChange(i,e),this.editor.svg.part.change(n),this.editor.trigger(a.REQUEST_PRODUCT_ATTR_EVALUATION),this.editor.helpers.event.requestUpdate()}}trackChange(t,e){const i=this.editor.svg.size.mmToDisplayable(t),r=this.currentFormattedDimensions?this.currentFormattedDimensions[e]:void 0;if(i==r||!r)return;const n="width"===e?Js.CHANGE_WIDTH:Js.CHANGE_HEIGHT;this.editor.helpers.eventTracker.trackEditorChange(n,r,i,!0),this.currentFormattedDimensions[e]=i}createTooltip(){var t;if(!this.container.length)return;const e=new window.bootstrap.Tooltip(this.container,{placement:"top",fallbackPlacements:["auto"],trigger:"manual",container:this.editor.$el,title:()=>{var t;return null!==(t=this.container[0].dataset.bsTitle)&&void 0!==t?t:""}}),i=()=>{e.tip&&e.dispose()};e.show(),this.editor.svg.rootEl.addEventListener("click",i),null===(t=document.querySelector(".editor-modal-content"))||void 0===t||t.addEventListener("click",i),document.addEventListener("keydown",(t=>{"Escape"!==t.key&&27!==t.keyCode||i()}))}sizeDiffers(t,e){return this.widthDiffers(t)||this.heightDiffers(e)}widthDiffers(t){return parseInt(this.editor.initWidth)!==Math.floor(t)}heightDiffers(t){return parseInt(this.editor.initHeight)!==Math.floor(t)}onSizeChangeBySVG(t,e,i){i&&(this.sizeDiffers(t,e)&&!this.editor.model.settings.isAdmin&&this.createTooltip(),t&&(this.trackChange(t,"width"),this.context.sizeHelper.setMeasureAttrInMM("width_mm",t)),e&&(this.trackChange(e,"height"),this.context.sizeHelper.setMeasureAttrInMM("height_mm",e)),this.editor.helpers.event.requestUpdate(0)),this.render()}onProductAttributesEvaluated(){if(this.widthInput&&(this.widthInput.min=this.context.sizeHelper.minSize.localized.toString(),this.widthInput.max=this.context.sizeHelper.maxSize.localized.toString()),this.heightInput&&(this.heightInput.min=this.context.sizeHelper.minSize.localized.toString(),this.heightInput.max=this.context.sizeHelper.maxSize.localized.toString()),this.editorSVG.activePart&&"front"==this.editorSVG.activePart.side){let t=this.context.sizeHelper.width.mm,e=this.context.sizeHelper.height.mm;if(t&&e){let i=Math.abs(this.editorSVG.activePart.width-t),r=Math.abs(this.editorSVG.activePart.height-e);(i>1||r>1)&&this.editor.svg.part.change({width:t,height:e})}}}}class Bh extends kh{constructor(t){super(t),this.editorSVG.events.addListener(p.READY,(t=>{this.renderPrices(this.model.charge.compoundValues,this.model.charge.total)})),this.editorSVG.events.addListener(a.UPDATED,((t,e)=>{this.renderPrices(e.charge.compoundValues,e.charge.total)}))}renderPrices(t,e){let i=document.getElementsByClassName("price_details")[0];i.innerHTML="",Object.entries(t).forEach((t=>{const[e,r]=t;let n=document.createElement("span");n.classList.add("bs5-d-flex"),n.classList.add("bs5-justify-content-between");let s=document.createElement("span");s.id=e,s.textContent=e,n.appendChild(s);let o=document.createElement("span");o.textContent=r,n.appendChild(o),i.appendChild(n)}));let r=document.getElementsByClassName("summary-total price");for(let t=0;t<r.length;t++)r[t].innerHTML=e;let n=document.getElementsByClassName("backprint_price_portrait")[0];this.helpers.product.hasBackprint()?null==n||n.classList.remove("hidden"):null==n||n.classList.add("hidden")}}class Rh extends r{constructor(t,e){super(t),this._settingSizeAndOrientation=!1,this._currentlyFocusing=!1,this.showLivePreviewTools=!0,this._editor=e;let i=new CustomEvent("initValidator",{bubbles:!0});document.body.dispatchEvent(i),this.updateLivePreviewToolsVisibility()}destroy(){this.uploadTool.destroy(),this.toolPane.effectLayerTool.destroy(),this._toolpane.destroy()}$(t){return this.editor.$(t)}on(t,e,i){return this.editor.on(t,e,i)}init(){this.prepModel(),this.prepView(),this.prepController()}prepModel(){this.model.ui||(this.model.ui={})}prepView(){this.editor.el.querySelector(".tool-size")&&(this.sizeTool=new Dh(this.editor)),this.price=new Bh(this.editor),this.editor.$el.removeClass("hidden"),this.setSizeAndOrientation(),this._toolpane=new Ch(this.$(".tool-pane"),this.editor),this._$h1=this.$(".editor-header h1"),this._notificationTool=new le(this.$("section.editor-notifications"),this.editor),this.$("[class*=f-col] .content.input").each((function(){let t=$(this).find("label"),e=$("#"+t.attr("for"));if(t.length&&!e.length){let e=$(this).find("input");e.length&&(e.attr("id")||e.attr("id",Ih.uniqueID()),t.attr("for",e.attr("id")),e.on("focus",(function(){e.closest("[class*=f-col]").addClass("focus")})),e.on("blur",(function(){e.closest("[class*=f-col]").removeClass("focus")})))}}))}prepController(){this.editor.svg.events.addListenerTo(this.$el.get(),"click",".tool-emojis",(()=>this.helpers.emoji.fixEmoji())),this.editor.svg.events.addListenerTo(this.$el.get(),"click",".btn-save-sticker",(t=>(this.editor.svg.zoomHelper.zoomOut(),t.preventDefault()))),this.editor.svg.events.addListenerTo(this.$el.get(),"click",".btn-save-case",(()=>this.editor.svg.select.deselect())),this.editor.svg.events.addListenerTo(this.$el.get(),"click",".btn-save-skin",(()=>this.editor.svg.select.deselect())),this.editor.svg.events.addListenerTo(this.$el.get(),"click",".tool-fill-sheet:not(.disabled)",(()=>this.onFillSheet())),this.editor.svg.events.addListenerTo(this.$el.get(),"click",".btn-edit",(()=>this.editor.svg.preview.turnOff())),this.editor.svg.events.addListenerTo(this.$el.get(),"click",".tool-empty-sheet",(t=>this.onClickEmptySheet(t))),this.editor.svg.events.addListenerTo(this.$el.get(),"shown.bs.modal",".modal-editor",(t=>this.onShowModal(t))),this.editor.svg.events.addListener(p.DESELECT_NODE,((t,e)=>(this.$(".tool-fill-sheet").addClass("disabled"),this.$(".tip-template").hide()))),this.editor.svg.events.addListener(p.SELECT_NODE,((t,e)=>this.onSelectNode(e))),this.editor.svg.events.addListener(p.ZOOM_CHANGE,(t=>this.onEditorZoomChange(t.zoomMode))),this.editor.svg.events.addListener(p.PREVIEW_MODE_OFF,(()=>this.renderPreviewOff())),this.editor.svg.events.addListener(p.PREVIEW_MODE_ON,(()=>this.renderPreviewOn())),this.editor.svg.events.addListener(p.RESIZE,(t=>this.setSizeAndOrientation())),this.editor.svg.events.addListenerTo(this.toolPane.$el.get(),a.TOOL_PANE_STATE_CHANGE,(t=>this.onEditorToolPaneStateChange(t))),this.editor.svg.events.addListenerTo(this.$homeButton.get(),"click",(t=>this.onHomeClick(t))),this.editor.svg.events.addListenerTo(this.$el.get(),"focus focusout","textarea, input",(t=>this.onFocusEvent(t))),this.editor.svg.events.addListenerTo(this.$el.get(),"click",".tool.tool-close",(t=>{this.closeEditor((()=>this.helpers.eventTracker.trackEditorEvent(Js.CLOSE)))})),this.editor.svg.events.addListenerTo(this.$el.get(),"change",".tool.tool-size",(t=>this.editor.trigger(a.PART_EDITED,{edited:"size"}))),this.editor.svg.events.addListener(p.TEXT_SELECTED,((t,e)=>this.setText(e.getTextAsJson()))),this.editor.svg.events.addListener(p.TEXT_EDIT,((t,e)=>this.setText(e.getTextAsJson(),!0))),this.editor.svg.events.addListenerTo(this.$previewBtn.get(),"click",(t=>{this.prepPreviewBtnController()})),this.editor.svg.events.addListenerTo(this.$editBtn.get(),"click",(t=>{var e;null===(e=this.editor.helpers.livePreview)||void 0===e||e.hide()})),document.addEventListener("keyup",(t=>{"Escape"===t.key&&(this.showLivePreviewTools=!this.showLivePreviewTools,this.updateLivePreviewToolsVisibility())}))}prepPreviewBtnController(){var t,e,i,r,n;null===(t=this.editor.ui.toolPane.backPrintEditorTool)||void 0===t||t.deselectActiveButton(),null===(e=this.editor.ui.toolPane.backPrintEditorTool)||void 0===e||e.selectActiveButton("front"),this.editor.svg.select.deselect(),null===(r=null===(i=this.editor.ui.toolPane)||void 0===i?void 0:i.backPrintEditorTool)||void 0===r||r.handleOnSelectFront(),this.editor.svg.events.trigger(a.SWITCH_SIDE,"front"),null===(n=this.editor.helpers.livePreview)||void 0===n||n.show()}setLivePreviewToolsVisibility(t){this.showLivePreviewTools=t,this.updateLivePreviewToolsVisibility()}updateLivePreviewToolsVisibility(){var t,e;this.showLivePreviewTools?this.$(".editor-live-preview-tools").removeClass("hidden"):this.$(".editor-live-preview-tools").addClass("hidden"),null===(e=null===(t=this.editor.helpers)||void 0===t?void 0:t.livePreview)||void 0===e||e.updateToolsVisibility(this.showLivePreviewTools)}setTitle(t){this._$h1.text(t)}closeEditor(t=()=>{}){this.editor.isModal?this.model.settings.askBeforeExit&&this.editor.helpers.change.isChanged2()?s.instance.confirmOrCancel(this._editor.model.language.unload_warning,(()=>{t(),m._instance.hide()})):(t(),m._instance.hide()):(t(),window.location.href="/")}repositionTooltipsAndPopovers(){this.showTemplateTip(!0)}showTemplateTip(t=!1){if(this.$(".tip-template").length){let e=this.editor.svg.part.getTopLeftPart();if(e){let i=this.editor.$el.get(0).getBoundingClientRect();t||(this.editor.svg.select.select(this.editor.svg.node.getNodeById(e.part_id)),this.$(".tip-template").removeClass("hidden")),this.$(".tip-template").css({top:e.point1.y-this.$(".tip-template").height()/2-50-i.top+"px",left:e.point2.x-this.$(".tip-template").width()/2+36-i.left+"px"})}}}setSizeAndOrientation(){var t,e;if(this._settingSizeAndOrientation)return;this._settingSizeAndOrientation=!0;let i=this.editor.isEmbededInModal()?this.editor.$editorModal.width():this.editor.$el.outerWidth(),r=this.editor.isEmbededInModal()?this.editor.$editorModal.height():this.editor.$el.outerHeight(),n=this.editor.orientation;this.editor.orientation=wd.isLandscape(i,r)?wd.ORIENTATION_LANDSCAPE:wd.ORIENTATION_PORTRAIT,wd.isLarge(i,r)?(this.editor.$el.addClass(wd.SIZE_LARGE),this.editor.svg.svgSettings.fontSize=22):(this.editor.$el.removeClass(wd.SIZE_LARGE),this.editor.svg.svgSettings.fontSize=15),this.editor.orientation===wd.ORIENTATION_PORTRAIT?this.handlePortraitSizeChange():this.handleLandscapeSizeChange(),(null===(e=null===(t=this.editor.svg)||void 0===t?void 0:t.root)||void 0===e?void 0:e.element)&&this.editor.svg.margin.setMargin(this.formatSVGMargin()),this.editor.svg.trigger(a.ORIENTATION_UPDATE,{isLandscape:this.editor.isLandscapeOrientation(),isLarge:this.editor.isLargeMode()}),this.editor.orientation!=n&&this.editor.svg.trigger(a.ORIENTATION_CHANGE,{isLandscape:this.editor.isLandscapeOrientation(),isLarge:this.editor.isLargeMode()}),this._settingSizeAndOrientation=!1}handleLandscapeSizeChange(){this.$(".tool-backside-print.appended").is(":visible"),this.$(".editor-spinner").css("bottom","0"),this.$("> .tool-pane").css("bottom",""),this.$(".editor-container").css("bottom","0"),this.editor.helpers.livePreview.container.style.bottom="0",this.$(".editor-container").css("padding-top",""),this.$(".editor-container").css("padding-bottom","0px");const t=0!=this.editor.container.offsetWidth?this.editor.container.offsetWidth:this.editor.helpers.livePreview.container.offsetWidth;this.$(".tool-backside-print.appended").css("width",t+"px");const e=(0!==this.editor.container.offsetWidth?this.editor.container:this.editor.helpers.livePreview.container).getBoundingClientRect(),i=e.right;this.$(".editor-live-preview-tools").css("right",window.innerWidth-i+"px"),this._notificationTool&&this._notificationTool.$el.css("width",`${e.right}px`),this.editor.helpers.livePreview.container.style.top="0px",this.editor.helpers.livePreview.container.style.padding="0px"}handlePortraitSizeChange(){let t=0;this.$(".tool-backside-print.appended").is(":visible")&&(t=this.$(".tool-backside-print.appended").heightInt()+parseInt(this.$(".tool-backside-print.appended").css("top"))-$(".editor-header").heightInt());const e=0!=this.editor.container.offsetWidth?this.editor.container.offsetWidth:this.editor.helpers.livePreview.container.offsetWidth;if(this.$(".tool-backside-print.appended").css("width",e+"px"),this.editor.isModal||(t-=$(".navbar-header").heightInt()),this.$(".editor-container").css("padding-top",t-10+"px"),this._toolpane&&this._toolpane.state!=Ch.STATE_TOOL_OPEN){let t=this.$(".tool-pane").heightInt()+this.$("> .tool-bar").heightInt();t!=parseFloat(this.$(".editor-container").css("bottom"))&&(this.$(".editor-container").css("bottom",t+"px"),this.editor.helpers.livePreview.container.style.bottom=t+"px",this.$(".editor-spinner").css("bottom",t+"px"),this.$("> .tool-pane").css("bottom",this.editor.$("> .tool-bar").outerHeight()+"px"),this.$(".editor-container").css("padding-bottom",""),$(window).trigger("resize"))}this.editor.helpers.livePreview.container.style.top="55px",this.editor.helpers.livePreview.container.style.padding="20px"}formatSVGMargin(){return this.editor.orientation==wd.ORIENTATION_PORTRAIT?"8 8 8 8 8 8 8 8":"8 8 108 8 8 8 8 8"}showSpinner(){this.$(".editor-spinner").removeClass("hidden")}hideSpinner(){this.$(".editor-spinner").addClass("hidden")}renderPreviewOff(){this.editor.$el.removeClass("preview-on").addClass("preview-off"),this.$(".visible-preview").hide()}renderPreviewOn(){this.editor.$el.removeClass("preview-off").addClass("preview-on"),this.$(".visible-preview").show()}save(){this.editor.trigger(a.SAVE)}setText(t,e=!1){if("back_deal"==this.editor.svg.part.getActivePartSide()?this.backPrintDealtextTool.setTextByJSON(t):this.textTool.setTextByJSON(t),e){let t=this.editor.svg.part.getActivePartSide();this.editor.isLandscapeOrientation()||("back_deal"===t?this.editor.ui.backPrintDealtextTool.show():this.editor.ui.textTool.show())}}showError(t){this.$messages.prepend('<div class="alert alert-danger upload">'+t+"</div>"),this.$uploadMessages.delay(8e3).fadeOut("fast")}showMessage(t,e,i,r){this._notificationTool.add(t,e,i,r)}hideMessage(t){this._notificationTool.remove(t)}highlightMessageSender(t){this.editor.svg.dpi.highlight(t)}getCurrentMediaSize(){return i}uploadFile(){this.uploadTool.open()}get $previewBtn(){return this.editor.$(".btn-preview")}get $editBtn(){return this.editor.$(".btn-edit")}get $saveBtn(){return this.editor.$(".btn-save")}get $homeButton(){return this.$(".editor-header .cta.home")}get uploadTool(){return this.toolPane.uploadTool}get $messages(){return this.$("section.messages")}get $uploadMessages(){return this.$("section.messages .upload")}get quantity(){return parseInt(this._toolpane.quantityTool.quantity)}get editor(){return this._editor}get editor2(){return this._editor}get model(){return this.editor.model}get textTool(){return this._toolpane.textTool}get backPrintDealtextTool(){return this._toolpane.backPrintDealTextTool}get toolPane(){return this._toolpane}get $fileupload(){return this.$("input.fileupload")}get currentlyFocusing(){return this._currentlyFocusing}get notificationTool(){return this._notificationTool}get $quantitySelector(){return $(".form-control.quantity-selector")}get helpers(){return this.editor.helpers}onEditorZoomChange(t){"sheet"==t?this.editor.$el.removeClass("zoomed"):this.editor.$el.addClass("zoomed")}onSelectNode(t){t.isSheetBackground||$(".tool-fill-sheet").removeClass("disabled")}onFillSheet(){$("#overlay").fadeIn("fast",(()=>{this.$(".tool-fill-sheet").hasClass("template")?(this.editor.svg.part.copyPartContent(!1,!0,!0),$("#overlay").hide()):this.helpers.fill.fill((()=>{$("#overlay").hide()}))}))}onClickEmptySheet(t){s.instance.confirmOrCancel(this.model.language.empty_sheet,(()=>(this.editor.svg.sheetHelper.clearSheet(),this.editor.svg.select.deselect())))}onShowModal(t){"phone"!=i&&($(".modal-backdrop").hide(),$(".modal.editor").not(t.currentTarget).modal("hide"))}onEditorToolPaneStateChange(t){switch(this.toolPane.state){case Ch.STATE_TOOLS_OVERVIEW:this.$homeButton.addClass("disabled");break;case Ch.STATE_TOOL_OPEN:this.$homeButton.removeClass("disabled")}this.editor.isLandscapeOrientation()}onHomeClick(t){this.toolPane.currentTool&&this.toolPane.currentTool.$backButton.trigger("click")}onFocusEvent(t){"focusout"!=t.type?this._currentlyFocusing=!0:this._currentlyFocusing=!1}}class $h extends kh{exportAndDetectChanges(){let t=this.exportSheet();return this.helpers.product.getChanged()||this.helpers.product.setChanged(this.helpers.change.isChanged()?1:0),t}exportAndSanitizeData(t){let e=this.exportAndDetectChanges();return e.hasCollage=null!=this.editorSVG.collage,e.productItem=JSON.stringify(this.context.productItem),e.id=this.model.id,e.intent=t,e.lang=this.model.settings.lang,this.editor.model.settings.livePreviewEnabled&&(e.previewData=this.editor.helpers.livePreview.exportLivePreviewData()),e}exportSheet(){return{sheet:this.helpers.product.formatToOrderSheet(),parts:this.editorSVG.export.exportParts()}}}class jh extends kh{isTooManyImages(){var t,e=this;if(null!=this.editor_.svg.collage){if(null==this.editor_.svg.activePart||this.editor_.svg.collage.getPart().intId!=this.editor_.svg.activePart.intId)return!1;if($(null===(t=this.editorSVG.element)||void 0===t?void 0:t.getElementsByTagName("image")).map((function(){for(var t=$(this),i=$(this).parent(),r=0;r<5;r++){if(i.is($(e.editor_.svg.collage.element)))return $(t).attr("xlink:href");i=i.parent()}})).get().length>=this.editor_.svg.collage.getColParts().length)return!0}return!1}}class qh{constructor(){this.nodeUrl="",this.toolsUrl="",this._sharpMimeTypes=["image/jpeg","image/png","image/tiff","image/webp","image/svg+xml","image/gif","image/avif"],o.isProd()?(this.nodeUrl="https://node.fileapp.io",this.toolsUrl="https://tools.fileapp.io"):(this.nodeUrl="https://node.fileapp.xyz",this.toolsUrl="https://tools.fileapp.xyz")}getThumbnail(t,e,i="default",r){let n=new XMLHttpRequest,s=`${this.nodeUrl}/thumb/${t}?size=${i}`;n.addEventListener("load",(function(){if(200!==n.status)return r(null);let t=JSON.parse(n.response);r(t)})),n.open("GET",s),n.setRequestHeader("Content-Type","application/json"),n.send()}getContainerizedOutline(t,e){let i=new XMLHttpRequest,r={json:t};i.addEventListener("load",(t=>{e(t)})),i.open("POST",`${this.toolsUrl}/outline`),i.setRequestHeader("Content-Type","application/json"),i.setRequestHeader("X-Auth","HsPLnj9EBpX3t9ACqYCiBiyQ"),i.send(JSON.stringify(r))}getOffsetPath(t,e){let i=new FormData;for(const e in t)i.append(e,t[e]);fetch(this.toolsUrl+"/path/offset",{method:"POST",body:i}).then((t=>t.json())).then((t=>{e(t.innerPaths,t.outerPaths)})).catch((t=>{}))}static getRegionFromSvg(t){let e=null,i=/fileapp_region="(.*?)"/.exec(t);return i&&i[1]&&(e=i[1]),e}}var Vh=function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function o(t){try{l(r.next(t))}catch(t){s(t)}}function a(t){try{l(r.throw(t))}catch(t){s(t)}}function l(t){t.done?n(t.value):function(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(o,a)}l((r=r.apply(t,e||[])).next())}))};class Fh extends kh{constructor(t){super(t),this.outlineSmoothing=3,this.outlinePadding=15,this.outlineCornerless=1,this.outlineImageSize=500,this.outlineSmoothingText=5,this.outlinePaddingText=50,this.outlineCornerlessText=2,this.editor.svg.overridables.outlinePartFn=this.outlinePart.bind(this),this.editor.svg.overridables.outlineImageFn=this.outlineImage.bind(this),this.editor.svg.overridables.offsetPathFn=this.offsetPath.bind(this)}jsonSettings(t){t.smoothing&&(this.outlineSmoothing=t.smoothing),t.padding&&(this.outlinePadding=t.padding),t.cornerless&&(this.outlineCornerless=t.cornerless),t.imageSize&&(this.outlineImageSize=t.imageSize)}buildJsonSettings(t){return"path-new-x"===t?{size:String(this.editor.$("[name=new-outline-size]").val()),threshold1:String(this.editor.$("[name=new-outline-threshold1]").val()),gaussian:String(this.editor.$("[name=new-outline-gaussian]").val()),k:String(this.editor.$("[name=new-outline-k]").val()),a:String(this.editor.$("[name=new-outline-a]").val()),O:String(this.editor.$("[name=new-outline-O]").val()),expand:String(this.editor.$("[name=new-outline-expand]").val()),contract:String(this.editor.$("[name=new-outline-contract]").val()),keep:this.editor.$("[name=new-outline-keep]").is(":checked"),auto:this.editor.$("[name=new-outline-auto]").is(":checked"),overcut:this.editor.$("[name=new-outline-overcut]").is(":checked"),padding:this.editor.$("[name=new-outline-padding]").is(":checked"),findEmbedded:this.editor.$("[name=new-outline-findEmbedded]").is(":checked"),expandEmbedded:String(this.editor.$("[name=new-outline-expandEmbedded]").val()),contractEmbedded:String(this.editor.$("[name=new-outline-contractEmbedded]").val()),gaussianEmbedded:String(this.editor.$("[name=new-outline-gaussianEmbedded]").val()),kEmbedded:String(this.editor.$("[name=new-outline-kEmbedded]").val())}:Object.assign(Object.assign({},{size:"800",threshold1:"200",gaussian:"2",k:"0.5",a:"1.2",O:"0.1",expand:"2.9",contract:"0.1",keep:!1,auto:!0,overcut:!1,padding:!0,findEmbedded:!1,contractEmbedded:"0",expandEmbedded:"0",gaussianEmbedded:"0",kEmbedded:"0.9"}),{"path-s":{gaussian:"1",expand:"1.7"},"path-l":{gaussian:"3",expand:"4"}}[t]||{})}outlineSvg(t,e,i,r,n){r=void 0===r?"path-m":r,this.helpers.product.setOutline(r);for(var s=t.partGroupNode.element.getBBox(),o=this.outlineImageSize/s.height,a=new XMLSerializer,l="",h=t.partGroupNode.children,d=h.length-1;d>=0;d--)l+=a.serializeToString(h[d].element);var c=(l=(l=l.replace(/xlink:href=/g,'xmlns:xlink="'+u.XLINK+'" xlink:href=')).replace(/ href=/g," xlink:href=")).indexOf('xmlns:xlink="http://www.w3.org/1999/xlink"'),p=l.lastIndexOf('xmlns:xlink="http://www.w3.org/1999/xlink"');if(c!=p){var g=l.substring(0,p),m=l.substring(p+42);l=g+m}for(var f=l.match(/<(.*?)>/g),v=0;v<f.length;v++)if(2==f[v].split('xmlns:xlink="http://www.w3.org/1999/xlink"').length-1){var b=f[v],y=f[v].indexOf('xmlns:xlink="http://www.w3.org/1999/xlink"'),_=f[v].substring(0,y)+" "+f[v].substring(y+42);l=l.replace(b,_)}l='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+(l='<g transform="scale('+o+", "+o+") translate("+-s.x+", "+-s.y+') ">'+l+"</g>")+"</svg>";let T=s.height*o/t.height;const x={fileappId:!1};x.host=window.location.hostname,x.svg=l,x.x=String(Math.round(s.x*o)),x.y=String(Math.round(s.y*o)),x.width=String(Math.round(s.width*o)),x.height=String(Math.round(s.height*o)),x.widthmm=String(Math.round(t.width)),x.heightmm=String(Math.round(t.height)),x.px2mm=String(T),x.type="svg",x.bgcolor=n,x.settings=this.buildJsonSettings(r),(new qh).getContainerizedOutline(x,(i=>{let r=JSON.parse(i.target.responseText),n=r.rect,a=("embedded"in r&&r.embedded,"embeddedTransform"in r&&r.embeddedTransform,r.paths[0].path),l=this.editorSVG.createSVGMatrix();l=l.multiply(t.partGroupNode.element.transform.baseVal.getItem(0).matrix),l=l.translate(s.x,s.y),l=l.scale(1/o);let h=this.editor.svg.path.transformByMatrix(a,l).toString();n?e(h,!0):e(h)}))}outlineImg(t,e,i,r,n,s,o,a){if(this.helpers.product.setOutline("image"),0==t.indexOf("data:",0))return void a(null,null);let l=window.location.protocol+"//"+window.location.host,h=new URL(t,l);var d={fileappId:!1};d.host=window.location.hostname,d.folder=h.pathname.substring(1,h.pathname.lastIndexOf("/")+1),d.file=h.pathname.substring(h.pathname.lastIndexOf("/")+1),d.x=String(0),d.y=String(0),d.width=String(e),d.height=String(i),d.widthmm=String(parseInt(n)),d.heightmm=String(parseInt(s)),d.px2mm=r.toString(),d.type="img",d.settings={},d.settings.size=String(800),d.settings.threshold1=String(200),d.settings.gaussian=String(1),d.settings.k=String(.5),d.settings.a=String(1.2),d.settings.O=String(.1),d.settings.expand=String(3),d.settings.contract=String(.1),d.settings.keep=!1,d.settings.auto=!0,d.settings.overcut=!1,d.settings.padding=!0,d.settings.findEmbedded=!0,d.settings.contractEmbedded=String(0),d.settings.expandEmbedded=String(0),d.settings.gaussianEmbedded=String(0),d.settings.kEmbedded=String(.9),d.bgcolor=o;let c=t.split("/")[4].split("_")[0],u=new qh;d.fileappId=c,u.getContainerizedOutline(d,(t=>{let e=JSON.parse(t.target.responseText);if(console.debug(e),e.rect)a(null,null);else{let t=e.paths?e.paths[0].path:null;a(t,e.paths)}}))}offsetPath(t,e){return new Promise((i=>{if(e){let r=jt.bleedMMToPX(e);(new qh).getOffsetPath({path:t,px:r},((t,e)=>{i({inner:t.join(""),outer:e.join("")})}))}else i({inner:null,outer:null})}))}outlineImage(t,e){return new Promise((i=>Vh(this,void 0,void 0,(function*(){let r={path:null,type:e.part_type,backgroundColor:null},n=0;n=e.height/t.imageHeight>e.width/t.imageWidth?t.imageHeight/e.height:t.imageWidth/e.width,r.backgroundColor=yield this.helpers.canvas.getBackgroundColorOnImage(t),this.outlineImg(t.link,t.imageWidth,t.imageHeight,n,e.width,e.height,r.backgroundColor,((t,e)=>{r.path=t,i(r.path?r:null)}))}))))}outlinePart(t,e){return new Promise((i=>Vh(this,void 0,void 0,(function*(){e.startsWith("path")&&(yield this.editor.helpers.canvas.setHiddenCanvas()),this.helpers.canvas.getBackgroundColor(this.editor.ui.toolPane.cutlineTool.canvas,(r=>{let n={path:null,type:t.part_type,backgroundColor:r};this.outlineSvg(t,((t,e)=>{n.path=t,i(n.path?n:null)}),t.isJustText(),e,r)}))}))))}}class Hh{constructor(t,e,i,r,n){this.p1=n.element.createSVGPoint(),this.p1.x=t,this.p1.y=e,this.p2=n.element.createSVGPoint(),this.p2.x=i,this.p2.y=r,this.children=[],this.children[0]=null,this.children[1]=null,this.children[2]=null,this.children[3]=null,this.free=!0}}class zh extends kh{constructor(){super(...arguments),this.maxGridWidth_=null,this.maxGridHeight_=null,this.gridWidth_=null,this.gridHeight_=null,this.nodeCounter_=0,this.notFreeCounter_=0,this.checkingNodesCounter_=0,this.freeCounter_=0}fill(t=null){null!=this.editor.svg.selected?this.gridFill(this.editor.svg.selected,t):(this.editor.ui.showMessage(4,2,this.editor.helpers.message.getId(),"Nothing selected"),t&&t())}gridFill(t,e){this.nodeCounter_=0,this.notFreeCounter_=0,this.checkingNodesCounter_=0,this.freeCounter_=0,this.maxGridWidth_=t.boundingBox.width/10,this.maxGridHeight_=t.boundingBox.height/10;var i=new Hh(0,0,this.editor_.svg.sheet.boundingBox.width,this.editor_.svg.sheet.boundingBox.height,this.editor_.svg.root);this.makeTree(i),this.checkIfFree(i);for(var r,n=1,s=1,o=1;s<this.nodeCounter_;)n++,s+=o*=4;r=Math.pow(2,n);var a=this.editor_.svg.sheet.boundingBox.width/r,l=this.editor_.svg.sheet.boundingBox.height/r,h=Math.ceil(t.boundingBox.width/a),d=Math.ceil(t.boundingBox.height/l),c=[];this.treeToGrid(i,c,0,0,n);for(var u=0;u<r;u++)for(var p=0;p<r;p++)if(c[u][p].free){for(var g=!0,m=0;m<h;m++){for(var f=0;f<d;f++){if(u+m>=r||p+f>=r){g=!1;break}if(!c[u+m][p+f].free){g=!1;break}}if(!g)break}if(g){this.freeCounter_++;var v=new Array;for(v.x=c[u][p].p1.x,v.y=c[u][p].p1.y,this.editorSVG.node.copy(t,v),m=0;m<h;m++)for(f=0;f<d;f++)c[u+m][p+f].free=!1}}void 0!==e&&e()}treeToGrid(t,e,i,r,n){n--;var s=Math.pow(2,n);if(null==t.children[0])return void 0===e[i]&&(e[i]=new Array),void(e[i][r]=t);this.treeToGrid(t.children[0],e,i,r,n),this.treeToGrid(t.children[1],e,i+s,r,n),this.treeToGrid(t.children[2],e,i,r+s,n),this.treeToGrid(t.children[3],e,i+s,r+s,n)}makeTree(t){this.nodeCounter_++;var e=t.p1.x,i=t.p1.y,r=(t.p1.x+t.p2.x)/2,n=t.p1.y,s=(t.p2.x,t.p1.y,t.p1.x),o=(t.p1.y+t.p2.y)/2,a=(t.p1.x+t.p2.x)/2,l=(t.p1.y+t.p2.y)/2,h=t.p2.x,d=(t.p1.y+t.p2.y)/2,c=(t.p1.x,t.p2.y,(t.p1.x+t.p2.x)/2),u=t.p2.y,p=t.p2.x,g=t.p2.y;t.children[0]=new Hh(e,i,a,l,this.editor_.svg.root),t.children[1]=new Hh(r,n,h,d,this.editor_.svg.root),t.children[2]=new Hh(s,o,c,u,this.editor_.svg.root),t.children[3]=new Hh(a,l,p,g,this.editor_.svg.root),r-e>this.maxGridWidth_&&o-i>this.maxGridHeight_&&(this.makeTree(t.children[0]),this.makeTree(t.children[1]),this.makeTree(t.children[2]),this.makeTree(t.children[3]))}fillFree(t){var e=it.createElement("rect");e.setAttribute("x",t.p1.x),e.setAttribute("y",t.p1.y),e.setAttribute("width",(t.p2.x-t.p1.x).toString()),e.setAttribute("height",(t.p2.y-t.p1.y).toString()),e.setAttribute("stroke","black"),e.setAttribute("stroke-width","0.5"),e.setAttribute("fill","none"),t.free,$("#svgroot").append(e),null!=t.children[0]&&this.fillFree(t.children[0]),null!=t.children[1]&&this.fillFree(t.children[1]),null!=t.children[2]&&this.fillFree(t.children[2]),null!=t.children[3]&&this.fillFree(t.children[3])}checkIfFree(t){this.checkingNodesCounter_++;for(var e=this.editor_.svg.sheet.parts,i=0;i<e.length;i++)if(!(e[i].boundingBox.x+e[i].boundingBox.width<t.p1.x||e[i].boundingBox.x>t.p2.x||e[i].boundingBox.y+e[i].boundingBox.height<t.p1.y||e[i].boundingBox.y>t.p2.y||e[i].isSheetBackground)){t.free=!1,this.notFreeCounter_++;break}t.free||(null!=t.children[0]&&this.checkIfFree(t.children[0]),null!=t.children[1]&&this.checkIfFree(t.children[1]),null!=t.children[2]&&this.checkIfFree(t.children[2]),null!=t.children[3]&&this.checkIfFree(t.children[3]))}}class Uh extends kh{constructor(){super(...arguments),this.id=0}getId(){return this.id++,this.id}}class Gh extends kh{constructor(t){super(t),this._partsLoaded=0,this._totalParts=0,this._$form=$('<form id="figure-template" class="hidden" method="post"></form>'),$("body").append(this._$form),this._$form.attr("action",t.model.settings.postURL),this.editorSVG.events.addListener(a.INITIATED,(t=>this.onEditorInit())),this._$form.on("submit",(()=>this.onSubmit()))}submit(){if(this.editor.isModal){let t={},e=this._$form.serializeArray();for(let i in e)t[e[i].name]=e[i].value;$.ajax(this.editor.model.settings.postURL,{data:t,method:"POST",success:e=>{this.helpers.change.isChanged(!0),$("#overlay").hide(),this.editor.trigger(a.DATA_POSTED,{request:t,response:e})},error:function(t){$("#connection-error").modal("show"),$("#overlay").hide()}})}else this._$form.trigger("submit")}findImageNodeAndMergeWithParentMatrix(t){let e=this.findImage(t),i=e.element.transform.baseVal.consolidate().matrix;for(;e;)e.parent.element.transform.baseVal.numberOfItems>0&&(i=e.parent.element.transform.baseVal.consolidate().matrix.multiply(i)),e="Part"==e.type?null:e.parent;return i}findImage(t){if("ShapeImage"==(null==t?void 0:t.type))return t;if(null==t?void 0:t.children.length){let e=null;return $(t.children).each(((t,i)=>{let r=this.findImage(i);e||(e=r)})),e}return null}onSaveClick(t){t.preventDefault(),$("#overlay").show();let e=this.helpers.exportHelper.exportAndDetectChanges();this._$form.append('<textarea name="sheet_width_mm" class="nodisplay">'+this.helpers.context.sizeHelper.width.mm+"</textarea>"),this._$form.append('<textarea name="sheet_height_mm" class="nodisplay">'+this.helpers.context.sizeHelper.height.mm+"</textarea>"),this._$form.append('<textarea name="translateX" class="nodisplay">0</textarea>'),this._$form.append('<textarea name="translateY" class="nodisplay">0</textarea>'),this._$form.append('<textarea name="nonce" class="nodisplay">'+this.editor.model.settings.postNonce+"</textarea>"),this._totalParts=this.editor.svg.sheet.parts.length,$(this.editor.svg.sheet.parts).each(((t,i)=>{i.scalePathToFitWidthAndHeight(),i.partGroupNode;let r="single"==this.helpers.product.getSheetType()?"svg":i.id,n=this.findImage(i);if(n){let t=this.findImageNodeAndMergeWithParentMatrix(n),s=n.element.getAttribute("transform"),o="matrix("+t.a+","+t.b+","+t.c+","+t.d+","+t.e+","+t.f+")";n.element.setAttribute("transform",o),n.element.outerHTML;let a=n.element.getAttribute("attachment_id");$.ajax("/ajax/getAttachmentAsImageNode/"+a,{data:{transform:o},success:t=>{this.onPartLoaded(r,t)},error:function(t){}}),this._$form.append('<textarea name="cuttingline" class="nodisplay">'+i.path+"</textarea>"),this._$form.append('<textarea name="background" class="nodisplay">'+e.parts[0].background+"</textarea>"),n.element.setAttribute("transform",s)}else this.onPartLoaded(null,null)}))}onPartLoaded(t,e){t&&this._$form.append('<textarea name="'+t+'" class="nodisplay">'+e+"</textarea>"),this._partsLoaded++,this._partsLoaded==this._totalParts&&this.submit()}onSubmit(){this.helpers.change.isChanged(!0)}onEditorInit(){this.editor.svg.events.unregisterAllByEventName(a.SAVE),this.editor.svg.events.addListener(a.SAVE,(t=>this.onSaveClick(t)))}}class Zh extends kh{fixEmoji(){var t=this;$.getJSON("/static/images/web/emoji/index.json",(function(e){for(var i=e,r=t.editor.container.getElementsByTagName("svg")[0],n=r.getElementsByTagName("tspan"),s=new Array,o=0;o<n.length;o++){var a=n[o];if("text"==a.parentNode.tagName){var l=$(a).html(),h=t.ucs2decode(l);if(null!=h)for(var d=0;d<h.length;d++)for(var c=h.length-1;c>=d;c--){for(var u=h[d].toString(16),p=d+1;p<=c;p++)u+="-"+h[p].toString(16);if(-1!=i.indexOf(u)){s.push(u),d=c;break}}}}r.getAttribute("viewBox").split(" ");var g=t.editor.svg.activePart.boundingBox.height/8,m=0;m=null!=t.editor.svg.activePart.bleedPathNode?t.editor.svg.activePart.bleedPathNode.boundingBox.x-g-g/4:t.editor.svg.activePart.boundingBox.x-g-g/4;var f=t.editor.svg.activePart.boundingBox.y,v=0;for(o=0;o<s.length;o++){++v>8&&(m-=g,f=t.editor.svg.activePart.boundingBox.y,v=1);var b={};b.svg='<image xlink:href="https://api.stickerapp.com/static/images/web/emoji/'+s[o]+'.png" x="'+m+'" y="'+f+'" height="'+g+'" width="'+g+'" />',b.id="emoji_img_"+s[o];var y=t.editorSVG.node.addNode(new St,{json:b,part:t.editor.svg.activePart.id});t.editorSVG.import.importSVGData(b.svg,y,(function(){t.editor.svg.runBBox=!0,setTimeout((function(){y.makeBBoxUpdateList()}),0)})),f+=g}})).fail((function(){}))}ucs2encode(t){return this.map(t,(function(t){var e="";return t>65535&&(t-=65536,e+=String.fromCharCode(t>>>10&1023|55296),t=56320|1023&t),e+String.fromCharCode(t)})).join("")}ucs2decode(t){if(null==t||void 0===t)return null;for(var e,i,r=[],n=0,s=t.length;n<s;)(e=t.charCodeAt(n++))>=55296&&e<=56319&&n<s?56320==(64512&(i=t.charCodeAt(n++)))?r.push(((1023&e)<<10)+(1023&i)+65536):(r.push(e),n--):r.push(e);return r}map(t,e){for(var i=t.length,r=[];i--;)r[i]=e(t[i]);return r}}var Wh=function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function o(t){try{l(r.next(t))}catch(t){s(t)}}function a(t){try{l(r.throw(t))}catch(t){s(t)}}function l(t){t.done?n(t.value):function(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(o,a)}l((r=r.apply(t,e||[])).next())}))};class Kh extends kh{constructor(t){super(t),t.svg.events.addListener(a.INITIATED,(t=>this.onEditorInit()))}addCustomSticker(t,e){return Wh(this,void 0,void 0,(function*(){window.addCustomSticker({attributes:t.sheet,productItem:this.context.productItem,parts:t.parts,imageUrl:""}).then((i=>{this.helpers.change.isChanged(!0),$("#overlay").hide(),this.editor.trigger(a.DATA_POSTED,{request:t,response:i,intent:e})})).catch((t=>{throw $("#overlay").hide(),Error(t)}))}))}updateCustomSticker(t,e){return Wh(this,void 0,void 0,(function*(){window.updateCustomSticker({attributes:t.sheet,productItem:this.context.productItem,parts:t.parts,imageUrl:"",id:this.editor.model.id}).then((i=>{$("#overlay").hide(),this.editor.trigger(a.DATA_POSTED,{request:t,response:i,intent:e})})).catch((t=>{throw $("#overlay").hide(),Error(t)}))}))}onSaveClick(t,e){return Wh(this,void 0,void 0,(function*(){t.preventDefault(),$("#overlay").show(),yield this.editor.helpers.livePreview.saveMasks();let i=this.helpers.exportHelper.exportAndSanitizeData(e);window.updateCustomSticker&&this.editor.model.id?this.updateCustomSticker(i,e):window.addCustomSticker?this.addCustomSticker(i,e):(i.returnEditorModel=!0,$.ajax({type:"POST",url:this.editor.model.settings.postURL,data:i,success:t=>Wh(this,void 0,void 0,(function*(){this.helpers.change.isChanged(!0),$("#overlay").hide(),this.editor.trigger(a.DATA_POSTED,{request:i,response:t,intent:e}),this.helpers.eventTracker.trackEditorEvent(Js.SAVE_DESIGN)})),statusCode:{500:t=>{}},error:function(t){throw Error(t.responseText)}}))}))}onEditorInit(){this.editor.svg.events.unregisterAllByEventName(a.SAVE),this.editor.svg.events.addListener(a.SAVE,(t=>this.onSaveClick(t,t.intent)))}}class Yh extends kh{constructor(t){super(t),this.editor.svg.events.addListener(a.DATA_POSTED,((t,e)=>this.onDataPosted(t,e)))}onDataPosted(t,e){var i;$("body").hasClass("checkout")||(this.helpers.change.isChanged(!0),(null===(i=e.response)||void 0===i?void 0:i.redirectURL)&&(window.location=e.response.redirectURL))}}class Xh{static get UPDATE(){return"updatestickerappcart"}static get CHANGE(){return"changestickerappcart"}static get DUPLICATED_CART_SHEET(){return"duplicatedcartsheet"}}class Qh extends kh{constructor(t){super(t),t.svg.events.addListener(a.INITIATED,(t=>this.onEditorInit()))}onSaveClick(t,e){t.preventDefault();var i=this;let r=this.helpers.exportHelper.exportAndSanitizeData(e);$.ajax({type:"POST",url:this.editor.model.settings.postURL,data:r,success:function(t){$(i.editor.$el).trigger(Xh.UPDATE,r)},error:function(t){$("#connection-error").modal("show"),$("#overlay").hide()}})}onEditorInit(){this.editor.controller.unregisterAllByEventName(a.SAVE),this.editor.svg.events.addListener(a.SAVE,(t=>this.onSaveClick(t,t.intent)))}}class Jh extends kh{constructor(t){super(t),this._queue=[],this._busy=!1,this.retries=0,this._nodeCollection=new oe,this._thumbVersionCollection=new oe,this.editor.svg.events.addListener(p.IMAGE_CHECK_QUALITY,((t,e)=>this.onImageCheckQuality(e)))}requestThumb(t,e){let i=t.intId;this._thumbVersionCollection.get(i)!=e&&(this._nodeCollection.add(i,t),this._thumbVersionCollection.add(i,e),this._queue.indexOf(i)<0&&this._queue.push(i),this.processNext())}processNext(){if(this._queue.length&&!this._busy){let t,e,i=this._queue.shift(),r=this._nodeCollection.get(i),n=this._thumbVersionCollection.get(i);if(r&&r.element&&(t=r.element.getAttribute("fileapp_id"),e=r.element.getAttribute("fileapp_region")),i&&r&&n){if(this.editor.ui.showSpinner(),this._busy=!0,null!==t&&null!==e){let e=this;(new qh).getThumbnail(t,"image/png",n,(function(t){null!==t&&t.thumbUrl?e.onResult(i,t.thumbUrl):e.onError(i,t)}))}else $.ajax("/editor/get_thumbnail_version",{method:"GET",headers:{"Cache-Control":"max-age=172800",Pragma:"cache"},data:{href:r.element.getAttribute("xlink:href"),version:n},success:t=>this.onResult(i,t),error:t=>this.onError(i,t)});return}}this._busy||this.editor.ui.hideSpinner()}onImageCheckQuality(t){if("1"==t.uploaded&&(this.detectThumbVersion(t),t.currentThumbVersion)){let e=2*Math.max(t.widthPX,t.heightPX);e>400&&e<800?"sm"==t.currentThumbVersion&&this.requestThumb(t,"md"):e>800&&("sm"!=t.currentThumbVersion&&"md"!=t.currentThumbVersion||this.requestThumb(t,"lg"))}}detectThumbVersion(t){if(t.currentThumbVersion=null,"1"==t.uploaded){let e=t.element.getAttribute("xlink:href");e&&(e.indexOf("thumb.")?t.currentThumbVersion="sm":e.indexOf("_thumb_md.")?t.currentThumbVersion="md":e.indexOf("_thumb_lg.")&&(t.currentThumbVersion="lg"))}}onResult(t,e){let i=this._nodeCollection.get(t),r=this._thumbVersionCollection.get(t);i.currentThumbVersion=r,i.element.setAttribute("xlink:href",e),this.editor.helpers.livePreview.thumbVersions[i.id]=r,this._nodeCollection.delete(t),this._thumbVersionCollection.delete(t),this._busy=!1,this._queue.length?this.processNext():(this.editor.ui.hideSpinner(),this.editor.svg.events.trigger(p.SVG_PART_IMAGES_QUALITY_UPDATED))}onError(t,e){let i=this._nodeCollection.get(t),r=this._thumbVersionCollection.get(t);if(this._busy=!1,this.model.settings.livePreviewEnabled&&this.retries<=3)return this.retries++,this._nodeCollection.delete(t),this._thumbVersionCollection.delete(t),this.onImageCheckQuality(i);500==(null==e?void 0:e.status)&&(i.currentThumbVersion=r,this._nodeCollection.delete(t),this._thumbVersionCollection.delete(t)),this._queue.length?this.processNext():(this.editor.ui.hideSpinner(),this.editor.helpers.livePreview.hideLoadingSpinner(),this.editor.svg.events.trigger(a.GENERAL_ERROR,"Failed to get thumbnail, please try again"))}}class td extends kh{isChanged2(){return this.editor.edited}isChanged(t=!1){if(!this.editor.changed)return!1;let e=this.editor.helpers.exportHelper.exportSheet(),i=!1,r=JSON.stringify(this.editor.changed),n=this.allIndexOf(r,"flags");for(let t=0;t<n.length;t++){let e=n[t]+8,i=r.substr(e).indexOf('"'),s=new Array(i+1).join("1");r=r.substr(0,e)+s+r.substr(e+i)}let s=JSON.stringify(e),o=this.allIndexOf(s,"flags");for(let t=0;t<o.length;t++){let e=o[t]+8,i=s.substr(e).indexOf('"'),r=new Array(i+1).join("1");s=s.substr(0,e)+r+s.substr(e+i)}return r!=s&&(i=!0),t&&(this.editor.changed=e),i}allIndexOf(t,e){for(var i=[],r=t.indexOf(e);-1!==r;r=t.indexOf(e,r+1))i.push(r);return i}}class ed extends kh{changeCollage(t){var e=this;if(0!=t){this.removeCollage();var i=[];i.collage_id=t,i.parentId="back",this.editorSVG.node.addNode(new Ot,i,(function(t){t.parent.moveChildToPos(t,t.parent.children.length-1),t.isIndexLocked=!0,t.ignore=!0,t.overHandling=l.OVER_LAYER,e.editor.svg.collage=t;for(var i=0;i<e.editor.svg.multiArr.length;i++)e.editor.svg.collage.getPart().intId==e.editor.svg.multiArr[i].getPart().intId&&(e.editor.svg.multiArr[i].collageObject=null,e.editor.svg.multiArr[i].type==d.SHAPE_MULTI&&null==e.editor.svg.multiArr[i].collageObject&&e.editor.svg.collage.addImage(e.editor.svg.multiArr[i]))}));for(var r=!1,n=0;n<this.editor.svg.multiArr.length;n++)null==this.editor.svg.multiArr[n].collageObject&&this.editor.svg.collage.getPart().intId==this.editor.svg.multiArr[n].getPart().intId&&(r=!0,this.editor.svg.multiArr[n].remove());r&&this.editor.ui.showMessage(7,1,this.editor.helpers.message.getId(),"Too many images"),this.editor.helpers.select.select(null),this.editor.trigger(p.ACTIVATE_COLLAGE)}else this.removeCollage()}removeCollage(){if(null!=this.editor.svg.collage){let t=this.editor.svg.collage.getColParts();for(let e=0;e<t.length;e++)null!=t[e].imageNode&&(t[e].imageNode.ignore=!1,t[e].imageNode.overHandling=l.OVER_BBOX,t[e].imageNode.createBBoxAndCenter(),t[e].imageNode.collageObject=null,this.editor.svg.activePart.partGroupNode.changeBranch(t[e].imageNode));this.editor.svg.collage.remove(),this.editorSVG.shadow.removeCollage(),this.editor.svg.collage=null,this.editor.trigger(p.DEACTIVATE_COLLAGE)}}}var id=function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function o(t){try{l(r.next(t))}catch(t){s(t)}}function a(t){try{l(r.throw(t))}catch(t){s(t)}}function l(t){t.done?n(t.value):function(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(o,a)}l((r=r.apply(t,e||[])).next())}))};class rd extends kh{setColorPickerCanvas(t){if(null!=t){let e=t.getContext("2d");e.clearRect(0,0,t.width,t.height);let i=new Image;i.onload=function(){let t=Math.round((190-i.width)/2),r=Math.round((190-i.height)/2);isNaN(t)&&(t=0),isNaN(r)&&(r=0),e.drawImage(i,t,r)};let r=this.getSvgForCanvas();$.ajax({method:"POST",url:B.getURL(B.METHOD_URI_THUMB),data:{width:"190",height:"190",json:!0,svg:r},error:t=>{}}).done((function(t){let e=JSON.parse(t);i.src=e.image}))}}setHiddenCanvas(){return new Promise(((t,e)=>{let i=this.editor.ui.toolPane.cutlineTool.canvas;if(null!=i){let r=i.getContext("2d",{willReadFrequently:!0});r.clearRect(0,0,i.width,i.height);let n=new Image;n.onload=()=>{i.width=n.width,i.height=n.height,r.drawImage(n,0,0),t()};let s=this.getSvgForCanvas(),o=new FormData;o.append("json","true"),o.append("svg",s),fetch(B.getURL(B.METHOD_URI_THUMB),{method:"POST",body:o}).then((t=>t.json())).then((t=>n.src=t.image)).catch((t=>e(t)))}else t()}))}getSvgForCanvas(){let t=this.helpers.exportHelper.exportAndDetectChanges();if(t.parts.length){let e=0;for(let i=0;i<t.parts.length;i++)null!==this.editor.svg.activePart&&t.parts[i].part_id==this.editor.svg.activePart.id&&(e=i);let i=t.parts[e].matrix,r=t.parts[e]._originalPathBoundingBox,n=r.x+" "+r.y+" "+r.width+" "+r.height;t=t.parts[e].svg;let s="<svg ";return $("#"+this.editorSVG.id).each((function(){$.each(this.attributes,(function(t,e){let i=e.name,r=e.value;"width"==i&&(r="190px"),"height"==i&&(r="190px"),"viewBox"==i&&(r=n),s+=i+'="'+r+'" '}))})),s+=">",t=s+'<g transform="'+i+'" >'+t+"</g></svg>",t}return""}getMousMoveCanvasHex(t,e){let i=t.getContext("2d"),r="#",n=t.getBoundingClientRect(),s=e.clientX-n.left,o=e.clientY-n.top,a=i.getImageData(s,o,1,1).data,l=a[3]/255,h=255+(a[0]-255)*l,d=255+(a[1]-255)*l,c=255+(a[2]-255)*l;return r+=qt.paddy(h.toString(16),2),r+=qt.paddy(d.toString(16),2),r+=qt.paddy(c.toString(16),2),r}getBackgroundColor(t,e){let i,r=t.getContext("2d").getImageData(0,0,t.width,t.height),n=[[2,2],[2,t.width-2],[t.height-2,2],[t.height-2,t.width-2]],s="",o="#FFFFFF00";null!==this.editorSVG.activePart&&null!==this.editorSVG.activePart.backGroundNode&&(o=this.editorSVG.activePart.backGroundNode.element.getAttribute("fill")),n.forEach((t=>{let e=t[0]*t[1]*4,n=r.data[e].toString(16),a=r.data[e+1].toString(16),l=r.data[e+2].toString(16),h=r.data[e+3];n=1==n.length?"0"+n:n,a=1==a.length?"0"+a:a,l=1==l.length?"0"+l:l,i="#"+n+a+l,0==h&&(i=o),s=""===s||this.checkTwoColors(i,s,10)?i:o})),e(s)}checkTwoColors(t,e,i){let r=parseInt(t.substring(1,3),16),n=parseInt(t.substring(3,5),16),s=parseInt(t.substring(5,7),16),o=parseInt(e.substring(1,3),16),a=parseInt(e.substring(3,5),16),l=parseInt(e.substring(5,7),16),h=!0;return(o<r-i||o>r+i)&&(h=!1),(a<n-i||a>n+i)&&(h=!1),(l<s-i||l>s+i)&&(h=!1),h}getBackgroundColorOnImage(t){return id(this,void 0,void 0,(function*(){let e="";try{const i=yield fetch(t.link,{mode:"cors",cache:"no-store"});if(!i.ok)throw new Error("Failed to fetch image");const r=yield i.blob();e=URL.createObjectURL(r)}catch(t){}return new Promise((t=>{let i=new Image;i.crossOrigin="Anonymous",i.onload=()=>id(this,void 0,void 0,(function*(){try{yield i.decode();let e=document.createElement("canvas");e.width=i.width,e.height=i.height,e.getContext("2d").drawImage(i,0,0),this.getBackgroundColor(e,(e=>{t(e)}))}catch(e){t("#FFFFFF00")}})),i.onerror=()=>{t("#FFFFFF00"),URL.revokeObjectURL(e)},i.src=e}))}))}}class nd extends e.ProductItemHelper{constructor(t){super(t.productItem),this.context=t}getSKU(){return this.context.getSKU()}formatToOrderSheet(){return{sheet_type:this.getSheetTypeSaveAs(),sheet_name:this.getSheetName(),material:this.getMaterial(),laminate:this.getLaminate(),width:this.getWidthMM(),height:this.getHeightMM(),quantity:this.getQuantity()}}setCherryPickValue(t,e,i){this.context.cherryPicks.setAttribute(t,e),i&&this.context.attrComputer.setPreferredValues({})}setFeature(t,e){e?this.feature.insertOne(t):this.feature.deleteOne(t)}setEffectLayer(t){this.setFeature("effect_layer",t)}setBackprint(t,e=!0){e&&(t?this.context.cherryPicks.setAttribute("feature","backpaper_print"):this.context.cherryPicks.removeAttribute("feature","backpaper_print")),this.setFeature("backpaper_print",t)}getAllOutOfStockAttributesInProductItem(){let t={},e=this.context.productItem,i=this.context.attrComputer;if(e.getAttributes())for(let[r,n]of Object.entries(e.getAttributes()))if(n&&"string"==typeof n)i.isOutOfStock(r,n)&&(t[r]=n);else if(n&&"object"==typeof n){let e=[];for(let[t,s]of Object.entries(n))i.getOutOfStockValues(r).includes(s)&&e.push(s);e.length>0&&(t[r]=e)}return t}hasBackprint(){return this.feature.has("backpaper_print")}isEffectLayerPossible(){return this.context.attrComputer.isAvailable("feature","effect_layer")}isBackprintDealEnabled(){return!1}isBackprintPossible(){return this.context.attrComputer.isAvailable("feature","backpaper_print")}}class sd extends kh{clearBackParts(){for(var t=this.editor.svg.sheet.parts.length-1;t>=0;t--)"back"!=this.editor.svg.sheet.parts[t].side&&"back_deal"!=this.editor.svg.sheet.parts[t].side||(this.editor.svg.sheet.parts[t].isDeleteable?this.editor.svg.sheet.parts[t].remove():(this.editor.svg.select.select(null),this.editor.svg.sheet.parts[t].partGroupNode.removeChildren(),null!=this.editor.svg.sheet.parts[t].backGroundNode&&this.editor.svg.sheet.parts[t].setBackground("#FFF")))}}class od extends kh{constructor(t){super(t),this.isUpdating=!1,this.editor.svg.events.addListener(a.UPDATED,(t=>{this.isUpdating=!1}))}requestUpdate(t=500,e){this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout((()=>{this.isUpdating=!0,this.editor.trigger(a.REQUEST_UPDATE,e)}),t)}changeTemplate(t){M.changeTemplate(this.editor.helpers.product.sheetName,t),this.helpers.product.sheetName=t,this.requestUpdate(0,{rebuildSVG:!0})}}var ad=Sn('<!> <div class="colorEffectSelector svelte-ab8ly5"><!></div>',1);const ld={hash:"svelte-ab8ly5",code:".colorEffectSelector.svelte-ab8ly5 {z-index:100;width:fit-content;height:80px;position:absolute;margin-left:auto;margin-right:auto;left:0;right:0;bottom:35px;text-align:center;}"};function hd(t,e){dn(e,!0),Kn(t,ld);let i=Ls(e,"editor",7);const r=STATIC_BASE_URL.replace(/\/$/,"");let n=tn(!0),o=tn(!1),l=tn(oi({widthMM:i().helpers.product.item.getAttribute("width_mm"),heightMM:i().helpers.product.item.getAttribute("height_mm"),imperialUnits:i().helpers.product.item.getAttribute("imperial_units")}));Ms((()=>{i().helpers.livePreview.isVisible&&y()}));const h={invertEffects:i().model.language.live_preview.invertEffects,reset:i().model.language.live_preview.reset,materialEffect:i().model.language.live_preview.materialEffects,applyOnColors:i().model.language.live_preview.applyOnColors,tooltip:i().model.language.live_preview.tooltip,noEffect:i().model.language.live_preview.noEffect,colorEffect:i().model.language.live_preview.colorEffect,fullEffect:i().model.language.live_preview.fullEffect,errorHeader:i().model.language.live_preview.errorHeader,errorText:i().model.language.live_preview.errorText,reload:i().model.language.live_preview.reload,combinedMaskColorChangeAction:i().model.language.live_preview.combinedMaskColorChangeAction};let d=tn(oi(e.baseProps));const c=.45;let u=oi({laminateLayerEnabled:!0,patternScale:c,lightweight:e.lightweight,animationMode:e.animationMode,effectLayerEnabled:b(),holoIndex:2,showFps:!1,backgroundOption:i().ui.toolPane.backgroundSelector.getSelectedBg(),fullSize:!1}),p=tn(!1),g=tn(oi(T(e.baseProps.material.type))),m=tn(oi(e.visible)),f=tn(oi(Oo.SAVED_MASK)),v={width:+i().helpers.product.item.getAttribute("width_mm"),height:+i().helpers.product.item.getAttribute("height_mm")};function b(){return!!i().helpers.product.isEffectLayerPossible()}function y(){rn(m,!0)}function _(t){zr(d).laminate=t,rn(d,{...zr(d)},!0)}function T(t){if(t==Eo.Clear||t==Eo.ClearThin){const t=i().ui.toolPane.backgroundSelector.getSelectedBg();if(t==Ya.Light)return r+"/images/web/preview/backgrounds/checkers.svg";if(t==Ya.Dark)return r+"/images/web/preview/backgrounds/checkers-dark.svg"}const e=r+"/images/web/editor/";return["brushed_alloy","glitter","kraft_paper","mirror","pixie_dust","prismatic","holographic","reflective","gitd_industrial","kraft_thin","silver_thin"].includes(t)?e+zr(d).material.type+"_bg.png":""}function x(){zr(d).sticker.whiteLayerMasks.forEach((t=>{t.mode==Po.Mix?t.mode=Po.None:t.mode==Po.None&&(t.mode=Po.Mix)})),rn(d,{...zr(d)},!0)}function w(){rn(o,!1);let t=new CustomEvent(a.LIVE_PREVIEW_RELOAD_MASKS);dispatchEvent(t)}function E(){zr(f)==Oo.SAVED_MASK&&rn(f,Oo.CHANGED_SAVED_MASK,!0)}Di((()=>{zr(p)?i().ui.toolPane.saveButtonTool.setEnabled(!1):i().ui.toolPane.saveButtonTool.maybeEnable()})),Di((()=>{zr(d).laminate==Ao.SatinMatte?u.holoIndex=3:u.holoIndex=2,zr(f)&&(i().helpers.livePreview.whiteLayerMaskSource=zr(f)),function(){let t=new CustomEvent(a.LIVE_PREVIEW_BASE_PROPS_CHANGE,{detail:ni(zr(d))});dispatchEvent(t)}()}));var A=ad(),P=bi(A);Wa(P,{get isLoading(){return zr(p)},staticUrl:r,get settings(){return u},get wiggle(){return zr(n)},get productItemDimensions(){return zr(l)},get visible(){return zr(m)},set visible(t){rn(m,t,!0)},get baseProps(){return zr(d)},set baseProps(t){rn(d,t,!0)}});var S=yi(P,2),O=vi(S);const M=Pi((function(){const t=[Eo.Gitd,Eo.Reflective];return!u.effectLayerEnabled||!zr(n)||t.includes(zr(d).material.type)}));return Wl(O,{get isLoading(){return zr(p)},get materialImage(){return zr(g)},get materialName(){return zr(d).material.type},get masks(){return zr(d).sticker.whiteLayerMasks},get whiteLayerMaskSource(){return zr(f)},get disabled(){return zr(M)},get hasError(){return zr(o)},onUpdateMask:(t,e)=>{zr(d).sticker.whiteLayerMasks[e].mode=t,rn(d,{...zr(d)},!0),E(),i().helpers.eventTracker.trackEditorEvent(Js.SELECT_EFFECT)},onInvertMasksClicked:()=>{zr(f)==Oo.COMBINED?s.instance.confirmOrCancel(h.combinedMaskColorChangeAction,(()=>{w(),x()})):(x(),E()),i().helpers.eventTracker.trackEditorEvent(Js.INVERT_EFFECT)},onResetMasksClicked:()=>{zr(d).sticker.whiteLayerMasks.forEach((t=>{t.mode=Po.Mix})),rn(d,{...zr(d)},!0),i().helpers.eventTracker.trackEditorEvent(Js.RESET_EFFECT)},onCombinedMaskSourceSelect:()=>{s.instance.confirmOrCancel(h.combinedMaskColorChangeAction,w)},onReloadMasksClicked:w,translations:h}),ti(S),Cn(t,A),cn({setProductItemDimensions:function(t){rn(l,t,!0)},updateWiggleMode:function(t){rn(n,t,!0)},setAnimationMode:function(t){u.animationMode=t},setErrorFetchingMasks:function(){rn(o,!1)},clearMasks:function(){zr(d).sticker.whiteLayerMasks=[]},backgroundUpdated:function(){rn(g,T(zr(d).material.type),!0),u.backgroundOption=i().ui.toolPane.backgroundSelector.getSelectedBg()},laminateChanged:function(t){_(t)},materialChanged:function(t){!function(t){let e=Jl.find((e=>e.type===t));e?zr(d).material=e:(zr(d).material.type=t,zr(d).material.title=t,t==Eo.Clear&&(zr(d).material.isMetal=!0)),rn(d,{...zr(d)},!0),i().ui.toolPane.backgroundSelector.onMaterialChanged(t),rn(g,T(t),!0)}(t),_(i().context.productItem.getAttribute("laminate")),u.effectLayerEnabled=b()},updateSize:function(){let t=+i().helpers.product.item.getAttribute("width_mm"),e=+i().helpers.product.item.getAttribute("height_mm"),r=v.width/t,n=v.height/e;u.patternScale=c*(r+n)/2},updateSticker:function(t,e=!1){rn(d,{...zr(d),sticker:t},!0),u.effectLayerEnabled=b(),u.patternScale=c,v={width:+i().helpers.product.item.getAttribute("width_mm"),height:+i().helpers.product.item.getAttribute("height_mm")},rn(o,!1)},setLoadingMasks:function(t){rn(p,t,!0)},show:y,hide:function(){rn(m,!1)},updateMaskSource:function(t){rn(f,t,!0)}})}class dd{isApprovedForUpload(){return this.fileSizeTest&&this.fileTypeTest}}class cd{constructor(t="us"){this.lang="us",this.mimeTypeError="File type not allowed.",this.fileSizeError="File size too big.",this.fileAppEnabled=!1,this.lang=t}}class ud{static getURL(t="us",e=""){let i="https://api.stickerapp.com";return o.isDevMode()&&(i=window.API_URL?API_URL:"http://api.stickerapp.ci:8080"),o.isTestMode()&&(i=window.API_URL?API_URL:PROTOCOL+"://api."+DOMAIN),o.isLocalDevMode()&&(i="",e&&e.length&&e.indexOf("?")>=0?e+="&site=api":e&&e.length?e+="?site=api":e="?site=api"),e.length&&(i=i+"/"+e),i}static formatFormData(t){const e=new URLSearchParams;for(const i in t)e.append(i,t[i].toString());return e.toString()}}window.APIUtil=ud;class pd{constructor(t){this._fileSizeLimitInBytes=1e9,this._mimeTypeRestrictionList=["image/jpeg","image/pjpeg","image/png","image/gif","application/pdf","application/postscript","image/svg+xml","image/bmp","image/x-windows-bmp","application/psd","application/x-photoshop","application/photoshop","image/photoshop","image/psd","image/x-photoshop","image/x-psd","image/vnd.adobe.photoshop","image/tiff"],this._fileAppEnabled=!1,this._fileAppFilesProgress=new Map,this._fileAppFilesThumbResult=new Map,this._i18n=t||new cd,this._xhr=new XMLHttpRequest,this._xhr.upload.addEventListener("progress",(t=>this.onXHRUpload(t)),!1),this._xhr.onload=t=>this.onXHRLoad(t),this._postURL=ud.getURL(this._i18n.lang,"sticker_wizard/upload"),t&&(this._fileAppEnabled=t.fileAppEnabled),this._fileAppEnabled&&(this._fileAppService=new qh)}upload(t,e=null){this._files=[],this._fileAppEnabled&&(this._fileAppFilesProgress=new Map,this._fileAppFilesThumbResult=new Map),this._progress=0,this._xhr.abort(),e||(e=new FormData),e.append("lang",this._i18n.lang);let i=0,r=!1;for(;i<t.length;){let n=t.item(i),s=this.test(n);s.isApprovedForUpload()&&(e.append("files["+i.toString()+"]",n),r=!0),this._files.push(s),i++}return r&&(this._fileAppEnabled?(this._xhr.open("POST",this._fileAppService.nodeUrl+"/upload"),this._xhr.send(e)):(this._xhr.open("POST",this.postURL),this._xhr.send(e))),r}abort(){this._xhr.abort()}test(t){let e=new dd;return e.file=t,e.fileSizeTest=!0,e.fileTypeTest=!0,this.fileSizeLimitInBytes>0&&t.size>this.fileSizeLimitInBytes&&(e.fileSizeTest=!1,e.error=this._i18n.fileSizeError),this.mimeTypeRestrictionList&&this.mimeTypeRestrictionList.indexOf(t.type)<0&&(e.fileTypeTest=!1,e.error=this._i18n.mimeTypeError),e}getFilesAsJSON(){let t=[];for(let e in this.files)t[e]=Object.assign({},this.files[e]),delete t[e].file;return t}get postURL(){return this._postURL}set postURL(t){this._postURL=t}get onDone(){return this._onDone}set onDone(t){this._onDone=t}get onProgress(){return this._onProgress}set onProgress(t){this._onProgress=t}get onError(){return this._onError}set onError(t){this._onError=t}get progress(){return this._progress}get serverResponse(){return this._serverResponse}get serverResponseCode(){return this._serverResponseCode}get fileSizeLimitInBytes(){return this._fileSizeLimitInBytes}set fileSizeLimitInBytes(t){this._fileSizeLimitInBytes=t}get mimeTypeRestrictionList(){return this._mimeTypeRestrictionList}set mimeTypeRestrictionList(t){this._mimeTypeRestrictionList=t}get files(){return this._files}onXHRUpload(t){if(t.lengthComputable){let e=Math.round(100*t.loaded/t.total);this._progress!=e&&(this._progress=e,this._onProgress&&this._onProgress(this._progress))}}onFileAppUploadProgress(t,e){let i=t.target.id;if(t.lengthComputable){let r=Math.round(100*t.loaded/t.total);e._progress!=r&&(e._fileAppFilesProgress.set(i,r),e._progress=0,e._fileAppFilesProgress.forEach(((t,i)=>{e._progress+=Number(t)})),e._progress=e._progress/e._fileAppFilesProgress.size,e._onProgress&&e._onProgress(e._progress))}}onXHRLoad(t){if(this._serverResponseCode=this._xhr.status,200==this._serverResponseCode){this._progress=100,this._serverResponse=JSON.parse(this._xhr.response);let t,e=-1;for(let i in this._serverResponse.files){for(e++,t=this._files[e];!t.isApprovedForUpload()&&e<this._files.length-1;)e++,t=this._files[e];t.isApprovedForUpload()&&Object.assign(t,this._serverResponse.files[i])}this._onDone&&this._onDone()}else this.onError&&this.onError(this._xhr.status)}}var gd=function(t,e,i,r){return new(i||(i=Promise))((function(n,s){function o(t){try{l(r.next(t))}catch(t){s(t)}}function a(t){try{l(r.throw(t))}catch(t){s(t)}}function l(t){t.done?n(t.value):function(t){return t instanceof i?t:new i((function(e){e(t)}))}(t.value).then(o,a)}l((r=r.apply(t,e||[])).next())}))};class md{constructor(t){this.initialized=!1,this.shouldRebuildLivePreview=!0,this.fetching=!1,this.fetchingRequestID=0,this.fetchingRequestMap=new Map,this.inactivated=!1,this.previewWrapper=null,this.fonts=[],this.thumbVersions={},this.deviceType="desktop",this.initEventCriterias={svgReady:!1,imageQualityUpdated:!1},this.editor=t,this.container=document.getElementById("live-preview-container"),this.deviceType=n.getDeviceType(),this.editor.model.settings.livePreviewEnabled&&this.container&&(this.showLoadingSpinner(),this.setupEditorEvents(),window.addEventListener(a.BACKGROUND_UPDATED,(()=>{var t;this.isOn()&&(null===(t=this.previewWrapper)||void 0===t||t.backgroundUpdated())})),window.addEventListener(a.LIVE_PREVIEW_BASE_PROPS_CHANGE,(t=>{const e=t.detail;this.livePreviewWrapperStateBaseProps=e})),window.addEventListener(a.LIVE_PREVIEW_RELOAD_MASKS,(()=>gd(this,void 0,void 0,(function*(){try{const t=this.livePreviewWrapperStateBaseProps.sticker;t.whiteLayerMasks=yield this.getWhiteLayerMasks(t.previewImage),this.previewWrapper.updateSticker(t)}catch(t){this.onError(t)}})))))}setupEditorEvents(){this.editor.on(p.READY,this.container,(t=>{this.updateCriteriaAndInitialize("svgReady"),this.editor.svg.part.getFrontPart().imageNode||this.updateCriteriaAndInitialize("imageQualityUpdated")})),this.editor.on(p.RESIZE,this.container,(t=>{var e;null===(e=this.previewWrapper)||void 0===e||e.setProductItemDimensions({widthMM:this.editor.helpers.product.item.getAttribute("width_mm"),heightMM:this.editor.helpers.product.item.getAttribute("height_mm"),imperialUnits:this.editor.helpers.product.item.getAttribute("imperial_units")})})),this.editor.on(p.SVG_PART_IMAGES_QUALITY_UPDATED,this.container,(t=>{this.updateCriteriaAndInitialize("imageQualityUpdated")})),this.editor.on(a.LAMINATE_CHANGE,(t=>{this.isOn()&&this.previewWrapper.laminateChanged(t.detail.to)})),this.editor.on(a.MATERIAL_CHANGE,(t=>gd(this,void 0,void 0,(function*(){if(this.isOn()&&(this.show(),this.previewWrapper.materialChanged(t.detail.to),yield this.updateMaskMode(),!this.editor.helpers.product.isEffectLayerPossible())){const t=yield this.getLivePreviewPropsFromPart();this.previewWrapper.updateSticker(t)}})))),this.editor.on(a.REQUEST_PRODUCT_ATTR_EVALUATION,(()=>{this.previewWrapper.updateSize()}))}updateMaskMode(){return gd(this,void 0,void 0,(function*(){if(this.shouldSetMasksToMix()){const t=yield this.getLivePreviewPropsFromPart();t.whiteLayerMasks=t.whiteLayerMasks.map((t=>Object.assign(Object.assign({},t),{mode:Po.Mix}))),this.previewWrapper.updateSticker(t)}else if(this.shouldSetMasksToNone()){this.editor.ui.toolPane.backgroundTool.updateTransparentActive();const t=yield this.getLivePreviewPropsFromPart();t.whiteLayerMasks=t.whiteLayerMasks.map((t=>Object.assign(Object.assign({},t),{mode:Po.None}))),this.previewWrapper.updateSticker(t)}}))}shouldSetMasksToNone(){const t=[Eo.Gitd,Eo.Reflective,Eo.Vinyl,Eo.WhiteHiTack,Eo.WhiteRemovable,Eo.WhiteThin,Eo.WhiteWall,Eo.WhiteSturdy].includes(this.livePreviewWrapperStateBaseProps.material.type),e=this.editor.ui.toolPane.backgroundTool.isOriginalBackgroundTransparent,i=this.editor.svg.part.getBackground(),r="#FFFFFF"==i||"none"==i;return this.editor.helpers.product.isEffectLayerPossible()&&t&&e&&r}shouldSetMasksToMix(){const t=[Eo.Gitd,Eo.Reflective],e=this.editor.helpers.product.getMaterial();return t.includes(e)}updateCriteriaAndInitialize(t){this.initEventCriterias[t]=!0,this.areInitCriteriasMet()&&this.initialize()}areInitCriteriasMet(){return!(this.initialized||!this.isOn())&&Object.values(this.initEventCriterias).every((t=>!0===t))}updateToolsVisibility(t){var e;null===(e=this.previewWrapper)||void 0===e||e.updateWiggleMode(t)}initialize(){return gd(this,void 0,void 0,(function*(){if(!this.initialized&&this.container){this.initialized=!0;try{0===this.fonts.length&&(this.fonts=yield qo(API_URL));let t=yield this.buildBaseProps();yield this.initializePreviewWrapper(t),this.hideLoadingSpinner(),this.editor.ui.toolPane.backgroundSelector.onMaterialChanged(this.livePreviewWrapperStateBaseProps.material.type),this.shouldRebuildLivePreview=!1,this.previewWrapper.setAnimationMode(xo.OnMouseMoveReset),yield this.initOrientationForMobile();try{t.sticker.whiteLayerMasks=yield this.getWhiteLayerMasks(t.sticker.previewImage,this.shouldGetSavedMasks(this.editor.helpers.product.item)),this.previewWrapper.updateSticker(t.sticker)}catch(t){this.onError(t)}}catch(t){this.initialized=!1}}else this.hideLoadingSpinner()}))}shouldGetSavedMasks(t){var e;const i=t.hasAttribute("live_preview_white_layer_mask"),r=t.hasAttribute("live_preview_opacity_mask"),n=t.hasAttribute("live_preview_mask_color_settings");return null!==(e=null!=i?i:r)&&void 0!==e?e:n}initializePreviewWrapper(t){return gd(this,void 0,void 0,(function*(){null==this.previewWrapper&&(this.previewWrapper=Nn(hd,{target:this.container,props:{visible:!1,editor:this.editor,baseProps:t,lightweight:"mobile"===this.deviceType||this.editor.isSafari(),animationMode:"desktop"===this.deviceType?xo.OnMouseMove:xo.Loop}}))}))}initOrientationForMobile(){return gd(this,void 0,void 0,(function*(){"mobile"==this.deviceType&&"undefined"!=typeof DeviceOrientationEvent&&(this.shouldRequestPermissionForDeviceOrientation()?(yield this.requestPermissionForDeviceOrientation())instanceof Error&&s.instance.confirmOrCancel("Device orientation needs your permission.",this.requestPermissionForDeviceOrientation.bind(this)):this.previewWrapper.setAnimationMode(xo.OnDeviceOrientation))}))}shouldRequestPermissionForDeviceOrientation(){return"function"==typeof DeviceOrientationEvent.requestPermission}requestPermissionForDeviceOrientation(){return new Promise(((t,e)=>{DeviceOrientationEvent.requestPermission().then((e=>{"granted"==e?(this.previewWrapper.setAnimationMode(xo.OnDeviceOrientation),t(!0)):t(!1)})).catch((()=>t(new Error("Failed to request permission for device orientation."))))}))}get isVisible(){return!this.container.classList.contains("hidden")}get isHidden(){return this.container.classList.contains("hidden")}hideLoadingSpinner(){var t;null===(t=document.getElementById("live-preview-loading-spinner"))||void 0===t||t.classList.add("hidden")}showLoadingSpinner(){var t;null===(t=document.getElementById("live-preview-loading-spinner"))||void 0===t||t.classList.remove("hidden")}hide(){this.container&&(this.isActive&&this.editor.helpers.eventTracker.trackEditorEvent(Js.VIEW_EDIT),this.toggleVisibility(!1),this.isActive=!1,this.editor.trigger(a.LIVE_PREVIEW_HIDE),this.editor.svg.preview.turnOff())}shouldShowLivePreview(){return!!this.container&&!this.isActive&&!!this.isOn()}toggleVisibility(t){var e,i,r,n;t?(null===(e=this.editor.container)||void 0===e||e.classList.add("hidden"),this.container.classList.remove("hidden"),null===(i=this.previewWrapper)||void 0===i||i.show()):(null===(r=this.editor.container)||void 0===r||r.classList.remove("hidden"),this.container.classList.add("hidden"),null===(n=this.previewWrapper)||void 0===n||n.hide())}show(){this.shouldShowLivePreview()&&!this.isVisible&&(this.toggleVisibility(!0),this.initialized&&this.shouldRebuildLivePreview&&this.buildLivePreview(),this.editor.trigger(a.LIVE_PREVIEW_SHOW),this.editor.helpers.eventTracker.trackEditorEvent(Js.VIEW_PREVIEW),this.previewWrapper||(this.isActive=!0,this.showLoader()),this.editor.ui.notificationTool.clear())}buildLivePreview(){return gd(this,void 0,void 0,(function*(){const t=yield this.getLivePreviewPropsFromPart();this.previewWrapper.updateSticker(t),this.shouldRebuildLivePreview=!1;try{t.whiteLayerMasks=yield this.getWhiteLayerMasks(t.previewImage),this.previewWrapper.updateSticker(t)}catch(t){}this.fetching}))}showLoader(){this.isActive&&this.fetching&&$("#overlay").show()}hideLoader(){$("#overlay").hide()}onError(t){"AbortError"!==t.name&&(this.previewWrapper.clearMasks(),this.previewWrapper.setErrorFetchingMasks(),this.hideLoadingSpinner(),this.previewWrapper.setLoadingMasks(!1))}shouldRemoveMasks(){return this.areAllWhiteLayerMasksMixed()&&this.editor.helpers.product.isEffectLayerPossible()||!this.editor.helpers.product.isEffectLayerPossible()}shouldSaveMasks(){const t=this.areAllWhiteLayerMasksMixed(),e=this.editor.helpers.product.isEffectLayerPossible(),i=this.whiteLayerMaskSource===Oo.GENERATED,r=this.whiteLayerMaskSource===Oo.CHANGED_SAVED_MASK;return(i||r)&&e&&!t}areAllWhiteLayerMasksMixed(){var t;const e=null===(t=this.livePreviewWrapperStateBaseProps)||void 0===t?void 0:t.sticker.whiteLayerMasks;return!e||e.every((t=>t.mode===Po.Mix))}isDefaultInverted(){var t;const e=null===(t=this.livePreviewWrapperStateBaseProps)||void 0===t?void 0:t.sticker.whiteLayerMasks,i=this.editor.ui.toolPane.backgroundTool.isOriginalBackgroundTransparent&&this.editor.ui.toolPane.backgroundTool.isTransparentChecked,r=!!e&&e.every((t=>t.mode===Po.None));return i&&r}saveMasks(){return gd(this,void 0,void 0,(function*(){if(!this.isOn()||!this.shouldSaveMasks())return void(this.shouldRemoveMasks()&&(this.editor.helpers.product.item.removeAttribute("live_preview_white_layer_mask"),this.editor.helpers.product.item.removeAttribute("live_preview_opacity_mask")));this.isDefaultInverted()&&this.editor.helpers.product.item.setAttribute("live_preview_auto_inverted",!0);const t=yield function(t){return Jo(this,arguments,void 0,(function*(t,e=!1){const i=t.sticker.whiteLayerMasks[0].maskImgUrl,r=yield ea(i);let n=null;n=e&&t.material.type===Eo.Clear?yield function(t,e,i){return Jo(this,void 0,void 0,(function*(){const r=document.createElement("canvas"),n=r.getContext("2d");if(!n)return r;r.width=t,r.height=e;const s=yield Promise.all(i.filter((t=>""!==t.maskImgUrl&&t.mode==Po.None)).map((t=>Jo(this,void 0,void 0,(function*(){return{img:yield ea(t.maskImgUrl),color:t.colorRange,mode:t.mode}})))));return n.fillStyle=So.Effect,n.globalCompositeOperation="source-over",n.imageSmoothingEnabled=!0,n.imageSmoothingQuality="high",n.fillRect(0,0,r.width,r.height),s.forEach((t=>{n.drawImage(t.img,0,0,r.width,r.height)})),(yield Promise.all(i.filter((t=>""!==t.maskImgUrl&&t.mode==Po.Mix)).map((t=>Jo(this,void 0,void 0,(function*(){return{img:yield ea(t.maskImgUrl),color:t.colorRange,mode:t.mode}})))))).forEach((t=>{const e=function(t,e,i){e/=255,i/=255;const r=.4124564*(t=(t/=255)>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3575761*(e=e>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.1804375*(i=i>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92),n=.2126729*t+.7151522*e+.072175*i,s=.0193339*t+.119192*e+.9503041*i;let[o,a,l]=[r/.95047,n/1,s/1.08883];const h=.008856,d=903.3;return o=o>h?Math.pow(o,1/3):(d*o+16)/116,a=a>h?Math.pow(a,1/3):(d*a+16)/116,l=l>h?Math.pow(l,1/3):(d*l+16)/116,{l:Math.max(0,Math.min(100,116*a-16)),a:Math.max(-128,Math.min(127,500*(o-a))),b:Math.max(-128,Math.min(127,200*(a-l)))}}((o=function(t){const e=t.split(",").map(Number);return{r:e[0],g:e[1],b:e[2],a:void 0!==e[3]?e[3]:255}}(t.color)).r,o.g,o.b).l/100*(o.a/255)*.2*255,i=`rgba(${e}, ${e}, ${e}, 255)`,s=ra(t.img,i);var o;n.drawImage(s,0,0,r.width,r.height)})),r}))}(r.naturalWidth,r.naturalHeight,t.sticker.whiteLayerMasks):yield ta({imgWidth:r.naturalWidth,imgHeight:r.naturalHeight,fillStyle:t.maskBackground===Po.None?So.Color:So.Effect,globalCompositeOperation:t.maskBackground===Po.None?"destination-out":"source-over",filterMode:Po.None},t.maskBackground,t.sticker.whiteLayerMasks);const s=yield ta({imgWidth:r.naturalWidth,imgHeight:r.naturalHeight,fillStyle:t.maskBackground===Po.Full?So.Effect:So.Color,globalCompositeOperation:t.maskBackground===Po.Full?"source-over":"destination-out",filterMode:Po.Full},t.maskBackground,t.sticker.whiteLayerMasks);return{b64WhiteLayerMask:n.toDataURL("image/png"),b64OpacityMask:s.toDataURL("image/png")}}))}(this.livePreviewWrapperStateBaseProps,this.editor.model.settings.useGrayscaleMask),e=Ql(t.b64WhiteLayerMask,"image/png"),i=Ql(t.b64OpacityMask,"image/png"),r=new File([e],"whitelayer.png",{type:"image/png"}),n=new File([i],"opacity.png",{type:"image/png"});r&&n&&(yield this.uploadFilesToFileapp(r,n))}))}uploadFilesToFileapp(t,e){return gd(this,void 0,void 0,(function*(){const i=new cd(LANG);i.fileAppEnabled=!0;const r=new pd(i),n=new FormData,s=new DataTransfer;return s.items.add(t),s.items.add(e),new Promise(((t,e)=>gd(this,void 0,void 0,(function*(){try{(yield r.upload(s.files,n))?(r.files,r.onDone=()=>{try{const e=r.files;this.onUploadMasksCompleted(e),t()}catch(t){e(t)}}):e(new Error("No files were uploaded."))}catch(t){e(t)}}))))}))}onUploadMasksCompleted(t){t.forEach((t=>{var e,i;"whitelayer.png"===t.name&&this.editor.helpers.product.item.setAttribute("live_preview_white_layer_mask",t.fileapp_id),"opacity.png"===t.name&&this.editor.helpers.product.item.setAttribute("live_preview_opacity_mask",t.fileapp_id);const r=(null===(i=null===(e=this.livePreviewWrapperStateBaseProps)||void 0===e?void 0:e.sticker.whiteLayerMasks)||void 0===i?void 0:i.map((t=>{var{maskImgUrl:e}=t;return function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i}(t,["maskImgUrl"])})))||[];this.editor.helpers.product.item.setAttribute("live_preview_mask_color_settings",JSON.stringify(r))}))}isOn(){return!this.inactivated&&this.editor.model.settings.livePreviewEnabled}exportLivePreviewData(){var t;return{whiteLayerMaskSettings:null===(t=this.livePreviewWrapperStateBaseProps)||void 0===t?void 0:t.sticker.whiteLayerMasks}}getLivePreviewPropsFromPart(){return gd(this,void 0,void 0,(function*(){var t,e,i;const r=this.editor.svg.export.exportPart(this.editor.svg.part.getFrontPart(),0);let n=Bo(r);n=this.processSvg(n);const s=$o(r.matrix),o=Do(r.cuttingline,s),a=yield Lo(n,this.fonts,1080,1080,this.editor.isSafari()),l=No(n);return{path:o,width:l.xMax,height:l.yMax,pathWidth:l.xMax,pathHeight:l.yMax,previewImage:a,whiteLayerMasks:null!==(i=null===(e=null===(t=this.livePreviewWrapperStateBaseProps)||void 0===t?void 0:t.sticker)||void 0===e?void 0:e.whiteLayerMasks)&&void 0!==i?i:[]}}))}processSvg(t){const e=(new DOMParser).parseFromString(t,"image/svg+xml");for(const[t,i]of Object.entries(this.thumbVersions)){const r=e.getElementById(t);if(r){let t=r.getAttribute("xlink:href");t&&(t=t.replace(/thumb\./g,`thumb_${i}.`),r.setAttribute("xlink:href",t))}}return(new XMLSerializer).serializeToString(e)}getWhiteLayerMasks(t){return gd(this,arguments,void 0,(function*(t,e=!1){var i,r;let n=[],s=null;return this.fetching&&this.abortFetch(),this.previewWrapper.setLoadingMasks(!0),e&&(s=yield this.fetchMasks("","/editor/get_saved_preview_masks_from_product_item",{productItem:JSON.stringify(this.editor.model.productItem)}),n=null!==(i=s.masks)&&void 0!==i?i:[]),0===n.length&&(s=yield this.performMasksFetch(t),n=null!==(r=s.masks)&&void 0!==r?r:[]),s.source===Oo.COMBINED&&(n=yield Yl(n)),this.whiteLayerMaskSource=s.source,this.previewWrapper.setLoadingMasks(!1),this.previewWrapper.updateMaskSource(this.whiteLayerMaskSource),function(t,e){const i=t.whiteLayerMasks;if(!i)return e;const r=e.map((t=>{var e;const r=i.find((e=>function(t,e,i=10){if(!t||!e)return!1;const r=t.split(",").map(Number),n=e.split(",").map(Number);return r.length===n.length&&r.every(((t,e)=>Math.abs(t-n[e])<=i))}(e.colorRange,t.colorRange,20)));return Object.assign(Object.assign({},t),{colorRange:null!==(e=null==r?void 0:r.colorRange)&&void 0!==e?e:t.colorRange,mode:r?r.mode:t.mode})}));return r}(this.livePreviewWrapperStateBaseProps.sticker,n)}))}performMasksFetch(t){return gd(this,void 0,void 0,(function*(){var e;let i=null;const r=this.editor.ui.toolPane.backgroundTool.isTransparentChecked&&!this.shouldSetMasksToMix()?"Color":"Mix";return i=this.editor.model.settings.isAdmin?yield this.fetchMasks(API_URL,"/whitelayer/get_live_preview_mask",{b64:t,mode:r}):yield this.fetchMasks("","/api/whitelayer/get_live_preview_mask",{b64:t,mode:r}),(i.error||0===(null===(e=i.masks)||void 0===e?void 0:e.length))&&this.previewWrapper.setErrorFetchingMasks(),i}))}abortFetch(){this.fetchingRequestMap.forEach(((t,e)=>{t.abort()})),this.fetching=!1}closeFetch(t){this.fetchingRequestMap.delete(t),0===this.fetchingRequestMap.size&&(this.fetching=!1,this.hideLoader())}mapNewFetch(t){let e=this.nextFetchID();return this.fetchingRequestMap.set(e,t),this.fetching||(this.fetching=!0),e}nextFetchID(){return this.fetchingRequestID++}fetchMasks(t,e){return gd(this,arguments,void 0,(function*(t,e,i={}){let r=new AbortController;const n=new so(t),s=new FormData;let o=this.mapNewFetch(r);try{for(const t in i)i.hasOwnProperty(t)&&s.append(t,i[t]);n.setURL(e).setSignal(r.signal).setMethod("POST").setBody(s);let t=yield n.execute().then((t=>t));return null!=t?t:{masks:[]}}catch(t){if("AbortError"===t.name)throw this.closeFetch(o),t;this.onError(t)}finally{this.closeFetch(o)}}))}buildBaseProps(){return gd(this,void 0,void 0,(function*(){var t;const e=yield this.getLivePreviewPropsFromPart(),i=Jl.find((t=>t.type===this.editor.helpers.product.getMaterial()));return{patternScale:1,sticker:e,laminate:this.editor.helpers.product.getLaminate(),material:{type:this.editor.helpers.product.getMaterial(),title:this.editor.helpers.product.getMaterial(),isMetal:i.isMetal,enabled:!0,metallicOpacity:"function"==typeof i.metallicOpacity?i.metallicOpacity(this.editor.helpers.product.getLaminate()):null!==(t=i.metallicOpacity)&&void 0!==t?t:0,laminateSettings:{enabled:i.laminateSettings.enabled,laminateOpacity:i.laminateSettings.laminateOpacity}},maskBackground:Po.Mix}}))}}class fd{constructor(t){this.eventName="editor_interaction",this.savedEditorChanged={},this.editor=t}trackEditorChange(t,e,i,r=!1){var n,s,o;const a={event:this.eventName,event_params:Object.assign({change_from:e,change_to:i},this.getCommonEventData(t))};r?((null===(s=null===(n=this.savedEditorChanged[t])||void 0===n?void 0:n.event_params)||void 0===s?void 0:s.change_from)&&(a.event_params.change_from=null===(o=this.savedEditorChanged[t].event_params)||void 0===o?void 0:o.change_from),this.savedEditorChanged[t]=a):(this.dumpSavedEvents(),dataLayer.push({event_params:null}),dataLayer.push(a))}trackEditorEvent(t){const e={event:this.eventName,event_params:Object.assign({},this.getCommonEventData(t))};dataLayer.push({event_params:null}),dataLayer.push(e)}dumpSavedEvents(){for(const t in this.savedEditorChanged)if(Object.prototype.hasOwnProperty.call(this.savedEditorChanged,t)){const e=this.savedEditorChanged[t];dataLayer.push({event_params:null}),dataLayer.push(e)}this.savedEditorChanged={}}getCommonEventData(t){return{event_action:t,event_group:this.getEventGroup(),event_variant:this.getEventVariant(),editor_version:this.getEditorVersion(),signed_in:this.getSignedIn()}}getEventGroup(){return this.editor.helpers.livePreview.isVisible?eo.EDITOR_PREVIEW:this.editor.svg.part.isBackSideActive()?eo.EDITOR_BPP:eo.EDITOR_EDIT}getEventVariant(){var t;return null!==(t=this.editor.model.settings.origin)&&void 0!==t?t:o.isCheckout()?to.CHECKOUT_EDITOR:to.WIZARD_EDITOR}getEditorVersion(){return this.editor.helpers.livePreview.isOn()?"2":"1"}getSignedIn(){return this.editor.model.settings.isUserSignedIn?"true":"false"}}class vd extends kh{constructor(t){super(t),this.exportHelper=new $h(t),this.menu=new jh(t),this.outline=new Fh(t),this.fill=new zh(t),this.message=new Uh(t),this.emoji=new Zh(t),this.thumbnail=new Jh(t),this.change=new td(t),this.collage=new ed(t),this.canvas=new rd(t),this.product=new nd(t.context),this.backprint=new sd(t),this.event=new od(t),this.sizeConverter=new e.SizeConverter(this.context.productItem,0),this.livePreview=new md(t),this.eventTracker=new fd(t),($("body").hasClass("figure")||$("body").hasClass("customer")||t.model.settings.helpers&&t.model.settings.helpers.indexOf("helper_admin_figure")>-1)&&(this.figure=new Gh(t)),t.model.settings.helpers&&t.model.settings.helpers.indexOf("helper_modal")>-1&&new Kh(t),t.model.settings.helpers&&t.model.settings.helpers.indexOf("helper_stickerapp_modal")>-1&&new Yh(t),t.model.settings.helpers&&t.model.settings.helpers.indexOf("helper_stickerapp_inline_editor")>-1&&new Qh(t),this.editorSVG.overridables.mmToDisplayableFn=t=>(this.sizeConverter.mm=t,this.context.sizeHelper.formatDisplayableMeassure(this.sizeConverter.localized)),this.editorSVG.overridables.evaluatePartScaleFn=(t,e)=>this.editorSVG.isSheetMode?null:this.size.transform.evaluateScale(e,[t.width,t.height]),this.editorSVG.overridables.evaluatePartSizeFn=(t,e,i)=>{if(!this.editorSVG.isSheetMode){let t={widthMM:e,heightMM:i};const r=this.size.hasMaxSizeOtherSide()&&e>=i?this.size.maxSizeOtherSide.mm:this.size.maxSize.mm,n=this.size.hasMaxSizeOtherSide()&&e<i?this.size.maxSizeOtherSide.mm:this.size.maxSize.mm;return t.widthMM<this.size.minSize.mm&&(t.widthMM=this.size.minSize.mm),t.heightMM<this.size.minSize.mm&&(t.heightMM=this.size.minSize.mm),t.widthMM=t.widthMM>n?n:t.widthMM,t.heightMM=t.heightMM>r?r:t.heightMM,t}return null}}destroy(){}get size(){return this.context.sizeHelper}}class bd extends oe{static getInstance(){return bd._instance||(bd._instance=new bd),bd._instance}}class yd{constructor(){this.mode=E.MODE_SHEET,this.sheetZoomable=!0,this.zoomMode=c.ZOOM_SHEET,this.fontSize=22,this.subPartFontSize=17,this.minSizeMM=10,this.maxSizeMM=100,this.subPartMinSizeMM=10,this.bleedSizeMM=1,this.px2mm=2.83465,this.viewBox=null,this.preserveAspectRatio="xMidYMid meet",this.margin="8 8 8 8 8 8 8 8",this.noZoom=!1,this.zoomDelay=10,this.zoomSteps=2,this.fadePathId="cut",this.extraCopy=!1,this.useFlags=!0,this.iconsDefaultShape=d.SHAPE_CIRCLE,this.controlScaleToFitMediaOnDblClick=!0,this.fxDropShadow=!1,this.displayNodeMeasures=!1}}class _d extends v{execute(t,e){let i=t.currentTarget.querySelector("[id^=clippySvgPath]"),r=t.clientX,n=t.clientY,s=i.getBoundingClientRect(),o=(r-s.left)/s.width,a=(n-s.top)/s.height;if(Math.max(o,a)<=1&&Math.min(o,a)>=0){let t=this.editor.svg.part.getFrontPart();this.editor.svg.events.addListenerOnce(p.ZOOM_ANIMATION_END,(()=>{let e=t.clipPathNode.clipPathPath.element.getBoundingClientRect(),i=e.width*o+e.left,r=e.height*a+e.top;this.editor.svg.mouse.triggerEditorEvent(p.CLICK,{clientX:i,clientY:r})}))}}}class Td extends v{execute(t,e){var i,r;null===(r=null===(i=this.editor.ui.toolPane)||void 0===i?void 0:i.backPrintEditorTool)||void 0===r||r.show();let n=this.editor.svg.part.getFrontPart();this.editor.svg.zoomHelper.changeMode(c.ZOOM_PART,n),this.editor.ui.toolPane.saveButtonTool.setEnabled(!1),this.editor.ui.$previewBtn.removeClass("hidden"),this.editor.ui.$saveBtn.addClass("hidden"),this.editor.ui.$editBtn.addClass("hidden"),this.editor.ui.setLivePreviewToolsVisibility(!0)}}class xd extends v{execute(t,e){var i;null===(i=this.editor.ui.toolPane.backPrintEditorTool)||void 0===i||i.hide(),this.editor.ui.toolPane.saveButtonTool.maybeEnable(),this.model.settings.materialPresetsSelectorEnabled&&!this.editor.ui.toolPane.materialPresetsTool.visible&&this.editor.isLandscapeOrientation()&&(this.editor.ui.toolPane.materialPresetsTool.visible=!0),this.editor.ui.$editBtn.removeClass("hidden"),this.editor.ui.$previewBtn.addClass("hidden"),this.editor.ui.$saveBtn.removeClass("hidden"),this.editor.ui.setLivePreviewToolsVisibility(!0)}}class wd extends r{static get currentEditor(){return wd._currentEditor}static set currentEditor(t){wd._currentEditor=t}constructor(t,i){super(t),this.edited=!1,this._destroyed=!1,this._focus=null,this.initWidth="0",this.initHeight="0",this.model=window.editorData_=i,this.context=new e.ProductWizardContext;let r=!!(this.model.settings.isAdmin||this.model.productItem.attributes.hasOwnProperty("reorder_id")&&this.model.productItem.attributes.reorder_id);this.context.setCherryPicks({material:this.model.productItem.attributes.material,laminate:this.model.productItem.attributes.laminate,quantity:this.model.productItem.attributes.quantity,feature:this.model.productItem.attributes.feature,production_line:this.model.productItem.attributes.production_line,sheet_name:this.model.productItem.attributes.sheet_name},r),this.initWidth=this.model.productItem.attributes.width_mm.toString(),this.initHeight=this.model.productItem.attributes.height_mm.toString(),wd.isLandscape(window.innerWidth,window.innerHeight)?this.model.settings.livePreviewEnabled&&this.model.svgSettings.backgroundPattern&&(this.model.svgSettings.backgroundPattern=void 0):this.model.settings.livePreviewEnabled=!1,this.context.attrComputer.debugEnabled=!0,this.context.attrComputer.useFilters=this.model.settings.useFilters,this.svg=new se(this.container,this.id+"-svgroot",this.model.svgSettings,this.model.settings.livePreviewEnabled),this._ui=document.menuApi=new Rh(t,this)}static getInstance(t){if(bd.getInstance().has(t))return bd.getInstance().get(t);let e="#"+t,i=$(e).find("textarea").first().text(),r=JSON.parse(i);for(let t of r.parts)null!=t&&void 0!==t.svg&&null!==t.svg&&(t.svg=t.svg.replace(/&(?!amp;)/g,"&amp;"),t.svg=t.svg.replace(/(<tspan.*?>)(.*?)(<\/tspan>)/g,(function(t,e,i,r){return e+(i=(i=(i=i.replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/"/g,"&quot;"))+r})));let n=new wd($(e),r);return bd.getInstance().add(t,n),wd.currentEditor=n,n.init(),n}static constructUniqueID(){return"editor-"+(bd.getInstance().length+1)}init(){this.prepModel(),this.prepView(),this.prepController(),this.svg.canvas=this.helpers.canvas,this.rebuildSVG(this.model),this.trigger(a.INITIATED,this),this.isCartFull()}prepModel(){this._size=this.$el.data("size")}prepView(){this.helpers=new vd(this),this.ui.init(),this.$container.attr("id",this.containerID)}prepController(){let t=new V;this.registerCommand("resize orientationchange",t,window),n.isTouchDevice()&&(this.registerCommand("focusin",new S,document.body,"input, textarea"),this.registerCommand("blur",t,document.body,"input, textarea")),this.registerCommand("dragover",new b,this.$container.get(0)),this.registerCommand("drop",new x,this.$container.get(0)),this.svg.events.addListenerTo(window,"beforeunload",(t=>this.onWindowBeforeUnload(t))),this.registerCommand(a.OPEN_TEMPLATE_TYPE_SELECTOR,new C),this.registerCommand(a.REQUEST_UPDATE,new R),this.registerCommand(a.SAVE,new L),this.registerCommand(a.PRE_CHECKOUT_ACTION,new I);let e=new F;this.registerCommand(a.ORIENTATION_UPDATE,e),this.registerCommand(p.READY,new N);let i=new O;this.registerCommand(a.PART_EDITED,i),this.registerCommand(p.NODE_TRANSFORMED,i),this.registerCommand(p.NODE_REMOVED,i),this.svg.events.addListener(a.GENERAL_ERROR,(t=>{var e;this.helpers.livePreview.hideLoadingSpinner(),s.instance.confirmWithTitle(null!==(e=t.detail)&&void 0!==e?e:"Something went wrong please try again","Bad news...",(()=>{this.model.settings.askBeforeExit=!1,this._ui.closeEditor()}))})),this.model.settings.backPrintToolEnabled&&this.prepPaperBackPrintCommands();let r=new k;this.registerCommand(a.REQUEST_PRODUCT_ATTR_EVALUATION,r),this.registerCommand(p.READY,t),this.registerCommand(p.READY,r),this.registerCommand(a.UPDATED,r),this.registerCommand(a.BACKSIDEPRINT_REMOVED,r);let o=new w;this.registerCommand(a.PRODUCT_ATTR_EVALUATED,o),this.registerCommand(a.PRODUCT_ATTR_EVALUATED,new P);const l=this.helpers.livePreview.container;l&&this.model.settings.livePreviewEnabled&&(this.registerCommand("mousedown",new _d,l,"svg"),this.registerCommand(a.LIVE_PREVIEW_HIDE,new Td),this.registerCommand(a.LIVE_PREVIEW_SHOW,new xd))}prepPaperBackPrintCommands(){this.registerCommand(a.SWITCH_SIDE,new q);let t=new D;this.registerCommand(p.READY,t),this.registerCommand(a.UPDATE_BACKPRINT_PATH,t),this.svg.events.addListener(a.PRE_SAVE,(()=>{this.helpers.product.hasBackprint()||this.helpers.backprint.clearBackParts()}))}trigger(t,e,i,r){this.svg.events.trigger(t,e,i,r)}rebuildSVG(t,e=!1){if(this.svg.container.style.visibility="hidden",this.model=t,this.context.reset(this.model.productItem,this.model.attributes,!0),this.context.sizeHelper.evaluate(),this.svg.built&&this.svg.empty(),this.svg.svgSettings=Object.assign(Object.assign(Object.assign(Object.assign({},new yd),{controlScaleToFitMediaOnDblClick:this.model.settings.isAdmin}),this.model.svgSettings),{fxDropShadow:!this.model.settings.livePreviewEnabled,viewBox:"0 0 "+this.context.sizeHelper.width.px+" "+this.context.sizeHelper.height.px+100,margin:this.ui.formatSVGMargin()}),Array.isArray(this.model.parts)&&this.model.settings.backPrintToolEnabled){let t=!1;this.model.parts.forEach((e=>{"back"==e.side&&(t=!0)})),t||this.model.parts.push({resizeable:!1,aspectchangable:!1,side:"back",part_type:"back_print"})}this.svg.build(this.model.parts,this.context.sizeHelper.width.mm,this.context.sizeHelper.height.mm)}isSafari(){let t=navigator.userAgent.indexOf("Chrome")>-1;return navigator.userAgent.indexOf("Safari")>-1&&!t}destroy(){this.controller.trigger(a.DESTROY),this.svg.events.deleteAll(),this.svg.empty(),this.helpers.destroy(),this._ui.destroy(),this.$container.html(""),this._destroyed=!0,this.isSafari()&&(window.scrollBy(0,1),window.scrollBy(0,-1))}registerCommand(t,e,i,r){return e.editor=this,this.svg.events.registerHandler(t,e,i,r)}on(t,e,i){return this.svg.events.addListenerTo(this.$el.get(),t,e,i),this.$el}once(t,e,i){this.on(t,e,((...r)=>{this.off(t,e,i),(i||e)(...r)}))}isLargeMode(){return this.$el.hasClass(wd.SIZE_LARGE)}isLandscapeOrientation(){return this.$el.hasClass(wd.ORIENTATION_LANDSCAPE)}isEmbededInModal(){return this.$editorModal.length>0}static isLandscape(t,e){return n.isLandscape(t,e)&&e>480}static isLarge(t,e){return n.isLarge(t,e)}get $editorModal(){return this.$el.closest("#"+m.ELEMENT_ID)}get destroyed(){return this._destroyed}get isModal(){return!!this.$el.closest(".editor-modal").length}get $container(){return this.$(".editor-container")}get container(){return this.$container.get(0)}get ui(){return this._ui}get size(){return this._size&&"auto"!=this._size?this._size:i}get id(){return this.$el.attr("id")}get containerID(){return this.id+"-container"}get controller(){return this.svg.events}set orientation(t){switch(t){case wd.ORIENTATION_PORTRAIT:this.$el.removeClass(wd.ORIENTATION_LANDSCAPE).addClass(wd.ORIENTATION_PORTRAIT);break;case wd.ORIENTATION_LANDSCAPE:this.$el.removeClass(wd.ORIENTATION_PORTRAIT).addClass(wd.ORIENTATION_LANDSCAPE)}}get orientation(){return this.$el.hasClass(wd.ORIENTATION_LANDSCAPE)?wd.ORIENTATION_LANDSCAPE:this.$el.hasClass(wd.ORIENTATION_PORTRAIT)?wd.ORIENTATION_PORTRAIT:null}get focus(){return this._focus}set focus(t){this._focus=t}static get ORIENTATION_LANDSCAPE(){return"editor-orientation-landscape"}static get ORIENTATION_PORTRAIT(){return"editor-orientation-portrait"}static get SIZE_LARGE(){return"editor-size-lg"}onWindowBeforeUnload(t){var e;if(!(null===(e=this.ui.toolPane.convertSheetToSingleTool)||void 0===e?void 0:e.reloadPath))return this.model.settings.askBeforeExit&&this.helpers.change.isChanged()?(t.returnValue=this.model.language.unload_warning,this.model.language.unload_warning):void 0}isCartFull(){this.model.settings.isCartFull&&!this.model.id&&$("#modal-full-cart-warning").modal("show")}}const Ed='<style type="text/css" title="svg" media="all">'+__webpack_require__(7533).A+"</style>";function Ad(t,e){dn(e,!0);const i=Pi((()=>Promise.resolve({id:jo(),parts:e.parts,productItem:e.productItem,attributes:e.productItem.attributes})));ul(t,{get customStickerPromise(){return zr(i)}}),cn()}$((function(){window.EDITOR_INITIATED||($("head").append(Ed),$("div.editor").length&&$("div.editor").each((function(){$(this).attr("id")||$(this).attr("id",wd.constructUniqueID()),wd.getInstance($(this).attr("id"))})),$(document).on("build.stickerapp.editor","div.editor",(function(t){$(t.currentTarget).attr("id")||$(t.currentTarget).attr("id",wd.constructUniqueID()),wd.getInstance($(t.currentTarget).attr("id"))})),$(document).on("selfdestroy.stickerapp.editor","div.editor",(function(t){wd.getInstance($(t.currentTarget).attr("id")).destroy()})),window.EDITOR_INITIATED=!0)}));class Pd extends r{static get DATA_KEY(){return"stickerapp.sheetpreview"}static get CSS_CLASS_NAME(){return"sheet-preview"}constructor(t,e){super(t),this.refreshURL=e}render(t){this.$el.html(t);let e=this.$el.find(".lineItemLivePreviewContainer");if(e.length){e.data("productItem");const t=e.data("product-item"),i=e.data("parts");Nn(Ad,{target:e[0],props:{parts:i,productItem:t}})}this.$el.addClass("animated rubberBand").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",(function(){$(this).removeClass("animated rubberBand")}))}refresh(){this._xhr&&this._xhr.abort();let t=$("<div class='loader-wrapper'><img src='"+STATIC_BASE_URL+"/images/web/loaders/light.gif' class='loader-gif' /> </div>");t.css("width",this.$el.innerWidth()+"px"),t.css("height",this.$el.innerHeight()+"px"),this.$el.html(""),this.$el.append(t),this._xhr=$.ajax(this.refreshURL,{dataType:"text",success:t=>this.render(t),error:t=>{}})}get refreshURL(){return this._refreshURL}set refreshURL(t){this._refreshURL=t}static getInstance(t){return t.data(Pd.DATA_KEY)||t.data(Pd.DATA_KEY,new Pd(t,t.data("refresh-url"))),t.data(Pd.DATA_KEY)}}class Sd{constructor(){this.listeners=[]}on(t,e){this.listeners.push([t,e])}off(t,e){this.listeners=this.listeners.filter((([i,r])=>!(t===i&&e===r)))}once(t,e){const i=r=>{e(r),this.off(t,i)};this.on(t,i)}trigger(t,e){for(const[i,r]of this.listeners)i===t&&r(e)}destroy(){this.listeners=[]}}class Od extends Sd{constructor(){super(),this.patterns=[],window.addEventListener("popstate",(t=>{this.notify()}))}route(t,e){this.patterns.push([t,e])}push(t,e){window.history.pushState(e,"",t),this.notify()}replace(t,e){window.history.replaceState(e,"",t),this.notify()}go(t){window.history.go(t),this.notify()}forward(){window.history.forward()}back(){window.history.back()}navigate(t,e={trigger:!0}){window.history.pushState(void 0,"",t),e.trigger&&this.notify()}notify(){const t=window.location.toString();for(const[e,i]of this.patterns)if(e.test(t))return void this.trigger(`route:${i}`);this.trigger("route:nomatch")}}class Md extends Od{constructor(){super()}static get instance(){return Md._instance||(Md._instance=new Md),Md._instance}}$((function(){let t;Md.instance.route(/editor\/edit\/.*path/,"viewEditor"),Md.instance.route(/action=edit_template/,"viewEditor"),Md.instance.on("route:nomatch",(function(t){m.instance.isShown&&(m.instance.askBeforeHide?(m.instance.confirmHide(!1,(()=>Md.instance.forward())),n.isTouchDevice()&&setTimeout((()=>{s.instance.$el.scrollTop(10)}),500)):m.instance.hide(!1))})),Md.instance.on("route:viewEditor",(function(t){let e=location.pathname.slice(1),i=$("a[href='"+e+"'],a[href='/"+e+"'],a[href='/"+e+"/'],a[href='"+e+"/']");i.length&&i.trigger("click")})),$("body").on("openEditor",(function(e){m.instance.renderWithData(e.detail.toString()),t=location.href,Md.instance.navigate($(this).attr("href"),{trigger:!1}),$("body").hasClass("modal-open")&&$(".cart .hybrid-drawer-trigger").trigger("click")})),$("body").on("click","a[data-toggle=editor]",(function(e){e.preventDefault(),m.instance.render($(this).attr("href"),$(this).data("sheet-preview-component")),t=location.href,Md.instance.navigate($(this).attr("href"),{trigger:!1}),$("body").hasClass("modal-open")&&$(".cart .hybrid-drawer-trigger").trigger("click")})),$("body").on("hide.editormodal.stickerapp",(()=>m.instance.hide())),$("body").on(a.DATA_POSTED,(function(e){var i,r;"noRedirect"!==(null===(r=null===(i=e.originalEvent)||void 0===i?void 0:i.detail)||void 0===r?void 0:r.intent)&&(Md.instance.navigate(t,{trigger:!1}),m.instance.hide(!1),m.instance.sheetPreviewComponent&&m.instance.sheetPreviewComponent.length&&$(m.instance.sheetPreviewComponent).length&&setTimeout((function(){Pd.getInstance($(m.instance.sheetPreviewComponent)).refresh()}),300))})),$("body").on("hidden.stickerapp.editormodal",(function(){Md.instance.back()}))})),$(document).ready((function(){var t="."+Pd.CSS_CLASS_NAME;$("body").on("refresh.sheetpreview.stickerapp",t,(function(t){Pd.getInstance($(this)).refresh()}))}))})()})();
//# sourceMappingURL=editor.js.map